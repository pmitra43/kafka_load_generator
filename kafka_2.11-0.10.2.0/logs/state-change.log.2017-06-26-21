[2017-06-26 23:21:01,232] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to brokers Set() for partition __consumer_offsets-49 (state.change.logger)
[2017-06-26 23:21:01,233] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to brokers Set() for partition __consumer_offsets-38 (state.change.logger)
[2017-06-26 23:21:01,233] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to brokers Set() for partition __consumer_offsets-16 (state.change.logger)
[2017-06-26 23:21:01,233] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to brokers Set() for partition __consumer_offsets-27 (state.change.logger)
[2017-06-26 23:21:01,233] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to brokers Set() for partition __consumer_offsets-8 (state.change.logger)
[2017-06-26 23:21:01,233] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to brokers Set() for partition __consumer_offsets-19 (state.change.logger)
[2017-06-26 23:21:01,233] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to brokers Set() for partition __consumer_offsets-2 (state.change.logger)
[2017-06-26 23:21:01,233] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to brokers Set() for partition __consumer_offsets-13 (state.change.logger)
[2017-06-26 23:21:01,233] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to brokers Set() for partition __consumer_offsets-35 (state.change.logger)
[2017-06-26 23:21:01,233] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to brokers Set() for partition __consumer_offsets-46 (state.change.logger)
[2017-06-26 23:21:01,233] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to brokers Set() for partition __consumer_offsets-24 (state.change.logger)
[2017-06-26 23:21:01,233] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to brokers Set() for partition __consumer_offsets-5 (state.change.logger)
[2017-06-26 23:21:01,233] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to brokers Set() for partition __consumer_offsets-43 (state.change.logger)
[2017-06-26 23:21:01,233] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to brokers Set() for partition __consumer_offsets-32 (state.change.logger)
[2017-06-26 23:21:01,233] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to brokers Set() for partition __consumer_offsets-21 (state.change.logger)
[2017-06-26 23:21:01,233] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to brokers Set() for partition __consumer_offsets-10 (state.change.logger)
[2017-06-26 23:21:01,233] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to brokers Set() for partition __consumer_offsets-37 (state.change.logger)
[2017-06-26 23:21:01,233] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to brokers Set() for partition __consumer_offsets-48 (state.change.logger)
[2017-06-26 23:21:01,233] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to brokers Set() for partition __consumer_offsets-18 (state.change.logger)
[2017-06-26 23:21:01,233] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to brokers Set() for partition __consumer_offsets-40 (state.change.logger)
[2017-06-26 23:21:01,233] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to brokers Set() for partition __consumer_offsets-29 (state.change.logger)
[2017-06-26 23:21:01,233] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to brokers Set() for partition __consumer_offsets-7 (state.change.logger)
[2017-06-26 23:21:01,233] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to brokers Set() for partition __consumer_offsets-45 (state.change.logger)
[2017-06-26 23:21:01,233] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to brokers Set() for partition __consumer_offsets-34 (state.change.logger)
[2017-06-26 23:21:01,233] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to brokers Set() for partition __consumer_offsets-23 (state.change.logger)
[2017-06-26 23:21:01,233] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to brokers Set() for partition __consumer_offsets-26 (state.change.logger)
[2017-06-26 23:21:01,233] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to brokers Set() for partition __consumer_offsets-4 (state.change.logger)
[2017-06-26 23:21:01,233] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to brokers Set() for partition __consumer_offsets-15 (state.change.logger)
[2017-06-26 23:21:01,233] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to brokers Set() for partition __consumer_offsets-42 (state.change.logger)
[2017-06-26 23:21:01,233] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to brokers Set() for partition __consumer_offsets-9 (state.change.logger)
[2017-06-26 23:21:01,233] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to brokers Set() for partition __consumer_offsets-31 (state.change.logger)
[2017-06-26 23:21:01,233] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to brokers Set() for partition __consumer_offsets-20 (state.change.logger)
[2017-06-26 23:21:01,233] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to brokers Set() for partition __consumer_offsets-1 (state.change.logger)
[2017-06-26 23:21:01,233] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to brokers Set() for partition __consumer_offsets-12 (state.change.logger)
[2017-06-26 23:21:01,234] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to brokers Set() for partition __consumer_offsets-28 (state.change.logger)
[2017-06-26 23:21:01,234] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to brokers Set() for partition __consumer_offsets-17 (state.change.logger)
[2017-06-26 23:21:01,234] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to brokers Set() for partition __consumer_offsets-6 (state.change.logger)
[2017-06-26 23:21:01,234] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to brokers Set() for partition __consumer_offsets-39 (state.change.logger)
[2017-06-26 23:21:01,234] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to brokers Set() for partition __consumer_offsets-44 (state.change.logger)
[2017-06-26 23:21:01,234] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to brokers Set() for partition __consumer_offsets-36 (state.change.logger)
[2017-06-26 23:21:01,234] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to brokers Set() for partition __consumer_offsets-47 (state.change.logger)
[2017-06-26 23:21:01,234] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:6,ControllerEpoch:7) to brokers Set() for partition rf1p1-0 (state.change.logger)
[2017-06-26 23:21:01,234] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to brokers Set() for partition __consumer_offsets-25 (state.change.logger)
[2017-06-26 23:21:01,234] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to brokers Set() for partition __consumer_offsets-3 (state.change.logger)
[2017-06-26 23:21:01,234] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to brokers Set() for partition __consumer_offsets-14 (state.change.logger)
[2017-06-26 23:21:01,234] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to brokers Set() for partition __consumer_offsets-41 (state.change.logger)
[2017-06-26 23:21:01,234] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to brokers Set() for partition __consumer_offsets-30 (state.change.logger)
[2017-06-26 23:21:01,234] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to brokers Set() for partition __consumer_offsets-11 (state.change.logger)
[2017-06-26 23:21:01,234] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to brokers Set() for partition __consumer_offsets-22 (state.change.logger)
[2017-06-26 23:21:01,234] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to brokers Set() for partition __consumer_offsets-33 (state.change.logger)
[2017-06-26 23:21:01,234] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to brokers Set() for partition __consumer_offsets-0 (state.change.logger)
[2017-06-26 23:21:01,235] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,19] (state.change.logger)
[2017-06-26 23:21:01,238] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,19] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,19] is alive. Live brokers are: [Set()], Assigned replicas are: [List(1, 2, 0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:67)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:342)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:160)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:85)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1174)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:736)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 23:21:01,238] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,30] (state.change.logger)
[2017-06-26 23:21:01,241] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,30] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,30] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0, 1, 2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:67)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:342)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:160)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:85)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1174)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:736)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 23:21:01,241] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,47] (state.change.logger)
[2017-06-26 23:21:01,244] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,47] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,47] is alive. Live brokers are: [Set()], Assigned replicas are: [List(2, 1, 0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:67)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:342)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:160)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:85)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1174)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:736)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 23:21:01,244] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,29] (state.change.logger)
[2017-06-26 23:21:01,246] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,29] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,29] is alive. Live brokers are: [Set()], Assigned replicas are: [List(2, 1, 0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:67)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:342)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:160)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:85)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1174)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:736)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 23:21:01,247] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,41] (state.change.logger)
[2017-06-26 23:21:01,249] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,41] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,41] is alive. Live brokers are: [Set()], Assigned replicas are: [List(2, 1, 0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:67)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:342)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:160)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:85)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1174)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:736)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 23:21:01,249] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,39] (state.change.logger)
[2017-06-26 23:21:01,251] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,39] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,39] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0, 2, 1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:67)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:342)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:160)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:85)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1174)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:736)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 23:21:01,252] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,17] (state.change.logger)
[2017-06-26 23:21:01,254] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,17] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,17] is alive. Live brokers are: [Set()], Assigned replicas are: [List(2, 1, 0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:67)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:342)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:160)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:85)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1174)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:736)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 23:21:01,254] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,10] (state.change.logger)
[2017-06-26 23:21:01,256] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,10] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,10] is alive. Live brokers are: [Set()], Assigned replicas are: [List(1, 0, 2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:67)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:342)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:160)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:85)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1174)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:736)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 23:21:01,257] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,14] (state.change.logger)
[2017-06-26 23:21:01,259] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,14] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,14] is alive. Live brokers are: [Set()], Assigned replicas are: [List(2, 0, 1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:67)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:342)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:160)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:85)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1174)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:736)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 23:21:01,259] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,40] (state.change.logger)
[2017-06-26 23:21:01,262] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,40] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,40] is alive. Live brokers are: [Set()], Assigned replicas are: [List(1, 0, 2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:67)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:342)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:160)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:85)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1174)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:736)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 23:21:01,262] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,18] (state.change.logger)
[2017-06-26 23:21:01,265] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,18] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,18] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0, 1, 2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:67)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:342)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:160)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:85)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1174)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:736)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 23:21:01,265] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,0] (state.change.logger)
[2017-06-26 23:21:01,269] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0, 1, 2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:67)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:342)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:160)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:85)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1174)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:736)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 23:21:01,269] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,26] (state.change.logger)
[2017-06-26 23:21:01,272] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,26] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,26] is alive. Live brokers are: [Set()], Assigned replicas are: [List(2, 0, 1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:67)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:342)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:160)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:85)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1174)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:736)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 23:21:01,272] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,24] (state.change.logger)
[2017-06-26 23:21:01,275] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,24] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,24] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0, 1, 2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:67)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:342)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:160)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:85)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1174)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:736)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 23:21:01,275] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,33] (state.change.logger)
[2017-06-26 23:21:01,277] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,33] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,33] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0, 2, 1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:67)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:342)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:160)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:85)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1174)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:736)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 23:21:01,277] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,20] (state.change.logger)
[2017-06-26 23:21:01,280] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,20] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,20] is alive. Live brokers are: [Set()], Assigned replicas are: [List(2, 0, 1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:67)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:342)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:160)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:85)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1174)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:736)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 23:21:01,280] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,21] (state.change.logger)
[2017-06-26 23:21:01,282] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,21] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,21] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0, 2, 1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:67)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:342)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:160)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:85)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1174)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:736)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 23:21:01,282] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,3] (state.change.logger)
[2017-06-26 23:21:01,284] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,3] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,3] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0, 2, 1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:67)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:342)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:160)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:85)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1174)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:736)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 23:21:01,284] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,22] (state.change.logger)
[2017-06-26 23:21:01,287] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,22] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,22] is alive. Live brokers are: [Set()], Assigned replicas are: [List(1, 0, 2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:67)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:342)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:160)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:85)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1174)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:736)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 23:21:01,287] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,5] (state.change.logger)
[2017-06-26 23:21:01,289] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,5] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,5] is alive. Live brokers are: [Set()], Assigned replicas are: [List(2, 1, 0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:67)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:342)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:160)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:85)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1174)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:736)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 23:21:01,290] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,12] (state.change.logger)
[2017-06-26 23:21:01,292] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,12] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,12] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0, 1, 2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:67)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:342)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:160)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:85)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1174)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:736)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 23:21:01,292] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,8] (state.change.logger)
[2017-06-26 23:21:01,294] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,8] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,8] is alive. Live brokers are: [Set()], Assigned replicas are: [List(2, 0, 1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:67)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:342)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:160)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:85)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1174)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:736)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 23:21:01,294] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,23] (state.change.logger)
[2017-06-26 23:21:01,297] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,23] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,23] is alive. Live brokers are: [Set()], Assigned replicas are: [List(2, 1, 0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:67)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:342)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:160)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:85)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1174)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:736)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 23:21:01,297] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,15] (state.change.logger)
[2017-06-26 23:21:01,299] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,15] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,15] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0, 2, 1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:67)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:342)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:160)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:85)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1174)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:736)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 23:21:01,299] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,11] (state.change.logger)
[2017-06-26 23:21:01,302] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,11] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,11] is alive. Live brokers are: [Set()], Assigned replicas are: [List(2, 1, 0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:67)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:342)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:160)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:85)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1174)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:736)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 23:21:01,302] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,48] (state.change.logger)
[2017-06-26 23:21:01,316] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,48] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,48] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0, 1, 2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:67)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:342)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:160)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:85)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1174)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:736)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 23:21:01,316] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,13] (state.change.logger)
[2017-06-26 23:21:01,318] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,13] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,13] is alive. Live brokers are: [Set()], Assigned replicas are: [List(1, 2, 0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:67)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:342)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:160)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:85)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1174)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:736)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 23:21:01,318] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,6] (state.change.logger)
[2017-06-26 23:21:01,321] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,6] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,6] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0, 1, 2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:67)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:342)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:160)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:85)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1174)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:736)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 23:21:01,321] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,49] (state.change.logger)
[2017-06-26 23:21:01,323] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,49] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,49] is alive. Live brokers are: [Set()], Assigned replicas are: [List(1, 2, 0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:67)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:342)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:160)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:85)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1174)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:736)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 23:21:01,324] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,4] (state.change.logger)
[2017-06-26 23:21:01,326] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,4] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,4] is alive. Live brokers are: [Set()], Assigned replicas are: [List(1, 0, 2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:67)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:342)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:160)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:85)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1174)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:736)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 23:21:01,326] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,28] (state.change.logger)
[2017-06-26 23:21:01,328] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,28] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,28] is alive. Live brokers are: [Set()], Assigned replicas are: [List(1, 0, 2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:67)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:342)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:160)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:85)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1174)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:736)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 23:21:01,328] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,37] (state.change.logger)
[2017-06-26 23:21:01,330] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,37] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,37] is alive. Live brokers are: [Set()], Assigned replicas are: [List(1, 2, 0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:67)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:342)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:160)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:85)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1174)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:736)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 23:21:01,330] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,31] (state.change.logger)
[2017-06-26 23:21:01,331] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,31] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,31] is alive. Live brokers are: [Set()], Assigned replicas are: [List(1, 2, 0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:67)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:342)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:160)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:85)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1174)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:736)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 23:21:01,331] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,44] (state.change.logger)
[2017-06-26 23:21:01,333] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,44] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,44] is alive. Live brokers are: [Set()], Assigned replicas are: [List(2, 0, 1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:67)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:342)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:160)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:85)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1174)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:736)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 23:21:01,333] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,42] (state.change.logger)
[2017-06-26 23:21:01,335] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,42] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,42] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0, 1, 2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:67)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:342)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:160)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:85)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1174)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:736)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 23:21:01,335] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,34] (state.change.logger)
[2017-06-26 23:21:01,337] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,34] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,34] is alive. Live brokers are: [Set()], Assigned replicas are: [List(1, 0, 2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:67)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:342)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:160)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:85)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1174)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:736)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 23:21:01,337] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,46] (state.change.logger)
[2017-06-26 23:21:01,338] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,46] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,46] is alive. Live brokers are: [Set()], Assigned replicas are: [List(1, 0, 2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:67)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:342)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:160)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:85)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1174)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:736)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 23:21:01,338] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,25] (state.change.logger)
[2017-06-26 23:21:01,340] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,25] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,25] is alive. Live brokers are: [Set()], Assigned replicas are: [List(1, 2, 0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:67)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:342)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:160)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:85)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1174)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:736)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 23:21:01,340] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,27] (state.change.logger)
[2017-06-26 23:21:01,341] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,27] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,27] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0, 2, 1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:67)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:342)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:160)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:85)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1174)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:736)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 23:21:01,341] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,45] (state.change.logger)
[2017-06-26 23:21:01,343] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,45] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,45] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0, 2, 1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:67)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:342)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:160)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:85)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1174)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:736)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 23:21:01,343] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,32] (state.change.logger)
[2017-06-26 23:21:01,344] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,32] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,32] is alive. Live brokers are: [Set()], Assigned replicas are: [List(2, 0, 1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:67)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:342)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:160)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:85)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1174)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:736)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 23:21:01,344] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,43] (state.change.logger)
[2017-06-26 23:21:01,346] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,43] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,43] is alive. Live brokers are: [Set()], Assigned replicas are: [List(1, 2, 0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:67)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:342)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:160)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:85)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1174)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:736)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 23:21:01,346] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,36] (state.change.logger)
[2017-06-26 23:21:01,347] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,36] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,36] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0, 1, 2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:67)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:342)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:160)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:85)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1174)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:736)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 23:21:01,347] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,35] (state.change.logger)
[2017-06-26 23:21:01,349] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,35] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,35] is alive. Live brokers are: [Set()], Assigned replicas are: [List(2, 1, 0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:67)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:342)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:160)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:85)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1174)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:736)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 23:21:01,349] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,7] (state.change.logger)
[2017-06-26 23:21:01,350] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,7] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,7] is alive. Live brokers are: [Set()], Assigned replicas are: [List(1, 2, 0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:67)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:342)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:160)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:85)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1174)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:736)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 23:21:01,351] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,38] (state.change.logger)
[2017-06-26 23:21:01,352] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,38] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,38] is alive. Live brokers are: [Set()], Assigned replicas are: [List(2, 0, 1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:67)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:342)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:160)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:85)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1174)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:736)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 23:21:01,352] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,9] (state.change.logger)
[2017-06-26 23:21:01,354] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,9] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,9] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0, 2, 1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:67)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:342)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:160)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:85)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1174)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:736)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 23:21:01,354] TRACE Controller 0 epoch 8 started leader election for partition [rf1p1,0] (state.change.logger)
[2017-06-26 23:21:01,355] ERROR Controller 0 epoch 8 initiated state change for partition [rf1p1,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [rf1p1,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:67)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:342)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:160)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:85)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1174)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:736)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 23:21:01,355] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,1] (state.change.logger)
[2017-06-26 23:21:01,357] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,1] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,1] is alive. Live brokers are: [Set()], Assigned replicas are: [List(1, 2, 0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:67)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:342)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:160)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:85)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1174)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:736)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 23:21:01,357] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,2] (state.change.logger)
[2017-06-26 23:21:01,358] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,2] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,2] is alive. Live brokers are: [Set()], Assigned replicas are: [List(2, 0, 1)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:67)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:342)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:160)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:85)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1174)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:736)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 23:21:01,358] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,16] (state.change.logger)
[2017-06-26 23:21:01,360] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,16] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,16] is alive. Live brokers are: [Set()], Assigned replicas are: [List(1, 0, 2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:67)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:342)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:160)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:85)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1175)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1174)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:736)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 23:21:06,376] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-49 (state.change.logger)
[2017-06-26 23:21:06,376] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-38 (state.change.logger)
[2017-06-26 23:21:06,376] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-16 (state.change.logger)
[2017-06-26 23:21:06,376] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-27 (state.change.logger)
[2017-06-26 23:21:06,376] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-8 (state.change.logger)
[2017-06-26 23:21:06,376] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-19 (state.change.logger)
[2017-06-26 23:21:06,376] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-2 (state.change.logger)
[2017-06-26 23:21:06,377] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-13 (state.change.logger)
[2017-06-26 23:21:06,377] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-35 (state.change.logger)
[2017-06-26 23:21:06,377] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-46 (state.change.logger)
[2017-06-26 23:21:06,377] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-24 (state.change.logger)
[2017-06-26 23:21:06,377] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-5 (state.change.logger)
[2017-06-26 23:21:06,377] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-43 (state.change.logger)
[2017-06-26 23:21:06,377] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-32 (state.change.logger)
[2017-06-26 23:21:06,377] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-21 (state.change.logger)
[2017-06-26 23:21:06,377] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-10 (state.change.logger)
[2017-06-26 23:21:06,377] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-37 (state.change.logger)
[2017-06-26 23:21:06,377] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-48 (state.change.logger)
[2017-06-26 23:21:06,377] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-18 (state.change.logger)
[2017-06-26 23:21:06,377] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-40 (state.change.logger)
[2017-06-26 23:21:06,377] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-29 (state.change.logger)
[2017-06-26 23:21:06,377] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-7 (state.change.logger)
[2017-06-26 23:21:06,377] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-45 (state.change.logger)
[2017-06-26 23:21:06,377] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-34 (state.change.logger)
[2017-06-26 23:21:06,377] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-23 (state.change.logger)
[2017-06-26 23:21:06,377] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-26 (state.change.logger)
[2017-06-26 23:21:06,377] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-4 (state.change.logger)
[2017-06-26 23:21:06,377] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-15 (state.change.logger)
[2017-06-26 23:21:06,377] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-42 (state.change.logger)
[2017-06-26 23:21:06,377] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-9 (state.change.logger)
[2017-06-26 23:21:06,377] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-31 (state.change.logger)
[2017-06-26 23:21:06,377] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-20 (state.change.logger)
[2017-06-26 23:21:06,377] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-1 (state.change.logger)
[2017-06-26 23:21:06,377] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-12 (state.change.logger)
[2017-06-26 23:21:06,377] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-28 (state.change.logger)
[2017-06-26 23:21:06,377] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-17 (state.change.logger)
[2017-06-26 23:21:06,377] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-6 (state.change.logger)
[2017-06-26 23:21:06,377] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-39 (state.change.logger)
[2017-06-26 23:21:06,377] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-44 (state.change.logger)
[2017-06-26 23:21:06,377] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-36 (state.change.logger)
[2017-06-26 23:21:06,377] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-47 (state.change.logger)
[2017-06-26 23:21:06,377] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:6,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition rf1p1-0 (state.change.logger)
[2017-06-26 23:21:06,377] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-25 (state.change.logger)
[2017-06-26 23:21:06,377] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-3 (state.change.logger)
[2017-06-26 23:21:06,377] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-14 (state.change.logger)
[2017-06-26 23:21:06,377] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-41 (state.change.logger)
[2017-06-26 23:21:06,377] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-30 (state.change.logger)
[2017-06-26 23:21:06,377] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-11 (state.change.logger)
[2017-06-26 23:21:06,377] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-22 (state.change.logger)
[2017-06-26 23:21:06,377] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-33 (state.change.logger)
[2017-06-26 23:21:06,377] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-0 (state.change.logger)
[2017-06-26 23:21:06,379] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-13 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 0 (state.change.logger)
[2017-06-26 23:21:06,379] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,28] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,379] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-46 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 0 (state.change.logger)
[2017-06-26 23:21:06,379] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-9 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 0 (state.change.logger)
[2017-06-26 23:21:06,379] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,17] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,379] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-42 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 0 (state.change.logger)
[2017-06-26 23:21:06,379] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-21 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 0 (state.change.logger)
[2017-06-26 23:21:06,379] TRACE Controller 0 epoch 8 changed state of replica 0 for partition [__consumer_offsets,25] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,380] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-17 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 0 (state.change.logger)
[2017-06-26 23:21:06,380] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-30 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 0 (state.change.logger)
[2017-06-26 23:21:06,380] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,48] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,380] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-26 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 0 (state.change.logger)
[2017-06-26 23:21:06,380] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-5 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 0 (state.change.logger)
[2017-06-26 23:21:06,380] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-38 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 0 (state.change.logger)
[2017-06-26 23:21:06,380] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,5] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,380] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-1 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 0 (state.change.logger)
[2017-06-26 23:21:06,380] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-34 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 0 (state.change.logger)
[2017-06-26 23:21:06,380] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,21] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,380] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-16 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 0 (state.change.logger)
[2017-06-26 23:21:06,380] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-45 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 0 (state.change.logger)
[2017-06-26 23:21:06,380] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,38] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,380] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-12 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 0 (state.change.logger)
[2017-06-26 23:21:06,380] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-41 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 0 (state.change.logger)
[2017-06-26 23:21:06,380] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,39] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,380] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-24 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 0 (state.change.logger)
[2017-06-26 23:21:06,380] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-20 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 0 (state.change.logger)
[2017-06-26 23:21:06,380] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,2] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,380] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-49 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 0 (state.change.logger)
[2017-06-26 23:21:06,380] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-0 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 0 (state.change.logger)
[2017-06-26 23:21:06,380] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,18] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,380] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-29 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 0 (state.change.logger)
[2017-06-26 23:21:06,380] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-25 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 0 (state.change.logger)
[2017-06-26 23:21:06,380] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,23] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,380] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-8 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 0 (state.change.logger)
[2017-06-26 23:21:06,380] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-37 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 0 (state.change.logger)
[2017-06-26 23:21:06,380] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,48] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,381] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-4 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 0 (state.change.logger)
[2017-06-26 23:21:06,381] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-33 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 0 (state.change.logger)
[2017-06-26 23:21:06,381] TRACE Controller 0 epoch 8 changed state of replica 0 for partition [__consumer_offsets,12] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,381] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-15 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 0 (state.change.logger)
[2017-06-26 23:21:06,381] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-48 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 0 (state.change.logger)
[2017-06-26 23:21:06,381] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,23] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,381] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-11 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 0 (state.change.logger)
[2017-06-26 23:21:06,381] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-44 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 0 (state.change.logger)
[2017-06-26 23:21:06,381] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,9] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,381] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-23 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 0 (state.change.logger)
[2017-06-26 23:21:06,381] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:6,ControllerEpoch:7),ReplicationFactor:1),AllReplicas:2) for partition rf1p1-0 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 0 (state.change.logger)
[2017-06-26 23:21:06,381] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,42] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,381] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-19 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 0 (state.change.logger)
[2017-06-26 23:21:06,381] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-32 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 0 (state.change.logger)
[2017-06-26 23:21:06,381] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,39] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,381] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-28 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 0 (state.change.logger)
[2017-06-26 23:21:06,381] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-7 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 0 (state.change.logger)
[2017-06-26 23:21:06,381] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,31] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,381] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-40 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 0 (state.change.logger)
[2017-06-26 23:21:06,381] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-3 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 0 (state.change.logger)
[2017-06-26 23:21:06,381] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,2] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,381] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-36 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 0 (state.change.logger)
[2017-06-26 23:21:06,381] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-47 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 0 (state.change.logger)
[2017-06-26 23:21:06,381] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,22] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,381] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-14 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 0 (state.change.logger)
[2017-06-26 23:21:06,381] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-43 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 0 (state.change.logger)
[2017-06-26 23:21:06,381] TRACE Controller 0 epoch 8 changed state of replica 0 for partition [__consumer_offsets,31] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,381] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-10 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 0 (state.change.logger)
[2017-06-26 23:21:06,381] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-22 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 0 (state.change.logger)
[2017-06-26 23:21:06,381] TRACE Controller 0 epoch 8 changed state of replica 0 for partition [__consumer_offsets,40] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,381] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-18 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 0 (state.change.logger)
[2017-06-26 23:21:06,381] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-31 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 0 (state.change.logger)
[2017-06-26 23:21:06,381] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,19] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,381] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-27 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 0 (state.change.logger)
[2017-06-26 23:21:06,381] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-39 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 0 (state.change.logger)
[2017-06-26 23:21:06,381] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,10] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,381] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-6 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 0 (state.change.logger)
[2017-06-26 23:21:06,381] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-35 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 0 (state.change.logger)
[2017-06-26 23:21:06,381] TRACE Controller 0 epoch 8 changed state of replica 0 for partition [__consumer_offsets,35] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,381] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-2 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 0 (state.change.logger)
[2017-06-26 23:21:06,382] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,13] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,382] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,34] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,382] TRACE Controller 0 epoch 8 changed state of replica 0 for partition [__consumer_offsets,9] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,382] TRACE Controller 0 epoch 8 changed state of replica 0 for partition [__consumer_offsets,43] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,382] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:21:06,382] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,22] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,382] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,40] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,382] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,33] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,382] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,3] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,383] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:21:06,383] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:21:06,383] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,37] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,383] TRACE Controller 0 epoch 8 changed state of replica 0 for partition [__consumer_offsets,2] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,383] TRACE Controller 0 epoch 8 changed state of replica 0 for partition [__consumer_offsets,11] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,383] TRACE Controller 0 epoch 8 changed state of replica 0 for partition [__consumer_offsets,29] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,383] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,24] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,383] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,43] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,383] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,40] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,383] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,11] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,383] TRACE Controller 0 epoch 8 changed state of replica 0 for partition [__consumer_offsets,30] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,383] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,27] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,383] TRACE Controller 0 epoch 8 changed state of replica 0 for partition [__consumer_offsets,4] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,383] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,6] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,383] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,1] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,383] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,20] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,383] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,47] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,383] TRACE Controller 0 epoch 8 changed state of replica 0 for partition [__consumer_offsets,42] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,383] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,30] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,383] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,42] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,383] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,27] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,383] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,41] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,384] TRACE Controller 0 epoch 8 changed state of replica 0 for partition [__consumer_offsets,26] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,384] TRACE Controller 0 epoch 8 changed state of replica 0 for partition [__consumer_offsets,34] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,384] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,30] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,384] TRACE Controller 0 epoch 8 changed state of replica 0 for partition [__consumer_offsets,17] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,384] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,15] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,384] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,3] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,384] TRACE Controller 0 epoch 8 changed state of replica 0 for partition [__consumer_offsets,37] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,384] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,28] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,384] TRACE Controller 0 epoch 8 changed state of replica 0 for partition [__consumer_offsets,27] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,384] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,13] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,384] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,7] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,384] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,43] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,384] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,10] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,384] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,4] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,384] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,16] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,384] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,46] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,384] TRACE Controller 0 epoch 8 changed state of replica 0 for partition [__consumer_offsets,10] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,384] TRACE Controller 0 epoch 8 changed state of replica 0 for partition [__consumer_offsets,41] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,384] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,12] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,384] TRACE Controller 0 epoch 8 changed state of replica 0 for partition [__consumer_offsets,20] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,384] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,32] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,384] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,49] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,384] TRACE Controller 0 epoch 8 changed state of replica 0 for partition [__consumer_offsets,28] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,384] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,14] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,384] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,4] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,384] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,26] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,385] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,35] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,385] TRACE Controller 0 epoch 8 changed state of replica 0 for partition [__consumer_offsets,46] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,385] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,45] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,385] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,46] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,385] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,37] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,385] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,29] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,385] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,20] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,385] TRACE Controller 0 epoch 8 changed state of replica 0 for partition [__consumer_offsets,39] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,385] TRACE Controller 0 epoch 8 changed state of replica 0 for partition [__consumer_offsets,47] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,385] TRACE Controller 0 epoch 8 changed state of replica 0 for partition [__consumer_offsets,49] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,385] TRACE Controller 0 epoch 8 changed state of replica 0 for partition [__consumer_offsets,22] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,385] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,8] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,385] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,6] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,385] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,38] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,385] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,8] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,385] TRACE Controller 0 epoch 8 changed state of replica 0 for partition [__consumer_offsets,1] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,385] TRACE Controller 0 epoch 8 changed state of replica 0 for partition [__consumer_offsets,24] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,385] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,44] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,385] TRACE Controller 0 epoch 8 changed state of replica 0 for partition [__consumer_offsets,6] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,385] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,7] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,385] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,45] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,385] TRACE Controller 0 epoch 8 changed state of replica 0 for partition [__consumer_offsets,36] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,385] TRACE Controller 0 epoch 8 changed state of replica 0 for partition [__consumer_offsets,8] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,385] TRACE Controller 0 epoch 8 changed state of replica 0 for partition [__consumer_offsets,38] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,386] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,49] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,386] TRACE Controller 0 epoch 8 changed state of replica 0 for partition [__consumer_offsets,16] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,386] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,1] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,386] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,19] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,386] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,386] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,34] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,386] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,36] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,386] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,33] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,386] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,14] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,386] TRACE Controller 0 epoch 8 changed state of replica 0 for partition [__consumer_offsets,21] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,386] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,26] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,386] TRACE Controller 0 epoch 8 changed state of replica 0 for partition [__consumer_offsets,18] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,386] TRACE Controller 0 epoch 8 changed state of replica 0 for partition [__consumer_offsets,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,386] TRACE Controller 0 epoch 8 changed state of replica 0 for partition [__consumer_offsets,48] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,386] TRACE Controller 0 epoch 8 changed state of replica 0 for partition [__consumer_offsets,5] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,386] TRACE Controller 0 epoch 8 changed state of replica 0 for partition [__consumer_offsets,13] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,386] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,44] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,386] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,32] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,386] TRACE Controller 0 epoch 8 changed state of replica 0 for partition [__consumer_offsets,3] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,386] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,25] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,386] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,11] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,386] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,31] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,386] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,21] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,386] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,25] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,386] TRACE Controller 0 epoch 8 changed state of replica 0 for partition [__consumer_offsets,44] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,386] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,5] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,386] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,41] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,386] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,47] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 changed state of replica 0 for partition [__consumer_offsets,15] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,36] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 changed state of replica 0 for partition [__consumer_offsets,7] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,12] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,16] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 changed state of replica 0 for partition [__consumer_offsets,19] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 changed state of replica 0 for partition [__consumer_offsets,33] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,35] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,29] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,15] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 changed state of replica 0 for partition [__consumer_offsets,45] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 changed state of replica 0 for partition [__consumer_offsets,23] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,18] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,17] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 changed state of replica 0 for partition [__consumer_offsets,32] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [rf1p1,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 changed state of replica 0 for partition [__consumer_offsets,14] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,24] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,9] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to broker 2 for partition [__consumer_offsets,49] (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to broker 2 for partition [__consumer_offsets,38] (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to broker 2 for partition [__consumer_offsets,27] (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to broker 2 for partition [__consumer_offsets,16] (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to broker 2 for partition [__consumer_offsets,8] (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to broker 2 for partition [__consumer_offsets,19] (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to broker 2 for partition [__consumer_offsets,2] (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to broker 2 for partition [__consumer_offsets,13] (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to broker 2 for partition [__consumer_offsets,24] (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to broker 2 for partition [__consumer_offsets,35] (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to broker 2 for partition [__consumer_offsets,46] (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to broker 2 for partition [__consumer_offsets,5] (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to broker 2 for partition [__consumer_offsets,43] (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to broker 2 for partition [__consumer_offsets,32] (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to broker 2 for partition [__consumer_offsets,21] (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to broker 2 for partition [__consumer_offsets,10] (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to broker 2 for partition [__consumer_offsets,37] (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to broker 2 for partition [__consumer_offsets,48] (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to broker 2 for partition [__consumer_offsets,40] (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to broker 2 for partition [__consumer_offsets,29] (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to broker 2 for partition [__consumer_offsets,18] (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to broker 2 for partition [__consumer_offsets,7] (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to broker 2 for partition [__consumer_offsets,23] (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to broker 2 for partition [__consumer_offsets,34] (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to broker 2 for partition [__consumer_offsets,45] (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to broker 2 for partition [__consumer_offsets,26] (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to broker 2 for partition [__consumer_offsets,15] (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to broker 2 for partition [__consumer_offsets,4] (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to broker 2 for partition [__consumer_offsets,42] (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to broker 2 for partition [__consumer_offsets,9] (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to broker 2 for partition [__consumer_offsets,20] (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to broker 2 for partition [__consumer_offsets,31] (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to broker 2 for partition [__consumer_offsets,12] (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to broker 2 for partition [__consumer_offsets,1] (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to broker 2 for partition [__consumer_offsets,28] (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to broker 2 for partition [__consumer_offsets,17] (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to broker 2 for partition [__consumer_offsets,6] (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to broker 2 for partition [__consumer_offsets,39] (state.change.logger)
[2017-06-26 23:21:06,387] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to broker 2 for partition [__consumer_offsets,44] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to broker 2 for partition [__consumer_offsets,36] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to broker 2 for partition [__consumer_offsets,47] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:6,ControllerEpoch:7) to broker 2 for partition [rf1p1,0] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to broker 2 for partition [__consumer_offsets,3] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to broker 2 for partition [__consumer_offsets,14] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to broker 2 for partition [__consumer_offsets,25] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to broker 2 for partition [__consumer_offsets,30] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to broker 2 for partition [__consumer_offsets,41] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to broker 2 for partition [__consumer_offsets,11] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to broker 2 for partition [__consumer_offsets,22] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to broker 2 for partition [__consumer_offsets,33] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to broker 2 for partition [__consumer_offsets,0] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to broker 1 for partition [__consumer_offsets,49] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to broker 1 for partition [__consumer_offsets,38] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to broker 1 for partition [__consumer_offsets,27] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to broker 1 for partition [__consumer_offsets,16] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to broker 1 for partition [__consumer_offsets,19] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to broker 1 for partition [__consumer_offsets,8] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to broker 1 for partition [__consumer_offsets,13] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to broker 1 for partition [__consumer_offsets,2] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to broker 1 for partition [__consumer_offsets,24] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to broker 1 for partition [__consumer_offsets,46] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to broker 1 for partition [__consumer_offsets,35] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to broker 1 for partition [__consumer_offsets,5] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to broker 1 for partition [__consumer_offsets,43] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to broker 1 for partition [__consumer_offsets,21] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to broker 1 for partition [__consumer_offsets,32] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to broker 1 for partition [__consumer_offsets,10] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to broker 1 for partition [__consumer_offsets,37] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to broker 1 for partition [__consumer_offsets,48] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to broker 1 for partition [__consumer_offsets,40] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to broker 1 for partition [__consumer_offsets,18] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to broker 1 for partition [__consumer_offsets,29] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to broker 1 for partition [__consumer_offsets,7] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to broker 1 for partition [__consumer_offsets,23] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to broker 1 for partition [__consumer_offsets,45] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to broker 1 for partition [__consumer_offsets,34] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to broker 1 for partition [__consumer_offsets,26] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to broker 1 for partition [__consumer_offsets,4] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to broker 1 for partition [__consumer_offsets,15] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to broker 1 for partition [__consumer_offsets,42] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to broker 1 for partition [__consumer_offsets,9] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to broker 1 for partition [__consumer_offsets,31] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to broker 1 for partition [__consumer_offsets,20] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to broker 1 for partition [__consumer_offsets,1] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to broker 1 for partition [__consumer_offsets,12] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to broker 1 for partition [__consumer_offsets,28] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to broker 1 for partition [__consumer_offsets,17] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to broker 1 for partition [__consumer_offsets,6] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to broker 1 for partition [__consumer_offsets,39] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to broker 1 for partition [__consumer_offsets,44] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to broker 1 for partition [__consumer_offsets,47] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to broker 1 for partition [__consumer_offsets,36] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to broker 1 for partition [__consumer_offsets,3] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to broker 1 for partition [__consumer_offsets,14] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to broker 1 for partition [__consumer_offsets,25] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to broker 1 for partition [__consumer_offsets,41] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to broker 1 for partition [__consumer_offsets,30] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to broker 1 for partition [__consumer_offsets,22] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to broker 1 for partition [__consumer_offsets,33] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to broker 1 for partition [__consumer_offsets,11] (state.change.logger)
[2017-06-26 23:21:06,388] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to broker 1 for partition [__consumer_offsets,0] (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to broker 0 for partition [__consumer_offsets,49] (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to broker 0 for partition [__consumer_offsets,38] (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to broker 0 for partition [__consumer_offsets,27] (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to broker 0 for partition [__consumer_offsets,16] (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to broker 0 for partition [__consumer_offsets,8] (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to broker 0 for partition [__consumer_offsets,19] (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to broker 0 for partition [__consumer_offsets,2] (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to broker 0 for partition [__consumer_offsets,13] (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to broker 0 for partition [__consumer_offsets,46] (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to broker 0 for partition [__consumer_offsets,35] (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to broker 0 for partition [__consumer_offsets,24] (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to broker 0 for partition [__consumer_offsets,5] (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to broker 0 for partition [__consumer_offsets,43] (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to broker 0 for partition [__consumer_offsets,21] (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to broker 0 for partition [__consumer_offsets,32] (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to broker 0 for partition [__consumer_offsets,10] (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to broker 0 for partition [__consumer_offsets,37] (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to broker 0 for partition [__consumer_offsets,48] (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to broker 0 for partition [__consumer_offsets,40] (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to broker 0 for partition [__consumer_offsets,29] (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to broker 0 for partition [__consumer_offsets,18] (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to broker 0 for partition [__consumer_offsets,7] (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to broker 0 for partition [__consumer_offsets,34] (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to broker 0 for partition [__consumer_offsets,45] (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to broker 0 for partition [__consumer_offsets,23] (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to broker 0 for partition [__consumer_offsets,26] (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to broker 0 for partition [__consumer_offsets,4] (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to broker 0 for partition [__consumer_offsets,15] (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to broker 0 for partition [__consumer_offsets,42] (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to broker 0 for partition [__consumer_offsets,20] (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to broker 0 for partition [__consumer_offsets,31] (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to broker 0 for partition [__consumer_offsets,9] (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to broker 0 for partition [__consumer_offsets,12] (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to broker 0 for partition [__consumer_offsets,1] (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to broker 0 for partition [__consumer_offsets,28] (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to broker 0 for partition [__consumer_offsets,17] (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to broker 0 for partition [__consumer_offsets,6] (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to broker 0 for partition [__consumer_offsets,39] (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to broker 0 for partition [__consumer_offsets,44] (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to broker 0 for partition [__consumer_offsets,47] (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to broker 0 for partition [__consumer_offsets,36] (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to broker 0 for partition [__consumer_offsets,14] (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to broker 0 for partition [__consumer_offsets,25] (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to broker 0 for partition [__consumer_offsets,3] (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to broker 0 for partition [__consumer_offsets,41] (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to broker 0 for partition [__consumer_offsets,30] (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to broker 0 for partition [__consumer_offsets,11] (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to broker 0 for partition [__consumer_offsets,22] (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to broker 0 for partition [__consumer_offsets,33] (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to broker 0 for partition [__consumer_offsets,0] (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-49 (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-38 (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-16 (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-27 (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-8 (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-19 (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-13 (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-2 (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-46 (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-24 (state.change.logger)
[2017-06-26 23:21:06,389] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-35 (state.change.logger)
[2017-06-26 23:21:06,390] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-5 (state.change.logger)
[2017-06-26 23:21:06,390] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-43 (state.change.logger)
[2017-06-26 23:21:06,390] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-32 (state.change.logger)
[2017-06-26 23:21:06,390] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-21 (state.change.logger)
[2017-06-26 23:21:06,390] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-10 (state.change.logger)
[2017-06-26 23:21:06,390] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-37 (state.change.logger)
[2017-06-26 23:21:06,390] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-48 (state.change.logger)
[2017-06-26 23:21:06,390] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-29 (state.change.logger)
[2017-06-26 23:21:06,390] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-40 (state.change.logger)
[2017-06-26 23:21:06,390] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-18 (state.change.logger)
[2017-06-26 23:21:06,390] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-7 (state.change.logger)
[2017-06-26 23:21:06,390] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=7, leader=1, leaderEpoch=3, isr=[1], zkVersion=7, replicas=[0, 1, 2]) correlation id 1 from controller 0 epoch 8 for partition [__consumer_offsets,13] (state.change.logger)
[2017-06-26 23:21:06,390] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-45 (state.change.logger)
[2017-06-26 23:21:06,390] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=7, leader=1, leaderEpoch=3, isr=[1], zkVersion=4, replicas=[0, 1, 2]) correlation id 1 from controller 0 epoch 8 for partition [__consumer_offsets,46] (state.change.logger)
[2017-06-26 23:21:06,390] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-34 (state.change.logger)
[2017-06-26 23:21:06,390] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=7, leader=0, leaderEpoch=3, isr=[0], zkVersion=5, replicas=[0, 1, 2]) correlation id 1 from controller 0 epoch 8 for partition [__consumer_offsets,9] (state.change.logger)
[2017-06-26 23:21:06,390] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-23 (state.change.logger)
[2017-06-26 23:21:06,390] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=7, leader=0, leaderEpoch=3, isr=[0], zkVersion=5, replicas=[0, 1, 2]) correlation id 1 from controller 0 epoch 8 for partition [__consumer_offsets,42] (state.change.logger)
[2017-06-26 23:21:06,390] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-26 (state.change.logger)
[2017-06-26 23:21:06,390] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=7, leader=0, leaderEpoch=3, isr=[0], zkVersion=5, replicas=[0, 1, 2]) correlation id 1 from controller 0 epoch 8 for partition [__consumer_offsets,21] (state.change.logger)
[2017-06-26 23:21:06,390] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-15 (state.change.logger)
[2017-06-26 23:21:06,390] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=7, leader=2, leaderEpoch=3, isr=[2], zkVersion=6, replicas=[0, 1, 2]) correlation id 1 from controller 0 epoch 8 for partition [__consumer_offsets,17] (state.change.logger)
[2017-06-26 23:21:06,390] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-4 (state.change.logger)
[2017-06-26 23:21:06,390] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=7, leader=0, leaderEpoch=3, isr=[0], zkVersion=5, replicas=[0, 1, 2]) correlation id 1 from controller 0 epoch 8 for partition [__consumer_offsets,30] (state.change.logger)
[2017-06-26 23:21:06,390] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-42 (state.change.logger)
[2017-06-26 23:21:06,390] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=7, leader=2, leaderEpoch=3, isr=[2], zkVersion=6, replicas=[0, 1, 2]) correlation id 1 from controller 0 epoch 8 for partition [__consumer_offsets,26] (state.change.logger)
[2017-06-26 23:21:06,390] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-20 (state.change.logger)
[2017-06-26 23:21:06,390] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=7, leader=2, leaderEpoch=3, isr=[2], zkVersion=6, replicas=[0, 1, 2]) correlation id 1 from controller 0 epoch 8 for partition [__consumer_offsets,5] (state.change.logger)
[2017-06-26 23:21:06,390] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-31 (state.change.logger)
[2017-06-26 23:21:06,390] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=7, leader=2, leaderEpoch=3, isr=[2], zkVersion=6, replicas=[0, 1, 2]) correlation id 1 from controller 0 epoch 8 for partition [__consumer_offsets,38] (state.change.logger)
[2017-06-26 23:21:06,390] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-9 (state.change.logger)
[2017-06-26 23:21:06,390] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=7, leader=1, leaderEpoch=3, isr=[1], zkVersion=4, replicas=[0, 1, 2]) correlation id 1 from controller 0 epoch 8 for partition [__consumer_offsets,1] (state.change.logger)
[2017-06-26 23:21:06,390] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-1 (state.change.logger)
[2017-06-26 23:21:06,390] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=7, leader=1, leaderEpoch=3, isr=[1], zkVersion=4, replicas=[0, 1, 2]) correlation id 1 from controller 0 epoch 8 for partition [__consumer_offsets,34] (state.change.logger)
[2017-06-26 23:21:06,390] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-12 (state.change.logger)
[2017-06-26 23:21:06,390] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=7, leader=1, leaderEpoch=3, isr=[1], zkVersion=4, replicas=[0, 1, 2]) correlation id 1 from controller 0 epoch 8 for partition [__consumer_offsets,16] (state.change.logger)
[2017-06-26 23:21:06,390] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-17 (state.change.logger)
[2017-06-26 23:21:06,390] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=7, leader=0, leaderEpoch=3, isr=[0], zkVersion=5, replicas=[0, 1, 2]) correlation id 1 from controller 0 epoch 8 for partition [__consumer_offsets,45] (state.change.logger)
[2017-06-26 23:21:06,390] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-28 (state.change.logger)
[2017-06-26 23:21:06,390] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-6 (state.change.logger)
[2017-06-26 23:21:06,390] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-39 (state.change.logger)
[2017-06-26 23:21:06,390] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-44 (state.change.logger)
[2017-06-26 23:21:06,390] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-36 (state.change.logger)
[2017-06-26 23:21:06,390] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-47 (state.change.logger)
[2017-06-26 23:21:06,390] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:6,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition rf1p1-0 (state.change.logger)
[2017-06-26 23:21:06,390] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-14 (state.change.logger)
[2017-06-26 23:21:06,390] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-3 (state.change.logger)
[2017-06-26 23:21:06,391] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-25 (state.change.logger)
[2017-06-26 23:21:06,391] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-41 (state.change.logger)
[2017-06-26 23:21:06,391] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-30 (state.change.logger)
[2017-06-26 23:21:06,391] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-11 (state.change.logger)
[2017-06-26 23:21:06,391] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-33 (state.change.logger)
[2017-06-26 23:21:06,391] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-22 (state.change.logger)
[2017-06-26 23:21:06,390] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=7, leader=0, leaderEpoch=3, isr=[0], zkVersion=5, replicas=[0, 1, 2]) correlation id 1 from controller 0 epoch 8 for partition [__consumer_offsets,12] (state.change.logger)
[2017-06-26 23:21:06,391] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=7, leader=2, leaderEpoch=3, isr=[2], zkVersion=6, replicas=[0, 1, 2]) correlation id 1 from controller 0 epoch 8 for partition [__consumer_offsets,41] (state.change.logger)
[2017-06-26 23:21:06,391] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=7, leader=0, leaderEpoch=3, isr=[0], zkVersion=5, replicas=[0, 1, 2]) correlation id 1 from controller 0 epoch 8 for partition [__consumer_offsets,24] (state.change.logger)
[2017-06-26 23:21:06,391] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=7, leader=2, leaderEpoch=3, isr=[2], zkVersion=6, replicas=[0, 1, 2]) correlation id 1 from controller 0 epoch 8 for partition [__consumer_offsets,20] (state.change.logger)
[2017-06-26 23:21:06,391] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=7, leader=1, leaderEpoch=3, isr=[1], zkVersion=4, replicas=[0, 1, 2]) correlation id 1 from controller 0 epoch 8 for partition [__consumer_offsets,49] (state.change.logger)
[2017-06-26 23:21:06,391] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=7, leader=0, leaderEpoch=3, isr=[0], zkVersion=5, replicas=[0, 1, 2]) correlation id 1 from controller 0 epoch 8 for partition [__consumer_offsets,0] (state.change.logger)
[2017-06-26 23:21:06,391] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=7, leader=2, leaderEpoch=3, isr=[2], zkVersion=6, replicas=[0, 1, 2]) correlation id 1 from controller 0 epoch 8 for partition [__consumer_offsets,29] (state.change.logger)
[2017-06-26 23:21:06,391] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=7, leader=1, leaderEpoch=3, isr=[1], zkVersion=4, replicas=[0, 1, 2]) correlation id 1 from controller 0 epoch 8 for partition [__consumer_offsets,25] (state.change.logger)
[2017-06-26 23:21:06,391] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7) to brokers Set(0, 1, 2) for partition __consumer_offsets-0 (state.change.logger)
[2017-06-26 23:21:06,391] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=7, leader=2, leaderEpoch=3, isr=[2], zkVersion=6, replicas=[0, 1, 2]) correlation id 1 from controller 0 epoch 8 for partition [__consumer_offsets,8] (state.change.logger)
[2017-06-26 23:21:06,391] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=7, leader=1, leaderEpoch=3, isr=[1], zkVersion=6, replicas=[0, 1, 2]) correlation id 1 from controller 0 epoch 8 for partition [__consumer_offsets,37] (state.change.logger)
[2017-06-26 23:21:06,391] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=7, leader=1, leaderEpoch=3, isr=[1], zkVersion=6, replicas=[0, 1, 2]) correlation id 1 from controller 0 epoch 8 for partition [__consumer_offsets,4] (state.change.logger)
[2017-06-26 23:21:06,391] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=7, leader=0, leaderEpoch=3, isr=[0], zkVersion=5, replicas=[0, 1, 2]) correlation id 1 from controller 0 epoch 8 for partition [__consumer_offsets,33] (state.change.logger)
[2017-06-26 23:21:06,391] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=7, leader=0, leaderEpoch=3, isr=[0], zkVersion=5, replicas=[0, 1, 2]) correlation id 1 from controller 0 epoch 8 for partition [__consumer_offsets,15] (state.change.logger)
[2017-06-26 23:21:06,391] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=7, leader=0, leaderEpoch=3, isr=[0], zkVersion=5, replicas=[0, 1, 2]) correlation id 1 from controller 0 epoch 8 for partition [__consumer_offsets,48] (state.change.logger)
[2017-06-26 23:21:06,391] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=7, leader=2, leaderEpoch=3, isr=[2], zkVersion=6, replicas=[0, 1, 2]) correlation id 1 from controller 0 epoch 8 for partition [__consumer_offsets,11] (state.change.logger)
[2017-06-26 23:21:06,391] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=7, leader=2, leaderEpoch=3, isr=[2], zkVersion=6, replicas=[0, 1, 2]) correlation id 1 from controller 0 epoch 8 for partition [__consumer_offsets,44] (state.change.logger)
[2017-06-26 23:21:06,391] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=7, leader=2, leaderEpoch=3, isr=[2], zkVersion=6, replicas=[0, 1, 2]) correlation id 1 from controller 0 epoch 8 for partition [__consumer_offsets,23] (state.change.logger)
[2017-06-26 23:21:06,391] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,19] (state.change.logger)
[2017-06-26 23:21:06,391] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=7, leader=1, leaderEpoch=3, isr=[1], zkVersion=4, replicas=[0, 1, 2]) correlation id 1 from controller 0 epoch 8 for partition [__consumer_offsets,19] (state.change.logger)
[2017-06-26 23:21:06,391] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=7, leader=2, leaderEpoch=3, isr=[2], zkVersion=6, replicas=[0, 1, 2]) correlation id 1 from controller 0 epoch 8 for partition [__consumer_offsets,32] (state.change.logger)
[2017-06-26 23:21:06,391] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=7, leader=1, leaderEpoch=3, isr=[1], zkVersion=4, replicas=[0, 1, 2]) correlation id 1 from controller 0 epoch 8 for partition [__consumer_offsets,28] (state.change.logger)
[2017-06-26 23:21:06,391] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=7, leader=1, leaderEpoch=3, isr=[1], zkVersion=4, replicas=[0, 1, 2]) correlation id 1 from controller 0 epoch 8 for partition [__consumer_offsets,7] (state.change.logger)
[2017-06-26 23:21:06,391] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=7, leader=1, leaderEpoch=3, isr=[1], zkVersion=4, replicas=[0, 1, 2]) correlation id 1 from controller 0 epoch 8 for partition [__consumer_offsets,40] (state.change.logger)
[2017-06-26 23:21:06,391] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=7, leader=0, leaderEpoch=3, isr=[0], zkVersion=5, replicas=[0, 1, 2]) correlation id 1 from controller 0 epoch 8 for partition [__consumer_offsets,3] (state.change.logger)
[2017-06-26 23:21:06,391] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=7, leader=0, leaderEpoch=3, isr=[0], zkVersion=5, replicas=[0, 1, 2]) correlation id 1 from controller 0 epoch 8 for partition [__consumer_offsets,36] (state.change.logger)
[2017-06-26 23:21:06,391] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=7, leader=2, leaderEpoch=3, isr=[2], zkVersion=6, replicas=[0, 1, 2]) correlation id 1 from controller 0 epoch 8 for partition [__consumer_offsets,47] (state.change.logger)
[2017-06-26 23:21:06,391] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=49,error_code=11},{topic=__consumer_offsets,partition=38,error_code=11},{topic=__consumer_offsets,partition=16,error_code=11},{topic=__consumer_offsets,partition=27,error_code=11},{topic=__consumer_offsets,partition=8,error_code=11},{topic=__consumer_offsets,partition=19,error_code=11},{topic=__consumer_offsets,partition=2,error_code=11},{topic=__consumer_offsets,partition=13,error_code=11},{topic=__consumer_offsets,partition=35,error_code=11},{topic=__consumer_offsets,partition=24,error_code=11},{topic=__consumer_offsets,partition=46,error_code=11},{topic=__consumer_offsets,partition=5,error_code=11},{topic=__consumer_offsets,partition=43,error_code=11},{topic=__consumer_offsets,partition=21,error_code=11},{topic=__consumer_offsets,partition=32,error_code=11},{topic=__consumer_offsets,partition=10,error_code=11},{topic=__consumer_offsets,partition=37,error_code=11},{topic=__consumer_offsets,partition=48,error_code=11},{topic=__consumer_offsets,partition=29,error_code=11},{topic=__consumer_offsets,partition=40,error_code=11},{topic=__consumer_offsets,partition=18,error_code=11},{topic=__consumer_offsets,partition=7,error_code=11},{topic=__consumer_offsets,partition=45,error_code=11},{topic=__consumer_offsets,partition=34,error_code=11},{topic=__consumer_offsets,partition=23,error_code=11},{topic=__consumer_offsets,partition=26,error_code=11},{topic=__consumer_offsets,partition=4,error_code=11},{topic=__consumer_offsets,partition=15,error_code=11},{topic=__consumer_offsets,partition=42,error_code=11},{topic=__consumer_offsets,partition=20,error_code=11},{topic=__consumer_offsets,partition=9,error_code=11},{topic=__consumer_offsets,partition=31,error_code=11},{topic=__consumer_offsets,partition=12,error_code=11},{topic=__consumer_offsets,partition=1,error_code=11},{topic=__consumer_offsets,partition=17,error_code=11},{topic=__consumer_offsets,partition=28,error_code=11},{topic=__consumer_offsets,partition=6,error_code=11},{topic=__consumer_offsets,partition=39,error_code=11},{topic=__consumer_offsets,partition=44,error_code=11},{topic=__consumer_offsets,partition=36,error_code=11},{topic=__consumer_offsets,partition=47,error_code=11},{topic=rf1p1,partition=0,error_code=11},{topic=__consumer_offsets,partition=25,error_code=11},{topic=__consumer_offsets,partition=3,error_code=11},{topic=__consumer_offsets,partition=14,error_code=11},{topic=__consumer_offsets,partition=41,error_code=11},{topic=__consumer_offsets,partition=30,error_code=11},{topic=__consumer_offsets,partition=33,error_code=11},{topic=__consumer_offsets,partition=11,error_code=11},{topic=__consumer_offsets,partition=22,error_code=11},{topic=__consumer_offsets,partition=0,error_code=11}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:21:06,391] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=7, leader=2, leaderEpoch=3, isr=[2], zkVersion=6, replicas=[0, 1, 2]) correlation id 1 from controller 0 epoch 8 for partition [__consumer_offsets,14] (state.change.logger)
[2017-06-26 23:21:06,391] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=7, leader=1, leaderEpoch=3, isr=[1], zkVersion=4, replicas=[0, 1, 2]) correlation id 1 from controller 0 epoch 8 for partition [__consumer_offsets,43] (state.change.logger)
[2017-06-26 23:21:06,391] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=7, leader=1, leaderEpoch=3, isr=[1], zkVersion=4, replicas=[0, 1, 2]) correlation id 1 from controller 0 epoch 8 for partition [__consumer_offsets,10] (state.change.logger)
[2017-06-26 23:21:06,391] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=7, leader=1, leaderEpoch=3, isr=[1], zkVersion=6, replicas=[0, 1, 2]) correlation id 1 from controller 0 epoch 8 for partition [__consumer_offsets,22] (state.change.logger)
[2017-06-26 23:21:06,392] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=7, leader=0, leaderEpoch=3, isr=[0], zkVersion=5, replicas=[0, 1, 2]) correlation id 1 from controller 0 epoch 8 for partition [__consumer_offsets,18] (state.change.logger)
[2017-06-26 23:21:06,392] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=7, leader=1, leaderEpoch=3, isr=[1], zkVersion=4, replicas=[0, 1, 2]) correlation id 1 from controller 0 epoch 8 for partition [__consumer_offsets,31] (state.change.logger)
[2017-06-26 23:21:06,392] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=7, leader=0, leaderEpoch=3, isr=[0], zkVersion=5, replicas=[0, 1, 2]) correlation id 1 from controller 0 epoch 8 for partition [__consumer_offsets,27] (state.change.logger)
[2017-06-26 23:21:06,392] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=7, leader=0, leaderEpoch=3, isr=[0], zkVersion=5, replicas=[0, 1, 2]) correlation id 1 from controller 0 epoch 8 for partition [__consumer_offsets,39] (state.change.logger)
[2017-06-26 23:21:06,392] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=7, leader=0, leaderEpoch=3, isr=[0], zkVersion=5, replicas=[0, 1, 2]) correlation id 1 from controller 0 epoch 8 for partition [__consumer_offsets,6] (state.change.logger)
[2017-06-26 23:21:06,392] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=7, leader=2, leaderEpoch=3, isr=[2], zkVersion=6, replicas=[0, 1, 2]) correlation id 1 from controller 0 epoch 8 for partition [__consumer_offsets,35] (state.change.logger)
[2017-06-26 23:21:06,392] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=7, leader=2, leaderEpoch=3, isr=[2], zkVersion=6, replicas=[0, 1, 2]) correlation id 1 from controller 0 epoch 8 for partition [__consumer_offsets,2] (state.change.logger)
[2017-06-26 23:21:06,392] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 8 for partition [__consumer_offsets,13] since its associated leader epoch 3 is not higher than the current leader epoch 3 (state.change.logger)
[2017-06-26 23:21:06,392] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 8 for partition [__consumer_offsets,46] since its associated leader epoch 3 is not higher than the current leader epoch 3 (state.change.logger)
[2017-06-26 23:21:06,392] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 8 for partition [__consumer_offsets,9] since its associated leader epoch 3 is not higher than the current leader epoch 3 (state.change.logger)
[2017-06-26 23:21:06,392] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 8 for partition [__consumer_offsets,42] since its associated leader epoch 3 is not higher than the current leader epoch 3 (state.change.logger)
[2017-06-26 23:21:06,392] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 8 for partition [__consumer_offsets,21] since its associated leader epoch 3 is not higher than the current leader epoch 3 (state.change.logger)
[2017-06-26 23:21:06,392] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 8 for partition [__consumer_offsets,17] since its associated leader epoch 3 is not higher than the current leader epoch 3 (state.change.logger)
[2017-06-26 23:21:06,392] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 8 for partition [__consumer_offsets,30] since its associated leader epoch 3 is not higher than the current leader epoch 3 (state.change.logger)
[2017-06-26 23:21:06,392] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 8 for partition [__consumer_offsets,26] since its associated leader epoch 3 is not higher than the current leader epoch 3 (state.change.logger)
[2017-06-26 23:21:06,392] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 8 for partition [__consumer_offsets,5] since its associated leader epoch 3 is not higher than the current leader epoch 3 (state.change.logger)
[2017-06-26 23:21:06,392] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 8 for partition [__consumer_offsets,38] since its associated leader epoch 3 is not higher than the current leader epoch 3 (state.change.logger)
[2017-06-26 23:21:06,392] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 8 for partition [__consumer_offsets,1] since its associated leader epoch 3 is not higher than the current leader epoch 3 (state.change.logger)
[2017-06-26 23:21:06,392] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 8 for partition [__consumer_offsets,34] since its associated leader epoch 3 is not higher than the current leader epoch 3 (state.change.logger)
[2017-06-26 23:21:06,392] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 8 for partition [__consumer_offsets,16] since its associated leader epoch 3 is not higher than the current leader epoch 3 (state.change.logger)
[2017-06-26 23:21:06,392] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 8 for partition [__consumer_offsets,45] since its associated leader epoch 3 is not higher than the current leader epoch 3 (state.change.logger)
[2017-06-26 23:21:06,392] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 8 for partition [__consumer_offsets,12] since its associated leader epoch 3 is not higher than the current leader epoch 3 (state.change.logger)
[2017-06-26 23:21:06,392] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 8 for partition [__consumer_offsets,41] since its associated leader epoch 3 is not higher than the current leader epoch 3 (state.change.logger)
[2017-06-26 23:21:06,392] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 8 for partition [__consumer_offsets,24] since its associated leader epoch 3 is not higher than the current leader epoch 3 (state.change.logger)
[2017-06-26 23:21:06,392] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 8 for partition [__consumer_offsets,20] since its associated leader epoch 3 is not higher than the current leader epoch 3 (state.change.logger)
[2017-06-26 23:21:06,392] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 8 for partition [__consumer_offsets,49] since its associated leader epoch 3 is not higher than the current leader epoch 3 (state.change.logger)
[2017-06-26 23:21:06,392] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 8 for partition [__consumer_offsets,0] since its associated leader epoch 3 is not higher than the current leader epoch 3 (state.change.logger)
[2017-06-26 23:21:06,392] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 8 for partition [__consumer_offsets,29] since its associated leader epoch 3 is not higher than the current leader epoch 3 (state.change.logger)
[2017-06-26 23:21:06,392] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 8 for partition [__consumer_offsets,25] since its associated leader epoch 3 is not higher than the current leader epoch 3 (state.change.logger)
[2017-06-26 23:21:06,392] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 8 for partition [__consumer_offsets,8] since its associated leader epoch 3 is not higher than the current leader epoch 3 (state.change.logger)
[2017-06-26 23:21:06,392] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 8 for partition [__consumer_offsets,37] since its associated leader epoch 3 is not higher than the current leader epoch 3 (state.change.logger)
[2017-06-26 23:21:06,392] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 8 for partition [__consumer_offsets,4] since its associated leader epoch 3 is not higher than the current leader epoch 3 (state.change.logger)
[2017-06-26 23:21:06,392] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 8 for partition [__consumer_offsets,33] since its associated leader epoch 3 is not higher than the current leader epoch 3 (state.change.logger)
[2017-06-26 23:21:06,392] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 8 for partition [__consumer_offsets,15] since its associated leader epoch 3 is not higher than the current leader epoch 3 (state.change.logger)
[2017-06-26 23:21:06,392] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 8 for partition [__consumer_offsets,48] since its associated leader epoch 3 is not higher than the current leader epoch 3 (state.change.logger)
[2017-06-26 23:21:06,392] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 8 for partition [__consumer_offsets,11] since its associated leader epoch 3 is not higher than the current leader epoch 3 (state.change.logger)
[2017-06-26 23:21:06,393] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 8 for partition [__consumer_offsets,44] since its associated leader epoch 3 is not higher than the current leader epoch 3 (state.change.logger)
[2017-06-26 23:21:06,393] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 8 for partition [__consumer_offsets,23] since its associated leader epoch 3 is not higher than the current leader epoch 3 (state.change.logger)
[2017-06-26 23:21:06,393] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 8 for partition [__consumer_offsets,19] since its associated leader epoch 3 is not higher than the current leader epoch 3 (state.change.logger)
[2017-06-26 23:21:06,393] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 8 for partition [__consumer_offsets,32] since its associated leader epoch 3 is not higher than the current leader epoch 3 (state.change.logger)
[2017-06-26 23:21:06,393] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 8 for partition [__consumer_offsets,28] since its associated leader epoch 3 is not higher than the current leader epoch 3 (state.change.logger)
[2017-06-26 23:21:06,393] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 8 for partition [__consumer_offsets,7] since its associated leader epoch 3 is not higher than the current leader epoch 3 (state.change.logger)
[2017-06-26 23:21:06,393] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 8 for partition [__consumer_offsets,40] since its associated leader epoch 3 is not higher than the current leader epoch 3 (state.change.logger)
[2017-06-26 23:21:06,393] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 8 for partition [__consumer_offsets,3] since its associated leader epoch 3 is not higher than the current leader epoch 3 (state.change.logger)
[2017-06-26 23:21:06,393] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 8 for partition [__consumer_offsets,36] since its associated leader epoch 3 is not higher than the current leader epoch 3 (state.change.logger)
[2017-06-26 23:21:06,393] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 8 for partition [__consumer_offsets,47] since its associated leader epoch 3 is not higher than the current leader epoch 3 (state.change.logger)
[2017-06-26 23:21:06,393] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 8 for partition [__consumer_offsets,14] since its associated leader epoch 3 is not higher than the current leader epoch 3 (state.change.logger)
[2017-06-26 23:21:06,393] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 8 for partition [__consumer_offsets,43] since its associated leader epoch 3 is not higher than the current leader epoch 3 (state.change.logger)
[2017-06-26 23:21:06,393] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 8 for partition [__consumer_offsets,10] since its associated leader epoch 3 is not higher than the current leader epoch 3 (state.change.logger)
[2017-06-26 23:21:06,393] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 8 for partition [__consumer_offsets,22] since its associated leader epoch 3 is not higher than the current leader epoch 3 (state.change.logger)
[2017-06-26 23:21:06,393] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 8 for partition [__consumer_offsets,18] since its associated leader epoch 3 is not higher than the current leader epoch 3 (state.change.logger)
[2017-06-26 23:21:06,393] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 8 for partition [__consumer_offsets,31] since its associated leader epoch 3 is not higher than the current leader epoch 3 (state.change.logger)
[2017-06-26 23:21:06,393] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 8 for partition [__consumer_offsets,27] since its associated leader epoch 3 is not higher than the current leader epoch 3 (state.change.logger)
[2017-06-26 23:21:06,393] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 8 for partition [__consumer_offsets,39] since its associated leader epoch 3 is not higher than the current leader epoch 3 (state.change.logger)
[2017-06-26 23:21:06,393] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 8 for partition [__consumer_offsets,6] since its associated leader epoch 3 is not higher than the current leader epoch 3 (state.change.logger)
[2017-06-26 23:21:06,393] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 8 for partition [__consumer_offsets,35] since its associated leader epoch 3 is not higher than the current leader epoch 3 (state.change.logger)
[2017-06-26 23:21:06,393] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 8 for partition [__consumer_offsets,2] since its associated leader epoch 3 is not higher than the current leader epoch 3 (state.change.logger)
[2017-06-26 23:21:06,393] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=49,error_code=11},{topic=__consumer_offsets,partition=38,error_code=11},{topic=__consumer_offsets,partition=16,error_code=11},{topic=__consumer_offsets,partition=27,error_code=11},{topic=__consumer_offsets,partition=8,error_code=11},{topic=__consumer_offsets,partition=19,error_code=11},{topic=__consumer_offsets,partition=2,error_code=11},{topic=__consumer_offsets,partition=13,error_code=11},{topic=__consumer_offsets,partition=24,error_code=11},{topic=__consumer_offsets,partition=46,error_code=11},{topic=__consumer_offsets,partition=35,error_code=11},{topic=__consumer_offsets,partition=5,error_code=11},{topic=__consumer_offsets,partition=43,error_code=11},{topic=__consumer_offsets,partition=21,error_code=11},{topic=__consumer_offsets,partition=32,error_code=11},{topic=__consumer_offsets,partition=10,error_code=11},{topic=__consumer_offsets,partition=37,error_code=11},{topic=__consumer_offsets,partition=48,error_code=11},{topic=__consumer_offsets,partition=29,error_code=11},{topic=__consumer_offsets,partition=40,error_code=11},{topic=__consumer_offsets,partition=18,error_code=11},{topic=__consumer_offsets,partition=7,error_code=11},{topic=__consumer_offsets,partition=45,error_code=11},{topic=__consumer_offsets,partition=34,error_code=11},{topic=__consumer_offsets,partition=23,error_code=11},{topic=__consumer_offsets,partition=26,error_code=11},{topic=__consumer_offsets,partition=4,error_code=11},{topic=__consumer_offsets,partition=15,error_code=11},{topic=__consumer_offsets,partition=42,error_code=11},{topic=__consumer_offsets,partition=20,error_code=11},{topic=__consumer_offsets,partition=9,error_code=11},{topic=__consumer_offsets,partition=31,error_code=11},{topic=__consumer_offsets,partition=12,error_code=11},{topic=__consumer_offsets,partition=1,error_code=11},{topic=__consumer_offsets,partition=17,error_code=11},{topic=__consumer_offsets,partition=28,error_code=11},{topic=__consumer_offsets,partition=6,error_code=11},{topic=__consumer_offsets,partition=39,error_code=11},{topic=__consumer_offsets,partition=44,error_code=11},{topic=__consumer_offsets,partition=36,error_code=11},{topic=__consumer_offsets,partition=47,error_code=11},{topic=__consumer_offsets,partition=25,error_code=11},{topic=__consumer_offsets,partition=3,error_code=11},{topic=__consumer_offsets,partition=14,error_code=11},{topic=__consumer_offsets,partition=41,error_code=11},{topic=__consumer_offsets,partition=30,error_code=11},{topic=__consumer_offsets,partition=33,error_code=11},{topic=__consumer_offsets,partition=11,error_code=11},{topic=__consumer_offsets,partition=22,error_code=11},{topic=__consumer_offsets,partition=0,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:21:06,394] TRACE Controller 0 epoch 8 elected leader 1 for Offline partition [__consumer_offsets,19] (state.change.logger)
[2017-06-26 23:21:06,395] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=49,error_code=11},{topic=__consumer_offsets,partition=38,error_code=11},{topic=__consumer_offsets,partition=16,error_code=11},{topic=__consumer_offsets,partition=27,error_code=11},{topic=__consumer_offsets,partition=8,error_code=11},{topic=__consumer_offsets,partition=19,error_code=11},{topic=__consumer_offsets,partition=2,error_code=11},{topic=__consumer_offsets,partition=13,error_code=11},{topic=__consumer_offsets,partition=24,error_code=11},{topic=__consumer_offsets,partition=46,error_code=11},{topic=__consumer_offsets,partition=35,error_code=11},{topic=__consumer_offsets,partition=5,error_code=11},{topic=__consumer_offsets,partition=43,error_code=11},{topic=__consumer_offsets,partition=21,error_code=11},{topic=__consumer_offsets,partition=32,error_code=11},{topic=__consumer_offsets,partition=10,error_code=11},{topic=__consumer_offsets,partition=37,error_code=11},{topic=__consumer_offsets,partition=48,error_code=11},{topic=__consumer_offsets,partition=29,error_code=11},{topic=__consumer_offsets,partition=40,error_code=11},{topic=__consumer_offsets,partition=18,error_code=11},{topic=__consumer_offsets,partition=7,error_code=11},{topic=__consumer_offsets,partition=45,error_code=11},{topic=__consumer_offsets,partition=34,error_code=11},{topic=__consumer_offsets,partition=23,error_code=11},{topic=__consumer_offsets,partition=26,error_code=11},{topic=__consumer_offsets,partition=4,error_code=11},{topic=__consumer_offsets,partition=15,error_code=11},{topic=__consumer_offsets,partition=42,error_code=11},{topic=__consumer_offsets,partition=20,error_code=11},{topic=__consumer_offsets,partition=9,error_code=11},{topic=__consumer_offsets,partition=31,error_code=11},{topic=__consumer_offsets,partition=12,error_code=11},{topic=__consumer_offsets,partition=1,error_code=11},{topic=__consumer_offsets,partition=17,error_code=11},{topic=__consumer_offsets,partition=28,error_code=11},{topic=__consumer_offsets,partition=6,error_code=11},{topic=__consumer_offsets,partition=39,error_code=11},{topic=__consumer_offsets,partition=44,error_code=11},{topic=__consumer_offsets,partition=36,error_code=11},{topic=__consumer_offsets,partition=47,error_code=11},{topic=__consumer_offsets,partition=25,error_code=11},{topic=__consumer_offsets,partition=3,error_code=11},{topic=__consumer_offsets,partition=14,error_code=11},{topic=__consumer_offsets,partition=41,error_code=11},{topic=__consumer_offsets,partition=30,error_code=11},{topic=__consumer_offsets,partition=33,error_code=11},{topic=__consumer_offsets,partition=11,error_code=11},{topic=__consumer_offsets,partition=22,error_code=11},{topic=__consumer_offsets,partition=0,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:21:06,395] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,19] from OfflinePartition to OnlinePartition with leader 1 (state.change.logger)
[2017-06-26 23:21:06,395] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:21:06,395] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,30] (state.change.logger)
[2017-06-26 23:21:06,396] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-13 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 2 (state.change.logger)
[2017-06-26 23:21:06,396] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-46 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 2 (state.change.logger)
[2017-06-26 23:21:06,396] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-9 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 2 (state.change.logger)
[2017-06-26 23:21:06,396] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-42 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 2 (state.change.logger)
[2017-06-26 23:21:06,396] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-21 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 2 (state.change.logger)
[2017-06-26 23:21:06,396] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-17 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 2 (state.change.logger)
[2017-06-26 23:21:06,396] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-30 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 2 (state.change.logger)
[2017-06-26 23:21:06,396] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-26 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 2 (state.change.logger)
[2017-06-26 23:21:06,397] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-5 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 2 (state.change.logger)
[2017-06-26 23:21:06,397] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-38 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 2 (state.change.logger)
[2017-06-26 23:21:06,397] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-1 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 2 (state.change.logger)
[2017-06-26 23:21:06,397] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-34 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 2 (state.change.logger)
[2017-06-26 23:21:06,397] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-16 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 2 (state.change.logger)
[2017-06-26 23:21:06,397] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-45 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 2 (state.change.logger)
[2017-06-26 23:21:06,397] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-12 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 2 (state.change.logger)
[2017-06-26 23:21:06,397] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-41 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 2 (state.change.logger)
[2017-06-26 23:21:06,397] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-24 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 2 (state.change.logger)
[2017-06-26 23:21:06,397] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-20 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 2 (state.change.logger)
[2017-06-26 23:21:06,397] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-49 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 2 (state.change.logger)
[2017-06-26 23:21:06,397] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-0 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 2 (state.change.logger)
[2017-06-26 23:21:06,397] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-29 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 2 (state.change.logger)
[2017-06-26 23:21:06,397] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-25 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 2 (state.change.logger)
[2017-06-26 23:21:06,397] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-8 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 2 (state.change.logger)
[2017-06-26 23:21:06,397] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-37 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 2 (state.change.logger)
[2017-06-26 23:21:06,397] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-4 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 2 (state.change.logger)
[2017-06-26 23:21:06,397] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-33 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 2 (state.change.logger)
[2017-06-26 23:21:06,397] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-15 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 2 (state.change.logger)
[2017-06-26 23:21:06,397] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:21:06,397] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-48 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 2 (state.change.logger)
[2017-06-26 23:21:06,397] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-11 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 2 (state.change.logger)
[2017-06-26 23:21:06,397] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-44 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 2 (state.change.logger)
[2017-06-26 23:21:06,397] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-23 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 2 (state.change.logger)
[2017-06-26 23:21:06,397] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:6,ControllerEpoch:7),ReplicationFactor:1),AllReplicas:2) for partition rf1p1-0 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 2 (state.change.logger)
[2017-06-26 23:21:06,397] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-19 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 2 (state.change.logger)
[2017-06-26 23:21:06,397] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-32 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 2 (state.change.logger)
[2017-06-26 23:21:06,398] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-28 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 2 (state.change.logger)
[2017-06-26 23:21:06,398] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-7 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 2 (state.change.logger)
[2017-06-26 23:21:06,398] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-40 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 2 (state.change.logger)
[2017-06-26 23:21:06,398] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-3 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 2 (state.change.logger)
[2017-06-26 23:21:06,398] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-36 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 2 (state.change.logger)
[2017-06-26 23:21:06,398] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-47 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 2 (state.change.logger)
[2017-06-26 23:21:06,398] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-14 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 2 (state.change.logger)
[2017-06-26 23:21:06,398] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-43 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 2 (state.change.logger)
[2017-06-26 23:21:06,398] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-10 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 2 (state.change.logger)
[2017-06-26 23:21:06,398] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-22 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 2 (state.change.logger)
[2017-06-26 23:21:06,398] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-18 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 2 (state.change.logger)
[2017-06-26 23:21:06,398] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-31 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 2 (state.change.logger)
[2017-06-26 23:21:06,398] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-27 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 2 (state.change.logger)
[2017-06-26 23:21:06,398] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-39 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 2 (state.change.logger)
[2017-06-26 23:21:06,398] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-6 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 2 (state.change.logger)
[2017-06-26 23:21:06,398] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-35 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 2 (state.change.logger)
[2017-06-26 23:21:06,398] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:3,ControllerEpoch:7),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-2 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 2 (state.change.logger)
[2017-06-26 23:21:06,398] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:21:06,398] TRACE Controller 0 epoch 8 elected leader 0 for Offline partition [__consumer_offsets,30] (state.change.logger)
[2017-06-26 23:21:06,399] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,30] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-06-26 23:21:06,399] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,47] (state.change.logger)
[2017-06-26 23:21:06,403] TRACE Controller 0 epoch 8 elected leader 2 for Offline partition [__consumer_offsets,47] (state.change.logger)
[2017-06-26 23:21:06,404] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,47] from OfflinePartition to OnlinePartition with leader 2 (state.change.logger)
[2017-06-26 23:21:06,404] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,29] (state.change.logger)
[2017-06-26 23:21:06,406] TRACE Controller 0 epoch 8 elected leader 2 for Offline partition [__consumer_offsets,29] (state.change.logger)
[2017-06-26 23:21:06,407] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,29] from OfflinePartition to OnlinePartition with leader 2 (state.change.logger)
[2017-06-26 23:21:06,407] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,41] (state.change.logger)
[2017-06-26 23:21:06,409] TRACE Controller 0 epoch 8 elected leader 2 for Offline partition [__consumer_offsets,41] (state.change.logger)
[2017-06-26 23:21:06,410] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,41] from OfflinePartition to OnlinePartition with leader 2 (state.change.logger)
[2017-06-26 23:21:06,410] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,39] (state.change.logger)
[2017-06-26 23:21:06,413] TRACE Controller 0 epoch 8 elected leader 0 for Offline partition [__consumer_offsets,39] (state.change.logger)
[2017-06-26 23:21:06,414] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,39] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-06-26 23:21:06,414] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,17] (state.change.logger)
[2017-06-26 23:21:06,417] TRACE Controller 0 epoch 8 elected leader 2 for Offline partition [__consumer_offsets,17] (state.change.logger)
[2017-06-26 23:21:06,417] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,17] from OfflinePartition to OnlinePartition with leader 2 (state.change.logger)
[2017-06-26 23:21:06,417] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,10] (state.change.logger)
[2017-06-26 23:21:06,420] TRACE Controller 0 epoch 8 elected leader 1 for Offline partition [__consumer_offsets,10] (state.change.logger)
[2017-06-26 23:21:06,420] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,10] from OfflinePartition to OnlinePartition with leader 1 (state.change.logger)
[2017-06-26 23:21:06,420] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,14] (state.change.logger)
[2017-06-26 23:21:06,422] TRACE Controller 0 epoch 8 elected leader 2 for Offline partition [__consumer_offsets,14] (state.change.logger)
[2017-06-26 23:21:06,423] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,14] from OfflinePartition to OnlinePartition with leader 2 (state.change.logger)
[2017-06-26 23:21:06,423] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,40] (state.change.logger)
[2017-06-26 23:21:06,425] TRACE Controller 0 epoch 8 elected leader 1 for Offline partition [__consumer_offsets,40] (state.change.logger)
[2017-06-26 23:21:06,426] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,40] from OfflinePartition to OnlinePartition with leader 1 (state.change.logger)
[2017-06-26 23:21:06,426] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,18] (state.change.logger)
[2017-06-26 23:21:06,428] TRACE Controller 0 epoch 8 elected leader 0 for Offline partition [__consumer_offsets,18] (state.change.logger)
[2017-06-26 23:21:06,429] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,18] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-06-26 23:21:06,429] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,0] (state.change.logger)
[2017-06-26 23:21:06,431] TRACE Controller 0 epoch 8 elected leader 0 for Offline partition [__consumer_offsets,0] (state.change.logger)
[2017-06-26 23:21:06,431] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-06-26 23:21:06,431] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,26] (state.change.logger)
[2017-06-26 23:21:06,434] TRACE Controller 0 epoch 8 elected leader 2 for Offline partition [__consumer_offsets,26] (state.change.logger)
[2017-06-26 23:21:06,434] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,26] from OfflinePartition to OnlinePartition with leader 2 (state.change.logger)
[2017-06-26 23:21:06,434] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,24] (state.change.logger)
[2017-06-26 23:21:06,436] TRACE Controller 0 epoch 8 elected leader 0 for Offline partition [__consumer_offsets,24] (state.change.logger)
[2017-06-26 23:21:06,437] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,24] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-06-26 23:21:06,437] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,33] (state.change.logger)
[2017-06-26 23:21:06,439] TRACE Controller 0 epoch 8 elected leader 0 for Offline partition [__consumer_offsets,33] (state.change.logger)
[2017-06-26 23:21:06,440] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,33] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-06-26 23:21:06,440] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,20] (state.change.logger)
[2017-06-26 23:21:06,442] TRACE Controller 0 epoch 8 elected leader 2 for Offline partition [__consumer_offsets,20] (state.change.logger)
[2017-06-26 23:21:06,443] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,20] from OfflinePartition to OnlinePartition with leader 2 (state.change.logger)
[2017-06-26 23:21:06,443] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,21] (state.change.logger)
[2017-06-26 23:21:06,445] TRACE Controller 0 epoch 8 elected leader 0 for Offline partition [__consumer_offsets,21] (state.change.logger)
[2017-06-26 23:21:06,446] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,21] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-06-26 23:21:06,446] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,3] (state.change.logger)
[2017-06-26 23:21:06,447] TRACE Controller 0 epoch 8 elected leader 0 for Offline partition [__consumer_offsets,3] (state.change.logger)
[2017-06-26 23:21:06,448] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,3] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-06-26 23:21:06,448] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,22] (state.change.logger)
[2017-06-26 23:21:06,475] TRACE Controller 0 epoch 8 elected leader 1 for Offline partition [__consumer_offsets,22] (state.change.logger)
[2017-06-26 23:21:06,476] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,22] from OfflinePartition to OnlinePartition with leader 1 (state.change.logger)
[2017-06-26 23:21:06,476] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,5] (state.change.logger)
[2017-06-26 23:21:06,478] TRACE Controller 0 epoch 8 elected leader 2 for Offline partition [__consumer_offsets,5] (state.change.logger)
[2017-06-26 23:21:06,479] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,5] from OfflinePartition to OnlinePartition with leader 2 (state.change.logger)
[2017-06-26 23:21:06,479] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,12] (state.change.logger)
[2017-06-26 23:21:06,481] TRACE Controller 0 epoch 8 elected leader 0 for Offline partition [__consumer_offsets,12] (state.change.logger)
[2017-06-26 23:21:06,481] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,12] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-06-26 23:21:06,481] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,8] (state.change.logger)
[2017-06-26 23:21:06,484] TRACE Controller 0 epoch 8 elected leader 2 for Offline partition [__consumer_offsets,8] (state.change.logger)
[2017-06-26 23:21:06,484] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,8] from OfflinePartition to OnlinePartition with leader 2 (state.change.logger)
[2017-06-26 23:21:06,484] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,23] (state.change.logger)
[2017-06-26 23:21:06,486] TRACE Controller 0 epoch 8 elected leader 2 for Offline partition [__consumer_offsets,23] (state.change.logger)
[2017-06-26 23:21:06,487] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,23] from OfflinePartition to OnlinePartition with leader 2 (state.change.logger)
[2017-06-26 23:21:06,487] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,15] (state.change.logger)
[2017-06-26 23:21:06,489] TRACE Controller 0 epoch 8 elected leader 0 for Offline partition [__consumer_offsets,15] (state.change.logger)
[2017-06-26 23:21:06,490] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,15] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-06-26 23:21:06,490] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,11] (state.change.logger)
[2017-06-26 23:21:06,492] TRACE Controller 0 epoch 8 elected leader 2 for Offline partition [__consumer_offsets,11] (state.change.logger)
[2017-06-26 23:21:06,493] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,11] from OfflinePartition to OnlinePartition with leader 2 (state.change.logger)
[2017-06-26 23:21:06,493] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,48] (state.change.logger)
[2017-06-26 23:21:06,495] TRACE Controller 0 epoch 8 elected leader 0 for Offline partition [__consumer_offsets,48] (state.change.logger)
[2017-06-26 23:21:06,496] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,48] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-06-26 23:21:06,496] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,13] (state.change.logger)
[2017-06-26 23:21:06,498] TRACE Controller 0 epoch 8 elected leader 1 for Offline partition [__consumer_offsets,13] (state.change.logger)
[2017-06-26 23:21:06,499] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,13] from OfflinePartition to OnlinePartition with leader 1 (state.change.logger)
[2017-06-26 23:21:06,499] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,6] (state.change.logger)
[2017-06-26 23:21:06,501] TRACE Controller 0 epoch 8 elected leader 0 for Offline partition [__consumer_offsets,6] (state.change.logger)
[2017-06-26 23:21:06,502] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,6] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-06-26 23:21:06,502] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,49] (state.change.logger)
[2017-06-26 23:21:06,504] TRACE Controller 0 epoch 8 elected leader 1 for Offline partition [__consumer_offsets,49] (state.change.logger)
[2017-06-26 23:21:06,504] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,49] from OfflinePartition to OnlinePartition with leader 1 (state.change.logger)
[2017-06-26 23:21:06,504] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,4] (state.change.logger)
[2017-06-26 23:21:06,506] TRACE Controller 0 epoch 8 elected leader 1 for Offline partition [__consumer_offsets,4] (state.change.logger)
[2017-06-26 23:21:06,507] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,4] from OfflinePartition to OnlinePartition with leader 1 (state.change.logger)
[2017-06-26 23:21:06,507] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,28] (state.change.logger)
[2017-06-26 23:21:06,509] TRACE Controller 0 epoch 8 elected leader 1 for Offline partition [__consumer_offsets,28] (state.change.logger)
[2017-06-26 23:21:06,509] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,28] from OfflinePartition to OnlinePartition with leader 1 (state.change.logger)
[2017-06-26 23:21:06,509] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,37] (state.change.logger)
[2017-06-26 23:21:06,511] TRACE Controller 0 epoch 8 elected leader 1 for Offline partition [__consumer_offsets,37] (state.change.logger)
[2017-06-26 23:21:06,511] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,37] from OfflinePartition to OnlinePartition with leader 1 (state.change.logger)
[2017-06-26 23:21:06,511] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,31] (state.change.logger)
[2017-06-26 23:21:06,512] TRACE Controller 0 epoch 8 elected leader 1 for Offline partition [__consumer_offsets,31] (state.change.logger)
[2017-06-26 23:21:06,513] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,31] from OfflinePartition to OnlinePartition with leader 1 (state.change.logger)
[2017-06-26 23:21:06,513] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,44] (state.change.logger)
[2017-06-26 23:21:06,513] TRACE Controller 0 epoch 8 elected leader 2 for Offline partition [__consumer_offsets,44] (state.change.logger)
[2017-06-26 23:21:06,514] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,44] from OfflinePartition to OnlinePartition with leader 2 (state.change.logger)
[2017-06-26 23:21:06,514] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,42] (state.change.logger)
[2017-06-26 23:21:06,515] TRACE Controller 0 epoch 8 elected leader 0 for Offline partition [__consumer_offsets,42] (state.change.logger)
[2017-06-26 23:21:06,515] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,42] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-06-26 23:21:06,515] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,34] (state.change.logger)
[2017-06-26 23:21:06,516] TRACE Controller 0 epoch 8 elected leader 1 for Offline partition [__consumer_offsets,34] (state.change.logger)
[2017-06-26 23:21:06,516] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,34] from OfflinePartition to OnlinePartition with leader 1 (state.change.logger)
[2017-06-26 23:21:06,516] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,46] (state.change.logger)
[2017-06-26 23:21:06,518] TRACE Controller 0 epoch 8 elected leader 1 for Offline partition [__consumer_offsets,46] (state.change.logger)
[2017-06-26 23:21:06,518] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,46] from OfflinePartition to OnlinePartition with leader 1 (state.change.logger)
[2017-06-26 23:21:06,518] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,25] (state.change.logger)
[2017-06-26 23:21:06,519] TRACE Controller 0 epoch 8 elected leader 1 for Offline partition [__consumer_offsets,25] (state.change.logger)
[2017-06-26 23:21:06,519] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,25] from OfflinePartition to OnlinePartition with leader 1 (state.change.logger)
[2017-06-26 23:21:06,519] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,27] (state.change.logger)
[2017-06-26 23:21:06,521] TRACE Controller 0 epoch 8 elected leader 0 for Offline partition [__consumer_offsets,27] (state.change.logger)
[2017-06-26 23:21:06,521] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,27] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-06-26 23:21:06,521] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,45] (state.change.logger)
[2017-06-26 23:21:06,522] TRACE Controller 0 epoch 8 elected leader 0 for Offline partition [__consumer_offsets,45] (state.change.logger)
[2017-06-26 23:21:06,523] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,45] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-06-26 23:21:06,523] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,32] (state.change.logger)
[2017-06-26 23:21:06,524] TRACE Controller 0 epoch 8 elected leader 2 for Offline partition [__consumer_offsets,32] (state.change.logger)
[2017-06-26 23:21:06,525] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,32] from OfflinePartition to OnlinePartition with leader 2 (state.change.logger)
[2017-06-26 23:21:06,525] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,43] (state.change.logger)
[2017-06-26 23:21:06,527] TRACE Controller 0 epoch 8 elected leader 1 for Offline partition [__consumer_offsets,43] (state.change.logger)
[2017-06-26 23:21:06,527] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,43] from OfflinePartition to OnlinePartition with leader 1 (state.change.logger)
[2017-06-26 23:21:06,527] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,36] (state.change.logger)
[2017-06-26 23:21:06,529] TRACE Controller 0 epoch 8 elected leader 0 for Offline partition [__consumer_offsets,36] (state.change.logger)
[2017-06-26 23:21:06,530] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,36] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-06-26 23:21:06,530] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,35] (state.change.logger)
[2017-06-26 23:21:06,532] TRACE Controller 0 epoch 8 elected leader 2 for Offline partition [__consumer_offsets,35] (state.change.logger)
[2017-06-26 23:21:06,533] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,35] from OfflinePartition to OnlinePartition with leader 2 (state.change.logger)
[2017-06-26 23:21:06,533] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,7] (state.change.logger)
[2017-06-26 23:21:06,535] TRACE Controller 0 epoch 8 elected leader 1 for Offline partition [__consumer_offsets,7] (state.change.logger)
[2017-06-26 23:21:06,536] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,7] from OfflinePartition to OnlinePartition with leader 1 (state.change.logger)
[2017-06-26 23:21:06,536] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,38] (state.change.logger)
[2017-06-26 23:21:06,538] TRACE Controller 0 epoch 8 elected leader 2 for Offline partition [__consumer_offsets,38] (state.change.logger)
[2017-06-26 23:21:06,539] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,38] from OfflinePartition to OnlinePartition with leader 2 (state.change.logger)
[2017-06-26 23:21:06,539] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,9] (state.change.logger)
[2017-06-26 23:21:06,541] TRACE Controller 0 epoch 8 elected leader 0 for Offline partition [__consumer_offsets,9] (state.change.logger)
[2017-06-26 23:21:06,542] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,9] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-06-26 23:21:06,542] TRACE Controller 0 epoch 8 started leader election for partition [rf1p1,0] (state.change.logger)
[2017-06-26 23:21:06,545] TRACE Controller 0 epoch 8 elected leader 2 for Offline partition [rf1p1,0] (state.change.logger)
[2017-06-26 23:21:06,546] TRACE Controller 0 epoch 8 changed partition [rf1p1,0] from OfflinePartition to OnlinePartition with leader 2 (state.change.logger)
[2017-06-26 23:21:06,546] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,1] (state.change.logger)
[2017-06-26 23:21:06,549] TRACE Controller 0 epoch 8 elected leader 1 for Offline partition [__consumer_offsets,1] (state.change.logger)
[2017-06-26 23:21:06,550] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,1] from OfflinePartition to OnlinePartition with leader 1 (state.change.logger)
[2017-06-26 23:21:06,550] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,2] (state.change.logger)
[2017-06-26 23:21:06,552] TRACE Controller 0 epoch 8 elected leader 2 for Offline partition [__consumer_offsets,2] (state.change.logger)
[2017-06-26 23:21:06,553] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,2] from OfflinePartition to OnlinePartition with leader 2 (state.change.logger)
[2017-06-26 23:21:06,553] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,16] (state.change.logger)
[2017-06-26 23:21:06,555] TRACE Controller 0 epoch 8 elected leader 1 for Offline partition [__consumer_offsets,16] (state.change.logger)
[2017-06-26 23:21:06,556] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,16] from OfflinePartition to OnlinePartition with leader 1 (state.change.logger)
[2017-06-26 23:21:06,556] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,49] (state.change.logger)
[2017-06-26 23:21:06,556] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,38] (state.change.logger)
[2017-06-26 23:21:06,556] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,16] (state.change.logger)
[2017-06-26 23:21:06,556] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,27] (state.change.logger)
[2017-06-26 23:21:06,556] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,8] (state.change.logger)
[2017-06-26 23:21:06,556] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,19] (state.change.logger)
[2017-06-26 23:21:06,556] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,2] (state.change.logger)
[2017-06-26 23:21:06,556] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,13] (state.change.logger)
[2017-06-26 23:21:06,557] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,24] (state.change.logger)
[2017-06-26 23:21:06,557] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,46] (state.change.logger)
[2017-06-26 23:21:06,557] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,35] (state.change.logger)
[2017-06-26 23:21:06,557] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,5] (state.change.logger)
[2017-06-26 23:21:06,557] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,43] (state.change.logger)
[2017-06-26 23:21:06,557] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,21] (state.change.logger)
[2017-06-26 23:21:06,557] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,32] (state.change.logger)
[2017-06-26 23:21:06,557] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,10] (state.change.logger)
[2017-06-26 23:21:06,557] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,37] (state.change.logger)
[2017-06-26 23:21:06,557] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,48] (state.change.logger)
[2017-06-26 23:21:06,557] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,29] (state.change.logger)
[2017-06-26 23:21:06,557] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,40] (state.change.logger)
[2017-06-26 23:21:06,557] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,18] (state.change.logger)
[2017-06-26 23:21:06,557] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,7] (state.change.logger)
[2017-06-26 23:21:06,557] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,23] (state.change.logger)
[2017-06-26 23:21:06,557] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,34] (state.change.logger)
[2017-06-26 23:21:06,557] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,45] (state.change.logger)
[2017-06-26 23:21:06,557] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,26] (state.change.logger)
[2017-06-26 23:21:06,557] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,15] (state.change.logger)
[2017-06-26 23:21:06,557] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,4] (state.change.logger)
[2017-06-26 23:21:06,557] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,42] (state.change.logger)
[2017-06-26 23:21:06,557] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,20] (state.change.logger)
[2017-06-26 23:21:06,557] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,31] (state.change.logger)
[2017-06-26 23:21:06,557] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,9] (state.change.logger)
[2017-06-26 23:21:06,557] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,12] (state.change.logger)
[2017-06-26 23:21:06,557] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,1] (state.change.logger)
[2017-06-26 23:21:06,557] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,17] (state.change.logger)
[2017-06-26 23:21:06,557] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,28] (state.change.logger)
[2017-06-26 23:21:06,557] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,6] (state.change.logger)
[2017-06-26 23:21:06,557] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,39] (state.change.logger)
[2017-06-26 23:21:06,557] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,44] (state.change.logger)
[2017-06-26 23:21:06,557] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,47] (state.change.logger)
[2017-06-26 23:21:06,557] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,36] (state.change.logger)
[2017-06-26 23:21:06,557] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:8) to broker 2 for partition [rf1p1,0] (state.change.logger)
[2017-06-26 23:21:06,557] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,3] (state.change.logger)
[2017-06-26 23:21:06,557] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,14] (state.change.logger)
[2017-06-26 23:21:06,558] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,25] (state.change.logger)
[2017-06-26 23:21:06,558] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,30] (state.change.logger)
[2017-06-26 23:21:06,558] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,41] (state.change.logger)
[2017-06-26 23:21:06,558] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,11] (state.change.logger)
[2017-06-26 23:21:06,558] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,22] (state.change.logger)
[2017-06-26 23:21:06,558] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,33] (state.change.logger)
[2017-06-26 23:21:06,558] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,0] (state.change.logger)
[2017-06-26 23:21:06,558] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,49] (state.change.logger)
[2017-06-26 23:21:06,558] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,38] (state.change.logger)
[2017-06-26 23:21:06,558] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,16] (state.change.logger)
[2017-06-26 23:21:06,558] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,27] (state.change.logger)
[2017-06-26 23:21:06,558] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,8] (state.change.logger)
[2017-06-26 23:21:06,558] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,19] (state.change.logger)
[2017-06-26 23:21:06,558] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,13] (state.change.logger)
[2017-06-26 23:21:06,558] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,2] (state.change.logger)
[2017-06-26 23:21:06,558] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,24] (state.change.logger)
[2017-06-26 23:21:06,558] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,46] (state.change.logger)
[2017-06-26 23:21:06,558] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,35] (state.change.logger)
[2017-06-26 23:21:06,558] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,5] (state.change.logger)
[2017-06-26 23:21:06,558] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,43] (state.change.logger)
[2017-06-26 23:21:06,558] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,21] (state.change.logger)
[2017-06-26 23:21:06,558] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,32] (state.change.logger)
[2017-06-26 23:21:06,558] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,10] (state.change.logger)
[2017-06-26 23:21:06,558] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,37] (state.change.logger)
[2017-06-26 23:21:06,558] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,48] (state.change.logger)
[2017-06-26 23:21:06,558] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,29] (state.change.logger)
[2017-06-26 23:21:06,558] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,40] (state.change.logger)
[2017-06-26 23:21:06,558] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,18] (state.change.logger)
[2017-06-26 23:21:06,558] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,7] (state.change.logger)
[2017-06-26 23:21:06,558] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,23] (state.change.logger)
[2017-06-26 23:21:06,558] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,34] (state.change.logger)
[2017-06-26 23:21:06,558] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,45] (state.change.logger)
[2017-06-26 23:21:06,558] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,26] (state.change.logger)
[2017-06-26 23:21:06,558] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,15] (state.change.logger)
[2017-06-26 23:21:06,558] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,4] (state.change.logger)
[2017-06-26 23:21:06,558] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,42] (state.change.logger)
[2017-06-26 23:21:06,558] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,20] (state.change.logger)
[2017-06-26 23:21:06,559] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,31] (state.change.logger)
[2017-06-26 23:21:06,559] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,9] (state.change.logger)
[2017-06-26 23:21:06,559] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,12] (state.change.logger)
[2017-06-26 23:21:06,559] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,1] (state.change.logger)
[2017-06-26 23:21:06,559] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,17] (state.change.logger)
[2017-06-26 23:21:06,559] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,28] (state.change.logger)
[2017-06-26 23:21:06,559] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,6] (state.change.logger)
[2017-06-26 23:21:06,559] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,39] (state.change.logger)
[2017-06-26 23:21:06,559] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,44] (state.change.logger)
[2017-06-26 23:21:06,559] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,47] (state.change.logger)
[2017-06-26 23:21:06,559] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,36] (state.change.logger)
[2017-06-26 23:21:06,559] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,3] (state.change.logger)
[2017-06-26 23:21:06,559] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,14] (state.change.logger)
[2017-06-26 23:21:06,559] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,25] (state.change.logger)
[2017-06-26 23:21:06,559] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,30] (state.change.logger)
[2017-06-26 23:21:06,559] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,41] (state.change.logger)
[2017-06-26 23:21:06,559] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,11] (state.change.logger)
[2017-06-26 23:21:06,559] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,22] (state.change.logger)
[2017-06-26 23:21:06,559] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,33] (state.change.logger)
[2017-06-26 23:21:06,559] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,0] (state.change.logger)
[2017-06-26 23:21:06,560] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,49] (state.change.logger)
[2017-06-26 23:21:06,560] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,38] (state.change.logger)
[2017-06-26 23:21:06,560] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,16] (state.change.logger)
[2017-06-26 23:21:06,560] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,27] (state.change.logger)
[2017-06-26 23:21:06,560] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,8] (state.change.logger)
[2017-06-26 23:21:06,560] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,19] (state.change.logger)
[2017-06-26 23:21:06,560] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,13] (state.change.logger)
[2017-06-26 23:21:06,560] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,2] (state.change.logger)
[2017-06-26 23:21:06,560] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,24] (state.change.logger)
[2017-06-26 23:21:06,560] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,46] (state.change.logger)
[2017-06-26 23:21:06,560] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,35] (state.change.logger)
[2017-06-26 23:21:06,560] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,5] (state.change.logger)
[2017-06-26 23:21:06,560] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,43] (state.change.logger)
[2017-06-26 23:21:06,560] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,21] (state.change.logger)
[2017-06-26 23:21:06,560] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,32] (state.change.logger)
[2017-06-26 23:21:06,560] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,10] (state.change.logger)
[2017-06-26 23:21:06,560] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,37] (state.change.logger)
[2017-06-26 23:21:06,560] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,48] (state.change.logger)
[2017-06-26 23:21:06,560] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,29] (state.change.logger)
[2017-06-26 23:21:06,560] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,40] (state.change.logger)
[2017-06-26 23:21:06,560] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,18] (state.change.logger)
[2017-06-26 23:21:06,560] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,7] (state.change.logger)
[2017-06-26 23:21:06,560] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,23] (state.change.logger)
[2017-06-26 23:21:06,560] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,34] (state.change.logger)
[2017-06-26 23:21:06,560] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,45] (state.change.logger)
[2017-06-26 23:21:06,560] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,26] (state.change.logger)
[2017-06-26 23:21:06,560] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,15] (state.change.logger)
[2017-06-26 23:21:06,561] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,4] (state.change.logger)
[2017-06-26 23:21:06,561] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,42] (state.change.logger)
[2017-06-26 23:21:06,561] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,20] (state.change.logger)
[2017-06-26 23:21:06,561] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,31] (state.change.logger)
[2017-06-26 23:21:06,561] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,9] (state.change.logger)
[2017-06-26 23:21:06,561] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,12] (state.change.logger)
[2017-06-26 23:21:06,561] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,1] (state.change.logger)
[2017-06-26 23:21:06,561] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,17] (state.change.logger)
[2017-06-26 23:21:06,561] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,28] (state.change.logger)
[2017-06-26 23:21:06,561] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,6] (state.change.logger)
[2017-06-26 23:21:06,561] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,39] (state.change.logger)
[2017-06-26 23:21:06,561] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,44] (state.change.logger)
[2017-06-26 23:21:06,561] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,47] (state.change.logger)
[2017-06-26 23:21:06,561] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,36] (state.change.logger)
[2017-06-26 23:21:06,561] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,3] (state.change.logger)
[2017-06-26 23:21:06,561] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,14] (state.change.logger)
[2017-06-26 23:21:06,561] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,25] (state.change.logger)
[2017-06-26 23:21:06,561] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,30] (state.change.logger)
[2017-06-26 23:21:06,561] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,41] (state.change.logger)
[2017-06-26 23:21:06,561] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,11] (state.change.logger)
[2017-06-26 23:21:06,561] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,22] (state.change.logger)
[2017-06-26 23:21:06,561] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,33] (state.change.logger)
[2017-06-26 23:21:06,561] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,0] (state.change.logger)
[2017-06-26 23:21:06,562] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-49 (state.change.logger)
[2017-06-26 23:21:06,562] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-38 (state.change.logger)
[2017-06-26 23:21:06,562] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-16 (state.change.logger)
[2017-06-26 23:21:06,562] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-27 (state.change.logger)
[2017-06-26 23:21:06,562] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-8 (state.change.logger)
[2017-06-26 23:21:06,562] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-19 (state.change.logger)
[2017-06-26 23:21:06,562] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-2 (state.change.logger)
[2017-06-26 23:21:06,562] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-13 (state.change.logger)
[2017-06-26 23:21:06,562] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-35 (state.change.logger)
[2017-06-26 23:21:06,562] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-46 (state.change.logger)
[2017-06-26 23:21:06,562] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-24 (state.change.logger)
[2017-06-26 23:21:06,562] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-5 (state.change.logger)
[2017-06-26 23:21:06,562] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-43 (state.change.logger)
[2017-06-26 23:21:06,562] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-32 (state.change.logger)
[2017-06-26 23:21:06,562] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-21 (state.change.logger)
[2017-06-26 23:21:06,562] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-10 (state.change.logger)
[2017-06-26 23:21:06,562] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-37 (state.change.logger)
[2017-06-26 23:21:06,562] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-48 (state.change.logger)
[2017-06-26 23:21:06,562] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-18 (state.change.logger)
[2017-06-26 23:21:06,562] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-40 (state.change.logger)
[2017-06-26 23:21:06,562] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-29 (state.change.logger)
[2017-06-26 23:21:06,562] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-7 (state.change.logger)
[2017-06-26 23:21:06,562] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-45 (state.change.logger)
[2017-06-26 23:21:06,562] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-34 (state.change.logger)
[2017-06-26 23:21:06,562] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-23 (state.change.logger)
[2017-06-26 23:21:06,562] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-26 (state.change.logger)
[2017-06-26 23:21:06,562] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-4 (state.change.logger)
[2017-06-26 23:21:06,562] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=8, replicas=[0, 1, 2]) correlation id 3 from controller 0 epoch 8 for partition [__consumer_offsets,13] (state.change.logger)
[2017-06-26 23:21:06,562] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-15 (state.change.logger)
[2017-06-26 23:21:06,562] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 3 from controller 0 epoch 8 for partition [__consumer_offsets,46] (state.change.logger)
[2017-06-26 23:21:06,562] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-42 (state.change.logger)
[2017-06-26 23:21:06,562] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 3 from controller 0 epoch 8 for partition [__consumer_offsets,9] (state.change.logger)
[2017-06-26 23:21:06,562] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-9 (state.change.logger)
[2017-06-26 23:21:06,562] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-31 (state.change.logger)
[2017-06-26 23:21:06,562] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-20 (state.change.logger)
[2017-06-26 23:21:06,562] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-1 (state.change.logger)
[2017-06-26 23:21:06,562] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-12 (state.change.logger)
[2017-06-26 23:21:06,563] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-28 (state.change.logger)
[2017-06-26 23:21:06,563] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-17 (state.change.logger)
[2017-06-26 23:21:06,562] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 3 from controller 0 epoch 8 for partition [__consumer_offsets,42] (state.change.logger)
[2017-06-26 23:21:06,563] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 3 from controller 0 epoch 8 for partition [__consumer_offsets,21] (state.change.logger)
[2017-06-26 23:21:06,563] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=2, leaderEpoch=4, isr=[2], zkVersion=7, replicas=[0, 1, 2]) correlation id 3 from controller 0 epoch 8 for partition [__consumer_offsets,17] (state.change.logger)
[2017-06-26 23:21:06,563] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 3 from controller 0 epoch 8 for partition [__consumer_offsets,30] (state.change.logger)
[2017-06-26 23:21:06,563] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=2, leaderEpoch=4, isr=[2], zkVersion=7, replicas=[0, 1, 2]) correlation id 3 from controller 0 epoch 8 for partition [__consumer_offsets,26] (state.change.logger)
[2017-06-26 23:21:06,563] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=2, leaderEpoch=4, isr=[2], zkVersion=7, replicas=[0, 1, 2]) correlation id 3 from controller 0 epoch 8 for partition [__consumer_offsets,5] (state.change.logger)
[2017-06-26 23:21:06,563] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=2, leaderEpoch=4, isr=[2], zkVersion=7, replicas=[0, 1, 2]) correlation id 3 from controller 0 epoch 8 for partition [__consumer_offsets,38] (state.change.logger)
[2017-06-26 23:21:06,563] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 3 from controller 0 epoch 8 for partition [__consumer_offsets,1] (state.change.logger)
[2017-06-26 23:21:06,563] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 3 from controller 0 epoch 8 for partition [__consumer_offsets,34] (state.change.logger)
[2017-06-26 23:21:06,563] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 3 from controller 0 epoch 8 for partition [__consumer_offsets,16] (state.change.logger)
[2017-06-26 23:21:06,563] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 3 from controller 0 epoch 8 for partition [__consumer_offsets,45] (state.change.logger)
[2017-06-26 23:21:06,563] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 3 from controller 0 epoch 8 for partition [__consumer_offsets,12] (state.change.logger)
[2017-06-26 23:21:06,563] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=2, leaderEpoch=4, isr=[2], zkVersion=7, replicas=[0, 1, 2]) correlation id 3 from controller 0 epoch 8 for partition [__consumer_offsets,41] (state.change.logger)
[2017-06-26 23:21:06,563] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 3 from controller 0 epoch 8 for partition [__consumer_offsets,24] (state.change.logger)
[2017-06-26 23:21:06,563] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=2, leaderEpoch=4, isr=[2], zkVersion=7, replicas=[0, 1, 2]) correlation id 3 from controller 0 epoch 8 for partition [__consumer_offsets,20] (state.change.logger)
[2017-06-26 23:21:06,563] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 3 from controller 0 epoch 8 for partition [__consumer_offsets,49] (state.change.logger)
[2017-06-26 23:21:06,563] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 3 from controller 0 epoch 8 for partition [__consumer_offsets,0] (state.change.logger)
[2017-06-26 23:21:06,563] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=2, leaderEpoch=4, isr=[2], zkVersion=7, replicas=[0, 1, 2]) correlation id 3 from controller 0 epoch 8 for partition [__consumer_offsets,29] (state.change.logger)
[2017-06-26 23:21:06,563] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 3 from controller 0 epoch 8 for partition [__consumer_offsets,25] (state.change.logger)
[2017-06-26 23:21:06,563] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=2, leaderEpoch=4, isr=[2], zkVersion=7, replicas=[0, 1, 2]) correlation id 3 from controller 0 epoch 8 for partition [__consumer_offsets,8] (state.change.logger)
[2017-06-26 23:21:06,563] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=7, replicas=[0, 1, 2]) correlation id 3 from controller 0 epoch 8 for partition [__consumer_offsets,37] (state.change.logger)
[2017-06-26 23:21:06,563] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=7, replicas=[0, 1, 2]) correlation id 3 from controller 0 epoch 8 for partition [__consumer_offsets,4] (state.change.logger)
[2017-06-26 23:21:06,563] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-6 (state.change.logger)
[2017-06-26 23:21:06,563] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-39 (state.change.logger)
[2017-06-26 23:21:06,563] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-44 (state.change.logger)
[2017-06-26 23:21:06,563] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-36 (state.change.logger)
[2017-06-26 23:21:06,563] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-47 (state.change.logger)
[2017-06-26 23:21:06,563] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition rf1p1-0 (state.change.logger)
[2017-06-26 23:21:06,563] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-25 (state.change.logger)
[2017-06-26 23:21:06,564] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-3 (state.change.logger)
[2017-06-26 23:21:06,564] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-14 (state.change.logger)
[2017-06-26 23:21:06,564] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-41 (state.change.logger)
[2017-06-26 23:21:06,564] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-30 (state.change.logger)
[2017-06-26 23:21:06,564] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-11 (state.change.logger)
[2017-06-26 23:21:06,564] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-22 (state.change.logger)
[2017-06-26 23:21:06,564] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-33 (state.change.logger)
[2017-06-26 23:21:06,564] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-0 (state.change.logger)
[2017-06-26 23:21:06,563] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 3 from controller 0 epoch 8 for partition [__consumer_offsets,33] (state.change.logger)
[2017-06-26 23:21:06,564] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 3 from controller 0 epoch 8 for partition [__consumer_offsets,15] (state.change.logger)
[2017-06-26 23:21:06,564] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 3 from controller 0 epoch 8 for partition [__consumer_offsets,48] (state.change.logger)
[2017-06-26 23:21:06,564] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=2, leaderEpoch=4, isr=[2], zkVersion=7, replicas=[0, 1, 2]) correlation id 3 from controller 0 epoch 8 for partition [__consumer_offsets,11] (state.change.logger)
[2017-06-26 23:21:06,564] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=2, leaderEpoch=4, isr=[2], zkVersion=7, replicas=[0, 1, 2]) correlation id 3 from controller 0 epoch 8 for partition [__consumer_offsets,44] (state.change.logger)
[2017-06-26 23:21:06,564] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=2, leaderEpoch=4, isr=[2], zkVersion=7, replicas=[0, 1, 2]) correlation id 3 from controller 0 epoch 8 for partition [__consumer_offsets,23] (state.change.logger)
[2017-06-26 23:21:06,564] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 3 from controller 0 epoch 8 for partition [__consumer_offsets,19] (state.change.logger)
[2017-06-26 23:21:06,564] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=2, leaderEpoch=4, isr=[2], zkVersion=7, replicas=[0, 1, 2]) correlation id 3 from controller 0 epoch 8 for partition [__consumer_offsets,32] (state.change.logger)
[2017-06-26 23:21:06,564] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 3 from controller 0 epoch 8 for partition [__consumer_offsets,28] (state.change.logger)
[2017-06-26 23:21:06,564] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 3 from controller 0 epoch 8 for partition [__consumer_offsets,7] (state.change.logger)
[2017-06-26 23:21:06,564] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 3 from controller 0 epoch 8 for partition [__consumer_offsets,40] (state.change.logger)
[2017-06-26 23:21:06,564] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 3 from controller 0 epoch 8 for partition [__consumer_offsets,3] (state.change.logger)
[2017-06-26 23:21:06,564] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 3 from controller 0 epoch 8 for partition [__consumer_offsets,36] (state.change.logger)
[2017-06-26 23:21:06,564] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=2, leaderEpoch=4, isr=[2], zkVersion=7, replicas=[0, 1, 2]) correlation id 3 from controller 0 epoch 8 for partition [__consumer_offsets,47] (state.change.logger)
[2017-06-26 23:21:06,565] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=2, leaderEpoch=4, isr=[2], zkVersion=7, replicas=[0, 1, 2]) correlation id 3 from controller 0 epoch 8 for partition [__consumer_offsets,14] (state.change.logger)
[2017-06-26 23:21:06,565] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 3 from controller 0 epoch 8 for partition [__consumer_offsets,43] (state.change.logger)
[2017-06-26 23:21:06,565] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 3 from controller 0 epoch 8 for partition [__consumer_offsets,10] (state.change.logger)
[2017-06-26 23:21:06,565] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=7, replicas=[0, 1, 2]) correlation id 3 from controller 0 epoch 8 for partition [__consumer_offsets,22] (state.change.logger)
[2017-06-26 23:21:06,565] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 3 from controller 0 epoch 8 for partition [__consumer_offsets,18] (state.change.logger)
[2017-06-26 23:21:06,565] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 3 from controller 0 epoch 8 for partition [__consumer_offsets,31] (state.change.logger)
[2017-06-26 23:21:06,565] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 3 from controller 0 epoch 8 for partition [__consumer_offsets,27] (state.change.logger)
[2017-06-26 23:21:06,565] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 3 from controller 0 epoch 8 for partition [__consumer_offsets,39] (state.change.logger)
[2017-06-26 23:21:06,565] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 3 from controller 0 epoch 8 for partition [__consumer_offsets,6] (state.change.logger)
[2017-06-26 23:21:06,565] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=2, leaderEpoch=4, isr=[2], zkVersion=7, replicas=[0, 1, 2]) correlation id 3 from controller 0 epoch 8 for partition [__consumer_offsets,35] (state.change.logger)
[2017-06-26 23:21:06,565] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=2, leaderEpoch=4, isr=[2], zkVersion=7, replicas=[0, 1, 2]) correlation id 3 from controller 0 epoch 8 for partition [__consumer_offsets,2] (state.change.logger)
[2017-06-26 23:21:06,565] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 8 starting the become-leader transition for partition __consumer_offsets-0 (state.change.logger)
[2017-06-26 23:21:06,565] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 8 starting the become-leader transition for partition __consumer_offsets-48 (state.change.logger)
[2017-06-26 23:21:06,565] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 8 starting the become-leader transition for partition __consumer_offsets-45 (state.change.logger)
[2017-06-26 23:21:06,565] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 8 starting the become-leader transition for partition __consumer_offsets-42 (state.change.logger)
[2017-06-26 23:21:06,565] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 8 starting the become-leader transition for partition __consumer_offsets-39 (state.change.logger)
[2017-06-26 23:21:06,565] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 8 starting the become-leader transition for partition __consumer_offsets-36 (state.change.logger)
[2017-06-26 23:21:06,565] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 8 starting the become-leader transition for partition __consumer_offsets-33 (state.change.logger)
[2017-06-26 23:21:06,565] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 8 starting the become-leader transition for partition __consumer_offsets-30 (state.change.logger)
[2017-06-26 23:21:06,565] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 8 starting the become-leader transition for partition __consumer_offsets-27 (state.change.logger)
[2017-06-26 23:21:06,565] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 8 starting the become-leader transition for partition __consumer_offsets-24 (state.change.logger)
[2017-06-26 23:21:06,565] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 8 starting the become-leader transition for partition __consumer_offsets-21 (state.change.logger)
[2017-06-26 23:21:06,565] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 8 starting the become-leader transition for partition __consumer_offsets-18 (state.change.logger)
[2017-06-26 23:21:06,565] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 8 starting the become-leader transition for partition __consumer_offsets-15 (state.change.logger)
[2017-06-26 23:21:06,565] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 8 starting the become-leader transition for partition __consumer_offsets-12 (state.change.logger)
[2017-06-26 23:21:06,565] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 8 starting the become-leader transition for partition __consumer_offsets-9 (state.change.logger)
[2017-06-26 23:21:06,565] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 8 starting the become-leader transition for partition __consumer_offsets-6 (state.change.logger)
[2017-06-26 23:21:06,565] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 8 starting the become-leader transition for partition __consumer_offsets-3 (state.change.logger)
[2017-06-26 23:21:06,566] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 8 for partition __consumer_offsets-0 since it is already the leader for the partition. (state.change.logger)
[2017-06-26 23:21:06,566] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 8 for partition __consumer_offsets-48 since it is already the leader for the partition. (state.change.logger)
[2017-06-26 23:21:06,566] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 8 for partition __consumer_offsets-45 since it is already the leader for the partition. (state.change.logger)
[2017-06-26 23:21:06,566] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 8 for partition __consumer_offsets-42 since it is already the leader for the partition. (state.change.logger)
[2017-06-26 23:21:06,566] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 8 for partition __consumer_offsets-39 since it is already the leader for the partition. (state.change.logger)
[2017-06-26 23:21:06,566] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 8 for partition __consumer_offsets-36 since it is already the leader for the partition. (state.change.logger)
[2017-06-26 23:21:06,566] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 8 for partition __consumer_offsets-33 since it is already the leader for the partition. (state.change.logger)
[2017-06-26 23:21:06,566] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 8 for partition __consumer_offsets-30 since it is already the leader for the partition. (state.change.logger)
[2017-06-26 23:21:06,567] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 8 for partition __consumer_offsets-27 since it is already the leader for the partition. (state.change.logger)
[2017-06-26 23:21:06,567] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 8 for partition __consumer_offsets-24 since it is already the leader for the partition. (state.change.logger)
[2017-06-26 23:21:06,567] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 8 for partition __consumer_offsets-21 since it is already the leader for the partition. (state.change.logger)
[2017-06-26 23:21:06,567] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 8 for partition __consumer_offsets-18 since it is already the leader for the partition. (state.change.logger)
[2017-06-26 23:21:06,567] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 8 for partition __consumer_offsets-15 since it is already the leader for the partition. (state.change.logger)
[2017-06-26 23:21:06,567] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 8 for partition __consumer_offsets-12 since it is already the leader for the partition. (state.change.logger)
[2017-06-26 23:21:06,567] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 8 for partition __consumer_offsets-9 since it is already the leader for the partition. (state.change.logger)
[2017-06-26 23:21:06,567] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 8 for partition __consumer_offsets-6 since it is already the leader for the partition. (state.change.logger)
[2017-06-26 23:21:06,567] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 8 for partition __consumer_offsets-3 since it is already the leader for the partition. (state.change.logger)
[2017-06-26 23:21:06,567] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 8 for the become-leader transition for partition __consumer_offsets-0 (state.change.logger)
[2017-06-26 23:21:06,567] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 8 for the become-leader transition for partition __consumer_offsets-48 (state.change.logger)
[2017-06-26 23:21:06,567] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 8 for the become-leader transition for partition __consumer_offsets-45 (state.change.logger)
[2017-06-26 23:21:06,567] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 8 for the become-leader transition for partition __consumer_offsets-42 (state.change.logger)
[2017-06-26 23:21:06,567] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 8 for the become-leader transition for partition __consumer_offsets-39 (state.change.logger)
[2017-06-26 23:21:06,567] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 8 for the become-leader transition for partition __consumer_offsets-36 (state.change.logger)
[2017-06-26 23:21:06,567] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 8 for the become-leader transition for partition __consumer_offsets-33 (state.change.logger)
[2017-06-26 23:21:06,567] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 8 for the become-leader transition for partition __consumer_offsets-30 (state.change.logger)
[2017-06-26 23:21:06,567] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 8 for the become-leader transition for partition __consumer_offsets-27 (state.change.logger)
[2017-06-26 23:21:06,567] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 8 for the become-leader transition for partition __consumer_offsets-24 (state.change.logger)
[2017-06-26 23:21:06,567] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 8 for the become-leader transition for partition __consumer_offsets-21 (state.change.logger)
[2017-06-26 23:21:06,567] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 8 for the become-leader transition for partition __consumer_offsets-18 (state.change.logger)
[2017-06-26 23:21:06,567] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 8 for the become-leader transition for partition __consumer_offsets-15 (state.change.logger)
[2017-06-26 23:21:06,567] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 8 for the become-leader transition for partition __consumer_offsets-12 (state.change.logger)
[2017-06-26 23:21:06,567] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 8 for the become-leader transition for partition __consumer_offsets-9 (state.change.logger)
[2017-06-26 23:21:06,568] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 8 for the become-leader transition for partition __consumer_offsets-6 (state.change.logger)
[2017-06-26 23:21:06,568] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 8 for the become-leader transition for partition __consumer_offsets-3 (state.change.logger)
[2017-06-26 23:21:06,568] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 8 starting the become-follower transition for partition __consumer_offsets-29 (state.change.logger)
[2017-06-26 23:21:06,568] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 8 starting the become-follower transition for partition __consumer_offsets-10 (state.change.logger)
[2017-06-26 23:21:06,568] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 8 starting the become-follower transition for partition __consumer_offsets-26 (state.change.logger)
[2017-06-26 23:21:06,568] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 8 starting the become-follower transition for partition __consumer_offsets-7 (state.change.logger)
[2017-06-26 23:21:06,568] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 8 starting the become-follower transition for partition __consumer_offsets-4 (state.change.logger)
[2017-06-26 23:21:06,568] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 8 starting the become-follower transition for partition __consumer_offsets-23 (state.change.logger)
[2017-06-26 23:21:06,568] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 8 starting the become-follower transition for partition __consumer_offsets-1 (state.change.logger)
[2017-06-26 23:21:06,568] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 8 starting the become-follower transition for partition __consumer_offsets-20 (state.change.logger)
[2017-06-26 23:21:06,568] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 8 starting the become-follower transition for partition __consumer_offsets-17 (state.change.logger)
[2017-06-26 23:21:06,568] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 8 starting the become-follower transition for partition __consumer_offsets-14 (state.change.logger)
[2017-06-26 23:21:06,568] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 8 starting the become-follower transition for partition __consumer_offsets-49 (state.change.logger)
[2017-06-26 23:21:06,568] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 8 starting the become-follower transition for partition __consumer_offsets-11 (state.change.logger)
[2017-06-26 23:21:06,568] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 8 starting the become-follower transition for partition __consumer_offsets-46 (state.change.logger)
[2017-06-26 23:21:06,568] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 8 starting the become-follower transition for partition __consumer_offsets-8 (state.change.logger)
[2017-06-26 23:21:06,568] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 8 starting the become-follower transition for partition __consumer_offsets-43 (state.change.logger)
[2017-06-26 23:21:06,568] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 8 starting the become-follower transition for partition __consumer_offsets-5 (state.change.logger)
[2017-06-26 23:21:06,568] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 8 starting the become-follower transition for partition __consumer_offsets-2 (state.change.logger)
[2017-06-26 23:21:06,568] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 8 starting the become-follower transition for partition __consumer_offsets-40 (state.change.logger)
[2017-06-26 23:21:06,568] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 8 starting the become-follower transition for partition __consumer_offsets-37 (state.change.logger)
[2017-06-26 23:21:06,568] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 8 starting the become-follower transition for partition __consumer_offsets-34 (state.change.logger)
[2017-06-26 23:21:06,568] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 8 starting the become-follower transition for partition __consumer_offsets-31 (state.change.logger)
[2017-06-26 23:21:06,568] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 8 starting the become-follower transition for partition __consumer_offsets-47 (state.change.logger)
[2017-06-26 23:21:06,568] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 8 starting the become-follower transition for partition __consumer_offsets-19 (state.change.logger)
[2017-06-26 23:21:06,568] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 8 starting the become-follower transition for partition __consumer_offsets-28 (state.change.logger)
[2017-06-26 23:21:06,568] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 8 starting the become-follower transition for partition __consumer_offsets-38 (state.change.logger)
[2017-06-26 23:21:06,568] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 8 starting the become-follower transition for partition __consumer_offsets-35 (state.change.logger)
[2017-06-26 23:21:06,568] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 8 starting the become-follower transition for partition __consumer_offsets-44 (state.change.logger)
[2017-06-26 23:21:06,568] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 8 starting the become-follower transition for partition __consumer_offsets-25 (state.change.logger)
[2017-06-26 23:21:06,568] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 8 starting the become-follower transition for partition __consumer_offsets-16 (state.change.logger)
[2017-06-26 23:21:06,568] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 8 starting the become-follower transition for partition __consumer_offsets-22 (state.change.logger)
[2017-06-26 23:21:06,568] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 8 starting the become-follower transition for partition __consumer_offsets-41 (state.change.logger)
[2017-06-26 23:21:06,568] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 8 starting the become-follower transition for partition __consumer_offsets-32 (state.change.logger)
[2017-06-26 23:21:06,568] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 8 starting the become-follower transition for partition __consumer_offsets-13 (state.change.logger)
[2017-06-26 23:21:06,569] INFO Broker 0 skipped the become-follower state change after marking its partition as follower with correlation id 3 from controller 0 epoch 8 for partition __consumer_offsets-29 since the new leader 2 is the same as the old leader (state.change.logger)
[2017-06-26 23:21:06,569] INFO Broker 0 skipped the become-follower state change after marking its partition as follower with correlation id 3 from controller 0 epoch 8 for partition __consumer_offsets-10 since the new leader 1 is the same as the old leader (state.change.logger)
[2017-06-26 23:21:06,569] INFO Broker 0 skipped the become-follower state change after marking its partition as follower with correlation id 3 from controller 0 epoch 8 for partition __consumer_offsets-26 since the new leader 2 is the same as the old leader (state.change.logger)
[2017-06-26 23:21:06,569] INFO Broker 0 skipped the become-follower state change after marking its partition as follower with correlation id 3 from controller 0 epoch 8 for partition __consumer_offsets-7 since the new leader 1 is the same as the old leader (state.change.logger)
[2017-06-26 23:21:06,569] INFO Broker 0 skipped the become-follower state change after marking its partition as follower with correlation id 3 from controller 0 epoch 8 for partition __consumer_offsets-4 since the new leader 1 is the same as the old leader (state.change.logger)
[2017-06-26 23:21:06,569] INFO Broker 0 skipped the become-follower state change after marking its partition as follower with correlation id 3 from controller 0 epoch 8 for partition __consumer_offsets-23 since the new leader 2 is the same as the old leader (state.change.logger)
[2017-06-26 23:21:06,569] INFO Broker 0 skipped the become-follower state change after marking its partition as follower with correlation id 3 from controller 0 epoch 8 for partition __consumer_offsets-1 since the new leader 1 is the same as the old leader (state.change.logger)
[2017-06-26 23:21:06,569] INFO Broker 0 skipped the become-follower state change after marking its partition as follower with correlation id 3 from controller 0 epoch 8 for partition __consumer_offsets-20 since the new leader 2 is the same as the old leader (state.change.logger)
[2017-06-26 23:21:06,569] INFO Broker 0 skipped the become-follower state change after marking its partition as follower with correlation id 3 from controller 0 epoch 8 for partition __consumer_offsets-17 since the new leader 2 is the same as the old leader (state.change.logger)
[2017-06-26 23:21:06,569] INFO Broker 0 skipped the become-follower state change after marking its partition as follower with correlation id 3 from controller 0 epoch 8 for partition __consumer_offsets-14 since the new leader 2 is the same as the old leader (state.change.logger)
[2017-06-26 23:21:06,569] INFO Broker 0 skipped the become-follower state change after marking its partition as follower with correlation id 3 from controller 0 epoch 8 for partition __consumer_offsets-49 since the new leader 1 is the same as the old leader (state.change.logger)
[2017-06-26 23:21:06,569] INFO Broker 0 skipped the become-follower state change after marking its partition as follower with correlation id 3 from controller 0 epoch 8 for partition __consumer_offsets-11 since the new leader 2 is the same as the old leader (state.change.logger)
[2017-06-26 23:21:06,569] INFO Broker 0 skipped the become-follower state change after marking its partition as follower with correlation id 3 from controller 0 epoch 8 for partition __consumer_offsets-46 since the new leader 1 is the same as the old leader (state.change.logger)
[2017-06-26 23:21:06,569] INFO Broker 0 skipped the become-follower state change after marking its partition as follower with correlation id 3 from controller 0 epoch 8 for partition __consumer_offsets-8 since the new leader 2 is the same as the old leader (state.change.logger)
[2017-06-26 23:21:06,570] INFO Broker 0 skipped the become-follower state change after marking its partition as follower with correlation id 3 from controller 0 epoch 8 for partition __consumer_offsets-43 since the new leader 1 is the same as the old leader (state.change.logger)
[2017-06-26 23:21:06,570] INFO Broker 0 skipped the become-follower state change after marking its partition as follower with correlation id 3 from controller 0 epoch 8 for partition __consumer_offsets-5 since the new leader 2 is the same as the old leader (state.change.logger)
[2017-06-26 23:21:06,570] INFO Broker 0 skipped the become-follower state change after marking its partition as follower with correlation id 3 from controller 0 epoch 8 for partition __consumer_offsets-2 since the new leader 2 is the same as the old leader (state.change.logger)
[2017-06-26 23:21:06,570] INFO Broker 0 skipped the become-follower state change after marking its partition as follower with correlation id 3 from controller 0 epoch 8 for partition __consumer_offsets-40 since the new leader 1 is the same as the old leader (state.change.logger)
[2017-06-26 23:21:06,570] INFO Broker 0 skipped the become-follower state change after marking its partition as follower with correlation id 3 from controller 0 epoch 8 for partition __consumer_offsets-37 since the new leader 1 is the same as the old leader (state.change.logger)
[2017-06-26 23:21:06,570] INFO Broker 0 skipped the become-follower state change after marking its partition as follower with correlation id 3 from controller 0 epoch 8 for partition __consumer_offsets-34 since the new leader 1 is the same as the old leader (state.change.logger)
[2017-06-26 23:21:06,570] INFO Broker 0 skipped the become-follower state change after marking its partition as follower with correlation id 3 from controller 0 epoch 8 for partition __consumer_offsets-31 since the new leader 1 is the same as the old leader (state.change.logger)
[2017-06-26 23:21:06,570] INFO Broker 0 skipped the become-follower state change after marking its partition as follower with correlation id 3 from controller 0 epoch 8 for partition __consumer_offsets-47 since the new leader 2 is the same as the old leader (state.change.logger)
[2017-06-26 23:21:06,570] INFO Broker 0 skipped the become-follower state change after marking its partition as follower with correlation id 3 from controller 0 epoch 8 for partition __consumer_offsets-19 since the new leader 1 is the same as the old leader (state.change.logger)
[2017-06-26 23:21:06,570] INFO Broker 0 skipped the become-follower state change after marking its partition as follower with correlation id 3 from controller 0 epoch 8 for partition __consumer_offsets-28 since the new leader 1 is the same as the old leader (state.change.logger)
[2017-06-26 23:21:06,570] INFO Broker 0 skipped the become-follower state change after marking its partition as follower with correlation id 3 from controller 0 epoch 8 for partition __consumer_offsets-38 since the new leader 2 is the same as the old leader (state.change.logger)
[2017-06-26 23:21:06,571] INFO Broker 0 skipped the become-follower state change after marking its partition as follower with correlation id 3 from controller 0 epoch 8 for partition __consumer_offsets-35 since the new leader 2 is the same as the old leader (state.change.logger)
[2017-06-26 23:21:06,571] INFO Broker 0 skipped the become-follower state change after marking its partition as follower with correlation id 3 from controller 0 epoch 8 for partition __consumer_offsets-44 since the new leader 2 is the same as the old leader (state.change.logger)
[2017-06-26 23:21:06,571] INFO Broker 0 skipped the become-follower state change after marking its partition as follower with correlation id 3 from controller 0 epoch 8 for partition __consumer_offsets-25 since the new leader 1 is the same as the old leader (state.change.logger)
[2017-06-26 23:21:06,571] INFO Broker 0 skipped the become-follower state change after marking its partition as follower with correlation id 3 from controller 0 epoch 8 for partition __consumer_offsets-16 since the new leader 1 is the same as the old leader (state.change.logger)
[2017-06-26 23:21:06,571] INFO Broker 0 skipped the become-follower state change after marking its partition as follower with correlation id 3 from controller 0 epoch 8 for partition __consumer_offsets-22 since the new leader 1 is the same as the old leader (state.change.logger)
[2017-06-26 23:21:06,571] INFO Broker 0 skipped the become-follower state change after marking its partition as follower with correlation id 3 from controller 0 epoch 8 for partition __consumer_offsets-41 since the new leader 2 is the same as the old leader (state.change.logger)
[2017-06-26 23:21:06,571] INFO Broker 0 skipped the become-follower state change after marking its partition as follower with correlation id 3 from controller 0 epoch 8 for partition __consumer_offsets-32 since the new leader 2 is the same as the old leader (state.change.logger)
[2017-06-26 23:21:06,571] INFO Broker 0 skipped the become-follower state change after marking its partition as follower with correlation id 3 from controller 0 epoch 8 for partition __consumer_offsets-13 since the new leader 1 is the same as the old leader (state.change.logger)
[2017-06-26 23:21:06,572] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=49,error_code=0},{topic=__consumer_offsets,partition=38,error_code=0},{topic=__consumer_offsets,partition=27,error_code=0},{topic=__consumer_offsets,partition=16,error_code=0},{topic=__consumer_offsets,partition=8,error_code=0},{topic=__consumer_offsets,partition=19,error_code=0},{topic=__consumer_offsets,partition=13,error_code=0},{topic=__consumer_offsets,partition=2,error_code=0},{topic=__consumer_offsets,partition=35,error_code=0},{topic=__consumer_offsets,partition=46,error_code=0},{topic=__consumer_offsets,partition=24,error_code=0},{topic=__consumer_offsets,partition=5,error_code=0},{topic=__consumer_offsets,partition=43,error_code=0},{topic=__consumer_offsets,partition=32,error_code=0},{topic=__consumer_offsets,partition=21,error_code=0},{topic=__consumer_offsets,partition=10,error_code=0},{topic=__consumer_offsets,partition=37,error_code=0},{topic=__consumer_offsets,partition=48,error_code=0},{topic=__consumer_offsets,partition=29,error_code=0},{topic=__consumer_offsets,partition=40,error_code=0},{topic=__consumer_offsets,partition=18,error_code=0},{topic=__consumer_offsets,partition=7,error_code=0},{topic=__consumer_offsets,partition=45,error_code=0},{topic=__consumer_offsets,partition=23,error_code=0},{topic=__consumer_offsets,partition=34,error_code=0},{topic=__consumer_offsets,partition=26,error_code=0},{topic=__consumer_offsets,partition=4,error_code=0},{topic=__consumer_offsets,partition=15,error_code=0},{topic=__consumer_offsets,partition=42,error_code=0},{topic=__consumer_offsets,partition=20,error_code=0},{topic=__consumer_offsets,partition=31,error_code=0},{topic=__consumer_offsets,partition=9,error_code=0},{topic=__consumer_offsets,partition=1,error_code=0},{topic=__consumer_offsets,partition=12,error_code=0},{topic=__consumer_offsets,partition=17,error_code=0},{topic=__consumer_offsets,partition=28,error_code=0},{topic=__consumer_offsets,partition=6,error_code=0},{topic=__consumer_offsets,partition=39,error_code=0},{topic=__consumer_offsets,partition=44,error_code=0},{topic=__consumer_offsets,partition=47,error_code=0},{topic=__consumer_offsets,partition=36,error_code=0},{topic=rf1p1,partition=0,error_code=0},{topic=__consumer_offsets,partition=3,error_code=0},{topic=__consumer_offsets,partition=14,error_code=0},{topic=__consumer_offsets,partition=25,error_code=0},{topic=__consumer_offsets,partition=41,error_code=0},{topic=__consumer_offsets,partition=30,error_code=0},{topic=__consumer_offsets,partition=11,error_code=0},{topic=__consumer_offsets,partition=33,error_code=0},{topic=__consumer_offsets,partition=22,error_code=0},{topic=__consumer_offsets,partition=0,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:21:06,573] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 8 for the become-follower transition for partition __consumer_offsets-29 (state.change.logger)
[2017-06-26 23:21:06,573] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 8 for the become-follower transition for partition __consumer_offsets-10 (state.change.logger)
[2017-06-26 23:21:06,573] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 8 for the become-follower transition for partition __consumer_offsets-26 (state.change.logger)
[2017-06-26 23:21:06,573] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 8 for the become-follower transition for partition __consumer_offsets-7 (state.change.logger)
[2017-06-26 23:21:06,573] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 8 for the become-follower transition for partition __consumer_offsets-4 (state.change.logger)
[2017-06-26 23:21:06,573] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 8 for the become-follower transition for partition __consumer_offsets-23 (state.change.logger)
[2017-06-26 23:21:06,573] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 8 for the become-follower transition for partition __consumer_offsets-1 (state.change.logger)
[2017-06-26 23:21:06,573] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 8 for the become-follower transition for partition __consumer_offsets-20 (state.change.logger)
[2017-06-26 23:21:06,573] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 8 for the become-follower transition for partition __consumer_offsets-17 (state.change.logger)
[2017-06-26 23:21:06,573] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 8 for the become-follower transition for partition __consumer_offsets-14 (state.change.logger)
[2017-06-26 23:21:06,573] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 8 for the become-follower transition for partition __consumer_offsets-49 (state.change.logger)
[2017-06-26 23:21:06,573] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 8 for the become-follower transition for partition __consumer_offsets-11 (state.change.logger)
[2017-06-26 23:21:06,573] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 8 for the become-follower transition for partition __consumer_offsets-46 (state.change.logger)
[2017-06-26 23:21:06,573] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 8 for the become-follower transition for partition __consumer_offsets-8 (state.change.logger)
[2017-06-26 23:21:06,573] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=49,error_code=0},{topic=__consumer_offsets,partition=38,error_code=0},{topic=__consumer_offsets,partition=16,error_code=0},{topic=__consumer_offsets,partition=27,error_code=0},{topic=__consumer_offsets,partition=19,error_code=0},{topic=__consumer_offsets,partition=8,error_code=0},{topic=__consumer_offsets,partition=13,error_code=0},{topic=__consumer_offsets,partition=2,error_code=0},{topic=__consumer_offsets,partition=46,error_code=0},{topic=__consumer_offsets,partition=24,error_code=0},{topic=__consumer_offsets,partition=35,error_code=0},{topic=__consumer_offsets,partition=5,error_code=0},{topic=__consumer_offsets,partition=43,error_code=0},{topic=__consumer_offsets,partition=21,error_code=0},{topic=__consumer_offsets,partition=32,error_code=0},{topic=__consumer_offsets,partition=10,error_code=0},{topic=__consumer_offsets,partition=37,error_code=0},{topic=__consumer_offsets,partition=48,error_code=0},{topic=__consumer_offsets,partition=29,error_code=0},{topic=__consumer_offsets,partition=40,error_code=0},{topic=__consumer_offsets,partition=18,error_code=0},{topic=__consumer_offsets,partition=7,error_code=0},{topic=__consumer_offsets,partition=23,error_code=0},{topic=__consumer_offsets,partition=45,error_code=0},{topic=__consumer_offsets,partition=34,error_code=0},{topic=__consumer_offsets,partition=26,error_code=0},{topic=__consumer_offsets,partition=4,error_code=0},{topic=__consumer_offsets,partition=15,error_code=0},{topic=__consumer_offsets,partition=42,error_code=0},{topic=__consumer_offsets,partition=20,error_code=0},{topic=__consumer_offsets,partition=31,error_code=0},{topic=__consumer_offsets,partition=9,error_code=0},{topic=__consumer_offsets,partition=1,error_code=0},{topic=__consumer_offsets,partition=12,error_code=0},{topic=__consumer_offsets,partition=28,error_code=0},{topic=__consumer_offsets,partition=17,error_code=0},{topic=__consumer_offsets,partition=6,error_code=0},{topic=__consumer_offsets,partition=39,error_code=0},{topic=__consumer_offsets,partition=44,error_code=0},{topic=__consumer_offsets,partition=36,error_code=0},{topic=__consumer_offsets,partition=47,error_code=0},{topic=__consumer_offsets,partition=3,error_code=0},{topic=__consumer_offsets,partition=25,error_code=0},{topic=__consumer_offsets,partition=14,error_code=0},{topic=__consumer_offsets,partition=30,error_code=0},{topic=__consumer_offsets,partition=41,error_code=0},{topic=__consumer_offsets,partition=22,error_code=0},{topic=__consumer_offsets,partition=33,error_code=0},{topic=__consumer_offsets,partition=11,error_code=0},{topic=__consumer_offsets,partition=0,error_code=0}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:21:06,573] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 8 for the become-follower transition for partition __consumer_offsets-43 (state.change.logger)
[2017-06-26 23:21:06,575] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 8 for the become-follower transition for partition __consumer_offsets-5 (state.change.logger)
[2017-06-26 23:21:06,575] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 8 for the become-follower transition for partition __consumer_offsets-2 (state.change.logger)
[2017-06-26 23:21:06,575] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 8 for the become-follower transition for partition __consumer_offsets-40 (state.change.logger)
[2017-06-26 23:21:06,575] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 8 for the become-follower transition for partition __consumer_offsets-37 (state.change.logger)
[2017-06-26 23:21:06,575] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 8 for the become-follower transition for partition __consumer_offsets-34 (state.change.logger)
[2017-06-26 23:21:06,575] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 8 for the become-follower transition for partition __consumer_offsets-31 (state.change.logger)
[2017-06-26 23:21:06,575] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 8 for the become-follower transition for partition __consumer_offsets-47 (state.change.logger)
[2017-06-26 23:21:06,575] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 8 for the become-follower transition for partition __consumer_offsets-19 (state.change.logger)
[2017-06-26 23:21:06,575] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 8 for the become-follower transition for partition __consumer_offsets-28 (state.change.logger)
[2017-06-26 23:21:06,575] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 8 for the become-follower transition for partition __consumer_offsets-38 (state.change.logger)
[2017-06-26 23:21:06,575] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 8 for the become-follower transition for partition __consumer_offsets-35 (state.change.logger)
[2017-06-26 23:21:06,575] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 8 for the become-follower transition for partition __consumer_offsets-44 (state.change.logger)
[2017-06-26 23:21:06,575] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 8 for the become-follower transition for partition __consumer_offsets-25 (state.change.logger)
[2017-06-26 23:21:06,575] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 8 for the become-follower transition for partition __consumer_offsets-16 (state.change.logger)
[2017-06-26 23:21:06,575] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 8 for the become-follower transition for partition __consumer_offsets-22 (state.change.logger)
[2017-06-26 23:21:06,575] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 8 for the become-follower transition for partition __consumer_offsets-41 (state.change.logger)
[2017-06-26 23:21:06,575] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 8 for the become-follower transition for partition __consumer_offsets-32 (state.change.logger)
[2017-06-26 23:21:06,575] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 8 for the become-follower transition for partition __consumer_offsets-13 (state.change.logger)
[2017-06-26 23:21:06,576] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=49,error_code=0},{topic=__consumer_offsets,partition=38,error_code=0},{topic=__consumer_offsets,partition=27,error_code=0},{topic=__consumer_offsets,partition=16,error_code=0},{topic=__consumer_offsets,partition=8,error_code=0},{topic=__consumer_offsets,partition=19,error_code=0},{topic=__consumer_offsets,partition=13,error_code=0},{topic=__consumer_offsets,partition=2,error_code=0},{topic=__consumer_offsets,partition=24,error_code=0},{topic=__consumer_offsets,partition=46,error_code=0},{topic=__consumer_offsets,partition=35,error_code=0},{topic=__consumer_offsets,partition=5,error_code=0},{topic=__consumer_offsets,partition=43,error_code=0},{topic=__consumer_offsets,partition=21,error_code=0},{topic=__consumer_offsets,partition=32,error_code=0},{topic=__consumer_offsets,partition=10,error_code=0},{topic=__consumer_offsets,partition=37,error_code=0},{topic=__consumer_offsets,partition=48,error_code=0},{topic=__consumer_offsets,partition=29,error_code=0},{topic=__consumer_offsets,partition=18,error_code=0},{topic=__consumer_offsets,partition=40,error_code=0},{topic=__consumer_offsets,partition=7,error_code=0},{topic=__consumer_offsets,partition=23,error_code=0},{topic=__consumer_offsets,partition=45,error_code=0},{topic=__consumer_offsets,partition=34,error_code=0},{topic=__consumer_offsets,partition=26,error_code=0},{topic=__consumer_offsets,partition=4,error_code=0},{topic=__consumer_offsets,partition=15,error_code=0},{topic=__consumer_offsets,partition=42,error_code=0},{topic=__consumer_offsets,partition=20,error_code=0},{topic=__consumer_offsets,partition=9,error_code=0},{topic=__consumer_offsets,partition=31,error_code=0},{topic=__consumer_offsets,partition=1,error_code=0},{topic=__consumer_offsets,partition=12,error_code=0},{topic=__consumer_offsets,partition=17,error_code=0},{topic=__consumer_offsets,partition=28,error_code=0},{topic=__consumer_offsets,partition=6,error_code=0},{topic=__consumer_offsets,partition=39,error_code=0},{topic=__consumer_offsets,partition=44,error_code=0},{topic=__consumer_offsets,partition=36,error_code=0},{topic=__consumer_offsets,partition=47,error_code=0},{topic=__consumer_offsets,partition=3,error_code=0},{topic=__consumer_offsets,partition=14,error_code=0},{topic=__consumer_offsets,partition=25,error_code=0},{topic=__consumer_offsets,partition=30,error_code=0},{topic=__consumer_offsets,partition=41,error_code=0},{topic=__consumer_offsets,partition=33,error_code=0},{topic=__consumer_offsets,partition=11,error_code=0},{topic=__consumer_offsets,partition=22,error_code=0},{topic=__consumer_offsets,partition=0,error_code=0}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:21:06,576] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:21:06,578] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-13 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 4 (state.change.logger)
[2017-06-26 23:21:06,578] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:21:06,578] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-46 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 4 (state.change.logger)
[2017-06-26 23:21:06,578] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-9 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 4 (state.change.logger)
[2017-06-26 23:21:06,578] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-42 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 4 (state.change.logger)
[2017-06-26 23:21:06,578] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-21 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 4 (state.change.logger)
[2017-06-26 23:21:06,578] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-17 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 4 (state.change.logger)
[2017-06-26 23:21:06,578] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-30 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 4 (state.change.logger)
[2017-06-26 23:21:06,578] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-26 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 4 (state.change.logger)
[2017-06-26 23:21:06,578] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-5 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 4 (state.change.logger)
[2017-06-26 23:21:06,578] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-38 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 4 (state.change.logger)
[2017-06-26 23:21:06,578] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-1 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 4 (state.change.logger)
[2017-06-26 23:21:06,578] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-34 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 4 (state.change.logger)
[2017-06-26 23:21:06,578] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-16 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 4 (state.change.logger)
[2017-06-26 23:21:06,578] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-45 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 4 (state.change.logger)
[2017-06-26 23:21:06,578] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-12 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 4 (state.change.logger)
[2017-06-26 23:21:06,578] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-41 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 4 (state.change.logger)
[2017-06-26 23:21:06,578] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-24 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 4 (state.change.logger)
[2017-06-26 23:21:06,578] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-20 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 4 (state.change.logger)
[2017-06-26 23:21:06,578] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-49 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 4 (state.change.logger)
[2017-06-26 23:21:06,579] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-0 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 4 (state.change.logger)
[2017-06-26 23:21:06,579] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-29 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 4 (state.change.logger)
[2017-06-26 23:21:06,579] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-25 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 4 (state.change.logger)
[2017-06-26 23:21:06,579] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-8 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 4 (state.change.logger)
[2017-06-26 23:21:06,579] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-37 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 4 (state.change.logger)
[2017-06-26 23:21:06,579] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-4 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 4 (state.change.logger)
[2017-06-26 23:21:06,579] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-33 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 4 (state.change.logger)
[2017-06-26 23:21:06,579] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-15 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 4 (state.change.logger)
[2017-06-26 23:21:06,579] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-48 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 4 (state.change.logger)
[2017-06-26 23:21:06,579] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-11 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 4 (state.change.logger)
[2017-06-26 23:21:06,579] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-44 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 4 (state.change.logger)
[2017-06-26 23:21:06,579] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-23 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 4 (state.change.logger)
[2017-06-26 23:21:06,579] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:8),ReplicationFactor:1),AllReplicas:2) for partition rf1p1-0 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 4 (state.change.logger)
[2017-06-26 23:21:06,579] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-19 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 4 (state.change.logger)
[2017-06-26 23:21:06,580] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-32 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 4 (state.change.logger)
[2017-06-26 23:21:06,580] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-28 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 4 (state.change.logger)
[2017-06-26 23:21:06,580] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-7 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 4 (state.change.logger)
[2017-06-26 23:21:06,580] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-40 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 4 (state.change.logger)
[2017-06-26 23:21:06,580] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-3 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 4 (state.change.logger)
[2017-06-26 23:21:06,580] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-36 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 4 (state.change.logger)
[2017-06-26 23:21:06,580] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-47 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 4 (state.change.logger)
[2017-06-26 23:21:06,580] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-14 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 4 (state.change.logger)
[2017-06-26 23:21:06,580] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-43 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 4 (state.change.logger)
[2017-06-26 23:21:06,580] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-10 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 4 (state.change.logger)
[2017-06-26 23:21:06,580] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-22 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 4 (state.change.logger)
[2017-06-26 23:21:06,580] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-18 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 4 (state.change.logger)
[2017-06-26 23:21:06,580] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-31 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 4 (state.change.logger)
[2017-06-26 23:21:06,581] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-27 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 4 (state.change.logger)
[2017-06-26 23:21:06,581] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-39 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 4 (state.change.logger)
[2017-06-26 23:21:06,581] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-6 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 4 (state.change.logger)
[2017-06-26 23:21:06,581] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-35 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 4 (state.change.logger)
[2017-06-26 23:21:06,581] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-2 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 4 (state.change.logger)
[2017-06-26 23:21:06,581] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:36,986] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,43] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:36,987] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,43] (state.change.logger)
[2017-06-26 23:41:36,987] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,43] (state.change.logger)
[2017-06-26 23:41:36,988] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-43 (state.change.logger)
[2017-06-26 23:41:36,988] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,14] (state.change.logger)
[2017-06-26 23:41:36,989] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 5 from controller 0 epoch 8 for partition [__consumer_offsets,43] (state.change.logger)
[2017-06-26 23:41:36,989] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 5 epoch 8 for partition [__consumer_offsets,43] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:36,989] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=43,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:36,990] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=43,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:36,990] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-43 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 6 (state.change.logger)
[2017-06-26 23:41:36,990] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:36,990] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:36,991] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=43,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:36,991] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=43,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:36,992] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:36,992] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,14] due to: No other replicas in ISR 2 for [__consumer_offsets,14] besides shutting down brokers 2. (state.change.logger)
[2017-06-26 23:41:36,992] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,14] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,14] due to: No other replicas in ISR 2 for [__consumer_offsets,14] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,14] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:41:36,994] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=28,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:36,996] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,28] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:36,996] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,28] (state.change.logger)
[2017-06-26 23:41:36,996] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,28] (state.change.logger)
[2017-06-26 23:41:36,996] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-28 (state.change.logger)
[2017-06-26 23:41:36,997] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 7 from controller 0 epoch 8 for partition [__consumer_offsets,28] (state.change.logger)
[2017-06-26 23:41:36,997] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 7 epoch 8 for partition [__consumer_offsets,28] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:36,997] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=28,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:36,997] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=28,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:36,997] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:36,998] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-28 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 8 (state.change.logger)
[2017-06-26 23:41:36,998] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:36,999] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,000] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=28,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,000] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,4] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:37,001] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,4] (state.change.logger)
[2017-06-26 23:41:37,001] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,4] (state.change.logger)
[2017-06-26 23:41:37,001] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-4 (state.change.logger)
[2017-06-26 23:41:37,001] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=4,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,001] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=7, replicas=[0, 1, 2]) correlation id 9 from controller 0 epoch 8 for partition [__consumer_offsets,4] (state.change.logger)
[2017-06-26 23:41:37,001] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 9 epoch 8 for partition [__consumer_offsets,4] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:37,001] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=4,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,002] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-4 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 10 (state.change.logger)
[2017-06-26 23:41:37,002] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=4,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,002] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,003] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,003] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,004] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=4,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,005] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=36,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,006] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,36] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:37,006] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,36] (state.change.logger)
[2017-06-26 23:41:37,006] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,36] (state.change.logger)
[2017-06-26 23:41:37,006] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-36 (state.change.logger)
[2017-06-26 23:41:37,006] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 11 from controller 0 epoch 8 for partition [__consumer_offsets,36] (state.change.logger)
[2017-06-26 23:41:37,006] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 11 epoch 8 for partition [__consumer_offsets,36] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:37,006] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=36,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,006] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=36,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,007] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,007] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-36 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 12 (state.change.logger)
[2017-06-26 23:41:37,007] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,007] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,007] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=36,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,008] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=6,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,009] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,6] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:37,009] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,6] (state.change.logger)
[2017-06-26 23:41:37,009] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,6] (state.change.logger)
[2017-06-26 23:41:37,009] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-6 (state.change.logger)
[2017-06-26 23:41:37,009] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 13 from controller 0 epoch 8 for partition [__consumer_offsets,6] (state.change.logger)
[2017-06-26 23:41:37,009] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 13 epoch 8 for partition [__consumer_offsets,6] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:37,009] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=6,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,010] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=6,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,010] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,010] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-6 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 14 (state.change.logger)
[2017-06-26 23:41:37,010] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,010] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,011] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=6,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,011] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=39,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,012] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,39] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:37,012] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,39] (state.change.logger)
[2017-06-26 23:41:37,012] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,39] (state.change.logger)
[2017-06-26 23:41:37,012] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-39 (state.change.logger)
[2017-06-26 23:41:37,012] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,23] (state.change.logger)
[2017-06-26 23:41:37,012] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 15 from controller 0 epoch 8 for partition [__consumer_offsets,39] (state.change.logger)
[2017-06-26 23:41:37,012] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 15 epoch 8 for partition [__consumer_offsets,39] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:37,013] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=39,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,013] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,013] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-39 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 16 (state.change.logger)
[2017-06-26 23:41:37,014] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,014] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=39,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,015] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,015] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=39,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,016] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,23] due to: No other replicas in ISR 2 for [__consumer_offsets,23] besides shutting down brokers 2. (state.change.logger)
[2017-06-26 23:41:37,016] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,23] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,23] due to: No other replicas in ISR 2 for [__consumer_offsets,23] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,23] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 23:41:37,017] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=24,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,018] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,24] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:37,018] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,24] (state.change.logger)
[2017-06-26 23:41:37,019] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,24] (state.change.logger)
[2017-06-26 23:41:37,019] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-24 (state.change.logger)
[2017-06-26 23:41:37,019] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 17 from controller 0 epoch 8 for partition [__consumer_offsets,24] (state.change.logger)
[2017-06-26 23:41:37,019] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 17 epoch 8 for partition [__consumer_offsets,24] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:37,019] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,38] (state.change.logger)
[2017-06-26 23:41:37,020] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=24,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,020] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,020] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=24,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,021] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-24 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 18 (state.change.logger)
[2017-06-26 23:41:37,021] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,022] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,023] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=24,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,026] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,38] due to: No other replicas in ISR 2 for [__consumer_offsets,38] besides shutting down brokers 2. (state.change.logger)
[2017-06-26 23:41:37,026] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,38] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,38] due to: No other replicas in ISR 2 for [__consumer_offsets,38] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,38] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:41:37,028] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=16,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,030] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,16] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:37,030] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,16] (state.change.logger)
[2017-06-26 23:41:37,030] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,16] (state.change.logger)
[2017-06-26 23:41:37,030] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-16 (state.change.logger)
[2017-06-26 23:41:37,031] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 19 from controller 0 epoch 8 for partition [__consumer_offsets,16] (state.change.logger)
[2017-06-26 23:41:37,031] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 19 epoch 8 for partition [__consumer_offsets,16] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:37,031] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=16,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,031] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=16,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,032] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,032] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-16 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 20 (state.change.logger)
[2017-06-26 23:41:37,033] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=16,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,033] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,033] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,034] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=3,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,035] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,3] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:37,035] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,3] (state.change.logger)
[2017-06-26 23:41:37,035] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,3] (state.change.logger)
[2017-06-26 23:41:37,035] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-3 (state.change.logger)
[2017-06-26 23:41:37,035] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 21 from controller 0 epoch 8 for partition [__consumer_offsets,3] (state.change.logger)
[2017-06-26 23:41:37,036] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 21 epoch 8 for partition [__consumer_offsets,3] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:37,036] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=3,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,036] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-3 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 22 (state.change.logger)
[2017-06-26 23:41:37,036] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,036] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,037] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=3,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,037] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=3,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,038] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,038] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=21,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,039] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,21] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:37,039] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,21] (state.change.logger)
[2017-06-26 23:41:37,039] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,21] (state.change.logger)
[2017-06-26 23:41:37,039] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-21 (state.change.logger)
[2017-06-26 23:41:37,039] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 23 from controller 0 epoch 8 for partition [__consumer_offsets,21] (state.change.logger)
[2017-06-26 23:41:37,039] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 23 epoch 8 for partition [__consumer_offsets,21] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:37,040] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=21,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,040] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=21,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,040] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,040] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-21 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 24 (state.change.logger)
[2017-06-26 23:41:37,040] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,040] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,041] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=21,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,041] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=10,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,042] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,10] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:37,042] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,10] (state.change.logger)
[2017-06-26 23:41:37,042] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,10] (state.change.logger)
[2017-06-26 23:41:37,042] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-10 (state.change.logger)
[2017-06-26 23:41:37,042] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 25 from controller 0 epoch 8 for partition [__consumer_offsets,10] (state.change.logger)
[2017-06-26 23:41:37,042] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 25 epoch 8 for partition [__consumer_offsets,10] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:37,042] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=10,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,042] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=10,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,042] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,043] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-10 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 26 (state.change.logger)
[2017-06-26 23:41:37,043] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,044] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,044] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=10,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,046] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,40] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:37,046] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,40] (state.change.logger)
[2017-06-26 23:41:37,046] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,40] (state.change.logger)
[2017-06-26 23:41:37,046] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-40 (state.change.logger)
[2017-06-26 23:41:37,048] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=40,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,048] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 27 from controller 0 epoch 8 for partition [__consumer_offsets,40] (state.change.logger)
[2017-06-26 23:41:37,048] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 27 epoch 8 for partition [__consumer_offsets,40] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:37,048] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,049] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=40,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,049] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=40,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,049] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=40,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,050] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,050] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-40 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 28 (state.change.logger)
[2017-06-26 23:41:37,050] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,051] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=34,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,052] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,34] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:37,052] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,34] (state.change.logger)
[2017-06-26 23:41:37,052] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,34] (state.change.logger)
[2017-06-26 23:41:37,053] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-34 (state.change.logger)
[2017-06-26 23:41:37,053] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 29 from controller 0 epoch 8 for partition [__consumer_offsets,34] (state.change.logger)
[2017-06-26 23:41:37,053] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 29 epoch 8 for partition [__consumer_offsets,34] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:37,053] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=34,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,054] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=34,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,054] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,054] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-34 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 30 (state.change.logger)
[2017-06-26 23:41:37,055] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,055] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,055] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=34,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,056] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=25,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,060] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,25] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:37,060] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,25] (state.change.logger)
[2017-06-26 23:41:37,060] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,25] (state.change.logger)
[2017-06-26 23:41:37,060] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-25 (state.change.logger)
[2017-06-26 23:41:37,060] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 31 from controller 0 epoch 8 for partition [__consumer_offsets,25] (state.change.logger)
[2017-06-26 23:41:37,060] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 31 epoch 8 for partition [__consumer_offsets,25] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:37,061] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=25,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,061] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=25,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,061] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,061] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-25 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 32 (state.change.logger)
[2017-06-26 23:41:37,062] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,062] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=25,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,062] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,063] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=27,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,064] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,27] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:37,064] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,27] (state.change.logger)
[2017-06-26 23:41:37,064] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,27] (state.change.logger)
[2017-06-26 23:41:37,064] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-27 (state.change.logger)
[2017-06-26 23:41:37,064] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 33 from controller 0 epoch 8 for partition [__consumer_offsets,27] (state.change.logger)
[2017-06-26 23:41:37,064] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 33 epoch 8 for partition [__consumer_offsets,27] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:37,065] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=27,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,065] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=27,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,065] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,065] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-27 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 34 (state.change.logger)
[2017-06-26 23:41:37,065] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,065] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,065] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=27,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,066] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=42,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,067] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,42] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:37,067] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,42] (state.change.logger)
[2017-06-26 23:41:37,067] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,42] (state.change.logger)
[2017-06-26 23:41:37,067] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-42 (state.change.logger)
[2017-06-26 23:41:37,067] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 35 from controller 0 epoch 8 for partition [__consumer_offsets,42] (state.change.logger)
[2017-06-26 23:41:37,067] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=42,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,067] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 35 epoch 8 for partition [__consumer_offsets,42] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:37,068] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,11] (state.change.logger)
[2017-06-26 23:41:37,068] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=42,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,068] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,068] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,068] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-42 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 36 (state.change.logger)
[2017-06-26 23:41:37,068] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,068] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=42,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,069] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,11] due to: No other replicas in ISR 2 for [__consumer_offsets,11] besides shutting down brokers 2. (state.change.logger)
[2017-06-26 23:41:37,070] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,11] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,11] due to: No other replicas in ISR 2 for [__consumer_offsets,11] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,11] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:41:37,071] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=7,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,072] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,7] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:37,072] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,7] (state.change.logger)
[2017-06-26 23:41:37,072] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,7] (state.change.logger)
[2017-06-26 23:41:37,072] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-7 (state.change.logger)
[2017-06-26 23:41:37,072] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 37 from controller 0 epoch 8 for partition [__consumer_offsets,7] (state.change.logger)
[2017-06-26 23:41:37,072] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 37 epoch 8 for partition [__consumer_offsets,7] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:37,072] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,47] (state.change.logger)
[2017-06-26 23:41:37,072] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=7,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,072] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=7,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,073] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,073] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-7 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 38 (state.change.logger)
[2017-06-26 23:41:37,073] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,073] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,073] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=7,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,075] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,47] due to: No other replicas in ISR 2 for [__consumer_offsets,47] besides shutting down brokers 2. (state.change.logger)
[2017-06-26 23:41:37,075] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,47] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,47] due to: No other replicas in ISR 2 for [__consumer_offsets,47] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,47] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:41:37,076] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=9,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,077] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,9] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:37,077] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,9] (state.change.logger)
[2017-06-26 23:41:37,078] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,9] (state.change.logger)
[2017-06-26 23:41:37,078] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-9 (state.change.logger)
[2017-06-26 23:41:37,078] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 39 from controller 0 epoch 8 for partition [__consumer_offsets,9] (state.change.logger)
[2017-06-26 23:41:37,078] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 39 epoch 8 for partition [__consumer_offsets,9] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:37,078] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=9,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,078] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,079] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-9 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 40 (state.change.logger)
[2017-06-26 23:41:37,079] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=9,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,079] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,080] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=9,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,082] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,082] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=13,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,085] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,13] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:37,085] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,13] (state.change.logger)
[2017-06-26 23:41:37,085] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,13] (state.change.logger)
[2017-06-26 23:41:37,085] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-13 (state.change.logger)
[2017-06-26 23:41:37,085] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,29] (state.change.logger)
[2017-06-26 23:41:37,086] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=8, replicas=[0, 1, 2]) correlation id 41 from controller 0 epoch 8 for partition [__consumer_offsets,13] (state.change.logger)
[2017-06-26 23:41:37,086] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 41 epoch 8 for partition [__consumer_offsets,13] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:37,086] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=13,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,086] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,086] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-13 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 42 (state.change.logger)
[2017-06-26 23:41:37,087] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,087] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=13,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,087] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=13,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,087] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,088] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,29] due to: No other replicas in ISR 2 for [__consumer_offsets,29] besides shutting down brokers 2. (state.change.logger)
[2017-06-26 23:41:37,088] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,29] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,29] due to: No other replicas in ISR 2 for [__consumer_offsets,29] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,29] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:41:37,089] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,8] (state.change.logger)
[2017-06-26 23:41:37,091] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,8] due to: No other replicas in ISR 2 for [__consumer_offsets,8] besides shutting down brokers 2. (state.change.logger)
[2017-06-26 23:41:37,091] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,8] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,8] due to: No other replicas in ISR 2 for [__consumer_offsets,8] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,8] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:41:37,092] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=22,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,093] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,22] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:37,093] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,22] (state.change.logger)
[2017-06-26 23:41:37,093] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,22] (state.change.logger)
[2017-06-26 23:41:37,093] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-22 (state.change.logger)
[2017-06-26 23:41:37,093] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=7, replicas=[0, 1, 2]) correlation id 43 from controller 0 epoch 8 for partition [__consumer_offsets,22] (state.change.logger)
[2017-06-26 23:41:37,093] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 43 epoch 8 for partition [__consumer_offsets,22] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:37,094] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=22,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,094] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,094] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=22,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,094] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-22 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 44 (state.change.logger)
[2017-06-26 23:41:37,094] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,094] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=22,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,094] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,095] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=31,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,096] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,31] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:37,096] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,31] (state.change.logger)
[2017-06-26 23:41:37,096] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,31] (state.change.logger)
[2017-06-26 23:41:37,096] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-31 (state.change.logger)
[2017-06-26 23:41:37,097] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 45 from controller 0 epoch 8 for partition [__consumer_offsets,31] (state.change.logger)
[2017-06-26 23:41:37,097] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 45 epoch 8 for partition [__consumer_offsets,31] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:37,097] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=31,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,097] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=31,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,097] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,097] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-31 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 46 (state.change.logger)
[2017-06-26 23:41:37,098] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,098] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=31,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,098] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,099] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=18,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,100] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,18] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:37,100] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,18] (state.change.logger)
[2017-06-26 23:41:37,101] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,18] (state.change.logger)
[2017-06-26 23:41:37,101] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-18 (state.change.logger)
[2017-06-26 23:41:37,101] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 47 from controller 0 epoch 8 for partition [__consumer_offsets,18] (state.change.logger)
[2017-06-26 23:41:37,101] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 47 epoch 8 for partition [__consumer_offsets,18] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:37,101] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=18,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,101] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=18,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,101] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,20] (state.change.logger)
[2017-06-26 23:41:37,101] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,101] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-18 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 48 (state.change.logger)
[2017-06-26 23:41:37,102] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,102] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,102] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=18,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,104] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,20] due to: No other replicas in ISR 2 for [__consumer_offsets,20] besides shutting down brokers 2. (state.change.logger)
[2017-06-26 23:41:37,104] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,20] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,20] due to: No other replicas in ISR 2 for [__consumer_offsets,20] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,20] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:41:37,105] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=37,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,106] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,37] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:37,106] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,37] (state.change.logger)
[2017-06-26 23:41:37,106] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,37] (state.change.logger)
[2017-06-26 23:41:37,106] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-37 (state.change.logger)
[2017-06-26 23:41:37,106] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=7, replicas=[0, 1, 2]) correlation id 49 from controller 0 epoch 8 for partition [__consumer_offsets,37] (state.change.logger)
[2017-06-26 23:41:37,106] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 49 epoch 8 for partition [__consumer_offsets,37] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:37,107] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=37,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,107] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=37,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,107] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,107] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-37 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 50 (state.change.logger)
[2017-06-26 23:41:37,107] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,107] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,107] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=37,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,108] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=49,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,109] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,49] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:37,109] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,49] (state.change.logger)
[2017-06-26 23:41:37,109] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,49] (state.change.logger)
[2017-06-26 23:41:37,109] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-49 (state.change.logger)
[2017-06-26 23:41:37,109] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 51 from controller 0 epoch 8 for partition [__consumer_offsets,49] (state.change.logger)
[2017-06-26 23:41:37,109] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 51 epoch 8 for partition [__consumer_offsets,49] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:37,110] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=49,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,110] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=49,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,110] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,110] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-49 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 52 (state.change.logger)
[2017-06-26 23:41:37,110] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,110] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,110] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=49,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,112] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=12,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,113] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,12] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:37,113] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,12] (state.change.logger)
[2017-06-26 23:41:37,113] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,12] (state.change.logger)
[2017-06-26 23:41:37,113] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-12 (state.change.logger)
[2017-06-26 23:41:37,114] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 53 from controller 0 epoch 8 for partition [__consumer_offsets,12] (state.change.logger)
[2017-06-26 23:41:37,114] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 53 epoch 8 for partition [__consumer_offsets,12] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:37,114] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=12,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,114] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=12,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,114] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,114] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-12 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 54 (state.change.logger)
[2017-06-26 23:41:37,114] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,114] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,114] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,5] (state.change.logger)
[2017-06-26 23:41:37,115] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=12,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,117] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,5] due to: No other replicas in ISR 2 for [__consumer_offsets,5] besides shutting down brokers 2. (state.change.logger)
[2017-06-26 23:41:37,117] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,5] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,5] due to: No other replicas in ISR 2 for [__consumer_offsets,5] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,5] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:41:37,118] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,32] (state.change.logger)
[2017-06-26 23:41:37,120] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,32] due to: No other replicas in ISR 2 for [__consumer_offsets,32] besides shutting down brokers 2. (state.change.logger)
[2017-06-26 23:41:37,120] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,32] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,32] due to: No other replicas in ISR 2 for [__consumer_offsets,32] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,32] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:41:37,121] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,2] (state.change.logger)
[2017-06-26 23:41:37,127] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,2] due to: No other replicas in ISR 2 for [__consumer_offsets,2] besides shutting down brokers 2. (state.change.logger)
[2017-06-26 23:41:37,127] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,2] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,2] due to: No other replicas in ISR 2 for [__consumer_offsets,2] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,2] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:41:37,128] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=1,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,131] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,1] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:37,131] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,1] (state.change.logger)
[2017-06-26 23:41:37,131] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,1] (state.change.logger)
[2017-06-26 23:41:37,131] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-1 (state.change.logger)
[2017-06-26 23:41:37,131] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 55 from controller 0 epoch 8 for partition [__consumer_offsets,1] (state.change.logger)
[2017-06-26 23:41:37,131] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 55 epoch 8 for partition [__consumer_offsets,1] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:37,132] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=1,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,132] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=1,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,132] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,132] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-1 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 56 (state.change.logger)
[2017-06-26 23:41:37,132] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,132] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,132] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=1,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,133] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=0,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,134] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,0] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:37,134] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,0] (state.change.logger)
[2017-06-26 23:41:37,135] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,0] (state.change.logger)
[2017-06-26 23:41:37,135] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-0 (state.change.logger)
[2017-06-26 23:41:37,135] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 57 from controller 0 epoch 8 for partition [__consumer_offsets,0] (state.change.logger)
[2017-06-26 23:41:37,135] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 57 epoch 8 for partition [__consumer_offsets,0] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:37,135] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=0,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,135] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=0,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,135] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,135] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-0 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 58 (state.change.logger)
[2017-06-26 23:41:37,136] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,136] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,136] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=0,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,137] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=15,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,138] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,15] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:37,139] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,15] (state.change.logger)
[2017-06-26 23:41:37,139] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,15] (state.change.logger)
[2017-06-26 23:41:37,139] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-15 (state.change.logger)
[2017-06-26 23:41:37,139] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 59 from controller 0 epoch 8 for partition [__consumer_offsets,15] (state.change.logger)
[2017-06-26 23:41:37,139] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 59 epoch 8 for partition [__consumer_offsets,15] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:37,139] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=15,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,139] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=15,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,139] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,44] (state.change.logger)
[2017-06-26 23:41:37,139] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,139] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-15 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 60 (state.change.logger)
[2017-06-26 23:41:37,140] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,140] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,140] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=15,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,142] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,44] due to: No other replicas in ISR 2 for [__consumer_offsets,44] besides shutting down brokers 2. (state.change.logger)
[2017-06-26 23:41:37,142] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,44] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,44] due to: No other replicas in ISR 2 for [__consumer_offsets,44] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,44] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 23 more
[2017-06-26 23:41:37,142] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,17] (state.change.logger)
[2017-06-26 23:41:37,144] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,17] due to: No other replicas in ISR 2 for [__consumer_offsets,17] besides shutting down brokers 2. (state.change.logger)
[2017-06-26 23:41:37,144] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,17] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,17] due to: No other replicas in ISR 2 for [__consumer_offsets,17] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,17] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 23 more
[2017-06-26 23:41:37,146] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=48,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,149] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,48] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:37,149] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,48] (state.change.logger)
[2017-06-26 23:41:37,149] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,48] (state.change.logger)
[2017-06-26 23:41:37,149] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-48 (state.change.logger)
[2017-06-26 23:41:37,149] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 61 from controller 0 epoch 8 for partition [__consumer_offsets,48] (state.change.logger)
[2017-06-26 23:41:37,149] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 61 epoch 8 for partition [__consumer_offsets,48] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:37,149] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,26] (state.change.logger)
[2017-06-26 23:41:37,149] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=48,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,149] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,150] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=48,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,150] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=48,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,150] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-48 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 62 (state.change.logger)
[2017-06-26 23:41:37,150] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,151] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,152] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,26] due to: No other replicas in ISR 2 for [__consumer_offsets,26] besides shutting down brokers 2. (state.change.logger)
[2017-06-26 23:41:37,152] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,26] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,26] due to: No other replicas in ISR 2 for [__consumer_offsets,26] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,26] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:41:37,154] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=33,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,156] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,33] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:37,156] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,33] (state.change.logger)
[2017-06-26 23:41:37,156] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,33] (state.change.logger)
[2017-06-26 23:41:37,156] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-33 (state.change.logger)
[2017-06-26 23:41:37,156] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=33,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,157] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,157] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,41] (state.change.logger)
[2017-06-26 23:41:37,157] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,157] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=33,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,157] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 63 from controller 0 epoch 8 for partition [__consumer_offsets,33] (state.change.logger)
[2017-06-26 23:41:37,157] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 63 epoch 8 for partition [__consumer_offsets,33] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:37,158] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=33,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,158] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-33 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 64 (state.change.logger)
[2017-06-26 23:41:37,158] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,159] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,41] due to: No other replicas in ISR 2 for [__consumer_offsets,41] besides shutting down brokers 2. (state.change.logger)
[2017-06-26 23:41:37,159] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,41] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,41] due to: No other replicas in ISR 2 for [__consumer_offsets,41] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,41] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 23:41:37,161] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=45,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,163] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,45] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:37,163] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,45] (state.change.logger)
[2017-06-26 23:41:37,163] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,45] (state.change.logger)
[2017-06-26 23:41:37,163] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-45 (state.change.logger)
[2017-06-26 23:41:37,163] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,35] (state.change.logger)
[2017-06-26 23:41:37,163] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 65 from controller 0 epoch 8 for partition [__consumer_offsets,45] (state.change.logger)
[2017-06-26 23:41:37,163] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 65 epoch 8 for partition [__consumer_offsets,45] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:37,164] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=45,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,164] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=45,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,164] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,164] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-45 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 66 (state.change.logger)
[2017-06-26 23:41:37,165] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,165] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,165] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=45,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,167] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,35] due to: No other replicas in ISR 2 for [__consumer_offsets,35] besides shutting down brokers 2. (state.change.logger)
[2017-06-26 23:41:37,167] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,35] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,35] due to: No other replicas in ISR 2 for [__consumer_offsets,35] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,35] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:41:37,168] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=46,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,170] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,46] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:37,170] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,46] (state.change.logger)
[2017-06-26 23:41:37,170] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,46] (state.change.logger)
[2017-06-26 23:41:37,170] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-46 (state.change.logger)
[2017-06-26 23:41:37,170] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 67 from controller 0 epoch 8 for partition [__consumer_offsets,46] (state.change.logger)
[2017-06-26 23:41:37,171] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 67 epoch 8 for partition [__consumer_offsets,46] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:37,171] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=46,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,171] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-46 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 68 (state.change.logger)
[2017-06-26 23:41:37,171] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=46,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,171] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,171] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,172] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,172] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=46,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,172] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=19,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,174] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,19] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:37,174] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,19] (state.change.logger)
[2017-06-26 23:41:37,174] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,19] (state.change.logger)
[2017-06-26 23:41:37,174] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-19 (state.change.logger)
[2017-06-26 23:41:37,174] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 69 from controller 0 epoch 8 for partition [__consumer_offsets,19] (state.change.logger)
[2017-06-26 23:41:37,174] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 69 epoch 8 for partition [__consumer_offsets,19] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:37,175] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=19,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,175] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=19,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,175] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:37,175] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-19 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 70 (state.change.logger)
[2017-06-26 23:41:37,175] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,175] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,186] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,30] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:37,186] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,30] (state.change.logger)
[2017-06-26 23:41:37,186] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,30] (state.change.logger)
[2017-06-26 23:41:37,186] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-30 (state.change.logger)
[2017-06-26 23:41:37,189] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 71 from controller 0 epoch 8 for partition [__consumer_offsets,30] (state.change.logger)
[2017-06-26 23:41:37,189] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=30,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:37,189] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 71 epoch 8 for partition [__consumer_offsets,30] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:37,189] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=30,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,189] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-30 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 72 (state.change.logger)
[2017-06-26 23:41:37,190] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:37,190] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,202] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,43] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:42,202] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,43] (state.change.logger)
[2017-06-26 23:41:42,202] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,43] (state.change.logger)
[2017-06-26 23:41:42,202] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-43 (state.change.logger)
[2017-06-26 23:41:42,202] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,14] (state.change.logger)
[2017-06-26 23:41:42,203] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 73 from controller 0 epoch 8 for partition [__consumer_offsets,43] (state.change.logger)
[2017-06-26 23:41:42,203] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 73 epoch 8 for partition [__consumer_offsets,43] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:42,203] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=43,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,203] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=43,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,203] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-43 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 74 (state.change.logger)
[2017-06-26 23:41:42,203] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,204] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,204] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,14] due to: No other replicas in ISR 2 for [__consumer_offsets,14] besides shutting down brokers 2. (state.change.logger)
[2017-06-26 23:41:42,205] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,14] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,14] due to: No other replicas in ISR 2 for [__consumer_offsets,14] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,14] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:41:42,207] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,28] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:42,207] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,28] (state.change.logger)
[2017-06-26 23:41:42,207] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,28] (state.change.logger)
[2017-06-26 23:41:42,207] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-28 (state.change.logger)
[2017-06-26 23:41:42,207] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 75 from controller 0 epoch 8 for partition [__consumer_offsets,28] (state.change.logger)
[2017-06-26 23:41:42,207] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 75 epoch 8 for partition [__consumer_offsets,28] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:42,207] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=28,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,207] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=28,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,208] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-28 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 76 (state.change.logger)
[2017-06-26 23:41:42,208] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,208] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,209] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,4] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:42,209] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,4] (state.change.logger)
[2017-06-26 23:41:42,209] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,4] (state.change.logger)
[2017-06-26 23:41:42,209] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-4 (state.change.logger)
[2017-06-26 23:41:42,209] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=7, replicas=[0, 1, 2]) correlation id 77 from controller 0 epoch 8 for partition [__consumer_offsets,4] (state.change.logger)
[2017-06-26 23:41:42,209] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 77 epoch 8 for partition [__consumer_offsets,4] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:42,209] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=4,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,209] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=4,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,210] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-4 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 78 (state.change.logger)
[2017-06-26 23:41:42,210] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,210] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,211] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,36] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:42,211] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,36] (state.change.logger)
[2017-06-26 23:41:42,211] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,36] (state.change.logger)
[2017-06-26 23:41:42,211] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-36 (state.change.logger)
[2017-06-26 23:41:42,211] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 79 from controller 0 epoch 8 for partition [__consumer_offsets,36] (state.change.logger)
[2017-06-26 23:41:42,211] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 79 epoch 8 for partition [__consumer_offsets,36] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:42,212] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=36,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,212] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=36,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,212] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-36 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 80 (state.change.logger)
[2017-06-26 23:41:42,212] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,212] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,213] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,6] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:42,213] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,6] (state.change.logger)
[2017-06-26 23:41:42,213] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,6] (state.change.logger)
[2017-06-26 23:41:42,213] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-6 (state.change.logger)
[2017-06-26 23:41:42,213] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 81 from controller 0 epoch 8 for partition [__consumer_offsets,6] (state.change.logger)
[2017-06-26 23:41:42,213] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 81 epoch 8 for partition [__consumer_offsets,6] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:42,214] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=6,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,214] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=6,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,214] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,214] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-6 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 82 (state.change.logger)
[2017-06-26 23:41:42,214] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,215] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,39] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:42,215] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,39] (state.change.logger)
[2017-06-26 23:41:42,215] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,39] (state.change.logger)
[2017-06-26 23:41:42,215] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-39 (state.change.logger)
[2017-06-26 23:41:42,215] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 83 from controller 0 epoch 8 for partition [__consumer_offsets,39] (state.change.logger)
[2017-06-26 23:41:42,215] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,23] (state.change.logger)
[2017-06-26 23:41:42,216] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 83 epoch 8 for partition [__consumer_offsets,39] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:42,216] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=39,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,216] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-39 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 84 (state.change.logger)
[2017-06-26 23:41:42,216] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=39,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,216] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,217] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,217] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,23] due to: No other replicas in ISR 2 for [__consumer_offsets,23] besides shutting down brokers 2. (state.change.logger)
[2017-06-26 23:41:42,218] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,23] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,23] due to: No other replicas in ISR 2 for [__consumer_offsets,23] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,23] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 23:41:42,220] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,24] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:42,220] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,24] (state.change.logger)
[2017-06-26 23:41:42,220] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,24] (state.change.logger)
[2017-06-26 23:41:42,220] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-24 (state.change.logger)
[2017-06-26 23:41:42,221] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 85 from controller 0 epoch 8 for partition [__consumer_offsets,24] (state.change.logger)
[2017-06-26 23:41:42,221] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,38] (state.change.logger)
[2017-06-26 23:41:42,221] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 85 epoch 8 for partition [__consumer_offsets,24] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:42,221] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=24,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,221] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=24,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,221] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-24 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 86 (state.change.logger)
[2017-06-26 23:41:42,221] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,221] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,222] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,38] due to: No other replicas in ISR 2 for [__consumer_offsets,38] besides shutting down brokers 2. (state.change.logger)
[2017-06-26 23:41:42,223] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,38] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,38] due to: No other replicas in ISR 2 for [__consumer_offsets,38] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,38] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:41:42,225] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,16] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:42,225] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,16] (state.change.logger)
[2017-06-26 23:41:42,225] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,16] (state.change.logger)
[2017-06-26 23:41:42,225] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-16 (state.change.logger)
[2017-06-26 23:41:42,225] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 87 from controller 0 epoch 8 for partition [__consumer_offsets,16] (state.change.logger)
[2017-06-26 23:41:42,225] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 87 epoch 8 for partition [__consumer_offsets,16] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:42,226] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=16,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,226] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=16,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,226] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-16 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 88 (state.change.logger)
[2017-06-26 23:41:42,226] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,226] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,228] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,3] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:42,228] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,3] (state.change.logger)
[2017-06-26 23:41:42,229] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,3] (state.change.logger)
[2017-06-26 23:41:42,229] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-3 (state.change.logger)
[2017-06-26 23:41:42,229] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 89 from controller 0 epoch 8 for partition [__consumer_offsets,3] (state.change.logger)
[2017-06-26 23:41:42,229] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 89 epoch 8 for partition [__consumer_offsets,3] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:42,229] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=3,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,229] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-3 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 90 (state.change.logger)
[2017-06-26 23:41:42,230] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,230] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=3,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,230] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,231] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,21] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:42,231] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,21] (state.change.logger)
[2017-06-26 23:41:42,231] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,21] (state.change.logger)
[2017-06-26 23:41:42,231] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-21 (state.change.logger)
[2017-06-26 23:41:42,232] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 91 from controller 0 epoch 8 for partition [__consumer_offsets,21] (state.change.logger)
[2017-06-26 23:41:42,232] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 91 epoch 8 for partition [__consumer_offsets,21] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:42,232] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=21,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,232] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=21,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,232] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-21 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 92 (state.change.logger)
[2017-06-26 23:41:42,232] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,232] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,234] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,10] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:42,234] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,10] (state.change.logger)
[2017-06-26 23:41:42,234] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,10] (state.change.logger)
[2017-06-26 23:41:42,234] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-10 (state.change.logger)
[2017-06-26 23:41:42,235] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 93 from controller 0 epoch 8 for partition [__consumer_offsets,10] (state.change.logger)
[2017-06-26 23:41:42,235] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 93 epoch 8 for partition [__consumer_offsets,10] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:42,235] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=10,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,235] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=10,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,235] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-10 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 94 (state.change.logger)
[2017-06-26 23:41:42,235] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,235] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,237] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,40] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:42,237] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,40] (state.change.logger)
[2017-06-26 23:41:42,237] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,40] (state.change.logger)
[2017-06-26 23:41:42,237] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-40 (state.change.logger)
[2017-06-26 23:41:42,237] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 95 from controller 0 epoch 8 for partition [__consumer_offsets,40] (state.change.logger)
[2017-06-26 23:41:42,237] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 95 epoch 8 for partition [__consumer_offsets,40] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:42,237] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=40,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,237] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=40,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,238] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-40 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 96 (state.change.logger)
[2017-06-26 23:41:42,238] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,238] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,239] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,34] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:42,239] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,34] (state.change.logger)
[2017-06-26 23:41:42,240] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,34] (state.change.logger)
[2017-06-26 23:41:42,240] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-34 (state.change.logger)
[2017-06-26 23:41:42,240] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 97 from controller 0 epoch 8 for partition [__consumer_offsets,34] (state.change.logger)
[2017-06-26 23:41:42,240] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 97 epoch 8 for partition [__consumer_offsets,34] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:42,240] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=34,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,240] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=34,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,240] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-34 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 98 (state.change.logger)
[2017-06-26 23:41:42,240] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,240] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,242] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,25] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:42,242] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,25] (state.change.logger)
[2017-06-26 23:41:42,242] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,25] (state.change.logger)
[2017-06-26 23:41:42,242] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-25 (state.change.logger)
[2017-06-26 23:41:42,242] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 99 from controller 0 epoch 8 for partition [__consumer_offsets,25] (state.change.logger)
[2017-06-26 23:41:42,242] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 99 epoch 8 for partition [__consumer_offsets,25] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:42,242] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=25,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,242] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=25,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,243] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-25 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 100 (state.change.logger)
[2017-06-26 23:41:42,243] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,243] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,244] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,27] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:42,244] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,27] (state.change.logger)
[2017-06-26 23:41:42,244] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,27] (state.change.logger)
[2017-06-26 23:41:42,245] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-27 (state.change.logger)
[2017-06-26 23:41:42,245] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 101 from controller 0 epoch 8 for partition [__consumer_offsets,27] (state.change.logger)
[2017-06-26 23:41:42,245] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 101 epoch 8 for partition [__consumer_offsets,27] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:42,245] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=27,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,245] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=27,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,245] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-27 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 102 (state.change.logger)
[2017-06-26 23:41:42,246] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,246] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,248] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,42] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:42,248] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,42] (state.change.logger)
[2017-06-26 23:41:42,248] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,42] (state.change.logger)
[2017-06-26 23:41:42,248] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-42 (state.change.logger)
[2017-06-26 23:41:42,248] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 103 from controller 0 epoch 8 for partition [__consumer_offsets,42] (state.change.logger)
[2017-06-26 23:41:42,248] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 103 epoch 8 for partition [__consumer_offsets,42] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:42,248] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,11] (state.change.logger)
[2017-06-26 23:41:42,249] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=42,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,249] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=42,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,250] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-42 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 104 (state.change.logger)
[2017-06-26 23:41:42,250] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,250] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,252] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,11] due to: No other replicas in ISR 2 for [__consumer_offsets,11] besides shutting down brokers 2. (state.change.logger)
[2017-06-26 23:41:42,252] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,11] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,11] due to: No other replicas in ISR 2 for [__consumer_offsets,11] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,11] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:41:42,258] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,7] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:42,258] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,7] (state.change.logger)
[2017-06-26 23:41:42,258] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,7] (state.change.logger)
[2017-06-26 23:41:42,258] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-7 (state.change.logger)
[2017-06-26 23:41:42,259] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,47] (state.change.logger)
[2017-06-26 23:41:42,259] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 105 from controller 0 epoch 8 for partition [__consumer_offsets,7] (state.change.logger)
[2017-06-26 23:41:42,259] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 105 epoch 8 for partition [__consumer_offsets,7] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:42,259] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=7,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,259] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=7,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,260] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-7 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 106 (state.change.logger)
[2017-06-26 23:41:42,260] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,261] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,262] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,47] due to: No other replicas in ISR 2 for [__consumer_offsets,47] besides shutting down brokers 2. (state.change.logger)
[2017-06-26 23:41:42,262] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,47] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,47] due to: No other replicas in ISR 2 for [__consumer_offsets,47] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,47] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:41:42,268] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,9] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:42,268] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,9] (state.change.logger)
[2017-06-26 23:41:42,268] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,9] (state.change.logger)
[2017-06-26 23:41:42,268] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-9 (state.change.logger)
[2017-06-26 23:41:42,269] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=9,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,269] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,269] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 107 from controller 0 epoch 8 for partition [__consumer_offsets,9] (state.change.logger)
[2017-06-26 23:41:42,269] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 107 epoch 8 for partition [__consumer_offsets,9] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:42,270] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=9,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,270] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-9 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 108 (state.change.logger)
[2017-06-26 23:41:42,270] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,271] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,13] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:42,271] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,13] (state.change.logger)
[2017-06-26 23:41:42,271] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,13] (state.change.logger)
[2017-06-26 23:41:42,271] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-13 (state.change.logger)
[2017-06-26 23:41:42,271] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=8, replicas=[0, 1, 2]) correlation id 109 from controller 0 epoch 8 for partition [__consumer_offsets,13] (state.change.logger)
[2017-06-26 23:41:42,271] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 109 epoch 8 for partition [__consumer_offsets,13] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:42,271] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,29] (state.change.logger)
[2017-06-26 23:41:42,271] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=13,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,271] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=13,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,271] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-13 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 110 (state.change.logger)
[2017-06-26 23:41:42,272] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,272] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,273] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,29] due to: No other replicas in ISR 2 for [__consumer_offsets,29] besides shutting down brokers 2. (state.change.logger)
[2017-06-26 23:41:42,273] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,29] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,29] due to: No other replicas in ISR 2 for [__consumer_offsets,29] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,29] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:41:42,273] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,8] (state.change.logger)
[2017-06-26 23:41:42,275] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,8] due to: No other replicas in ISR 2 for [__consumer_offsets,8] besides shutting down brokers 2. (state.change.logger)
[2017-06-26 23:41:42,275] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,8] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,8] due to: No other replicas in ISR 2 for [__consumer_offsets,8] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,8] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:41:42,278] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,22] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:42,278] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,22] (state.change.logger)
[2017-06-26 23:41:42,278] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,22] (state.change.logger)
[2017-06-26 23:41:42,278] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-22 (state.change.logger)
[2017-06-26 23:41:42,278] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=7, replicas=[0, 1, 2]) correlation id 111 from controller 0 epoch 8 for partition [__consumer_offsets,22] (state.change.logger)
[2017-06-26 23:41:42,279] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 111 epoch 8 for partition [__consumer_offsets,22] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:42,279] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=22,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,279] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=22,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,279] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-22 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 112 (state.change.logger)
[2017-06-26 23:41:42,279] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,279] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,280] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,31] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:42,280] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,31] (state.change.logger)
[2017-06-26 23:41:42,281] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,31] (state.change.logger)
[2017-06-26 23:41:42,281] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-31 (state.change.logger)
[2017-06-26 23:41:42,281] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 113 from controller 0 epoch 8 for partition [__consumer_offsets,31] (state.change.logger)
[2017-06-26 23:41:42,281] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 113 epoch 8 for partition [__consumer_offsets,31] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:42,281] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=31,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,281] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=31,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,281] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,281] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-31 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 114 (state.change.logger)
[2017-06-26 23:41:42,282] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,283] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,18] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:42,283] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,18] (state.change.logger)
[2017-06-26 23:41:42,283] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,18] (state.change.logger)
[2017-06-26 23:41:42,283] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-18 (state.change.logger)
[2017-06-26 23:41:42,283] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 115 from controller 0 epoch 8 for partition [__consumer_offsets,18] (state.change.logger)
[2017-06-26 23:41:42,283] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,20] (state.change.logger)
[2017-06-26 23:41:42,283] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 115 epoch 8 for partition [__consumer_offsets,18] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:42,283] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=18,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,283] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-18 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 116 (state.change.logger)
[2017-06-26 23:41:42,284] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=18,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,284] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,285] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,285] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,20] due to: No other replicas in ISR 2 for [__consumer_offsets,20] besides shutting down brokers 2. (state.change.logger)
[2017-06-26 23:41:42,285] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,20] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,20] due to: No other replicas in ISR 2 for [__consumer_offsets,20] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,20] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:41:42,287] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,37] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:42,287] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,37] (state.change.logger)
[2017-06-26 23:41:42,287] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,37] (state.change.logger)
[2017-06-26 23:41:42,287] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-37 (state.change.logger)
[2017-06-26 23:41:42,287] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=7, replicas=[0, 1, 2]) correlation id 117 from controller 0 epoch 8 for partition [__consumer_offsets,37] (state.change.logger)
[2017-06-26 23:41:42,288] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 117 epoch 8 for partition [__consumer_offsets,37] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:42,288] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=37,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,288] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=37,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,288] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-37 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 118 (state.change.logger)
[2017-06-26 23:41:42,288] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,289] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,290] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,49] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:42,290] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,49] (state.change.logger)
[2017-06-26 23:41:42,290] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,49] (state.change.logger)
[2017-06-26 23:41:42,290] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-49 (state.change.logger)
[2017-06-26 23:41:42,291] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 119 from controller 0 epoch 8 for partition [__consumer_offsets,49] (state.change.logger)
[2017-06-26 23:41:42,291] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 119 epoch 8 for partition [__consumer_offsets,49] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:42,291] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=49,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,291] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=49,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,291] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,291] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-49 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 120 (state.change.logger)
[2017-06-26 23:41:42,292] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,293] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,12] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:42,293] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,12] (state.change.logger)
[2017-06-26 23:41:42,293] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,12] (state.change.logger)
[2017-06-26 23:41:42,294] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-12 (state.change.logger)
[2017-06-26 23:41:42,294] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 121 from controller 0 epoch 8 for partition [__consumer_offsets,12] (state.change.logger)
[2017-06-26 23:41:42,294] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,5] (state.change.logger)
[2017-06-26 23:41:42,294] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 121 epoch 8 for partition [__consumer_offsets,12] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:42,294] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=12,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,294] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=12,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,294] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-12 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 122 (state.change.logger)
[2017-06-26 23:41:42,296] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,296] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,5] due to: No other replicas in ISR 2 for [__consumer_offsets,5] besides shutting down brokers 2. (state.change.logger)
[2017-06-26 23:41:42,296] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,5] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,5] due to: No other replicas in ISR 2 for [__consumer_offsets,5] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,5] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:41:42,297] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,297] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,32] (state.change.logger)
[2017-06-26 23:41:42,299] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,32] due to: No other replicas in ISR 2 for [__consumer_offsets,32] besides shutting down brokers 2. (state.change.logger)
[2017-06-26 23:41:42,299] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,32] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,32] due to: No other replicas in ISR 2 for [__consumer_offsets,32] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,32] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:41:42,300] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,2] (state.change.logger)
[2017-06-26 23:41:42,302] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,2] due to: No other replicas in ISR 2 for [__consumer_offsets,2] besides shutting down brokers 2. (state.change.logger)
[2017-06-26 23:41:42,302] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,2] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,2] due to: No other replicas in ISR 2 for [__consumer_offsets,2] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,2] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:41:42,304] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,1] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:42,304] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,1] (state.change.logger)
[2017-06-26 23:41:42,304] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,1] (state.change.logger)
[2017-06-26 23:41:42,304] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-1 (state.change.logger)
[2017-06-26 23:41:42,305] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 123 from controller 0 epoch 8 for partition [__consumer_offsets,1] (state.change.logger)
[2017-06-26 23:41:42,305] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 123 epoch 8 for partition [__consumer_offsets,1] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:42,305] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=1,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,305] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=1,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,305] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-1 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 124 (state.change.logger)
[2017-06-26 23:41:42,305] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,305] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,306] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,0] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:42,306] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,0] (state.change.logger)
[2017-06-26 23:41:42,306] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,0] (state.change.logger)
[2017-06-26 23:41:42,307] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-0 (state.change.logger)
[2017-06-26 23:41:42,307] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 125 from controller 0 epoch 8 for partition [__consumer_offsets,0] (state.change.logger)
[2017-06-26 23:41:42,307] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 125 epoch 8 for partition [__consumer_offsets,0] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:42,307] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=0,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,307] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=0,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,307] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-0 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 126 (state.change.logger)
[2017-06-26 23:41:42,307] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,307] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,309] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,15] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:42,309] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,15] (state.change.logger)
[2017-06-26 23:41:42,309] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,15] (state.change.logger)
[2017-06-26 23:41:42,309] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-15 (state.change.logger)
[2017-06-26 23:41:42,309] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 127 from controller 0 epoch 8 for partition [__consumer_offsets,15] (state.change.logger)
[2017-06-26 23:41:42,309] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,44] (state.change.logger)
[2017-06-26 23:41:42,309] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 127 epoch 8 for partition [__consumer_offsets,15] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:42,309] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=15,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,309] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=15,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,309] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-15 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 128 (state.change.logger)
[2017-06-26 23:41:42,310] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,310] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,311] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,44] due to: No other replicas in ISR 2 for [__consumer_offsets,44] besides shutting down brokers 2. (state.change.logger)
[2017-06-26 23:41:42,311] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,44] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,44] due to: No other replicas in ISR 2 for [__consumer_offsets,44] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,44] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 23 more
[2017-06-26 23:41:42,311] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,17] (state.change.logger)
[2017-06-26 23:41:42,313] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,17] due to: No other replicas in ISR 2 for [__consumer_offsets,17] besides shutting down brokers 2. (state.change.logger)
[2017-06-26 23:41:42,313] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,17] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,17] due to: No other replicas in ISR 2 for [__consumer_offsets,17] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,17] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 23 more
[2017-06-26 23:41:42,315] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,48] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:42,315] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,48] (state.change.logger)
[2017-06-26 23:41:42,315] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,48] (state.change.logger)
[2017-06-26 23:41:42,315] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-48 (state.change.logger)
[2017-06-26 23:41:42,315] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,26] (state.change.logger)
[2017-06-26 23:41:42,315] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 129 from controller 0 epoch 8 for partition [__consumer_offsets,48] (state.change.logger)
[2017-06-26 23:41:42,315] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 129 epoch 8 for partition [__consumer_offsets,48] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:42,315] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=48,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,316] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=48,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,316] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-48 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 130 (state.change.logger)
[2017-06-26 23:41:42,316] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,316] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,319] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,26] due to: No other replicas in ISR 2 for [__consumer_offsets,26] besides shutting down brokers 2. (state.change.logger)
[2017-06-26 23:41:42,319] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,26] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,26] due to: No other replicas in ISR 2 for [__consumer_offsets,26] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,26] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:41:42,322] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,33] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:42,322] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,33] (state.change.logger)
[2017-06-26 23:41:42,322] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,33] (state.change.logger)
[2017-06-26 23:41:42,322] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-33 (state.change.logger)
[2017-06-26 23:41:42,322] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 131 from controller 0 epoch 8 for partition [__consumer_offsets,33] (state.change.logger)
[2017-06-26 23:41:42,322] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 131 epoch 8 for partition [__consumer_offsets,33] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:42,322] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,41] (state.change.logger)
[2017-06-26 23:41:42,323] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=33,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,323] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=33,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,324] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-33 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 132 (state.change.logger)
[2017-06-26 23:41:42,324] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,324] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,325] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,41] due to: No other replicas in ISR 2 for [__consumer_offsets,41] besides shutting down brokers 2. (state.change.logger)
[2017-06-26 23:41:42,325] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,41] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,41] due to: No other replicas in ISR 2 for [__consumer_offsets,41] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,41] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 23:41:42,327] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,45] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:42,327] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,45] (state.change.logger)
[2017-06-26 23:41:42,328] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,45] (state.change.logger)
[2017-06-26 23:41:42,328] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-45 (state.change.logger)
[2017-06-26 23:41:42,328] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,35] (state.change.logger)
[2017-06-26 23:41:42,328] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 133 from controller 0 epoch 8 for partition [__consumer_offsets,45] (state.change.logger)
[2017-06-26 23:41:42,328] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 133 epoch 8 for partition [__consumer_offsets,45] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:42,328] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=45,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,328] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=45,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,328] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-45 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 134 (state.change.logger)
[2017-06-26 23:41:42,329] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,329] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,330] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,35] due to: No other replicas in ISR 2 for [__consumer_offsets,35] besides shutting down brokers 2. (state.change.logger)
[2017-06-26 23:41:42,330] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,35] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,35] due to: No other replicas in ISR 2 for [__consumer_offsets,35] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,35] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:41:42,332] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,46] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:42,332] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,46] (state.change.logger)
[2017-06-26 23:41:42,332] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,46] (state.change.logger)
[2017-06-26 23:41:42,332] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-46 (state.change.logger)
[2017-06-26 23:41:42,333] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 135 from controller 0 epoch 8 for partition [__consumer_offsets,46] (state.change.logger)
[2017-06-26 23:41:42,333] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 135 epoch 8 for partition [__consumer_offsets,46] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:42,333] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=46,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,333] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=46,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,333] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-46 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 136 (state.change.logger)
[2017-06-26 23:41:42,333] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,333] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,335] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,19] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:42,335] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,19] (state.change.logger)
[2017-06-26 23:41:42,335] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,19] (state.change.logger)
[2017-06-26 23:41:42,335] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-19 (state.change.logger)
[2017-06-26 23:41:42,335] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 137 from controller 0 epoch 8 for partition [__consumer_offsets,19] (state.change.logger)
[2017-06-26 23:41:42,335] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 137 epoch 8 for partition [__consumer_offsets,19] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:42,335] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=19,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,335] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=19,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,336] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-19 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 138 (state.change.logger)
[2017-06-26 23:41:42,336] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,336] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,337] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,30] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:42,337] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,30] (state.change.logger)
[2017-06-26 23:41:42,337] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,30] (state.change.logger)
[2017-06-26 23:41:42,337] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-30 (state.change.logger)
[2017-06-26 23:41:42,337] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 139 from controller 0 epoch 8 for partition [__consumer_offsets,30] (state.change.logger)
[2017-06-26 23:41:42,337] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 139 epoch 8 for partition [__consumer_offsets,30] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:42,337] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=30,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,337] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=30,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:42,338] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-30 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 140 (state.change.logger)
[2017-06-26 23:41:42,338] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:42,338] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,351] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,43] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:47,351] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,43] (state.change.logger)
[2017-06-26 23:41:47,351] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,43] (state.change.logger)
[2017-06-26 23:41:47,351] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-43 (state.change.logger)
[2017-06-26 23:41:47,351] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,14] (state.change.logger)
[2017-06-26 23:41:47,351] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 141 from controller 0 epoch 8 for partition [__consumer_offsets,43] (state.change.logger)
[2017-06-26 23:41:47,352] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 141 epoch 8 for partition [__consumer_offsets,43] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:47,352] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=43,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,352] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=43,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,352] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-43 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 142 (state.change.logger)
[2017-06-26 23:41:47,352] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,352] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,354] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,14] due to: No other replicas in ISR 2 for [__consumer_offsets,14] besides shutting down brokers 2. (state.change.logger)
[2017-06-26 23:41:47,354] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,14] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,14] due to: No other replicas in ISR 2 for [__consumer_offsets,14] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,14] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:41:47,356] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,28] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:47,356] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,28] (state.change.logger)
[2017-06-26 23:41:47,356] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,28] (state.change.logger)
[2017-06-26 23:41:47,356] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-28 (state.change.logger)
[2017-06-26 23:41:47,356] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 143 from controller 0 epoch 8 for partition [__consumer_offsets,28] (state.change.logger)
[2017-06-26 23:41:47,356] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 143 epoch 8 for partition [__consumer_offsets,28] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:47,356] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=28,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,356] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=28,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,357] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-28 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 144 (state.change.logger)
[2017-06-26 23:41:47,357] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,357] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,358] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,4] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:47,358] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,4] (state.change.logger)
[2017-06-26 23:41:47,358] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,4] (state.change.logger)
[2017-06-26 23:41:47,358] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-4 (state.change.logger)
[2017-06-26 23:41:47,358] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=7, replicas=[0, 1, 2]) correlation id 145 from controller 0 epoch 8 for partition [__consumer_offsets,4] (state.change.logger)
[2017-06-26 23:41:47,359] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 145 epoch 8 for partition [__consumer_offsets,4] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:47,359] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=4,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,359] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=4,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,359] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-4 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 146 (state.change.logger)
[2017-06-26 23:41:47,359] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,359] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,360] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,36] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:47,360] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,36] (state.change.logger)
[2017-06-26 23:41:47,360] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,36] (state.change.logger)
[2017-06-26 23:41:47,360] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-36 (state.change.logger)
[2017-06-26 23:41:47,361] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 147 from controller 0 epoch 8 for partition [__consumer_offsets,36] (state.change.logger)
[2017-06-26 23:41:47,361] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 147 epoch 8 for partition [__consumer_offsets,36] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:47,361] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=36,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,361] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=36,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,361] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-36 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 148 (state.change.logger)
[2017-06-26 23:41:47,361] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,361] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,362] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,6] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:47,362] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,6] (state.change.logger)
[2017-06-26 23:41:47,362] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,6] (state.change.logger)
[2017-06-26 23:41:47,362] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-6 (state.change.logger)
[2017-06-26 23:41:47,363] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 149 from controller 0 epoch 8 for partition [__consumer_offsets,6] (state.change.logger)
[2017-06-26 23:41:47,363] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 149 epoch 8 for partition [__consumer_offsets,6] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:47,363] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=6,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,363] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=6,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,363] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-6 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 150 (state.change.logger)
[2017-06-26 23:41:47,363] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,363] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,364] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,39] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:47,364] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,39] (state.change.logger)
[2017-06-26 23:41:47,364] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,39] (state.change.logger)
[2017-06-26 23:41:47,364] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-39 (state.change.logger)
[2017-06-26 23:41:47,365] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 151 from controller 0 epoch 8 for partition [__consumer_offsets,39] (state.change.logger)
[2017-06-26 23:41:47,365] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,23] (state.change.logger)
[2017-06-26 23:41:47,365] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 151 epoch 8 for partition [__consumer_offsets,39] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:47,365] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=39,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,365] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=39,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,365] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-39 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 152 (state.change.logger)
[2017-06-26 23:41:47,365] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,365] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,366] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,23] due to: No other replicas in ISR 2 for [__consumer_offsets,23] besides shutting down brokers 2. (state.change.logger)
[2017-06-26 23:41:47,367] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,23] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,23] due to: No other replicas in ISR 2 for [__consumer_offsets,23] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,23] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 23:41:47,369] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,24] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:47,369] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,24] (state.change.logger)
[2017-06-26 23:41:47,369] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,24] (state.change.logger)
[2017-06-26 23:41:47,369] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-24 (state.change.logger)
[2017-06-26 23:41:47,369] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,38] (state.change.logger)
[2017-06-26 23:41:47,369] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 153 from controller 0 epoch 8 for partition [__consumer_offsets,24] (state.change.logger)
[2017-06-26 23:41:47,369] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 153 epoch 8 for partition [__consumer_offsets,24] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:47,369] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=24,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,369] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=24,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,369] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-24 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 154 (state.change.logger)
[2017-06-26 23:41:47,370] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,370] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,371] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,38] due to: No other replicas in ISR 2 for [__consumer_offsets,38] besides shutting down brokers 2. (state.change.logger)
[2017-06-26 23:41:47,371] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,38] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,38] due to: No other replicas in ISR 2 for [__consumer_offsets,38] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,38] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:41:47,373] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,16] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:47,373] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,16] (state.change.logger)
[2017-06-26 23:41:47,373] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,16] (state.change.logger)
[2017-06-26 23:41:47,373] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-16 (state.change.logger)
[2017-06-26 23:41:47,373] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 155 from controller 0 epoch 8 for partition [__consumer_offsets,16] (state.change.logger)
[2017-06-26 23:41:47,373] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 155 epoch 8 for partition [__consumer_offsets,16] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:47,373] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=16,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,373] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=16,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,374] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-16 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 156 (state.change.logger)
[2017-06-26 23:41:47,374] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,374] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,375] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,3] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:47,375] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,3] (state.change.logger)
[2017-06-26 23:41:47,375] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,3] (state.change.logger)
[2017-06-26 23:41:47,375] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-3 (state.change.logger)
[2017-06-26 23:41:47,376] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 157 from controller 0 epoch 8 for partition [__consumer_offsets,3] (state.change.logger)
[2017-06-26 23:41:47,376] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 157 epoch 8 for partition [__consumer_offsets,3] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:47,376] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=3,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,376] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=3,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,376] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-3 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 158 (state.change.logger)
[2017-06-26 23:41:47,376] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,376] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,378] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,21] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:47,378] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,21] (state.change.logger)
[2017-06-26 23:41:47,378] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,21] (state.change.logger)
[2017-06-26 23:41:47,378] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-21 (state.change.logger)
[2017-06-26 23:41:47,378] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 159 from controller 0 epoch 8 for partition [__consumer_offsets,21] (state.change.logger)
[2017-06-26 23:41:47,378] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 159 epoch 8 for partition [__consumer_offsets,21] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:47,378] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=21,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,378] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=21,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,379] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-21 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 160 (state.change.logger)
[2017-06-26 23:41:47,379] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,379] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,380] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,10] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:47,380] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,10] (state.change.logger)
[2017-06-26 23:41:47,380] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,10] (state.change.logger)
[2017-06-26 23:41:47,380] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-10 (state.change.logger)
[2017-06-26 23:41:47,380] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 161 from controller 0 epoch 8 for partition [__consumer_offsets,10] (state.change.logger)
[2017-06-26 23:41:47,380] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 161 epoch 8 for partition [__consumer_offsets,10] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:47,380] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=10,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,381] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=10,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,381] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-10 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 162 (state.change.logger)
[2017-06-26 23:41:47,381] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,381] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,383] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,40] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:47,383] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,40] (state.change.logger)
[2017-06-26 23:41:47,383] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,40] (state.change.logger)
[2017-06-26 23:41:47,383] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-40 (state.change.logger)
[2017-06-26 23:41:47,383] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 163 from controller 0 epoch 8 for partition [__consumer_offsets,40] (state.change.logger)
[2017-06-26 23:41:47,383] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 163 epoch 8 for partition [__consumer_offsets,40] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:47,383] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=40,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,383] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=40,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,383] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-40 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 164 (state.change.logger)
[2017-06-26 23:41:47,384] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,384] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,385] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,34] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:47,385] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,34] (state.change.logger)
[2017-06-26 23:41:47,385] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,34] (state.change.logger)
[2017-06-26 23:41:47,385] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-34 (state.change.logger)
[2017-06-26 23:41:47,385] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 165 from controller 0 epoch 8 for partition [__consumer_offsets,34] (state.change.logger)
[2017-06-26 23:41:47,385] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 165 epoch 8 for partition [__consumer_offsets,34] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:47,385] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=34,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,385] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=34,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,385] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-34 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 166 (state.change.logger)
[2017-06-26 23:41:47,386] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,386] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,387] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,25] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:47,387] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,25] (state.change.logger)
[2017-06-26 23:41:47,387] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,25] (state.change.logger)
[2017-06-26 23:41:47,387] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-25 (state.change.logger)
[2017-06-26 23:41:47,387] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 167 from controller 0 epoch 8 for partition [__consumer_offsets,25] (state.change.logger)
[2017-06-26 23:41:47,387] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 167 epoch 8 for partition [__consumer_offsets,25] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:47,387] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=25,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,387] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=25,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,388] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-25 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 168 (state.change.logger)
[2017-06-26 23:41:47,388] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,388] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,389] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,27] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:47,389] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,27] (state.change.logger)
[2017-06-26 23:41:47,389] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,27] (state.change.logger)
[2017-06-26 23:41:47,389] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-27 (state.change.logger)
[2017-06-26 23:41:47,389] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 169 from controller 0 epoch 8 for partition [__consumer_offsets,27] (state.change.logger)
[2017-06-26 23:41:47,389] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 169 epoch 8 for partition [__consumer_offsets,27] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:47,389] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=27,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,389] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=27,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,390] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,390] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-27 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 170 (state.change.logger)
[2017-06-26 23:41:47,390] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,391] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,42] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:47,391] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,42] (state.change.logger)
[2017-06-26 23:41:47,391] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,42] (state.change.logger)
[2017-06-26 23:41:47,391] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-42 (state.change.logger)
[2017-06-26 23:41:47,391] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,11] (state.change.logger)
[2017-06-26 23:41:47,391] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 171 from controller 0 epoch 8 for partition [__consumer_offsets,42] (state.change.logger)
[2017-06-26 23:41:47,392] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 171 epoch 8 for partition [__consumer_offsets,42] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:47,392] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=42,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,392] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=42,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,392] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,392] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-42 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 172 (state.change.logger)
[2017-06-26 23:41:47,392] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,393] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,11] due to: No other replicas in ISR 2 for [__consumer_offsets,11] besides shutting down brokers 2. (state.change.logger)
[2017-06-26 23:41:47,393] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,11] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,11] due to: No other replicas in ISR 2 for [__consumer_offsets,11] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,11] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:41:47,395] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,7] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:47,395] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,7] (state.change.logger)
[2017-06-26 23:41:47,395] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,7] (state.change.logger)
[2017-06-26 23:41:47,395] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-7 (state.change.logger)
[2017-06-26 23:41:47,395] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 173 from controller 0 epoch 8 for partition [__consumer_offsets,7] (state.change.logger)
[2017-06-26 23:41:47,395] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,47] (state.change.logger)
[2017-06-26 23:41:47,395] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 173 epoch 8 for partition [__consumer_offsets,7] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:47,396] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=7,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,396] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=7,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,396] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-7 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 174 (state.change.logger)
[2017-06-26 23:41:47,396] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,396] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,397] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,47] due to: No other replicas in ISR 2 for [__consumer_offsets,47] besides shutting down brokers 2. (state.change.logger)
[2017-06-26 23:41:47,398] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,47] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,47] due to: No other replicas in ISR 2 for [__consumer_offsets,47] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,47] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:41:47,400] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,9] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:47,401] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,9] (state.change.logger)
[2017-06-26 23:41:47,401] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,9] (state.change.logger)
[2017-06-26 23:41:47,401] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-9 (state.change.logger)
[2017-06-26 23:41:47,401] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 175 from controller 0 epoch 8 for partition [__consumer_offsets,9] (state.change.logger)
[2017-06-26 23:41:47,401] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 175 epoch 8 for partition [__consumer_offsets,9] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:47,401] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=9,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,401] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=9,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,401] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-9 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 176 (state.change.logger)
[2017-06-26 23:41:47,401] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,401] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,403] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,13] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:47,403] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,13] (state.change.logger)
[2017-06-26 23:41:47,403] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,13] (state.change.logger)
[2017-06-26 23:41:47,403] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-13 (state.change.logger)
[2017-06-26 23:41:47,403] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,29] (state.change.logger)
[2017-06-26 23:41:47,403] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=8, replicas=[0, 1, 2]) correlation id 177 from controller 0 epoch 8 for partition [__consumer_offsets,13] (state.change.logger)
[2017-06-26 23:41:47,403] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 177 epoch 8 for partition [__consumer_offsets,13] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:47,403] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=13,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,403] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=13,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,404] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-13 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 178 (state.change.logger)
[2017-06-26 23:41:47,404] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,404] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,405] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,29] due to: No other replicas in ISR 2 for [__consumer_offsets,29] besides shutting down brokers 2. (state.change.logger)
[2017-06-26 23:41:47,405] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,29] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,29] due to: No other replicas in ISR 2 for [__consumer_offsets,29] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,29] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:41:47,405] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,8] (state.change.logger)
[2017-06-26 23:41:47,407] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,8] due to: No other replicas in ISR 2 for [__consumer_offsets,8] besides shutting down brokers 2. (state.change.logger)
[2017-06-26 23:41:47,407] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,8] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,8] due to: No other replicas in ISR 2 for [__consumer_offsets,8] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,8] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:41:47,409] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,22] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:47,409] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,22] (state.change.logger)
[2017-06-26 23:41:47,409] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,22] (state.change.logger)
[2017-06-26 23:41:47,409] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-22 (state.change.logger)
[2017-06-26 23:41:47,409] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=7, replicas=[0, 1, 2]) correlation id 179 from controller 0 epoch 8 for partition [__consumer_offsets,22] (state.change.logger)
[2017-06-26 23:41:47,409] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 179 epoch 8 for partition [__consumer_offsets,22] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:47,409] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=22,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,409] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=22,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,410] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-22 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 180 (state.change.logger)
[2017-06-26 23:41:47,410] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,410] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,411] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,31] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:47,411] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,31] (state.change.logger)
[2017-06-26 23:41:47,411] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,31] (state.change.logger)
[2017-06-26 23:41:47,411] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-31 (state.change.logger)
[2017-06-26 23:41:47,411] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 181 from controller 0 epoch 8 for partition [__consumer_offsets,31] (state.change.logger)
[2017-06-26 23:41:47,411] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 181 epoch 8 for partition [__consumer_offsets,31] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:47,412] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=31,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,412] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=31,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,412] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-31 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 182 (state.change.logger)
[2017-06-26 23:41:47,412] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,412] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,413] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,18] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:47,413] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,18] (state.change.logger)
[2017-06-26 23:41:47,413] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,18] (state.change.logger)
[2017-06-26 23:41:47,413] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-18 (state.change.logger)
[2017-06-26 23:41:47,414] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,20] (state.change.logger)
[2017-06-26 23:41:47,414] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 183 from controller 0 epoch 8 for partition [__consumer_offsets,18] (state.change.logger)
[2017-06-26 23:41:47,414] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 183 epoch 8 for partition [__consumer_offsets,18] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:47,414] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=18,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,414] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=18,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,414] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-18 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 184 (state.change.logger)
[2017-06-26 23:41:47,414] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,414] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,415] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,20] due to: No other replicas in ISR 2 for [__consumer_offsets,20] besides shutting down brokers 2. (state.change.logger)
[2017-06-26 23:41:47,415] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,20] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,20] due to: No other replicas in ISR 2 for [__consumer_offsets,20] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,20] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:41:47,417] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,37] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:47,417] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,37] (state.change.logger)
[2017-06-26 23:41:47,417] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,37] (state.change.logger)
[2017-06-26 23:41:47,418] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-37 (state.change.logger)
[2017-06-26 23:41:47,418] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=7, replicas=[0, 1, 2]) correlation id 185 from controller 0 epoch 8 for partition [__consumer_offsets,37] (state.change.logger)
[2017-06-26 23:41:47,418] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 185 epoch 8 for partition [__consumer_offsets,37] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:47,418] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=37,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,418] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=37,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,418] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-37 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 186 (state.change.logger)
[2017-06-26 23:41:47,418] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,418] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,420] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,49] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:47,420] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,49] (state.change.logger)
[2017-06-26 23:41:47,420] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,49] (state.change.logger)
[2017-06-26 23:41:47,420] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-49 (state.change.logger)
[2017-06-26 23:41:47,420] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 187 from controller 0 epoch 8 for partition [__consumer_offsets,49] (state.change.logger)
[2017-06-26 23:41:47,420] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 187 epoch 8 for partition [__consumer_offsets,49] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:47,420] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=49,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,420] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=49,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,420] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-49 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 188 (state.change.logger)
[2017-06-26 23:41:47,421] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,421] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,422] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,12] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:47,422] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,12] (state.change.logger)
[2017-06-26 23:41:47,422] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,12] (state.change.logger)
[2017-06-26 23:41:47,422] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-12 (state.change.logger)
[2017-06-26 23:41:47,422] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 189 from controller 0 epoch 8 for partition [__consumer_offsets,12] (state.change.logger)
[2017-06-26 23:41:47,422] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 189 epoch 8 for partition [__consumer_offsets,12] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:47,422] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,5] (state.change.logger)
[2017-06-26 23:41:47,423] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=12,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,423] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=12,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,423] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-12 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 190 (state.change.logger)
[2017-06-26 23:41:47,424] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,424] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,426] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,5] due to: No other replicas in ISR 2 for [__consumer_offsets,5] besides shutting down brokers 2. (state.change.logger)
[2017-06-26 23:41:47,426] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,5] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,5] due to: No other replicas in ISR 2 for [__consumer_offsets,5] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,5] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:41:47,426] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,32] (state.change.logger)
[2017-06-26 23:41:47,428] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,32] due to: No other replicas in ISR 2 for [__consumer_offsets,32] besides shutting down brokers 2. (state.change.logger)
[2017-06-26 23:41:47,428] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,32] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,32] due to: No other replicas in ISR 2 for [__consumer_offsets,32] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,32] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:41:47,428] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,2] (state.change.logger)
[2017-06-26 23:41:47,429] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,2] due to: No other replicas in ISR 2 for [__consumer_offsets,2] besides shutting down brokers 2. (state.change.logger)
[2017-06-26 23:41:47,429] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,2] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,2] due to: No other replicas in ISR 2 for [__consumer_offsets,2] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,2] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:41:47,431] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,1] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:47,431] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,1] (state.change.logger)
[2017-06-26 23:41:47,431] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,1] (state.change.logger)
[2017-06-26 23:41:47,431] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-1 (state.change.logger)
[2017-06-26 23:41:47,431] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 191 from controller 0 epoch 8 for partition [__consumer_offsets,1] (state.change.logger)
[2017-06-26 23:41:47,431] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 191 epoch 8 for partition [__consumer_offsets,1] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:47,432] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=1,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,432] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=1,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,432] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-1 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 192 (state.change.logger)
[2017-06-26 23:41:47,432] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,432] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,433] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,0] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:47,433] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,0] (state.change.logger)
[2017-06-26 23:41:47,433] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,0] (state.change.logger)
[2017-06-26 23:41:47,434] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-0 (state.change.logger)
[2017-06-26 23:41:47,434] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 193 from controller 0 epoch 8 for partition [__consumer_offsets,0] (state.change.logger)
[2017-06-26 23:41:47,434] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 193 epoch 8 for partition [__consumer_offsets,0] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:47,434] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=0,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,434] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=0,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,434] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-0 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 194 (state.change.logger)
[2017-06-26 23:41:47,434] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,434] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,436] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,15] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:47,436] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,15] (state.change.logger)
[2017-06-26 23:41:47,436] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,15] (state.change.logger)
[2017-06-26 23:41:47,436] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-15 (state.change.logger)
[2017-06-26 23:41:47,436] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,44] (state.change.logger)
[2017-06-26 23:41:47,436] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 195 from controller 0 epoch 8 for partition [__consumer_offsets,15] (state.change.logger)
[2017-06-26 23:41:47,436] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 195 epoch 8 for partition [__consumer_offsets,15] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:47,436] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=15,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,436] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=15,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,437] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-15 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 196 (state.change.logger)
[2017-06-26 23:41:47,437] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,437] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,438] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,44] due to: No other replicas in ISR 2 for [__consumer_offsets,44] besides shutting down brokers 2. (state.change.logger)
[2017-06-26 23:41:47,438] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,44] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,44] due to: No other replicas in ISR 2 for [__consumer_offsets,44] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,44] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 23 more
[2017-06-26 23:41:47,438] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,17] (state.change.logger)
[2017-06-26 23:41:47,440] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,17] due to: No other replicas in ISR 2 for [__consumer_offsets,17] besides shutting down brokers 2. (state.change.logger)
[2017-06-26 23:41:47,440] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,17] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,17] due to: No other replicas in ISR 2 for [__consumer_offsets,17] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,17] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 23 more
[2017-06-26 23:41:47,442] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,48] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:47,442] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,48] (state.change.logger)
[2017-06-26 23:41:47,442] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,48] (state.change.logger)
[2017-06-26 23:41:47,442] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-48 (state.change.logger)
[2017-06-26 23:41:47,442] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,26] (state.change.logger)
[2017-06-26 23:41:47,443] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 197 from controller 0 epoch 8 for partition [__consumer_offsets,48] (state.change.logger)
[2017-06-26 23:41:47,443] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 197 epoch 8 for partition [__consumer_offsets,48] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:47,443] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=48,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,443] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=48,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,443] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-48 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 198 (state.change.logger)
[2017-06-26 23:41:47,443] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,443] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,444] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,26] due to: No other replicas in ISR 2 for [__consumer_offsets,26] besides shutting down brokers 2. (state.change.logger)
[2017-06-26 23:41:47,444] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,26] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,26] due to: No other replicas in ISR 2 for [__consumer_offsets,26] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,26] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:41:47,447] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,33] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:47,447] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,33] (state.change.logger)
[2017-06-26 23:41:47,447] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,33] (state.change.logger)
[2017-06-26 23:41:47,447] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-33 (state.change.logger)
[2017-06-26 23:41:47,447] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,41] (state.change.logger)
[2017-06-26 23:41:47,447] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 199 from controller 0 epoch 8 for partition [__consumer_offsets,33] (state.change.logger)
[2017-06-26 23:41:47,447] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 199 epoch 8 for partition [__consumer_offsets,33] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:47,447] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=33,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,447] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=33,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,448] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-33 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 200 (state.change.logger)
[2017-06-26 23:41:47,448] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,448] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,449] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,41] due to: No other replicas in ISR 2 for [__consumer_offsets,41] besides shutting down brokers 2. (state.change.logger)
[2017-06-26 23:41:47,449] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,41] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,41] due to: No other replicas in ISR 2 for [__consumer_offsets,41] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,41] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 23:41:47,451] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,45] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:47,451] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,45] (state.change.logger)
[2017-06-26 23:41:47,451] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,45] (state.change.logger)
[2017-06-26 23:41:47,451] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-45 (state.change.logger)
[2017-06-26 23:41:47,451] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 201 from controller 0 epoch 8 for partition [__consumer_offsets,45] (state.change.logger)
[2017-06-26 23:41:47,452] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,35] (state.change.logger)
[2017-06-26 23:41:47,452] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 201 epoch 8 for partition [__consumer_offsets,45] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:47,452] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=45,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,452] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=45,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,452] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-45 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 202 (state.change.logger)
[2017-06-26 23:41:47,452] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,452] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,453] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,35] due to: No other replicas in ISR 2 for [__consumer_offsets,35] besides shutting down brokers 2. (state.change.logger)
[2017-06-26 23:41:47,453] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,35] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,35] due to: No other replicas in ISR 2 for [__consumer_offsets,35] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,35] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:41:47,456] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,46] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:47,456] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,46] (state.change.logger)
[2017-06-26 23:41:47,456] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,46] (state.change.logger)
[2017-06-26 23:41:47,456] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-46 (state.change.logger)
[2017-06-26 23:41:47,456] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=46,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,457] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,457] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 203 from controller 0 epoch 8 for partition [__consumer_offsets,46] (state.change.logger)
[2017-06-26 23:41:47,457] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 203 epoch 8 for partition [__consumer_offsets,46] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:47,458] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=46,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,459] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-46 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 204 (state.change.logger)
[2017-06-26 23:41:47,459] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,459] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,19] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:47,459] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,19] (state.change.logger)
[2017-06-26 23:41:47,459] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,19] (state.change.logger)
[2017-06-26 23:41:47,459] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-19 (state.change.logger)
[2017-06-26 23:41:47,460] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 205 from controller 0 epoch 8 for partition [__consumer_offsets,19] (state.change.logger)
[2017-06-26 23:41:47,460] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 205 epoch 8 for partition [__consumer_offsets,19] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:47,460] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=19,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,460] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=19,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,460] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-19 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 206 (state.change.logger)
[2017-06-26 23:41:47,461] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,461] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,463] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,30] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:41:47,463] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,30] (state.change.logger)
[2017-06-26 23:41:47,463] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,30] (state.change.logger)
[2017-06-26 23:41:47,463] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1, 2) for partition __consumer_offsets-30 (state.change.logger)
[2017-06-26 23:41:47,463] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 207 from controller 0 epoch 8 for partition [__consumer_offsets,30] (state.change.logger)
[2017-06-26 23:41:47,463] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 207 epoch 8 for partition [__consumer_offsets,30] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:41:47,463] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=30,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:47,463] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=30,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,464] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-30 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 208 (state.change.logger)
[2017-06-26 23:41:47,464] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:41:47,464] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:41:51,966] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=19,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:51,967] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=30,error_code=0}]} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:41:51,967] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 23:42:24,483] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,47] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 23:42:24,483] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,29] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 23:42:24,483] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,41] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 23:42:24,483] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,17] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 23:42:24,483] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,14] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 23:42:24,483] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,26] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 23:42:24,483] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,20] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 23:42:24,483] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,5] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 23:42:24,483] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,8] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 23:42:24,483] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,23] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 23:42:24,483] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,11] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 23:42:24,483] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,44] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 23:42:24,483] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,32] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 23:42:24,483] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,35] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 23:42:24,483] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,38] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 23:42:24,483] TRACE Controller 0 epoch 8 changed partition [rf1p1,0] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 23:42:24,483] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,2] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 23:42:24,483] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,47] (state.change.logger)
[2017-06-26 23:42:24,489] TRACE Controller 0 epoch 8 elected leader 1 for Offline partition [__consumer_offsets,47] (state.change.logger)
[2017-06-26 23:42:24,490] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,47] from OfflinePartition to OnlinePartition with leader 1 (state.change.logger)
[2017-06-26 23:42:24,490] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,29] (state.change.logger)
[2017-06-26 23:42:24,494] TRACE Controller 0 epoch 8 elected leader 1 for Offline partition [__consumer_offsets,29] (state.change.logger)
[2017-06-26 23:42:24,495] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,29] from OfflinePartition to OnlinePartition with leader 1 (state.change.logger)
[2017-06-26 23:42:24,495] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,41] (state.change.logger)
[2017-06-26 23:42:24,499] TRACE Controller 0 epoch 8 elected leader 1 for Offline partition [__consumer_offsets,41] (state.change.logger)
[2017-06-26 23:42:24,499] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,41] from OfflinePartition to OnlinePartition with leader 1 (state.change.logger)
[2017-06-26 23:42:24,499] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,17] (state.change.logger)
[2017-06-26 23:42:24,503] TRACE Controller 0 epoch 8 elected leader 1 for Offline partition [__consumer_offsets,17] (state.change.logger)
[2017-06-26 23:42:24,504] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,17] from OfflinePartition to OnlinePartition with leader 1 (state.change.logger)
[2017-06-26 23:42:24,504] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,14] (state.change.logger)
[2017-06-26 23:42:24,508] TRACE Controller 0 epoch 8 elected leader 0 for Offline partition [__consumer_offsets,14] (state.change.logger)
[2017-06-26 23:42:24,509] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,14] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-06-26 23:42:24,509] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,26] (state.change.logger)
[2017-06-26 23:42:24,512] TRACE Controller 0 epoch 8 elected leader 0 for Offline partition [__consumer_offsets,26] (state.change.logger)
[2017-06-26 23:42:24,513] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,26] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-06-26 23:42:24,513] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,20] (state.change.logger)
[2017-06-26 23:42:24,517] TRACE Controller 0 epoch 8 elected leader 0 for Offline partition [__consumer_offsets,20] (state.change.logger)
[2017-06-26 23:42:24,517] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,20] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-06-26 23:42:24,517] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,5] (state.change.logger)
[2017-06-26 23:42:24,521] TRACE Controller 0 epoch 8 elected leader 1 for Offline partition [__consumer_offsets,5] (state.change.logger)
[2017-06-26 23:42:24,522] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,5] from OfflinePartition to OnlinePartition with leader 1 (state.change.logger)
[2017-06-26 23:42:24,522] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,8] (state.change.logger)
[2017-06-26 23:42:24,526] TRACE Controller 0 epoch 8 elected leader 0 for Offline partition [__consumer_offsets,8] (state.change.logger)
[2017-06-26 23:42:24,526] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,8] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-06-26 23:42:24,526] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,23] (state.change.logger)
[2017-06-26 23:42:24,531] TRACE Controller 0 epoch 8 elected leader 1 for Offline partition [__consumer_offsets,23] (state.change.logger)
[2017-06-26 23:42:24,532] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,23] from OfflinePartition to OnlinePartition with leader 1 (state.change.logger)
[2017-06-26 23:42:24,532] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,11] (state.change.logger)
[2017-06-26 23:42:24,536] TRACE Controller 0 epoch 8 elected leader 1 for Offline partition [__consumer_offsets,11] (state.change.logger)
[2017-06-26 23:42:24,537] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,11] from OfflinePartition to OnlinePartition with leader 1 (state.change.logger)
[2017-06-26 23:42:24,537] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,44] (state.change.logger)
[2017-06-26 23:42:24,541] TRACE Controller 0 epoch 8 elected leader 0 for Offline partition [__consumer_offsets,44] (state.change.logger)
[2017-06-26 23:42:24,542] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,44] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-06-26 23:42:24,542] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,32] (state.change.logger)
[2017-06-26 23:42:24,546] TRACE Controller 0 epoch 8 elected leader 0 for Offline partition [__consumer_offsets,32] (state.change.logger)
[2017-06-26 23:42:24,546] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,32] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-06-26 23:42:24,546] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,35] (state.change.logger)
[2017-06-26 23:42:24,549] TRACE Controller 0 epoch 8 elected leader 1 for Offline partition [__consumer_offsets,35] (state.change.logger)
[2017-06-26 23:42:24,550] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,35] from OfflinePartition to OnlinePartition with leader 1 (state.change.logger)
[2017-06-26 23:42:24,550] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,38] (state.change.logger)
[2017-06-26 23:42:24,553] TRACE Controller 0 epoch 8 elected leader 0 for Offline partition [__consumer_offsets,38] (state.change.logger)
[2017-06-26 23:42:24,554] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,38] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-06-26 23:42:24,554] TRACE Controller 0 epoch 8 started leader election for partition [rf1p1,0] (state.change.logger)
[2017-06-26 23:42:24,556] ERROR Controller 0 epoch 8 initiated state change for partition [rf1p1,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [rf1p1,0] is alive. Live brokers are: [Set(0, 1)], Assigned replicas are: [List(2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 23:42:24,556] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,2] (state.change.logger)
[2017-06-26 23:42:24,560] TRACE Controller 0 epoch 8 elected leader 0 for Offline partition [__consumer_offsets,2] (state.change.logger)
[2017-06-26 23:42:24,560] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,2] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-06-26 23:42:24,560] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,38] (state.change.logger)
[2017-06-26 23:42:24,560] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,8] (state.change.logger)
[2017-06-26 23:42:24,560] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,2] (state.change.logger)
[2017-06-26 23:42:24,560] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,35] (state.change.logger)
[2017-06-26 23:42:24,560] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,5] (state.change.logger)
[2017-06-26 23:42:24,560] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,32] (state.change.logger)
[2017-06-26 23:42:24,560] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,29] (state.change.logger)
[2017-06-26 23:42:24,560] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,23] (state.change.logger)
[2017-06-26 23:42:24,560] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,26] (state.change.logger)
[2017-06-26 23:42:24,560] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,20] (state.change.logger)
[2017-06-26 23:42:24,560] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,17] (state.change.logger)
[2017-06-26 23:42:24,560] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,44] (state.change.logger)
[2017-06-26 23:42:24,560] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,47] (state.change.logger)
[2017-06-26 23:42:24,560] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,14] (state.change.logger)
[2017-06-26 23:42:24,560] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,41] (state.change.logger)
[2017-06-26 23:42:24,560] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,11] (state.change.logger)
[2017-06-26 23:42:24,560] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,38] (state.change.logger)
[2017-06-26 23:42:24,561] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,8] (state.change.logger)
[2017-06-26 23:42:24,561] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,2] (state.change.logger)
[2017-06-26 23:42:24,561] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,35] (state.change.logger)
[2017-06-26 23:42:24,561] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,5] (state.change.logger)
[2017-06-26 23:42:24,561] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,32] (state.change.logger)
[2017-06-26 23:42:24,561] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,29] (state.change.logger)
[2017-06-26 23:42:24,561] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,23] (state.change.logger)
[2017-06-26 23:42:24,561] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,26] (state.change.logger)
[2017-06-26 23:42:24,561] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,20] (state.change.logger)
[2017-06-26 23:42:24,561] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,17] (state.change.logger)
[2017-06-26 23:42:24,561] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,44] (state.change.logger)
[2017-06-26 23:42:24,561] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,47] (state.change.logger)
[2017-06-26 23:42:24,561] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,14] (state.change.logger)
[2017-06-26 23:42:24,561] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,41] (state.change.logger)
[2017-06-26 23:42:24,561] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,11] (state.change.logger)
[2017-06-26 23:42:24,561] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-38 (state.change.logger)
[2017-06-26 23:42:24,561] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-8 (state.change.logger)
[2017-06-26 23:42:24,561] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-2 (state.change.logger)
[2017-06-26 23:42:24,561] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-35 (state.change.logger)
[2017-06-26 23:42:24,561] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-5 (state.change.logger)
[2017-06-26 23:42:24,561] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-32 (state.change.logger)
[2017-06-26 23:42:24,561] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-29 (state.change.logger)
[2017-06-26 23:42:24,561] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-23 (state.change.logger)
[2017-06-26 23:42:24,561] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-26 (state.change.logger)
[2017-06-26 23:42:24,561] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-20 (state.change.logger)
[2017-06-26 23:42:24,561] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-17 (state.change.logger)
[2017-06-26 23:42:24,561] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-44 (state.change.logger)
[2017-06-26 23:42:24,562] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-47 (state.change.logger)
[2017-06-26 23:42:24,562] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-14 (state.change.logger)
[2017-06-26 23:42:24,562] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-41 (state.change.logger)
[2017-06-26 23:42:24,562] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-11 (state.change.logger)
[2017-06-26 23:42:24,562] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=5, isr=[1], zkVersion=8, replicas=[0, 1, 2]) correlation id 209 from controller 0 epoch 8 for partition [__consumer_offsets,47] (state.change.logger)
[2017-06-26 23:42:24,562] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=8, replicas=[0, 1, 2]) correlation id 209 from controller 0 epoch 8 for partition [__consumer_offsets,14] (state.change.logger)
[2017-06-26 23:42:24,562] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=5, isr=[1], zkVersion=8, replicas=[0, 1, 2]) correlation id 209 from controller 0 epoch 8 for partition [__consumer_offsets,11] (state.change.logger)
[2017-06-26 23:42:24,562] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=8, replicas=[0, 1, 2]) correlation id 209 from controller 0 epoch 8 for partition [__consumer_offsets,44] (state.change.logger)
[2017-06-26 23:42:24,562] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=5, isr=[1], zkVersion=8, replicas=[0, 1, 2]) correlation id 209 from controller 0 epoch 8 for partition [__consumer_offsets,41] (state.change.logger)
[2017-06-26 23:42:24,562] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=5, isr=[1], zkVersion=8, replicas=[0, 1, 2]) correlation id 209 from controller 0 epoch 8 for partition [__consumer_offsets,23] (state.change.logger)
[2017-06-26 23:42:24,562] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=8, replicas=[0, 1, 2]) correlation id 209 from controller 0 epoch 8 for partition [__consumer_offsets,20] (state.change.logger)
[2017-06-26 23:42:24,562] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=5, isr=[1], zkVersion=8, replicas=[0, 1, 2]) correlation id 209 from controller 0 epoch 8 for partition [__consumer_offsets,17] (state.change.logger)
[2017-06-26 23:42:24,562] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=8, replicas=[0, 1, 2]) correlation id 209 from controller 0 epoch 8 for partition [__consumer_offsets,32] (state.change.logger)
[2017-06-26 23:42:24,562] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=5, isr=[1], zkVersion=8, replicas=[0, 1, 2]) correlation id 209 from controller 0 epoch 8 for partition [__consumer_offsets,29] (state.change.logger)
[2017-06-26 23:42:24,562] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=8, replicas=[0, 1, 2]) correlation id 209 from controller 0 epoch 8 for partition [__consumer_offsets,26] (state.change.logger)
[2017-06-26 23:42:24,562] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=8, replicas=[0, 1, 2]) correlation id 209 from controller 0 epoch 8 for partition [__consumer_offsets,8] (state.change.logger)
[2017-06-26 23:42:24,562] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=5, isr=[1], zkVersion=8, replicas=[0, 1, 2]) correlation id 209 from controller 0 epoch 8 for partition [__consumer_offsets,5] (state.change.logger)
[2017-06-26 23:42:24,562] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=8, replicas=[0, 1, 2]) correlation id 209 from controller 0 epoch 8 for partition [__consumer_offsets,38] (state.change.logger)
[2017-06-26 23:42:24,562] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=5, isr=[1], zkVersion=8, replicas=[0, 1, 2]) correlation id 209 from controller 0 epoch 8 for partition [__consumer_offsets,35] (state.change.logger)
[2017-06-26 23:42:24,562] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=8, replicas=[0, 1, 2]) correlation id 209 from controller 0 epoch 8 for partition [__consumer_offsets,2] (state.change.logger)
[2017-06-26 23:42:24,562] TRACE Broker 0 handling LeaderAndIsr request correlationId 209 from controller 0 epoch 8 starting the become-leader transition for partition __consumer_offsets-26 (state.change.logger)
[2017-06-26 23:42:24,562] TRACE Broker 0 handling LeaderAndIsr request correlationId 209 from controller 0 epoch 8 starting the become-leader transition for partition __consumer_offsets-20 (state.change.logger)
[2017-06-26 23:42:24,562] TRACE Broker 0 handling LeaderAndIsr request correlationId 209 from controller 0 epoch 8 starting the become-leader transition for partition __consumer_offsets-14 (state.change.logger)
[2017-06-26 23:42:24,562] TRACE Broker 0 handling LeaderAndIsr request correlationId 209 from controller 0 epoch 8 starting the become-leader transition for partition __consumer_offsets-8 (state.change.logger)
[2017-06-26 23:42:24,562] TRACE Broker 0 handling LeaderAndIsr request correlationId 209 from controller 0 epoch 8 starting the become-leader transition for partition __consumer_offsets-2 (state.change.logger)
[2017-06-26 23:42:24,562] TRACE Broker 0 handling LeaderAndIsr request correlationId 209 from controller 0 epoch 8 starting the become-leader transition for partition __consumer_offsets-38 (state.change.logger)
[2017-06-26 23:42:24,562] TRACE Broker 0 handling LeaderAndIsr request correlationId 209 from controller 0 epoch 8 starting the become-leader transition for partition __consumer_offsets-44 (state.change.logger)
[2017-06-26 23:42:24,562] TRACE Broker 0 handling LeaderAndIsr request correlationId 209 from controller 0 epoch 8 starting the become-leader transition for partition __consumer_offsets-32 (state.change.logger)
[2017-06-26 23:42:24,565] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,17] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:24,566] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 8 with correlation id 209 for partition __consumer_offsets-44 (state.change.logger)
[2017-06-26 23:42:24,566] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 8 with correlation id 209 for partition __consumer_offsets-2 (state.change.logger)
[2017-06-26 23:42:24,566] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 8 with correlation id 209 for partition __consumer_offsets-8 (state.change.logger)
[2017-06-26 23:42:24,566] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 8 with correlation id 209 for partition __consumer_offsets-14 (state.change.logger)
[2017-06-26 23:42:24,566] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 8 with correlation id 209 for partition __consumer_offsets-20 (state.change.logger)
[2017-06-26 23:42:24,566] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 8 with correlation id 209 for partition __consumer_offsets-26 (state.change.logger)
[2017-06-26 23:42:24,566] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 8 with correlation id 209 for partition __consumer_offsets-32 (state.change.logger)
[2017-06-26 23:42:24,566] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 8 with correlation id 209 for partition __consumer_offsets-38 (state.change.logger)
[2017-06-26 23:42:24,566] TRACE Broker 0 completed LeaderAndIsr request correlationId 209 from controller 0 epoch 8 for the become-leader transition for partition __consumer_offsets-26 (state.change.logger)
[2017-06-26 23:42:24,566] TRACE Broker 0 completed LeaderAndIsr request correlationId 209 from controller 0 epoch 8 for the become-leader transition for partition __consumer_offsets-20 (state.change.logger)
[2017-06-26 23:42:24,566] TRACE Broker 0 completed LeaderAndIsr request correlationId 209 from controller 0 epoch 8 for the become-leader transition for partition __consumer_offsets-14 (state.change.logger)
[2017-06-26 23:42:24,566] TRACE Broker 0 completed LeaderAndIsr request correlationId 209 from controller 0 epoch 8 for the become-leader transition for partition __consumer_offsets-8 (state.change.logger)
[2017-06-26 23:42:24,566] TRACE Broker 0 completed LeaderAndIsr request correlationId 209 from controller 0 epoch 8 for the become-leader transition for partition __consumer_offsets-2 (state.change.logger)
[2017-06-26 23:42:24,566] TRACE Broker 0 completed LeaderAndIsr request correlationId 209 from controller 0 epoch 8 for the become-leader transition for partition __consumer_offsets-38 (state.change.logger)
[2017-06-26 23:42:24,566] TRACE Broker 0 completed LeaderAndIsr request correlationId 209 from controller 0 epoch 8 for the become-leader transition for partition __consumer_offsets-44 (state.change.logger)
[2017-06-26 23:42:24,566] TRACE Broker 0 completed LeaderAndIsr request correlationId 209 from controller 0 epoch 8 for the become-leader transition for partition __consumer_offsets-32 (state.change.logger)
[2017-06-26 23:42:24,566] TRACE Broker 0 handling LeaderAndIsr request correlationId 209 from controller 0 epoch 8 starting the become-follower transition for partition __consumer_offsets-29 (state.change.logger)
[2017-06-26 23:42:24,566] TRACE Broker 0 handling LeaderAndIsr request correlationId 209 from controller 0 epoch 8 starting the become-follower transition for partition __consumer_offsets-23 (state.change.logger)
[2017-06-26 23:42:24,566] TRACE Broker 0 handling LeaderAndIsr request correlationId 209 from controller 0 epoch 8 starting the become-follower transition for partition __consumer_offsets-17 (state.change.logger)
[2017-06-26 23:42:24,566] TRACE Broker 0 handling LeaderAndIsr request correlationId 209 from controller 0 epoch 8 starting the become-follower transition for partition __consumer_offsets-11 (state.change.logger)
[2017-06-26 23:42:24,566] TRACE Broker 0 handling LeaderAndIsr request correlationId 209 from controller 0 epoch 8 starting the become-follower transition for partition __consumer_offsets-5 (state.change.logger)
[2017-06-26 23:42:24,566] TRACE Broker 0 handling LeaderAndIsr request correlationId 209 from controller 0 epoch 8 starting the become-follower transition for partition __consumer_offsets-47 (state.change.logger)
[2017-06-26 23:42:24,566] TRACE Broker 0 handling LeaderAndIsr request correlationId 209 from controller 0 epoch 8 starting the become-follower transition for partition __consumer_offsets-35 (state.change.logger)
[2017-06-26 23:42:24,566] TRACE Broker 0 handling LeaderAndIsr request correlationId 209 from controller 0 epoch 8 starting the become-follower transition for partition __consumer_offsets-41 (state.change.logger)
[2017-06-26 23:42:24,568] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,38] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:24,568] TRACE Broker 0 stopped fetchers as part of become-follower request from controller 0 epoch 8 with correlation id 209 for partition __consumer_offsets-41 (state.change.logger)
[2017-06-26 23:42:24,568] TRACE Broker 0 stopped fetchers as part of become-follower request from controller 0 epoch 8 with correlation id 209 for partition __consumer_offsets-47 (state.change.logger)
[2017-06-26 23:42:24,568] TRACE Broker 0 stopped fetchers as part of become-follower request from controller 0 epoch 8 with correlation id 209 for partition __consumer_offsets-5 (state.change.logger)
[2017-06-26 23:42:24,568] TRACE Broker 0 stopped fetchers as part of become-follower request from controller 0 epoch 8 with correlation id 209 for partition __consumer_offsets-11 (state.change.logger)
[2017-06-26 23:42:24,568] TRACE Broker 0 stopped fetchers as part of become-follower request from controller 0 epoch 8 with correlation id 209 for partition __consumer_offsets-17 (state.change.logger)
[2017-06-26 23:42:24,568] TRACE Broker 0 stopped fetchers as part of become-follower request from controller 0 epoch 8 with correlation id 209 for partition __consumer_offsets-23 (state.change.logger)
[2017-06-26 23:42:24,568] TRACE Broker 0 stopped fetchers as part of become-follower request from controller 0 epoch 8 with correlation id 209 for partition __consumer_offsets-29 (state.change.logger)
[2017-06-26 23:42:24,568] TRACE Broker 0 stopped fetchers as part of become-follower request from controller 0 epoch 8 with correlation id 209 for partition __consumer_offsets-35 (state.change.logger)
[2017-06-26 23:42:24,569] TRACE Broker 0 truncated logs and checkpointed recovery boundaries for partition __consumer_offsets-41 as part of become-follower request with correlation id 209 from controller 0 epoch 8 (state.change.logger)
[2017-06-26 23:42:24,569] TRACE Broker 0 truncated logs and checkpointed recovery boundaries for partition __consumer_offsets-47 as part of become-follower request with correlation id 209 from controller 0 epoch 8 (state.change.logger)
[2017-06-26 23:42:24,569] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,39] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:24,569] TRACE Broker 0 truncated logs and checkpointed recovery boundaries for partition __consumer_offsets-5 as part of become-follower request with correlation id 209 from controller 0 epoch 8 (state.change.logger)
[2017-06-26 23:42:24,569] TRACE Broker 0 truncated logs and checkpointed recovery boundaries for partition __consumer_offsets-11 as part of become-follower request with correlation id 209 from controller 0 epoch 8 (state.change.logger)
[2017-06-26 23:42:24,569] TRACE Broker 0 truncated logs and checkpointed recovery boundaries for partition __consumer_offsets-17 as part of become-follower request with correlation id 209 from controller 0 epoch 8 (state.change.logger)
[2017-06-26 23:42:24,569] TRACE Broker 0 truncated logs and checkpointed recovery boundaries for partition __consumer_offsets-23 as part of become-follower request with correlation id 209 from controller 0 epoch 8 (state.change.logger)
[2017-06-26 23:42:24,569] TRACE Broker 0 truncated logs and checkpointed recovery boundaries for partition __consumer_offsets-29 as part of become-follower request with correlation id 209 from controller 0 epoch 8 (state.change.logger)
[2017-06-26 23:42:24,569] TRACE Broker 0 truncated logs and checkpointed recovery boundaries for partition __consumer_offsets-35 as part of become-follower request with correlation id 209 from controller 0 epoch 8 (state.change.logger)
[2017-06-26 23:42:24,571] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,23] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:24,572] ERROR Error on broker 0 while processing LeaderAndIsr request with correlationId 209 received from controller 0 epoch 8 (state.change.logger)
java.lang.IllegalArgumentException: A metric named 'MetricName [name=connection-close-rate, group=replica-fetcher-metrics, description=Connections closed per second in the window., tags={broker-id=1, fetcher-id=0}]' already exists, can't register another one.
	at org.apache.kafka.common.metrics.Metrics.registerMetric(Metrics.java:433)
	at org.apache.kafka.common.metrics.Sensor.add(Sensor.java:249)
	at org.apache.kafka.common.metrics.Sensor.add(Sensor.java:234)
	at org.apache.kafka.common.network.Selector$SelectorMetrics.<init>(Selector.java:680)
	at org.apache.kafka.common.network.Selector.<init>(Selector.java:140)
	at kafka.server.ReplicaFetcherThread.<init>(ReplicaFetcherThread.scala:86)
	at kafka.server.ReplicaFetcherManager.createFetcherThread(ReplicaFetcherManager.scala:35)
	at kafka.server.AbstractFetcherManager$$anonfun$addFetcherForPartitions$2.apply(AbstractFetcherManager.scala:83)
	at kafka.server.AbstractFetcherManager$$anonfun$addFetcherForPartitions$2.apply(AbstractFetcherManager.scala:78)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.immutable.Map$Map1.foreach(Map.scala:116)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.server.AbstractFetcherManager.addFetcherForPartitions(AbstractFetcherManager.scala:78)
	at kafka.server.ReplicaManager.makeFollowers(ReplicaManager.scala:884)
	at kafka.server.ReplicaManager.becomeLeaderOrFollower(ReplicaManager.scala:702)
	at kafka.server.KafkaApis.handleLeaderAndIsrRequest(KafkaApis.scala:148)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:84)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
[2017-06-26 23:42:24,573] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=47,error_code=-1},{topic=__consumer_offsets,partition=14,error_code=-1},{topic=__consumer_offsets,partition=11,error_code=-1},{topic=__consumer_offsets,partition=44,error_code=-1},{topic=__consumer_offsets,partition=41,error_code=-1},{topic=__consumer_offsets,partition=23,error_code=-1},{topic=__consumer_offsets,partition=20,error_code=-1},{topic=__consumer_offsets,partition=17,error_code=-1},{topic=__consumer_offsets,partition=32,error_code=-1},{topic=__consumer_offsets,partition=29,error_code=-1},{topic=__consumer_offsets,partition=26,error_code=-1},{topic=__consumer_offsets,partition=8,error_code=-1},{topic=__consumer_offsets,partition=5,error_code=-1},{topic=__consumer_offsets,partition=38,error_code=-1},{topic=__consumer_offsets,partition=35,error_code=-1},{topic=__consumer_offsets,partition=2,error_code=-1}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:24,573] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-47 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 210 (state.change.logger)
[2017-06-26 23:42:24,573] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-14 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 210 (state.change.logger)
[2017-06-26 23:42:24,573] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-11 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 210 (state.change.logger)
[2017-06-26 23:42:24,573] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-44 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 210 (state.change.logger)
[2017-06-26 23:42:24,573] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-41 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 210 (state.change.logger)
[2017-06-26 23:42:24,573] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-23 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 210 (state.change.logger)
[2017-06-26 23:42:24,573] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-20 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 210 (state.change.logger)
[2017-06-26 23:42:24,573] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,48] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:24,573] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-17 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 210 (state.change.logger)
[2017-06-26 23:42:24,574] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-32 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 210 (state.change.logger)
[2017-06-26 23:42:24,574] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-29 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 210 (state.change.logger)
[2017-06-26 23:42:24,574] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-26 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 210 (state.change.logger)
[2017-06-26 23:42:24,574] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-8 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 210 (state.change.logger)
[2017-06-26 23:42:24,574] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-5 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 210 (state.change.logger)
[2017-06-26 23:42:24,574] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-38 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 210 (state.change.logger)
[2017-06-26 23:42:24,574] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-35 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 210 (state.change.logger)
[2017-06-26 23:42:24,574] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-2 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 210 (state.change.logger)
[2017-06-26 23:42:24,574] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:24,575] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,42] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:24,576] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,2] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:24,578] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,22] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:24,579] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,13] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:24,580] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,34] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:24,582] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,40] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:24,583] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,33] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:24,584] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,3] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:24,586] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,37] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:24,587] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,24] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:24,589] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,11] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:24,590] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,20] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:24,591] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,27] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:24,592] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,30] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:24,594] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,15] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:24,596] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,28] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:24,597] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,7] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:24,598] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=47,error_code=-1},{topic=__consumer_offsets,partition=14,error_code=-1},{topic=__consumer_offsets,partition=11,error_code=-1},{topic=__consumer_offsets,partition=44,error_code=-1},{topic=__consumer_offsets,partition=41,error_code=-1},{topic=__consumer_offsets,partition=23,error_code=-1},{topic=__consumer_offsets,partition=20,error_code=-1},{topic=__consumer_offsets,partition=17,error_code=-1},{topic=__consumer_offsets,partition=32,error_code=-1},{topic=__consumer_offsets,partition=29,error_code=-1},{topic=__consumer_offsets,partition=26,error_code=-1},{topic=__consumer_offsets,partition=8,error_code=-1},{topic=__consumer_offsets,partition=5,error_code=-1},{topic=__consumer_offsets,partition=38,error_code=-1},{topic=__consumer_offsets,partition=35,error_code=-1},{topic=__consumer_offsets,partition=2,error_code=-1}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:24,602] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:24,602] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,43] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:24,606] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,10] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:24,607] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,12] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:24,608] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,32] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:24,610] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,4] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:24,611] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,26] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:24,612] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,35] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:24,614] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,46] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:24,615] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,6] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:24,616] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,8] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:24,618] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,44] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:24,620] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,45] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:24,622] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,49] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:24,623] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,1] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:24,625] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,19] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:24,626] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,36] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:24,627] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,14] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:24,629] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,31] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:24,630] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,21] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:24,632] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,25] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:24,634] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,5] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:24,635] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,41] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:24,638] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,47] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:24,640] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,16] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:24,641] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,0] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:24,642] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,29] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:24,644] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,18] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:24,649] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [rf1p1,0] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:24,650] TRACE Controller 0 epoch 8 changed state of replica 2 for partition [__consumer_offsets,9] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:24,650] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,49] (state.change.logger)
[2017-06-26 23:42:24,650] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,38] (state.change.logger)
[2017-06-26 23:42:24,650] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,27] (state.change.logger)
[2017-06-26 23:42:24,650] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,16] (state.change.logger)
[2017-06-26 23:42:24,650] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,8] (state.change.logger)
[2017-06-26 23:42:24,650] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,19] (state.change.logger)
[2017-06-26 23:42:24,650] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,2] (state.change.logger)
[2017-06-26 23:42:24,650] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,13] (state.change.logger)
[2017-06-26 23:42:24,650] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,24] (state.change.logger)
[2017-06-26 23:42:24,650] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,35] (state.change.logger)
[2017-06-26 23:42:24,650] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,46] (state.change.logger)
[2017-06-26 23:42:24,650] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,5] (state.change.logger)
[2017-06-26 23:42:24,650] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,43] (state.change.logger)
[2017-06-26 23:42:24,650] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,32] (state.change.logger)
[2017-06-26 23:42:24,650] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,21] (state.change.logger)
[2017-06-26 23:42:24,650] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,10] (state.change.logger)
[2017-06-26 23:42:24,651] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,37] (state.change.logger)
[2017-06-26 23:42:24,651] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,48] (state.change.logger)
[2017-06-26 23:42:24,651] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,40] (state.change.logger)
[2017-06-26 23:42:24,651] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,29] (state.change.logger)
[2017-06-26 23:42:24,651] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,18] (state.change.logger)
[2017-06-26 23:42:24,651] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,7] (state.change.logger)
[2017-06-26 23:42:24,651] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,23] (state.change.logger)
[2017-06-26 23:42:24,651] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,34] (state.change.logger)
[2017-06-26 23:42:24,651] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,45] (state.change.logger)
[2017-06-26 23:42:24,651] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,26] (state.change.logger)
[2017-06-26 23:42:24,651] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,15] (state.change.logger)
[2017-06-26 23:42:24,651] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,4] (state.change.logger)
[2017-06-26 23:42:24,651] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,42] (state.change.logger)
[2017-06-26 23:42:24,651] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,9] (state.change.logger)
[2017-06-26 23:42:24,651] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,20] (state.change.logger)
[2017-06-26 23:42:24,651] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,31] (state.change.logger)
[2017-06-26 23:42:24,651] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,12] (state.change.logger)
[2017-06-26 23:42:24,651] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,1] (state.change.logger)
[2017-06-26 23:42:24,651] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,28] (state.change.logger)
[2017-06-26 23:42:24,651] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,17] (state.change.logger)
[2017-06-26 23:42:24,651] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,6] (state.change.logger)
[2017-06-26 23:42:24,651] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,39] (state.change.logger)
[2017-06-26 23:42:24,652] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,44] (state.change.logger)
[2017-06-26 23:42:24,652] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,36] (state.change.logger)
[2017-06-26 23:42:24,652] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,47] (state.change.logger)
[2017-06-26 23:42:24,652] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,3] (state.change.logger)
[2017-06-26 23:42:24,652] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,14] (state.change.logger)
[2017-06-26 23:42:24,652] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,25] (state.change.logger)
[2017-06-26 23:42:24,652] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,30] (state.change.logger)
[2017-06-26 23:42:24,652] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,41] (state.change.logger)
[2017-06-26 23:42:24,652] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,11] (state.change.logger)
[2017-06-26 23:42:24,652] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,22] (state.change.logger)
[2017-06-26 23:42:24,652] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,33] (state.change.logger)
[2017-06-26 23:42:24,652] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 1 for partition [__consumer_offsets,0] (state.change.logger)
[2017-06-26 23:42:24,653] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,49] (state.change.logger)
[2017-06-26 23:42:24,653] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,38] (state.change.logger)
[2017-06-26 23:42:24,653] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,27] (state.change.logger)
[2017-06-26 23:42:24,653] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,16] (state.change.logger)
[2017-06-26 23:42:24,653] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,8] (state.change.logger)
[2017-06-26 23:42:24,653] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,19] (state.change.logger)
[2017-06-26 23:42:24,653] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,2] (state.change.logger)
[2017-06-26 23:42:24,653] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,13] (state.change.logger)
[2017-06-26 23:42:24,653] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,24] (state.change.logger)
[2017-06-26 23:42:24,654] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,35] (state.change.logger)
[2017-06-26 23:42:24,654] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,46] (state.change.logger)
[2017-06-26 23:42:24,654] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,5] (state.change.logger)
[2017-06-26 23:42:24,654] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,43] (state.change.logger)
[2017-06-26 23:42:24,654] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,32] (state.change.logger)
[2017-06-26 23:42:24,654] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,21] (state.change.logger)
[2017-06-26 23:42:24,654] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,10] (state.change.logger)
[2017-06-26 23:42:24,654] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,37] (state.change.logger)
[2017-06-26 23:42:24,654] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,48] (state.change.logger)
[2017-06-26 23:42:24,654] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,40] (state.change.logger)
[2017-06-26 23:42:24,654] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,29] (state.change.logger)
[2017-06-26 23:42:24,654] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,18] (state.change.logger)
[2017-06-26 23:42:24,654] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,7] (state.change.logger)
[2017-06-26 23:42:24,654] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,23] (state.change.logger)
[2017-06-26 23:42:24,654] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,34] (state.change.logger)
[2017-06-26 23:42:24,654] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,45] (state.change.logger)
[2017-06-26 23:42:24,654] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,26] (state.change.logger)
[2017-06-26 23:42:24,654] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,15] (state.change.logger)
[2017-06-26 23:42:24,654] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,4] (state.change.logger)
[2017-06-26 23:42:24,654] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,42] (state.change.logger)
[2017-06-26 23:42:24,654] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,9] (state.change.logger)
[2017-06-26 23:42:24,654] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,20] (state.change.logger)
[2017-06-26 23:42:24,654] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,31] (state.change.logger)
[2017-06-26 23:42:24,654] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,12] (state.change.logger)
[2017-06-26 23:42:24,654] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,1] (state.change.logger)
[2017-06-26 23:42:24,654] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,28] (state.change.logger)
[2017-06-26 23:42:24,654] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,17] (state.change.logger)
[2017-06-26 23:42:24,654] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,6] (state.change.logger)
[2017-06-26 23:42:24,654] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,39] (state.change.logger)
[2017-06-26 23:42:24,655] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,44] (state.change.logger)
[2017-06-26 23:42:24,655] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,36] (state.change.logger)
[2017-06-26 23:42:24,655] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,47] (state.change.logger)
[2017-06-26 23:42:24,655] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,3] (state.change.logger)
[2017-06-26 23:42:24,655] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,14] (state.change.logger)
[2017-06-26 23:42:24,655] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,25] (state.change.logger)
[2017-06-26 23:42:24,655] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,30] (state.change.logger)
[2017-06-26 23:42:24,655] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,41] (state.change.logger)
[2017-06-26 23:42:24,655] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,11] (state.change.logger)
[2017-06-26 23:42:24,655] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,22] (state.change.logger)
[2017-06-26 23:42:24,655] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,33] (state.change.logger)
[2017-06-26 23:42:24,655] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,0] (state.change.logger)
[2017-06-26 23:42:24,655] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-49 (state.change.logger)
[2017-06-26 23:42:24,655] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-38 (state.change.logger)
[2017-06-26 23:42:24,655] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-16 (state.change.logger)
[2017-06-26 23:42:24,655] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-27 (state.change.logger)
[2017-06-26 23:42:24,655] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-19 (state.change.logger)
[2017-06-26 23:42:24,655] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-8 (state.change.logger)
[2017-06-26 23:42:24,655] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-13 (state.change.logger)
[2017-06-26 23:42:24,655] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-2 (state.change.logger)
[2017-06-26 23:42:24,655] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-46 (state.change.logger)
[2017-06-26 23:42:24,656] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-35 (state.change.logger)
[2017-06-26 23:42:24,656] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-24 (state.change.logger)
[2017-06-26 23:42:24,656] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-5 (state.change.logger)
[2017-06-26 23:42:24,656] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-43 (state.change.logger)
[2017-06-26 23:42:24,656] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-21 (state.change.logger)
[2017-06-26 23:42:24,656] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-32 (state.change.logger)
[2017-06-26 23:42:24,656] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-10 (state.change.logger)
[2017-06-26 23:42:24,656] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-37 (state.change.logger)
[2017-06-26 23:42:24,656] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-48 (state.change.logger)
[2017-06-26 23:42:24,656] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-18 (state.change.logger)
[2017-06-26 23:42:24,656] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-29 (state.change.logger)
[2017-06-26 23:42:24,656] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-40 (state.change.logger)
[2017-06-26 23:42:24,656] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-7 (state.change.logger)
[2017-06-26 23:42:24,656] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=8, replicas=[0, 1, 2]) correlation id 211 from controller 0 epoch 8 for partition [__consumer_offsets,13] (state.change.logger)
[2017-06-26 23:42:24,656] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-45 (state.change.logger)
[2017-06-26 23:42:24,656] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 211 from controller 0 epoch 8 for partition [__consumer_offsets,46] (state.change.logger)
[2017-06-26 23:42:24,656] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-34 (state.change.logger)
[2017-06-26 23:42:24,656] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 211 from controller 0 epoch 8 for partition [__consumer_offsets,9] (state.change.logger)
[2017-06-26 23:42:24,656] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-23 (state.change.logger)
[2017-06-26 23:42:24,656] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 211 from controller 0 epoch 8 for partition [__consumer_offsets,42] (state.change.logger)
[2017-06-26 23:42:24,656] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-26 (state.change.logger)
[2017-06-26 23:42:24,656] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 211 from controller 0 epoch 8 for partition [__consumer_offsets,21] (state.change.logger)
[2017-06-26 23:42:24,656] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-4 (state.change.logger)
[2017-06-26 23:42:24,656] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=5, isr=[1], zkVersion=8, replicas=[0, 1, 2]) correlation id 211 from controller 0 epoch 8 for partition [__consumer_offsets,17] (state.change.logger)
[2017-06-26 23:42:24,656] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-15 (state.change.logger)
[2017-06-26 23:42:24,656] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 211 from controller 0 epoch 8 for partition [__consumer_offsets,30] (state.change.logger)
[2017-06-26 23:42:24,656] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-42 (state.change.logger)
[2017-06-26 23:42:24,656] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=8, replicas=[0, 1, 2]) correlation id 211 from controller 0 epoch 8 for partition [__consumer_offsets,26] (state.change.logger)
[2017-06-26 23:42:24,656] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-9 (state.change.logger)
[2017-06-26 23:42:24,656] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-31 (state.change.logger)
[2017-06-26 23:42:24,656] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=5, isr=[1], zkVersion=8, replicas=[0, 1, 2]) correlation id 211 from controller 0 epoch 8 for partition [__consumer_offsets,5] (state.change.logger)
[2017-06-26 23:42:24,656] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-20 (state.change.logger)
[2017-06-26 23:42:24,656] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=8, replicas=[0, 1, 2]) correlation id 211 from controller 0 epoch 8 for partition [__consumer_offsets,38] (state.change.logger)
[2017-06-26 23:42:24,656] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-1 (state.change.logger)
[2017-06-26 23:42:24,656] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 211 from controller 0 epoch 8 for partition [__consumer_offsets,1] (state.change.logger)
[2017-06-26 23:42:24,656] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-12 (state.change.logger)
[2017-06-26 23:42:24,656] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 211 from controller 0 epoch 8 for partition [__consumer_offsets,34] (state.change.logger)
[2017-06-26 23:42:24,656] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-28 (state.change.logger)
[2017-06-26 23:42:24,656] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-17 (state.change.logger)
[2017-06-26 23:42:24,656] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 211 from controller 0 epoch 8 for partition [__consumer_offsets,16] (state.change.logger)
[2017-06-26 23:42:24,656] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-6 (state.change.logger)
[2017-06-26 23:42:24,656] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 211 from controller 0 epoch 8 for partition [__consumer_offsets,45] (state.change.logger)
[2017-06-26 23:42:24,656] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-39 (state.change.logger)
[2017-06-26 23:42:24,656] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 211 from controller 0 epoch 8 for partition [__consumer_offsets,12] (state.change.logger)
[2017-06-26 23:42:24,656] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-44 (state.change.logger)
[2017-06-26 23:42:24,656] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=5, isr=[1], zkVersion=8, replicas=[0, 1, 2]) correlation id 211 from controller 0 epoch 8 for partition [__consumer_offsets,41] (state.change.logger)
[2017-06-26 23:42:24,656] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-47 (state.change.logger)
[2017-06-26 23:42:24,656] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-36 (state.change.logger)
[2017-06-26 23:42:24,656] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 211 from controller 0 epoch 8 for partition [__consumer_offsets,24] (state.change.logger)
[2017-06-26 23:42:24,657] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:8,ControllerEpoch:8) to brokers Set(0, 1) for partition rf1p1-0 (state.change.logger)
[2017-06-26 23:42:24,657] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=8, replicas=[0, 1, 2]) correlation id 211 from controller 0 epoch 8 for partition [__consumer_offsets,20] (state.change.logger)
[2017-06-26 23:42:24,657] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-25 (state.change.logger)
[2017-06-26 23:42:24,657] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 211 from controller 0 epoch 8 for partition [__consumer_offsets,49] (state.change.logger)
[2017-06-26 23:42:24,657] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-14 (state.change.logger)
[2017-06-26 23:42:24,657] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-3 (state.change.logger)
[2017-06-26 23:42:24,657] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 211 from controller 0 epoch 8 for partition [__consumer_offsets,0] (state.change.logger)
[2017-06-26 23:42:24,657] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-41 (state.change.logger)
[2017-06-26 23:42:24,657] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=5, isr=[1], zkVersion=8, replicas=[0, 1, 2]) correlation id 211 from controller 0 epoch 8 for partition [__consumer_offsets,29] (state.change.logger)
[2017-06-26 23:42:24,657] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-30 (state.change.logger)
[2017-06-26 23:42:24,657] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 211 from controller 0 epoch 8 for partition [__consumer_offsets,25] (state.change.logger)
[2017-06-26 23:42:24,657] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-11 (state.change.logger)
[2017-06-26 23:42:24,657] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=8, replicas=[0, 1, 2]) correlation id 211 from controller 0 epoch 8 for partition [__consumer_offsets,8] (state.change.logger)
[2017-06-26 23:42:24,657] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-33 (state.change.logger)
[2017-06-26 23:42:24,657] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=7, replicas=[0, 1, 2]) correlation id 211 from controller 0 epoch 8 for partition [__consumer_offsets,37] (state.change.logger)
[2017-06-26 23:42:24,657] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-22 (state.change.logger)
[2017-06-26 23:42:24,657] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=7, replicas=[0, 1, 2]) correlation id 211 from controller 0 epoch 8 for partition [__consumer_offsets,4] (state.change.logger)
[2017-06-26 23:42:24,657] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-0 (state.change.logger)
[2017-06-26 23:42:24,657] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 211 from controller 0 epoch 8 for partition [__consumer_offsets,33] (state.change.logger)
[2017-06-26 23:42:24,657] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 211 from controller 0 epoch 8 for partition [__consumer_offsets,15] (state.change.logger)
[2017-06-26 23:42:24,657] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 211 from controller 0 epoch 8 for partition [__consumer_offsets,48] (state.change.logger)
[2017-06-26 23:42:24,657] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=5, isr=[1], zkVersion=8, replicas=[0, 1, 2]) correlation id 211 from controller 0 epoch 8 for partition [__consumer_offsets,11] (state.change.logger)
[2017-06-26 23:42:24,657] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=8, replicas=[0, 1, 2]) correlation id 211 from controller 0 epoch 8 for partition [__consumer_offsets,44] (state.change.logger)
[2017-06-26 23:42:24,657] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=5, isr=[1], zkVersion=8, replicas=[0, 1, 2]) correlation id 211 from controller 0 epoch 8 for partition [__consumer_offsets,23] (state.change.logger)
[2017-06-26 23:42:24,657] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 211 from controller 0 epoch 8 for partition [__consumer_offsets,19] (state.change.logger)
[2017-06-26 23:42:24,657] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=8, replicas=[0, 1, 2]) correlation id 211 from controller 0 epoch 8 for partition [__consumer_offsets,32] (state.change.logger)
[2017-06-26 23:42:24,657] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 211 from controller 0 epoch 8 for partition [__consumer_offsets,28] (state.change.logger)
[2017-06-26 23:42:24,657] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 211 from controller 0 epoch 8 for partition [__consumer_offsets,7] (state.change.logger)
[2017-06-26 23:42:24,657] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 211 from controller 0 epoch 8 for partition [__consumer_offsets,40] (state.change.logger)
[2017-06-26 23:42:24,657] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 211 from controller 0 epoch 8 for partition [__consumer_offsets,3] (state.change.logger)
[2017-06-26 23:42:24,657] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 211 from controller 0 epoch 8 for partition [__consumer_offsets,36] (state.change.logger)
[2017-06-26 23:42:24,657] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=5, isr=[1], zkVersion=8, replicas=[0, 1, 2]) correlation id 211 from controller 0 epoch 8 for partition [__consumer_offsets,47] (state.change.logger)
[2017-06-26 23:42:24,657] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=8, replicas=[0, 1, 2]) correlation id 211 from controller 0 epoch 8 for partition [__consumer_offsets,14] (state.change.logger)
[2017-06-26 23:42:24,657] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 211 from controller 0 epoch 8 for partition [__consumer_offsets,43] (state.change.logger)
[2017-06-26 23:42:24,657] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 211 from controller 0 epoch 8 for partition [__consumer_offsets,10] (state.change.logger)
[2017-06-26 23:42:24,657] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=7, replicas=[0, 1, 2]) correlation id 211 from controller 0 epoch 8 for partition [__consumer_offsets,22] (state.change.logger)
[2017-06-26 23:42:24,657] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 211 from controller 0 epoch 8 for partition [__consumer_offsets,18] (state.change.logger)
[2017-06-26 23:42:24,657] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=4, isr=[1], zkVersion=5, replicas=[0, 1, 2]) correlation id 211 from controller 0 epoch 8 for partition [__consumer_offsets,31] (state.change.logger)
[2017-06-26 23:42:24,657] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 211 from controller 0 epoch 8 for partition [__consumer_offsets,27] (state.change.logger)
[2017-06-26 23:42:24,657] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 211 from controller 0 epoch 8 for partition [__consumer_offsets,39] (state.change.logger)
[2017-06-26 23:42:24,657] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 211 from controller 0 epoch 8 for partition [__consumer_offsets,6] (state.change.logger)
[2017-06-26 23:42:24,657] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=1, leaderEpoch=5, isr=[1], zkVersion=8, replicas=[0, 1, 2]) correlation id 211 from controller 0 epoch 8 for partition [__consumer_offsets,35] (state.change.logger)
[2017-06-26 23:42:24,657] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=8, replicas=[0, 1, 2]) correlation id 211 from controller 0 epoch 8 for partition [__consumer_offsets,2] (state.change.logger)
[2017-06-26 23:42:24,657] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 211 epoch 8 for partition [__consumer_offsets,13] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:24,657] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 211 epoch 8 for partition [__consumer_offsets,46] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:24,657] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 211 epoch 8 for partition [__consumer_offsets,9] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:24,657] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 211 epoch 8 for partition [__consumer_offsets,42] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:24,658] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 211 epoch 8 for partition [__consumer_offsets,21] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:24,658] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 211 epoch 8 for partition [__consumer_offsets,17] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:42:24,658] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 211 epoch 8 for partition [__consumer_offsets,30] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:24,658] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 211 epoch 8 for partition [__consumer_offsets,26] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:42:24,658] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 211 epoch 8 for partition [__consumer_offsets,5] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:42:24,658] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 211 epoch 8 for partition [__consumer_offsets,38] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:42:24,658] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 211 epoch 8 for partition [__consumer_offsets,1] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:24,658] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 211 epoch 8 for partition [__consumer_offsets,34] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:24,658] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 211 epoch 8 for partition [__consumer_offsets,16] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:24,658] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 211 epoch 8 for partition [__consumer_offsets,45] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:24,658] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 211 epoch 8 for partition [__consumer_offsets,12] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:24,658] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 211 epoch 8 for partition [__consumer_offsets,41] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:42:24,658] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 211 epoch 8 for partition [__consumer_offsets,24] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:24,658] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 211 epoch 8 for partition [__consumer_offsets,20] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:42:24,658] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 211 epoch 8 for partition [__consumer_offsets,49] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:24,658] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 211 epoch 8 for partition [__consumer_offsets,0] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:24,658] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 211 epoch 8 for partition [__consumer_offsets,29] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:42:24,658] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 211 epoch 8 for partition [__consumer_offsets,25] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:24,658] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 211 epoch 8 for partition [__consumer_offsets,8] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:42:24,658] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 211 epoch 8 for partition [__consumer_offsets,37] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:24,658] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 211 epoch 8 for partition [__consumer_offsets,4] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:24,658] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 211 epoch 8 for partition [__consumer_offsets,33] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:24,658] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 211 epoch 8 for partition [__consumer_offsets,15] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:24,658] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 211 epoch 8 for partition [__consumer_offsets,48] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:24,658] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 211 epoch 8 for partition [__consumer_offsets,11] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:42:24,658] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 211 epoch 8 for partition [__consumer_offsets,44] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:42:24,658] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 211 epoch 8 for partition [__consumer_offsets,23] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:42:24,658] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 211 epoch 8 for partition [__consumer_offsets,19] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:24,658] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 211 epoch 8 for partition [__consumer_offsets,32] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:42:24,658] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 211 epoch 8 for partition [__consumer_offsets,28] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:24,658] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 211 epoch 8 for partition [__consumer_offsets,7] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:24,658] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 211 epoch 8 for partition [__consumer_offsets,40] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:24,658] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 211 epoch 8 for partition [__consumer_offsets,3] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:24,658] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 211 epoch 8 for partition [__consumer_offsets,36] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:24,658] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 211 epoch 8 for partition [__consumer_offsets,47] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:42:24,658] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 211 epoch 8 for partition [__consumer_offsets,14] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:42:24,658] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 211 epoch 8 for partition [__consumer_offsets,43] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:24,658] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 211 epoch 8 for partition [__consumer_offsets,10] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:24,659] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 211 epoch 8 for partition [__consumer_offsets,22] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:24,659] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 211 epoch 8 for partition [__consumer_offsets,18] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:24,659] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 211 epoch 8 for partition [__consumer_offsets,31] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:24,659] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 211 epoch 8 for partition [__consumer_offsets,27] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:24,659] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 211 epoch 8 for partition [__consumer_offsets,39] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:24,659] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 211 epoch 8 for partition [__consumer_offsets,6] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:24,659] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 211 epoch 8 for partition [__consumer_offsets,35] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:42:24,659] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 211 epoch 8 for partition [__consumer_offsets,2] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:42:24,662] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=49,error_code=11},{topic=__consumer_offsets,partition=38,error_code=11},{topic=__consumer_offsets,partition=16,error_code=11},{topic=__consumer_offsets,partition=27,error_code=11},{topic=__consumer_offsets,partition=8,error_code=11},{topic=__consumer_offsets,partition=19,error_code=11},{topic=__consumer_offsets,partition=2,error_code=11},{topic=__consumer_offsets,partition=13,error_code=11},{topic=__consumer_offsets,partition=24,error_code=11},{topic=__consumer_offsets,partition=46,error_code=11},{topic=__consumer_offsets,partition=35,error_code=11},{topic=__consumer_offsets,partition=5,error_code=11},{topic=__consumer_offsets,partition=43,error_code=11},{topic=__consumer_offsets,partition=21,error_code=11},{topic=__consumer_offsets,partition=32,error_code=11},{topic=__consumer_offsets,partition=10,error_code=11},{topic=__consumer_offsets,partition=37,error_code=11},{topic=__consumer_offsets,partition=48,error_code=11},{topic=__consumer_offsets,partition=29,error_code=11},{topic=__consumer_offsets,partition=40,error_code=11},{topic=__consumer_offsets,partition=18,error_code=11},{topic=__consumer_offsets,partition=7,error_code=11},{topic=__consumer_offsets,partition=45,error_code=11},{topic=__consumer_offsets,partition=34,error_code=11},{topic=__consumer_offsets,partition=23,error_code=11},{topic=__consumer_offsets,partition=26,error_code=11},{topic=__consumer_offsets,partition=4,error_code=11},{topic=__consumer_offsets,partition=15,error_code=11},{topic=__consumer_offsets,partition=42,error_code=11},{topic=__consumer_offsets,partition=20,error_code=11},{topic=__consumer_offsets,partition=9,error_code=11},{topic=__consumer_offsets,partition=31,error_code=11},{topic=__consumer_offsets,partition=12,error_code=11},{topic=__consumer_offsets,partition=1,error_code=11},{topic=__consumer_offsets,partition=17,error_code=11},{topic=__consumer_offsets,partition=28,error_code=11},{topic=__consumer_offsets,partition=6,error_code=11},{topic=__consumer_offsets,partition=39,error_code=11},{topic=__consumer_offsets,partition=44,error_code=11},{topic=__consumer_offsets,partition=36,error_code=11},{topic=__consumer_offsets,partition=47,error_code=11},{topic=__consumer_offsets,partition=25,error_code=11},{topic=__consumer_offsets,partition=3,error_code=11},{topic=__consumer_offsets,partition=14,error_code=11},{topic=__consumer_offsets,partition=41,error_code=11},{topic=__consumer_offsets,partition=30,error_code=11},{topic=__consumer_offsets,partition=33,error_code=11},{topic=__consumer_offsets,partition=11,error_code=11},{topic=__consumer_offsets,partition=22,error_code=11},{topic=__consumer_offsets,partition=0,error_code=11}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:24,665] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:24,668] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=49,error_code=11},{topic=__consumer_offsets,partition=38,error_code=11},{topic=__consumer_offsets,partition=16,error_code=11},{topic=__consumer_offsets,partition=27,error_code=11},{topic=__consumer_offsets,partition=8,error_code=11},{topic=__consumer_offsets,partition=19,error_code=11},{topic=__consumer_offsets,partition=2,error_code=11},{topic=__consumer_offsets,partition=13,error_code=11},{topic=__consumer_offsets,partition=24,error_code=11},{topic=__consumer_offsets,partition=46,error_code=11},{topic=__consumer_offsets,partition=35,error_code=11},{topic=__consumer_offsets,partition=5,error_code=11},{topic=__consumer_offsets,partition=43,error_code=11},{topic=__consumer_offsets,partition=21,error_code=11},{topic=__consumer_offsets,partition=32,error_code=11},{topic=__consumer_offsets,partition=10,error_code=11},{topic=__consumer_offsets,partition=37,error_code=11},{topic=__consumer_offsets,partition=48,error_code=11},{topic=__consumer_offsets,partition=29,error_code=11},{topic=__consumer_offsets,partition=40,error_code=11},{topic=__consumer_offsets,partition=18,error_code=11},{topic=__consumer_offsets,partition=7,error_code=11},{topic=__consumer_offsets,partition=45,error_code=11},{topic=__consumer_offsets,partition=34,error_code=11},{topic=__consumer_offsets,partition=23,error_code=11},{topic=__consumer_offsets,partition=26,error_code=11},{topic=__consumer_offsets,partition=4,error_code=11},{topic=__consumer_offsets,partition=15,error_code=11},{topic=__consumer_offsets,partition=42,error_code=11},{topic=__consumer_offsets,partition=20,error_code=11},{topic=__consumer_offsets,partition=9,error_code=11},{topic=__consumer_offsets,partition=31,error_code=11},{topic=__consumer_offsets,partition=12,error_code=11},{topic=__consumer_offsets,partition=1,error_code=11},{topic=__consumer_offsets,partition=17,error_code=11},{topic=__consumer_offsets,partition=28,error_code=11},{topic=__consumer_offsets,partition=6,error_code=11},{topic=__consumer_offsets,partition=39,error_code=11},{topic=__consumer_offsets,partition=44,error_code=11},{topic=__consumer_offsets,partition=36,error_code=11},{topic=__consumer_offsets,partition=47,error_code=11},{topic=__consumer_offsets,partition=25,error_code=11},{topic=__consumer_offsets,partition=3,error_code=11},{topic=__consumer_offsets,partition=14,error_code=11},{topic=__consumer_offsets,partition=41,error_code=11},{topic=__consumer_offsets,partition=30,error_code=11},{topic=__consumer_offsets,partition=33,error_code=11},{topic=__consumer_offsets,partition=11,error_code=11},{topic=__consumer_offsets,partition=22,error_code=11},{topic=__consumer_offsets,partition=0,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:24,672] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-13 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 212 (state.change.logger)
[2017-06-26 23:42:24,672] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-46 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 212 (state.change.logger)
[2017-06-26 23:42:24,672] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-9 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 212 (state.change.logger)
[2017-06-26 23:42:24,672] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-42 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 212 (state.change.logger)
[2017-06-26 23:42:24,672] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-21 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 212 (state.change.logger)
[2017-06-26 23:42:24,672] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-17 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 212 (state.change.logger)
[2017-06-26 23:42:24,672] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-30 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 212 (state.change.logger)
[2017-06-26 23:42:24,672] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-26 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 212 (state.change.logger)
[2017-06-26 23:42:24,672] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-5 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 212 (state.change.logger)
[2017-06-26 23:42:24,672] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-38 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 212 (state.change.logger)
[2017-06-26 23:42:24,672] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-1 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 212 (state.change.logger)
[2017-06-26 23:42:24,672] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-34 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 212 (state.change.logger)
[2017-06-26 23:42:24,672] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-16 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 212 (state.change.logger)
[2017-06-26 23:42:24,672] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-45 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 212 (state.change.logger)
[2017-06-26 23:42:24,672] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-12 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 212 (state.change.logger)
[2017-06-26 23:42:24,672] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-41 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 212 (state.change.logger)
[2017-06-26 23:42:24,672] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-24 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 212 (state.change.logger)
[2017-06-26 23:42:24,672] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-20 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 212 (state.change.logger)
[2017-06-26 23:42:24,672] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-49 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 212 (state.change.logger)
[2017-06-26 23:42:24,672] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-0 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 212 (state.change.logger)
[2017-06-26 23:42:24,672] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-29 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 212 (state.change.logger)
[2017-06-26 23:42:24,673] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-25 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 212 (state.change.logger)
[2017-06-26 23:42:24,673] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-8 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 212 (state.change.logger)
[2017-06-26 23:42:24,673] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-37 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 212 (state.change.logger)
[2017-06-26 23:42:24,673] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-4 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 212 (state.change.logger)
[2017-06-26 23:42:24,673] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-33 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 212 (state.change.logger)
[2017-06-26 23:42:24,673] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-15 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 212 (state.change.logger)
[2017-06-26 23:42:24,673] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-48 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 212 (state.change.logger)
[2017-06-26 23:42:24,673] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-11 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 212 (state.change.logger)
[2017-06-26 23:42:24,673] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-44 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 212 (state.change.logger)
[2017-06-26 23:42:24,673] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-23 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 212 (state.change.logger)
[2017-06-26 23:42:24,673] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:8,ControllerEpoch:8),ReplicationFactor:1),AllReplicas:2) for partition rf1p1-0 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 212 (state.change.logger)
[2017-06-26 23:42:24,673] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-19 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 212 (state.change.logger)
[2017-06-26 23:42:24,673] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-32 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 212 (state.change.logger)
[2017-06-26 23:42:24,673] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-28 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 212 (state.change.logger)
[2017-06-26 23:42:24,673] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-7 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 212 (state.change.logger)
[2017-06-26 23:42:24,673] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-40 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 212 (state.change.logger)
[2017-06-26 23:42:24,674] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-3 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 212 (state.change.logger)
[2017-06-26 23:42:24,674] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-36 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 212 (state.change.logger)
[2017-06-26 23:42:24,674] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-47 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 212 (state.change.logger)
[2017-06-26 23:42:24,674] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-14 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 212 (state.change.logger)
[2017-06-26 23:42:24,674] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-43 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 212 (state.change.logger)
[2017-06-26 23:42:24,674] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-10 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 212 (state.change.logger)
[2017-06-26 23:42:24,674] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-22 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 212 (state.change.logger)
[2017-06-26 23:42:24,674] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-18 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 212 (state.change.logger)
[2017-06-26 23:42:24,674] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-31 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 212 (state.change.logger)
[2017-06-26 23:42:24,674] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-27 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 212 (state.change.logger)
[2017-06-26 23:42:24,675] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-39 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 212 (state.change.logger)
[2017-06-26 23:42:24,675] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-6 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 212 (state.change.logger)
[2017-06-26 23:42:24,675] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-35 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 212 (state.change.logger)
[2017-06-26 23:42:24,675] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-2 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 212 (state.change.logger)
[2017-06-26 23:42:24,675] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:28,500] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,43] (state.change.logger)
[2017-06-26 23:42:28,502] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,43] due to: No other replicas in ISR 1 for [__consumer_offsets,43] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:28,502] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,43] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,43] due to: No other replicas in ISR 1 for [__consumer_offsets,43] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,43] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:42:28,504] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,14] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:28,504] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,14] (state.change.logger)
[2017-06-26 23:42:28,504] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,14] (state.change.logger)
[2017-06-26 23:42:28,504] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-14 (state.change.logger)
[2017-06-26 23:42:28,504] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,28] (state.change.logger)
[2017-06-26 23:42:28,504] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=14,error_code=0}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,505] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=8, replicas=[0, 1, 2]) correlation id 213 from controller 0 epoch 8 for partition [__consumer_offsets,14] (state.change.logger)
[2017-06-26 23:42:28,505] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 213 epoch 8 for partition [__consumer_offsets,14] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:42:28,505] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=14,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:28,505] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-14 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 214 (state.change.logger)
[2017-06-26 23:42:28,505] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:28,505] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,506] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=14,error_code=0}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,506] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,28] due to: No other replicas in ISR 1 for [__consumer_offsets,28] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:28,506] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,28] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,28] due to: No other replicas in ISR 1 for [__consumer_offsets,28] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,28] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:42:28,506] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,4] (state.change.logger)
[2017-06-26 23:42:28,508] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,4] due to: No other replicas in ISR 1 for [__consumer_offsets,4] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:28,508] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,4] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,4] due to: No other replicas in ISR 1 for [__consumer_offsets,4] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,4] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:42:28,509] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=36,error_code=0}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,509] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,36] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:28,509] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,36] (state.change.logger)
[2017-06-26 23:42:28,510] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,36] (state.change.logger)
[2017-06-26 23:42:28,510] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-36 (state.change.logger)
[2017-06-26 23:42:28,510] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 215 from controller 0 epoch 8 for partition [__consumer_offsets,36] (state.change.logger)
[2017-06-26 23:42:28,510] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 215 epoch 8 for partition [__consumer_offsets,36] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:28,510] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=36,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:28,510] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,510] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-36 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 216 (state.change.logger)
[2017-06-26 23:42:28,510] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:28,510] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=36,error_code=0}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,511] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=6,error_code=0}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,511] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,6] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:28,511] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,6] (state.change.logger)
[2017-06-26 23:42:28,511] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,6] (state.change.logger)
[2017-06-26 23:42:28,512] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-6 (state.change.logger)
[2017-06-26 23:42:28,512] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 217 from controller 0 epoch 8 for partition [__consumer_offsets,6] (state.change.logger)
[2017-06-26 23:42:28,512] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 217 epoch 8 for partition [__consumer_offsets,6] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:28,512] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,512] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=6,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:28,512] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-6 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 218 (state.change.logger)
[2017-06-26 23:42:28,512] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:28,513] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=6,error_code=0}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,513] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=39,error_code=0}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,513] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,39] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:28,513] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,39] (state.change.logger)
[2017-06-26 23:42:28,514] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,39] (state.change.logger)
[2017-06-26 23:42:28,514] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-39 (state.change.logger)
[2017-06-26 23:42:28,514] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,23] (state.change.logger)
[2017-06-26 23:42:28,514] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 219 from controller 0 epoch 8 for partition [__consumer_offsets,39] (state.change.logger)
[2017-06-26 23:42:28,514] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 219 epoch 8 for partition [__consumer_offsets,39] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:28,514] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=39,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:28,514] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,514] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-39 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 220 (state.change.logger)
[2017-06-26 23:42:28,514] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:28,514] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=39,error_code=0}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,515] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,23] due to: No other replicas in ISR 1 for [__consumer_offsets,23] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:28,515] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,23] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,23] due to: No other replicas in ISR 1 for [__consumer_offsets,23] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,23] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 23:42:28,516] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=24,error_code=0}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,517] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,24] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:28,517] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,24] (state.change.logger)
[2017-06-26 23:42:28,517] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,24] (state.change.logger)
[2017-06-26 23:42:28,517] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-24 (state.change.logger)
[2017-06-26 23:42:28,517] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 221 from controller 0 epoch 8 for partition [__consumer_offsets,24] (state.change.logger)
[2017-06-26 23:42:28,517] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 221 epoch 8 for partition [__consumer_offsets,24] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:28,517] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=24,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:28,517] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,517] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-24 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 222 (state.change.logger)
[2017-06-26 23:42:28,518] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:28,518] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=24,error_code=0}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,518] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=38,error_code=0}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,519] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,38] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:28,519] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,38] (state.change.logger)
[2017-06-26 23:42:28,519] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,38] (state.change.logger)
[2017-06-26 23:42:28,519] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-38 (state.change.logger)
[2017-06-26 23:42:28,519] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,16] (state.change.logger)
[2017-06-26 23:42:28,519] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=8, replicas=[0, 1, 2]) correlation id 223 from controller 0 epoch 8 for partition [__consumer_offsets,38] (state.change.logger)
[2017-06-26 23:42:28,519] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 223 epoch 8 for partition [__consumer_offsets,38] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:42:28,519] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,519] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=38,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:28,519] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-38 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 224 (state.change.logger)
[2017-06-26 23:42:28,519] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:28,519] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=38,error_code=0}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,520] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,16] due to: No other replicas in ISR 1 for [__consumer_offsets,16] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:28,520] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,16] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,16] due to: No other replicas in ISR 1 for [__consumer_offsets,16] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,16] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 24 more
[2017-06-26 23:42:28,521] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=3,error_code=0}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,522] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,3] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:28,522] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,3] (state.change.logger)
[2017-06-26 23:42:28,522] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,3] (state.change.logger)
[2017-06-26 23:42:28,522] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-3 (state.change.logger)
[2017-06-26 23:42:28,522] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 225 from controller 0 epoch 8 for partition [__consumer_offsets,3] (state.change.logger)
[2017-06-26 23:42:28,522] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 225 epoch 8 for partition [__consumer_offsets,3] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:28,522] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,522] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=3,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:28,523] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-3 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 226 (state.change.logger)
[2017-06-26 23:42:28,523] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:28,523] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=3,error_code=0}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,523] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=21,error_code=0}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,524] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,21] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:28,524] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,21] (state.change.logger)
[2017-06-26 23:42:28,524] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,21] (state.change.logger)
[2017-06-26 23:42:28,524] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-21 (state.change.logger)
[2017-06-26 23:42:28,524] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,10] (state.change.logger)
[2017-06-26 23:42:28,524] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 227 from controller 0 epoch 8 for partition [__consumer_offsets,21] (state.change.logger)
[2017-06-26 23:42:28,524] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 227 epoch 8 for partition [__consumer_offsets,21] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:28,524] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,524] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=21,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:28,524] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-21 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 228 (state.change.logger)
[2017-06-26 23:42:28,524] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:28,525] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=21,error_code=0}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,525] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,10] due to: No other replicas in ISR 1 for [__consumer_offsets,10] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:28,525] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,10] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,10] due to: No other replicas in ISR 1 for [__consumer_offsets,10] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,10] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:42:28,526] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,40] (state.change.logger)
[2017-06-26 23:42:28,527] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,40] due to: No other replicas in ISR 1 for [__consumer_offsets,40] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:28,527] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,40] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,40] due to: No other replicas in ISR 1 for [__consumer_offsets,40] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,40] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:42:28,527] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,34] (state.change.logger)
[2017-06-26 23:42:28,528] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,34] due to: No other replicas in ISR 1 for [__consumer_offsets,34] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:28,528] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,34] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,34] due to: No other replicas in ISR 1 for [__consumer_offsets,34] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,34] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 23:42:28,528] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,25] (state.change.logger)
[2017-06-26 23:42:28,530] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,25] due to: No other replicas in ISR 1 for [__consumer_offsets,25] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:28,530] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,25] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,25] due to: No other replicas in ISR 1 for [__consumer_offsets,25] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,25] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:42:28,530] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=27,error_code=0}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,531] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,27] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:28,531] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,27] (state.change.logger)
[2017-06-26 23:42:28,531] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,27] (state.change.logger)
[2017-06-26 23:42:28,532] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-27 (state.change.logger)
[2017-06-26 23:42:28,532] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 229 from controller 0 epoch 8 for partition [__consumer_offsets,27] (state.change.logger)
[2017-06-26 23:42:28,532] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 229 epoch 8 for partition [__consumer_offsets,27] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:28,532] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=27,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:28,533] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,533] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-27 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 230 (state.change.logger)
[2017-06-26 23:42:28,534] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:28,534] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=27,error_code=0}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,535] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=42,error_code=0}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,536] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,42] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:28,536] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,42] (state.change.logger)
[2017-06-26 23:42:28,536] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,42] (state.change.logger)
[2017-06-26 23:42:28,536] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-42 (state.change.logger)
[2017-06-26 23:42:28,536] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 231 from controller 0 epoch 8 for partition [__consumer_offsets,42] (state.change.logger)
[2017-06-26 23:42:28,536] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,11] (state.change.logger)
[2017-06-26 23:42:28,536] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 231 epoch 8 for partition [__consumer_offsets,42] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:28,536] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=42,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:28,536] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,536] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-42 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 232 (state.change.logger)
[2017-06-26 23:42:28,537] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:28,537] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=42,error_code=0}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,538] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,11] due to: No other replicas in ISR 1 for [__consumer_offsets,11] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:28,538] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,11] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,11] due to: No other replicas in ISR 1 for [__consumer_offsets,11] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,11] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:42:28,538] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,7] (state.change.logger)
[2017-06-26 23:42:28,540] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,7] due to: No other replicas in ISR 1 for [__consumer_offsets,7] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:28,540] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,7] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,7] due to: No other replicas in ISR 1 for [__consumer_offsets,7] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,7] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:42:28,540] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,47] (state.change.logger)
[2017-06-26 23:42:28,541] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,47] due to: No other replicas in ISR 1 for [__consumer_offsets,47] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:28,541] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,47] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,47] due to: No other replicas in ISR 1 for [__consumer_offsets,47] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,47] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:42:28,542] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=9,error_code=0}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,543] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,9] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:28,543] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,9] (state.change.logger)
[2017-06-26 23:42:28,543] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,9] (state.change.logger)
[2017-06-26 23:42:28,543] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-9 (state.change.logger)
[2017-06-26 23:42:28,544] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 233 from controller 0 epoch 8 for partition [__consumer_offsets,9] (state.change.logger)
[2017-06-26 23:42:28,544] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,13] (state.change.logger)
[2017-06-26 23:42:28,544] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 233 epoch 8 for partition [__consumer_offsets,9] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:28,544] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,544] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=9,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:28,544] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-9 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 234 (state.change.logger)
[2017-06-26 23:42:28,544] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=9,error_code=0}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,544] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:28,545] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,13] due to: No other replicas in ISR 1 for [__consumer_offsets,13] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:28,545] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,13] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,13] due to: No other replicas in ISR 1 for [__consumer_offsets,13] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,13] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 23:42:28,545] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,29] (state.change.logger)
[2017-06-26 23:42:28,546] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,29] due to: No other replicas in ISR 1 for [__consumer_offsets,29] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:28,546] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,29] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,29] due to: No other replicas in ISR 1 for [__consumer_offsets,29] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,29] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:42:28,547] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=8,error_code=0}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,548] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,8] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:28,548] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,8] (state.change.logger)
[2017-06-26 23:42:28,548] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,8] (state.change.logger)
[2017-06-26 23:42:28,548] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-8 (state.change.logger)
[2017-06-26 23:42:28,549] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,22] (state.change.logger)
[2017-06-26 23:42:28,549] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=8, replicas=[0, 1, 2]) correlation id 235 from controller 0 epoch 8 for partition [__consumer_offsets,8] (state.change.logger)
[2017-06-26 23:42:28,549] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 235 epoch 8 for partition [__consumer_offsets,8] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:42:28,549] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,549] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=8,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:28,549] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-8 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 236 (state.change.logger)
[2017-06-26 23:42:28,549] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=8,error_code=0}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,549] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:28,550] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,22] due to: No other replicas in ISR 1 for [__consumer_offsets,22] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:28,550] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,22] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,22] due to: No other replicas in ISR 1 for [__consumer_offsets,22] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,22] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:42:28,550] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,31] (state.change.logger)
[2017-06-26 23:42:28,551] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,31] due to: No other replicas in ISR 1 for [__consumer_offsets,31] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:28,551] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,31] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,31] due to: No other replicas in ISR 1 for [__consumer_offsets,31] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,31] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 23:42:28,552] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=18,error_code=0}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,553] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,18] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:28,553] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,18] (state.change.logger)
[2017-06-26 23:42:28,553] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,18] (state.change.logger)
[2017-06-26 23:42:28,554] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-18 (state.change.logger)
[2017-06-26 23:42:28,554] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 237 from controller 0 epoch 8 for partition [__consumer_offsets,18] (state.change.logger)
[2017-06-26 23:42:28,554] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 237 epoch 8 for partition [__consumer_offsets,18] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:28,554] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=18,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:28,554] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,555] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-18 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 238 (state.change.logger)
[2017-06-26 23:42:28,555] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=18,error_code=0}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,555] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:28,556] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=20,error_code=0}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,557] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,20] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:28,557] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,20] (state.change.logger)
[2017-06-26 23:42:28,557] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,20] (state.change.logger)
[2017-06-26 23:42:28,557] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-20 (state.change.logger)
[2017-06-26 23:42:28,557] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,37] (state.change.logger)
[2017-06-26 23:42:28,557] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=8, replicas=[0, 1, 2]) correlation id 239 from controller 0 epoch 8 for partition [__consumer_offsets,20] (state.change.logger)
[2017-06-26 23:42:28,557] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 239 epoch 8 for partition [__consumer_offsets,20] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:42:28,557] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=20,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:28,557] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,557] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-20 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 240 (state.change.logger)
[2017-06-26 23:42:28,558] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:28,558] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=20,error_code=0}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,558] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,37] due to: No other replicas in ISR 1 for [__consumer_offsets,37] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:28,558] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,37] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,37] due to: No other replicas in ISR 1 for [__consumer_offsets,37] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,37] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 23:42:28,559] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,49] (state.change.logger)
[2017-06-26 23:42:28,560] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,49] due to: No other replicas in ISR 1 for [__consumer_offsets,49] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:28,560] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,49] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,49] due to: No other replicas in ISR 1 for [__consumer_offsets,49] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,49] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:42:28,561] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=12,error_code=0}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,561] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,12] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:28,561] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,12] (state.change.logger)
[2017-06-26 23:42:28,562] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,12] (state.change.logger)
[2017-06-26 23:42:28,562] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-12 (state.change.logger)
[2017-06-26 23:42:28,562] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 241 from controller 0 epoch 8 for partition [__consumer_offsets,12] (state.change.logger)
[2017-06-26 23:42:28,562] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 241 epoch 8 for partition [__consumer_offsets,12] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:28,562] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,5] (state.change.logger)
[2017-06-26 23:42:28,562] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=12,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:28,562] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,562] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-12 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 242 (state.change.logger)
[2017-06-26 23:42:28,562] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:28,563] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=12,error_code=0}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,563] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,5] due to: No other replicas in ISR 1 for [__consumer_offsets,5] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:28,564] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,5] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,5] due to: No other replicas in ISR 1 for [__consumer_offsets,5] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,5] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:42:28,564] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=32,error_code=0}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,565] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,32] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:28,565] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,32] (state.change.logger)
[2017-06-26 23:42:28,565] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,32] (state.change.logger)
[2017-06-26 23:42:28,565] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-32 (state.change.logger)
[2017-06-26 23:42:28,565] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=8, replicas=[0, 1, 2]) correlation id 243 from controller 0 epoch 8 for partition [__consumer_offsets,32] (state.change.logger)
[2017-06-26 23:42:28,565] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 243 epoch 8 for partition [__consumer_offsets,32] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:42:28,566] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,566] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=32,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:28,566] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-32 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 244 (state.change.logger)
[2017-06-26 23:42:28,566] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:28,566] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=32,error_code=0}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,567] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=2,error_code=0}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,567] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,2] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:28,567] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,2] (state.change.logger)
[2017-06-26 23:42:28,568] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,2] (state.change.logger)
[2017-06-26 23:42:28,568] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-2 (state.change.logger)
[2017-06-26 23:42:28,568] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,1] (state.change.logger)
[2017-06-26 23:42:28,568] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=8, replicas=[0, 1, 2]) correlation id 245 from controller 0 epoch 8 for partition [__consumer_offsets,2] (state.change.logger)
[2017-06-26 23:42:28,568] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 245 epoch 8 for partition [__consumer_offsets,2] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:42:28,568] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,568] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=2,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:28,568] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-2 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 246 (state.change.logger)
[2017-06-26 23:42:28,568] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:28,569] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=2,error_code=0}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,569] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,1] due to: No other replicas in ISR 1 for [__consumer_offsets,1] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:28,569] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,1] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,1] due to: No other replicas in ISR 1 for [__consumer_offsets,1] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,1] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:42:28,570] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=0,error_code=0}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,571] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,0] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:28,571] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,0] (state.change.logger)
[2017-06-26 23:42:28,571] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,0] (state.change.logger)
[2017-06-26 23:42:28,571] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-0 (state.change.logger)
[2017-06-26 23:42:28,571] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 247 from controller 0 epoch 8 for partition [__consumer_offsets,0] (state.change.logger)
[2017-06-26 23:42:28,571] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 247 epoch 8 for partition [__consumer_offsets,0] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:28,571] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,572] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=0,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:28,572] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-0 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 248 (state.change.logger)
[2017-06-26 23:42:28,572] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:28,572] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=0,error_code=0}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,573] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=15,error_code=0}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,573] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,15] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:28,573] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,15] (state.change.logger)
[2017-06-26 23:42:28,573] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,15] (state.change.logger)
[2017-06-26 23:42:28,573] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-15 (state.change.logger)
[2017-06-26 23:42:28,573] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 249 from controller 0 epoch 8 for partition [__consumer_offsets,15] (state.change.logger)
[2017-06-26 23:42:28,573] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 249 epoch 8 for partition [__consumer_offsets,15] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:28,574] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=15,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:28,574] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,574] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-15 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 250 (state.change.logger)
[2017-06-26 23:42:28,574] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:28,574] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=15,error_code=0}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,574] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=44,error_code=0}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,575] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,44] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:28,575] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,44] (state.change.logger)
[2017-06-26 23:42:28,575] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,44] (state.change.logger)
[2017-06-26 23:42:28,575] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-44 (state.change.logger)
[2017-06-26 23:42:28,575] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,17] (state.change.logger)
[2017-06-26 23:42:28,575] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=8, replicas=[0, 1, 2]) correlation id 251 from controller 0 epoch 8 for partition [__consumer_offsets,44] (state.change.logger)
[2017-06-26 23:42:28,575] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 251 epoch 8 for partition [__consumer_offsets,44] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:42:28,576] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=44,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:28,576] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,576] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-44 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 252 (state.change.logger)
[2017-06-26 23:42:28,576] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:28,576] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=44,error_code=0}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,577] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,17] due to: No other replicas in ISR 1 for [__consumer_offsets,17] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:28,577] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,17] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,17] due to: No other replicas in ISR 1 for [__consumer_offsets,17] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,17] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 23 more
[2017-06-26 23:42:28,578] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=48,error_code=0}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,579] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,48] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:28,579] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,48] (state.change.logger)
[2017-06-26 23:42:28,579] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,48] (state.change.logger)
[2017-06-26 23:42:28,579] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-48 (state.change.logger)
[2017-06-26 23:42:28,579] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 253 from controller 0 epoch 8 for partition [__consumer_offsets,48] (state.change.logger)
[2017-06-26 23:42:28,579] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 253 epoch 8 for partition [__consumer_offsets,48] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:28,579] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=48,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:28,579] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,579] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-48 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 254 (state.change.logger)
[2017-06-26 23:42:28,580] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:28,580] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=48,error_code=0}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,580] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=26,error_code=0}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,581] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,26] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:28,581] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,26] (state.change.logger)
[2017-06-26 23:42:28,581] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,26] (state.change.logger)
[2017-06-26 23:42:28,581] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-26 (state.change.logger)
[2017-06-26 23:42:28,581] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=8, replicas=[0, 1, 2]) correlation id 255 from controller 0 epoch 8 for partition [__consumer_offsets,26] (state.change.logger)
[2017-06-26 23:42:28,581] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 255 epoch 8 for partition [__consumer_offsets,26] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:42:28,581] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,581] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=26,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:28,581] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-26 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 256 (state.change.logger)
[2017-06-26 23:42:28,581] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:28,582] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=26,error_code=0}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,582] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=33,error_code=0}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,582] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,33] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:28,582] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,33] (state.change.logger)
[2017-06-26 23:42:28,583] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,33] (state.change.logger)
[2017-06-26 23:42:28,583] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-33 (state.change.logger)
[2017-06-26 23:42:28,583] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,41] (state.change.logger)
[2017-06-26 23:42:28,583] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 257 from controller 0 epoch 8 for partition [__consumer_offsets,33] (state.change.logger)
[2017-06-26 23:42:28,583] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 257 epoch 8 for partition [__consumer_offsets,33] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:28,583] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=33,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:28,583] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,583] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-33 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 258 (state.change.logger)
[2017-06-26 23:42:28,583] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=33,error_code=0}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,584] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:28,584] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,41] due to: No other replicas in ISR 1 for [__consumer_offsets,41] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:28,584] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,41] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,41] due to: No other replicas in ISR 1 for [__consumer_offsets,41] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,41] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 23:42:28,585] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=45,error_code=0}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,586] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,45] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:28,586] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,45] (state.change.logger)
[2017-06-26 23:42:28,586] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,45] (state.change.logger)
[2017-06-26 23:42:28,586] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-45 (state.change.logger)
[2017-06-26 23:42:28,587] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 259 from controller 0 epoch 8 for partition [__consumer_offsets,45] (state.change.logger)
[2017-06-26 23:42:28,587] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,35] (state.change.logger)
[2017-06-26 23:42:28,587] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 259 epoch 8 for partition [__consumer_offsets,45] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:28,587] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,587] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=45,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:28,587] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-45 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 260 (state.change.logger)
[2017-06-26 23:42:28,587] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:28,587] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=45,error_code=0}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,588] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,35] due to: No other replicas in ISR 1 for [__consumer_offsets,35] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:28,588] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,35] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,35] due to: No other replicas in ISR 1 for [__consumer_offsets,35] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,35] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:42:28,589] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,46] (state.change.logger)
[2017-06-26 23:42:28,590] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,46] due to: No other replicas in ISR 1 for [__consumer_offsets,46] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:28,590] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,46] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,46] due to: No other replicas in ISR 1 for [__consumer_offsets,46] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,46] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:42:28,590] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,19] (state.change.logger)
[2017-06-26 23:42:28,592] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,19] due to: No other replicas in ISR 1 for [__consumer_offsets,19] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:28,592] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,19] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,19] due to: No other replicas in ISR 1 for [__consumer_offsets,19] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,19] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:42:28,593] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=30,error_code=0}]} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,593] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,30] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:28,593] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,30] (state.change.logger)
[2017-06-26 23:42:28,594] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,30] (state.change.logger)
[2017-06-26 23:42:28,594] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-30 (state.change.logger)
[2017-06-26 23:42:28,594] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 261 from controller 0 epoch 8 for partition [__consumer_offsets,30] (state.change.logger)
[2017-06-26 23:42:28,594] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 261 epoch 8 for partition [__consumer_offsets,30] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:28,594] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=30,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:28,594] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 23:42:28,594] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-30 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 262 (state.change.logger)
[2017-06-26 23:42:28,594] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:33,607] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,43] (state.change.logger)
[2017-06-26 23:42:33,608] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,43] due to: No other replicas in ISR 1 for [__consumer_offsets,43] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:33,608] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,43] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,43] due to: No other replicas in ISR 1 for [__consumer_offsets,43] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,43] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:42:33,610] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,14] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:33,610] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,14] (state.change.logger)
[2017-06-26 23:42:33,611] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,14] (state.change.logger)
[2017-06-26 23:42:33,611] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-14 (state.change.logger)
[2017-06-26 23:42:33,611] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,28] (state.change.logger)
[2017-06-26 23:42:33,611] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=8, replicas=[0, 1, 2]) correlation id 263 from controller 0 epoch 8 for partition [__consumer_offsets,14] (state.change.logger)
[2017-06-26 23:42:33,611] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 263 epoch 8 for partition [__consumer_offsets,14] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:42:33,611] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=14,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:33,612] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-14 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 264 (state.change.logger)
[2017-06-26 23:42:33,612] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:33,613] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,28] due to: No other replicas in ISR 1 for [__consumer_offsets,28] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:33,613] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,28] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,28] due to: No other replicas in ISR 1 for [__consumer_offsets,28] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,28] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:42:33,613] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,4] (state.change.logger)
[2017-06-26 23:42:33,614] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,4] due to: No other replicas in ISR 1 for [__consumer_offsets,4] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:33,614] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,4] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,4] due to: No other replicas in ISR 1 for [__consumer_offsets,4] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,4] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:42:33,616] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,36] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:33,616] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,36] (state.change.logger)
[2017-06-26 23:42:33,616] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,36] (state.change.logger)
[2017-06-26 23:42:33,616] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-36 (state.change.logger)
[2017-06-26 23:42:33,616] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 265 from controller 0 epoch 8 for partition [__consumer_offsets,36] (state.change.logger)
[2017-06-26 23:42:33,616] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 265 epoch 8 for partition [__consumer_offsets,36] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:33,617] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=36,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:33,617] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-36 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 266 (state.change.logger)
[2017-06-26 23:42:33,617] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:33,618] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,6] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:33,618] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,6] (state.change.logger)
[2017-06-26 23:42:33,618] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,6] (state.change.logger)
[2017-06-26 23:42:33,618] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-6 (state.change.logger)
[2017-06-26 23:42:33,618] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 267 from controller 0 epoch 8 for partition [__consumer_offsets,6] (state.change.logger)
[2017-06-26 23:42:33,618] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 267 epoch 8 for partition [__consumer_offsets,6] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:33,618] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=6,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:33,619] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-6 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 268 (state.change.logger)
[2017-06-26 23:42:33,619] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:33,620] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,39] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:33,620] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,39] (state.change.logger)
[2017-06-26 23:42:33,620] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,39] (state.change.logger)
[2017-06-26 23:42:33,620] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-39 (state.change.logger)
[2017-06-26 23:42:33,620] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,23] (state.change.logger)
[2017-06-26 23:42:33,620] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 269 from controller 0 epoch 8 for partition [__consumer_offsets,39] (state.change.logger)
[2017-06-26 23:42:33,620] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 269 epoch 8 for partition [__consumer_offsets,39] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:33,620] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=39,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:33,620] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-39 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 270 (state.change.logger)
[2017-06-26 23:42:33,621] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:33,621] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,23] due to: No other replicas in ISR 1 for [__consumer_offsets,23] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:33,621] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,23] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,23] due to: No other replicas in ISR 1 for [__consumer_offsets,23] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,23] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 23:42:33,623] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,24] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:33,623] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,24] (state.change.logger)
[2017-06-26 23:42:33,623] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,24] (state.change.logger)
[2017-06-26 23:42:33,623] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-24 (state.change.logger)
[2017-06-26 23:42:33,623] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 271 from controller 0 epoch 8 for partition [__consumer_offsets,24] (state.change.logger)
[2017-06-26 23:42:33,623] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 271 epoch 8 for partition [__consumer_offsets,24] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:33,624] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=24,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:33,624] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-24 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 272 (state.change.logger)
[2017-06-26 23:42:33,624] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:33,625] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,38] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:33,625] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,38] (state.change.logger)
[2017-06-26 23:42:33,625] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,38] (state.change.logger)
[2017-06-26 23:42:33,625] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-38 (state.change.logger)
[2017-06-26 23:42:33,625] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=8, replicas=[0, 1, 2]) correlation id 273 from controller 0 epoch 8 for partition [__consumer_offsets,38] (state.change.logger)
[2017-06-26 23:42:33,625] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 273 epoch 8 for partition [__consumer_offsets,38] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:42:33,625] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,16] (state.change.logger)
[2017-06-26 23:42:33,625] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=38,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:33,625] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-38 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 274 (state.change.logger)
[2017-06-26 23:42:33,626] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:33,627] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,16] due to: No other replicas in ISR 1 for [__consumer_offsets,16] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:33,627] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,16] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,16] due to: No other replicas in ISR 1 for [__consumer_offsets,16] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,16] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 24 more
[2017-06-26 23:42:33,628] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,3] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:33,628] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,3] (state.change.logger)
[2017-06-26 23:42:33,628] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,3] (state.change.logger)
[2017-06-26 23:42:33,628] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-3 (state.change.logger)
[2017-06-26 23:42:33,629] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 275 from controller 0 epoch 8 for partition [__consumer_offsets,3] (state.change.logger)
[2017-06-26 23:42:33,629] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 275 epoch 8 for partition [__consumer_offsets,3] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:33,629] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=3,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:33,629] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-3 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 276 (state.change.logger)
[2017-06-26 23:42:33,629] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:33,630] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,21] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:33,630] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,21] (state.change.logger)
[2017-06-26 23:42:33,630] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,21] (state.change.logger)
[2017-06-26 23:42:33,630] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-21 (state.change.logger)
[2017-06-26 23:42:33,630] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 277 from controller 0 epoch 8 for partition [__consumer_offsets,21] (state.change.logger)
[2017-06-26 23:42:33,630] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,10] (state.change.logger)
[2017-06-26 23:42:33,631] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 277 epoch 8 for partition [__consumer_offsets,21] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:33,631] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=21,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:33,631] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-21 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 278 (state.change.logger)
[2017-06-26 23:42:33,631] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:33,632] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,10] due to: No other replicas in ISR 1 for [__consumer_offsets,10] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:33,632] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,10] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,10] due to: No other replicas in ISR 1 for [__consumer_offsets,10] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,10] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:42:33,633] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,40] (state.change.logger)
[2017-06-26 23:42:33,634] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,40] due to: No other replicas in ISR 1 for [__consumer_offsets,40] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:33,634] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,40] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,40] due to: No other replicas in ISR 1 for [__consumer_offsets,40] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,40] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:42:33,634] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,34] (state.change.logger)
[2017-06-26 23:42:33,636] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,34] due to: No other replicas in ISR 1 for [__consumer_offsets,34] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:33,636] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,34] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,34] due to: No other replicas in ISR 1 for [__consumer_offsets,34] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,34] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 23:42:33,636] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,25] (state.change.logger)
[2017-06-26 23:42:33,637] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,25] due to: No other replicas in ISR 1 for [__consumer_offsets,25] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:33,637] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,25] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,25] due to: No other replicas in ISR 1 for [__consumer_offsets,25] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,25] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:42:33,640] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,27] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:33,640] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,27] (state.change.logger)
[2017-06-26 23:42:33,640] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,27] (state.change.logger)
[2017-06-26 23:42:33,640] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-27 (state.change.logger)
[2017-06-26 23:42:33,640] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 279 from controller 0 epoch 8 for partition [__consumer_offsets,27] (state.change.logger)
[2017-06-26 23:42:33,640] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 279 epoch 8 for partition [__consumer_offsets,27] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:33,641] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=27,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:33,641] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-27 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 280 (state.change.logger)
[2017-06-26 23:42:33,641] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:33,642] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,42] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:33,642] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,42] (state.change.logger)
[2017-06-26 23:42:33,642] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,42] (state.change.logger)
[2017-06-26 23:42:33,642] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-42 (state.change.logger)
[2017-06-26 23:42:33,642] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,11] (state.change.logger)
[2017-06-26 23:42:33,642] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 281 from controller 0 epoch 8 for partition [__consumer_offsets,42] (state.change.logger)
[2017-06-26 23:42:33,642] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 281 epoch 8 for partition [__consumer_offsets,42] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:33,642] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=42,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:33,642] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-42 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 282 (state.change.logger)
[2017-06-26 23:42:33,643] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:33,643] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,11] due to: No other replicas in ISR 1 for [__consumer_offsets,11] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:33,643] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,11] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,11] due to: No other replicas in ISR 1 for [__consumer_offsets,11] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,11] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:42:33,643] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,7] (state.change.logger)
[2017-06-26 23:42:33,645] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,7] due to: No other replicas in ISR 1 for [__consumer_offsets,7] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:33,645] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,7] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,7] due to: No other replicas in ISR 1 for [__consumer_offsets,7] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,7] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:42:33,645] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,47] (state.change.logger)
[2017-06-26 23:42:33,646] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,47] due to: No other replicas in ISR 1 for [__consumer_offsets,47] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:33,646] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,47] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,47] due to: No other replicas in ISR 1 for [__consumer_offsets,47] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,47] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:42:33,648] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,9] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:33,648] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,9] (state.change.logger)
[2017-06-26 23:42:33,648] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,9] (state.change.logger)
[2017-06-26 23:42:33,648] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-9 (state.change.logger)
[2017-06-26 23:42:33,648] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 283 from controller 0 epoch 8 for partition [__consumer_offsets,9] (state.change.logger)
[2017-06-26 23:42:33,648] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 283 epoch 8 for partition [__consumer_offsets,9] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:33,648] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,13] (state.change.logger)
[2017-06-26 23:42:33,649] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=9,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:33,649] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-9 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 284 (state.change.logger)
[2017-06-26 23:42:33,649] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:33,650] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,13] due to: No other replicas in ISR 1 for [__consumer_offsets,13] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:33,650] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,13] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,13] due to: No other replicas in ISR 1 for [__consumer_offsets,13] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,13] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 23:42:33,650] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,29] (state.change.logger)
[2017-06-26 23:42:33,651] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,29] due to: No other replicas in ISR 1 for [__consumer_offsets,29] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:33,651] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,29] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,29] due to: No other replicas in ISR 1 for [__consumer_offsets,29] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,29] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:42:33,653] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,8] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:33,653] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,8] (state.change.logger)
[2017-06-26 23:42:33,653] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,8] (state.change.logger)
[2017-06-26 23:42:33,653] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-8 (state.change.logger)
[2017-06-26 23:42:33,653] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,22] (state.change.logger)
[2017-06-26 23:42:33,653] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=8, replicas=[0, 1, 2]) correlation id 285 from controller 0 epoch 8 for partition [__consumer_offsets,8] (state.change.logger)
[2017-06-26 23:42:33,653] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 285 epoch 8 for partition [__consumer_offsets,8] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:42:33,654] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=8,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:33,654] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-8 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 286 (state.change.logger)
[2017-06-26 23:42:33,654] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:33,655] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,22] due to: No other replicas in ISR 1 for [__consumer_offsets,22] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:33,655] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,22] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,22] due to: No other replicas in ISR 1 for [__consumer_offsets,22] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,22] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:42:33,656] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,31] (state.change.logger)
[2017-06-26 23:42:33,657] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,31] due to: No other replicas in ISR 1 for [__consumer_offsets,31] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:33,657] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,31] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,31] due to: No other replicas in ISR 1 for [__consumer_offsets,31] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,31] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 23:42:33,659] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,18] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:33,659] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,18] (state.change.logger)
[2017-06-26 23:42:33,659] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,18] (state.change.logger)
[2017-06-26 23:42:33,659] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-18 (state.change.logger)
[2017-06-26 23:42:33,659] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 287 from controller 0 epoch 8 for partition [__consumer_offsets,18] (state.change.logger)
[2017-06-26 23:42:33,659] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 287 epoch 8 for partition [__consumer_offsets,18] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:33,659] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=18,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:33,659] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-18 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 288 (state.change.logger)
[2017-06-26 23:42:33,660] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:33,661] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,20] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:33,661] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,20] (state.change.logger)
[2017-06-26 23:42:33,661] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,20] (state.change.logger)
[2017-06-26 23:42:33,661] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-20 (state.change.logger)
[2017-06-26 23:42:33,661] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,37] (state.change.logger)
[2017-06-26 23:42:33,661] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=8, replicas=[0, 1, 2]) correlation id 289 from controller 0 epoch 8 for partition [__consumer_offsets,20] (state.change.logger)
[2017-06-26 23:42:33,661] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 289 epoch 8 for partition [__consumer_offsets,20] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:42:33,661] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=20,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:33,662] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-20 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 290 (state.change.logger)
[2017-06-26 23:42:33,662] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:33,662] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,37] due to: No other replicas in ISR 1 for [__consumer_offsets,37] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:33,662] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,37] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,37] due to: No other replicas in ISR 1 for [__consumer_offsets,37] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,37] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 23:42:33,663] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,49] (state.change.logger)
[2017-06-26 23:42:33,664] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,49] due to: No other replicas in ISR 1 for [__consumer_offsets,49] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:33,664] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,49] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,49] due to: No other replicas in ISR 1 for [__consumer_offsets,49] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,49] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:42:33,665] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,12] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:33,666] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,12] (state.change.logger)
[2017-06-26 23:42:33,666] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,12] (state.change.logger)
[2017-06-26 23:42:33,666] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-12 (state.change.logger)
[2017-06-26 23:42:33,666] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,5] (state.change.logger)
[2017-06-26 23:42:33,666] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 291 from controller 0 epoch 8 for partition [__consumer_offsets,12] (state.change.logger)
[2017-06-26 23:42:33,666] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 291 epoch 8 for partition [__consumer_offsets,12] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:33,666] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=12,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:33,666] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-12 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 292 (state.change.logger)
[2017-06-26 23:42:33,666] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:33,667] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,5] due to: No other replicas in ISR 1 for [__consumer_offsets,5] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:33,667] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,5] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,5] due to: No other replicas in ISR 1 for [__consumer_offsets,5] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,5] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:42:33,669] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,32] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:33,669] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,32] (state.change.logger)
[2017-06-26 23:42:33,669] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,32] (state.change.logger)
[2017-06-26 23:42:33,669] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-32 (state.change.logger)
[2017-06-26 23:42:33,669] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=8, replicas=[0, 1, 2]) correlation id 293 from controller 0 epoch 8 for partition [__consumer_offsets,32] (state.change.logger)
[2017-06-26 23:42:33,669] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 293 epoch 8 for partition [__consumer_offsets,32] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:42:33,669] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=32,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:33,670] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-32 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 294 (state.change.logger)
[2017-06-26 23:42:33,671] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,2] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:33,671] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,2] (state.change.logger)
[2017-06-26 23:42:33,671] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:33,671] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,2] (state.change.logger)
[2017-06-26 23:42:33,671] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-2 (state.change.logger)
[2017-06-26 23:42:33,671] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,1] (state.change.logger)
[2017-06-26 23:42:33,671] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=8, replicas=[0, 1, 2]) correlation id 295 from controller 0 epoch 8 for partition [__consumer_offsets,2] (state.change.logger)
[2017-06-26 23:42:33,671] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 295 epoch 8 for partition [__consumer_offsets,2] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:42:33,672] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=2,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:33,672] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-2 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 296 (state.change.logger)
[2017-06-26 23:42:33,672] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:33,673] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,1] due to: No other replicas in ISR 1 for [__consumer_offsets,1] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:33,673] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,1] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,1] due to: No other replicas in ISR 1 for [__consumer_offsets,1] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,1] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:42:33,674] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,0] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:33,674] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,0] (state.change.logger)
[2017-06-26 23:42:33,674] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,0] (state.change.logger)
[2017-06-26 23:42:33,674] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-0 (state.change.logger)
[2017-06-26 23:42:33,674] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 297 from controller 0 epoch 8 for partition [__consumer_offsets,0] (state.change.logger)
[2017-06-26 23:42:33,674] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 297 epoch 8 for partition [__consumer_offsets,0] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:33,675] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=0,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:33,675] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-0 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 298 (state.change.logger)
[2017-06-26 23:42:33,675] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:33,676] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,15] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:33,676] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,15] (state.change.logger)
[2017-06-26 23:42:33,676] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,15] (state.change.logger)
[2017-06-26 23:42:33,676] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-15 (state.change.logger)
[2017-06-26 23:42:33,676] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 299 from controller 0 epoch 8 for partition [__consumer_offsets,15] (state.change.logger)
[2017-06-26 23:42:33,676] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 299 epoch 8 for partition [__consumer_offsets,15] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:33,677] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=15,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:33,677] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-15 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 300 (state.change.logger)
[2017-06-26 23:42:33,677] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:33,678] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,44] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:33,678] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,44] (state.change.logger)
[2017-06-26 23:42:33,678] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,44] (state.change.logger)
[2017-06-26 23:42:33,678] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-44 (state.change.logger)
[2017-06-26 23:42:33,678] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,17] (state.change.logger)
[2017-06-26 23:42:33,678] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=8, replicas=[0, 1, 2]) correlation id 301 from controller 0 epoch 8 for partition [__consumer_offsets,44] (state.change.logger)
[2017-06-26 23:42:33,678] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 301 epoch 8 for partition [__consumer_offsets,44] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:42:33,678] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=44,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:33,678] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-44 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 302 (state.change.logger)
[2017-06-26 23:42:33,679] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:33,679] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,17] due to: No other replicas in ISR 1 for [__consumer_offsets,17] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:33,679] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,17] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,17] due to: No other replicas in ISR 1 for [__consumer_offsets,17] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,17] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 23 more
[2017-06-26 23:42:33,681] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,48] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:33,681] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,48] (state.change.logger)
[2017-06-26 23:42:33,681] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,48] (state.change.logger)
[2017-06-26 23:42:33,681] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-48 (state.change.logger)
[2017-06-26 23:42:33,681] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 303 from controller 0 epoch 8 for partition [__consumer_offsets,48] (state.change.logger)
[2017-06-26 23:42:33,681] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 303 epoch 8 for partition [__consumer_offsets,48] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:33,681] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=48,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:33,681] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-48 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 304 (state.change.logger)
[2017-06-26 23:42:33,682] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:33,683] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,26] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:33,683] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,26] (state.change.logger)
[2017-06-26 23:42:33,683] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,26] (state.change.logger)
[2017-06-26 23:42:33,683] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-26 (state.change.logger)
[2017-06-26 23:42:33,683] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=8, replicas=[0, 1, 2]) correlation id 305 from controller 0 epoch 8 for partition [__consumer_offsets,26] (state.change.logger)
[2017-06-26 23:42:33,683] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 305 epoch 8 for partition [__consumer_offsets,26] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:42:33,683] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=26,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:33,683] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-26 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 306 (state.change.logger)
[2017-06-26 23:42:33,683] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:33,684] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,33] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:33,684] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,33] (state.change.logger)
[2017-06-26 23:42:33,684] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,33] (state.change.logger)
[2017-06-26 23:42:33,684] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-33 (state.change.logger)
[2017-06-26 23:42:33,685] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,41] (state.change.logger)
[2017-06-26 23:42:33,685] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 307 from controller 0 epoch 8 for partition [__consumer_offsets,33] (state.change.logger)
[2017-06-26 23:42:33,685] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 307 epoch 8 for partition [__consumer_offsets,33] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:33,685] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=33,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:33,685] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-33 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 308 (state.change.logger)
[2017-06-26 23:42:33,685] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:33,686] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,41] due to: No other replicas in ISR 1 for [__consumer_offsets,41] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:33,686] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,41] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,41] due to: No other replicas in ISR 1 for [__consumer_offsets,41] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,41] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 23:42:33,688] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,45] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:33,688] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,45] (state.change.logger)
[2017-06-26 23:42:33,688] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,45] (state.change.logger)
[2017-06-26 23:42:33,688] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-45 (state.change.logger)
[2017-06-26 23:42:33,688] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,35] (state.change.logger)
[2017-06-26 23:42:33,688] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 309 from controller 0 epoch 8 for partition [__consumer_offsets,45] (state.change.logger)
[2017-06-26 23:42:33,688] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 309 epoch 8 for partition [__consumer_offsets,45] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:33,688] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=45,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:33,688] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-45 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 310 (state.change.logger)
[2017-06-26 23:42:33,689] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:33,689] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,35] due to: No other replicas in ISR 1 for [__consumer_offsets,35] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:33,689] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,35] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,35] due to: No other replicas in ISR 1 for [__consumer_offsets,35] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,35] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:42:33,690] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,46] (state.change.logger)
[2017-06-26 23:42:33,691] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,46] due to: No other replicas in ISR 1 for [__consumer_offsets,46] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:33,691] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,46] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,46] due to: No other replicas in ISR 1 for [__consumer_offsets,46] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,46] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:42:33,691] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,19] (state.change.logger)
[2017-06-26 23:42:33,692] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,19] due to: No other replicas in ISR 1 for [__consumer_offsets,19] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:33,692] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,19] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,19] due to: No other replicas in ISR 1 for [__consumer_offsets,19] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,19] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:42:33,694] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,30] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:33,694] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,30] (state.change.logger)
[2017-06-26 23:42:33,694] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,30] (state.change.logger)
[2017-06-26 23:42:33,695] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-30 (state.change.logger)
[2017-06-26 23:42:33,695] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 311 from controller 0 epoch 8 for partition [__consumer_offsets,30] (state.change.logger)
[2017-06-26 23:42:33,695] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 311 epoch 8 for partition [__consumer_offsets,30] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:33,695] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=30,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:33,695] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-30 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 312 (state.change.logger)
[2017-06-26 23:42:33,695] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:38,702] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,43] (state.change.logger)
[2017-06-26 23:42:38,704] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,43] due to: No other replicas in ISR 1 for [__consumer_offsets,43] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:38,704] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,43] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,43] due to: No other replicas in ISR 1 for [__consumer_offsets,43] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,43] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:42:38,706] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,14] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:38,706] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,14] (state.change.logger)
[2017-06-26 23:42:38,706] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,14] (state.change.logger)
[2017-06-26 23:42:38,706] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-14 (state.change.logger)
[2017-06-26 23:42:38,707] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,28] (state.change.logger)
[2017-06-26 23:42:38,707] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=8, replicas=[0, 1, 2]) correlation id 313 from controller 0 epoch 8 for partition [__consumer_offsets,14] (state.change.logger)
[2017-06-26 23:42:38,707] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 313 epoch 8 for partition [__consumer_offsets,14] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:42:38,707] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=14,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:38,707] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-14 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 314 (state.change.logger)
[2017-06-26 23:42:38,707] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:38,708] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,28] due to: No other replicas in ISR 1 for [__consumer_offsets,28] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:38,708] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,28] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,28] due to: No other replicas in ISR 1 for [__consumer_offsets,28] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,28] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:42:38,709] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,4] (state.change.logger)
[2017-06-26 23:42:38,710] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,4] due to: No other replicas in ISR 1 for [__consumer_offsets,4] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:38,710] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,4] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,4] due to: No other replicas in ISR 1 for [__consumer_offsets,4] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,4] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:42:38,712] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,36] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:38,712] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,36] (state.change.logger)
[2017-06-26 23:42:38,712] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,36] (state.change.logger)
[2017-06-26 23:42:38,712] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-36 (state.change.logger)
[2017-06-26 23:42:38,712] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 315 from controller 0 epoch 8 for partition [__consumer_offsets,36] (state.change.logger)
[2017-06-26 23:42:38,712] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 315 epoch 8 for partition [__consumer_offsets,36] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:38,712] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=36,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:38,713] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-36 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 316 (state.change.logger)
[2017-06-26 23:42:38,713] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:38,714] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,6] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:38,714] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,6] (state.change.logger)
[2017-06-26 23:42:38,714] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,6] (state.change.logger)
[2017-06-26 23:42:38,714] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-6 (state.change.logger)
[2017-06-26 23:42:38,714] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 317 from controller 0 epoch 8 for partition [__consumer_offsets,6] (state.change.logger)
[2017-06-26 23:42:38,714] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 317 epoch 8 for partition [__consumer_offsets,6] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:38,714] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=6,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:38,715] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-6 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 318 (state.change.logger)
[2017-06-26 23:42:38,715] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:38,716] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,39] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:38,716] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,39] (state.change.logger)
[2017-06-26 23:42:38,716] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,39] (state.change.logger)
[2017-06-26 23:42:38,716] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-39 (state.change.logger)
[2017-06-26 23:42:38,716] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,23] (state.change.logger)
[2017-06-26 23:42:38,716] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 319 from controller 0 epoch 8 for partition [__consumer_offsets,39] (state.change.logger)
[2017-06-26 23:42:38,716] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 319 epoch 8 for partition [__consumer_offsets,39] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:38,716] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=39,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:38,716] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-39 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 320 (state.change.logger)
[2017-06-26 23:42:38,717] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:38,717] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,23] due to: No other replicas in ISR 1 for [__consumer_offsets,23] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:38,717] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,23] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,23] due to: No other replicas in ISR 1 for [__consumer_offsets,23] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,23] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 23:42:38,720] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,24] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:38,720] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,24] (state.change.logger)
[2017-06-26 23:42:38,720] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,24] (state.change.logger)
[2017-06-26 23:42:38,720] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-24 (state.change.logger)
[2017-06-26 23:42:38,720] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 321 from controller 0 epoch 8 for partition [__consumer_offsets,24] (state.change.logger)
[2017-06-26 23:42:38,720] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 321 epoch 8 for partition [__consumer_offsets,24] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:38,720] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=24,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:38,721] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-24 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 322 (state.change.logger)
[2017-06-26 23:42:38,721] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:38,722] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,38] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:38,722] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,38] (state.change.logger)
[2017-06-26 23:42:38,722] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,38] (state.change.logger)
[2017-06-26 23:42:38,722] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-38 (state.change.logger)
[2017-06-26 23:42:38,723] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=8, replicas=[0, 1, 2]) correlation id 323 from controller 0 epoch 8 for partition [__consumer_offsets,38] (state.change.logger)
[2017-06-26 23:42:38,723] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,16] (state.change.logger)
[2017-06-26 23:42:38,723] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 323 epoch 8 for partition [__consumer_offsets,38] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:42:38,723] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=38,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:38,723] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-38 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 324 (state.change.logger)
[2017-06-26 23:42:38,723] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:38,724] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,16] due to: No other replicas in ISR 1 for [__consumer_offsets,16] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:38,724] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,16] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,16] due to: No other replicas in ISR 1 for [__consumer_offsets,16] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,16] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 24 more
[2017-06-26 23:42:38,726] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,3] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:38,726] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,3] (state.change.logger)
[2017-06-26 23:42:38,726] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,3] (state.change.logger)
[2017-06-26 23:42:38,726] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-3 (state.change.logger)
[2017-06-26 23:42:38,726] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 325 from controller 0 epoch 8 for partition [__consumer_offsets,3] (state.change.logger)
[2017-06-26 23:42:38,726] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 325 epoch 8 for partition [__consumer_offsets,3] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:38,727] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=3,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:38,727] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-3 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 326 (state.change.logger)
[2017-06-26 23:42:38,727] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:38,728] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,21] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:38,728] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,21] (state.change.logger)
[2017-06-26 23:42:38,728] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,21] (state.change.logger)
[2017-06-26 23:42:38,728] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-21 (state.change.logger)
[2017-06-26 23:42:38,728] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,10] (state.change.logger)
[2017-06-26 23:42:38,728] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 327 from controller 0 epoch 8 for partition [__consumer_offsets,21] (state.change.logger)
[2017-06-26 23:42:38,728] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 327 epoch 8 for partition [__consumer_offsets,21] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:38,728] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=21,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:38,728] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-21 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 328 (state.change.logger)
[2017-06-26 23:42:38,729] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:38,729] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,10] due to: No other replicas in ISR 1 for [__consumer_offsets,10] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:38,729] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,10] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,10] due to: No other replicas in ISR 1 for [__consumer_offsets,10] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,10] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:42:38,730] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,40] (state.change.logger)
[2017-06-26 23:42:38,731] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,40] due to: No other replicas in ISR 1 for [__consumer_offsets,40] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:38,731] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,40] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,40] due to: No other replicas in ISR 1 for [__consumer_offsets,40] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,40] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:42:38,731] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,34] (state.change.logger)
[2017-06-26 23:42:38,733] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,34] due to: No other replicas in ISR 1 for [__consumer_offsets,34] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:38,733] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,34] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,34] due to: No other replicas in ISR 1 for [__consumer_offsets,34] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,34] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 23:42:38,733] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,25] (state.change.logger)
[2017-06-26 23:42:38,735] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,25] due to: No other replicas in ISR 1 for [__consumer_offsets,25] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:38,735] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,25] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,25] due to: No other replicas in ISR 1 for [__consumer_offsets,25] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,25] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:42:38,737] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,27] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:38,737] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,27] (state.change.logger)
[2017-06-26 23:42:38,737] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,27] (state.change.logger)
[2017-06-26 23:42:38,737] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-27 (state.change.logger)
[2017-06-26 23:42:38,738] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 329 from controller 0 epoch 8 for partition [__consumer_offsets,27] (state.change.logger)
[2017-06-26 23:42:38,738] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 329 epoch 8 for partition [__consumer_offsets,27] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:38,738] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=27,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:38,738] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-27 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 330 (state.change.logger)
[2017-06-26 23:42:38,738] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:38,739] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,42] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:38,739] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,42] (state.change.logger)
[2017-06-26 23:42:38,739] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,42] (state.change.logger)
[2017-06-26 23:42:38,739] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-42 (state.change.logger)
[2017-06-26 23:42:38,740] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,11] (state.change.logger)
[2017-06-26 23:42:38,740] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 331 from controller 0 epoch 8 for partition [__consumer_offsets,42] (state.change.logger)
[2017-06-26 23:42:38,740] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 331 epoch 8 for partition [__consumer_offsets,42] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:38,740] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=42,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:38,740] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-42 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 332 (state.change.logger)
[2017-06-26 23:42:38,740] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:38,741] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,11] due to: No other replicas in ISR 1 for [__consumer_offsets,11] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:38,741] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,11] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,11] due to: No other replicas in ISR 1 for [__consumer_offsets,11] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,11] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:42:38,742] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,7] (state.change.logger)
[2017-06-26 23:42:38,743] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,7] due to: No other replicas in ISR 1 for [__consumer_offsets,7] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:38,743] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,7] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,7] due to: No other replicas in ISR 1 for [__consumer_offsets,7] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,7] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:42:38,744] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,47] (state.change.logger)
[2017-06-26 23:42:38,746] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,47] due to: No other replicas in ISR 1 for [__consumer_offsets,47] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:38,746] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,47] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,47] due to: No other replicas in ISR 1 for [__consumer_offsets,47] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,47] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:42:38,748] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,9] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:38,748] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,9] (state.change.logger)
[2017-06-26 23:42:38,748] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,9] (state.change.logger)
[2017-06-26 23:42:38,748] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-9 (state.change.logger)
[2017-06-26 23:42:38,748] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,13] (state.change.logger)
[2017-06-26 23:42:38,748] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 333 from controller 0 epoch 8 for partition [__consumer_offsets,9] (state.change.logger)
[2017-06-26 23:42:38,748] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 333 epoch 8 for partition [__consumer_offsets,9] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:38,748] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=9,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:38,748] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-9 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 334 (state.change.logger)
[2017-06-26 23:42:38,749] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:38,750] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,13] due to: No other replicas in ISR 1 for [__consumer_offsets,13] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:38,750] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,13] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,13] due to: No other replicas in ISR 1 for [__consumer_offsets,13] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,13] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 23:42:38,750] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,29] (state.change.logger)
[2017-06-26 23:42:38,752] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,29] due to: No other replicas in ISR 1 for [__consumer_offsets,29] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:38,752] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,29] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,29] due to: No other replicas in ISR 1 for [__consumer_offsets,29] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,29] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:42:38,754] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,8] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:38,754] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,8] (state.change.logger)
[2017-06-26 23:42:38,755] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,8] (state.change.logger)
[2017-06-26 23:42:38,755] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-8 (state.change.logger)
[2017-06-26 23:42:38,755] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,22] (state.change.logger)
[2017-06-26 23:42:38,755] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=8, replicas=[0, 1, 2]) correlation id 335 from controller 0 epoch 8 for partition [__consumer_offsets,8] (state.change.logger)
[2017-06-26 23:42:38,755] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 335 epoch 8 for partition [__consumer_offsets,8] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:42:38,755] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=8,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:38,755] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-8 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 336 (state.change.logger)
[2017-06-26 23:42:38,756] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:38,757] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,22] due to: No other replicas in ISR 1 for [__consumer_offsets,22] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:38,757] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,22] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,22] due to: No other replicas in ISR 1 for [__consumer_offsets,22] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,22] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:42:38,757] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,31] (state.change.logger)
[2017-06-26 23:42:38,759] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,31] due to: No other replicas in ISR 1 for [__consumer_offsets,31] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:38,759] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,31] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,31] due to: No other replicas in ISR 1 for [__consumer_offsets,31] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,31] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 23:42:38,761] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,18] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:38,761] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,18] (state.change.logger)
[2017-06-26 23:42:38,761] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,18] (state.change.logger)
[2017-06-26 23:42:38,762] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-18 (state.change.logger)
[2017-06-26 23:42:38,762] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 337 from controller 0 epoch 8 for partition [__consumer_offsets,18] (state.change.logger)
[2017-06-26 23:42:38,762] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 337 epoch 8 for partition [__consumer_offsets,18] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:38,762] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=18,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:38,762] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-18 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 338 (state.change.logger)
[2017-06-26 23:42:38,762] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:38,763] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,20] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:38,763] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,20] (state.change.logger)
[2017-06-26 23:42:38,764] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,20] (state.change.logger)
[2017-06-26 23:42:38,764] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-20 (state.change.logger)
[2017-06-26 23:42:38,764] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,37] (state.change.logger)
[2017-06-26 23:42:38,764] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=8, replicas=[0, 1, 2]) correlation id 339 from controller 0 epoch 8 for partition [__consumer_offsets,20] (state.change.logger)
[2017-06-26 23:42:38,764] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 339 epoch 8 for partition [__consumer_offsets,20] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:42:38,764] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=20,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:38,764] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-20 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 340 (state.change.logger)
[2017-06-26 23:42:38,764] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:38,765] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,37] due to: No other replicas in ISR 1 for [__consumer_offsets,37] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:38,765] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,37] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,37] due to: No other replicas in ISR 1 for [__consumer_offsets,37] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,37] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 23:42:38,766] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,49] (state.change.logger)
[2017-06-26 23:42:38,767] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,49] due to: No other replicas in ISR 1 for [__consumer_offsets,49] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:38,767] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,49] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,49] due to: No other replicas in ISR 1 for [__consumer_offsets,49] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,49] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:42:38,769] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,12] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:38,769] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,12] (state.change.logger)
[2017-06-26 23:42:38,769] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,12] (state.change.logger)
[2017-06-26 23:42:38,769] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-12 (state.change.logger)
[2017-06-26 23:42:38,769] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,5] (state.change.logger)
[2017-06-26 23:42:38,770] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 341 from controller 0 epoch 8 for partition [__consumer_offsets,12] (state.change.logger)
[2017-06-26 23:42:38,770] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 341 epoch 8 for partition [__consumer_offsets,12] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:38,770] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=12,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:38,770] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-12 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 342 (state.change.logger)
[2017-06-26 23:42:38,770] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:38,771] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,5] due to: No other replicas in ISR 1 for [__consumer_offsets,5] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:38,771] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,5] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,5] due to: No other replicas in ISR 1 for [__consumer_offsets,5] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,5] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:42:38,774] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,32] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:38,774] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,32] (state.change.logger)
[2017-06-26 23:42:38,774] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,32] (state.change.logger)
[2017-06-26 23:42:38,774] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-32 (state.change.logger)
[2017-06-26 23:42:38,774] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=8, replicas=[0, 1, 2]) correlation id 343 from controller 0 epoch 8 for partition [__consumer_offsets,32] (state.change.logger)
[2017-06-26 23:42:38,774] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 343 epoch 8 for partition [__consumer_offsets,32] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:42:38,774] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=32,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:38,774] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-32 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 344 (state.change.logger)
[2017-06-26 23:42:38,774] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:38,775] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,2] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:38,775] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,2] (state.change.logger)
[2017-06-26 23:42:38,776] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,2] (state.change.logger)
[2017-06-26 23:42:38,776] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-2 (state.change.logger)
[2017-06-26 23:42:38,776] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,1] (state.change.logger)
[2017-06-26 23:42:38,776] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=8, replicas=[0, 1, 2]) correlation id 345 from controller 0 epoch 8 for partition [__consumer_offsets,2] (state.change.logger)
[2017-06-26 23:42:38,776] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 345 epoch 8 for partition [__consumer_offsets,2] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:42:38,776] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=2,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:38,776] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-2 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 346 (state.change.logger)
[2017-06-26 23:42:38,776] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:38,777] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,1] due to: No other replicas in ISR 1 for [__consumer_offsets,1] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:38,777] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,1] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,1] due to: No other replicas in ISR 1 for [__consumer_offsets,1] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,1] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:42:38,779] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,0] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:38,779] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,0] (state.change.logger)
[2017-06-26 23:42:38,780] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,0] (state.change.logger)
[2017-06-26 23:42:38,780] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-0 (state.change.logger)
[2017-06-26 23:42:38,780] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 347 from controller 0 epoch 8 for partition [__consumer_offsets,0] (state.change.logger)
[2017-06-26 23:42:38,780] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 347 epoch 8 for partition [__consumer_offsets,0] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:38,781] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=0,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:38,781] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-0 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 348 (state.change.logger)
[2017-06-26 23:42:38,781] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:38,782] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,15] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:38,782] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,15] (state.change.logger)
[2017-06-26 23:42:38,782] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,15] (state.change.logger)
[2017-06-26 23:42:38,782] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-15 (state.change.logger)
[2017-06-26 23:42:38,782] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 349 from controller 0 epoch 8 for partition [__consumer_offsets,15] (state.change.logger)
[2017-06-26 23:42:38,782] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 349 epoch 8 for partition [__consumer_offsets,15] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:38,782] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=15,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:38,783] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-15 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 350 (state.change.logger)
[2017-06-26 23:42:38,783] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:38,784] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,44] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:38,784] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,44] (state.change.logger)
[2017-06-26 23:42:38,784] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,44] (state.change.logger)
[2017-06-26 23:42:38,784] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-44 (state.change.logger)
[2017-06-26 23:42:38,784] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,17] (state.change.logger)
[2017-06-26 23:42:38,784] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=8, replicas=[0, 1, 2]) correlation id 351 from controller 0 epoch 8 for partition [__consumer_offsets,44] (state.change.logger)
[2017-06-26 23:42:38,784] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 351 epoch 8 for partition [__consumer_offsets,44] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:42:38,784] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=44,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:38,785] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-44 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 352 (state.change.logger)
[2017-06-26 23:42:38,785] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:38,786] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,17] due to: No other replicas in ISR 1 for [__consumer_offsets,17] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:38,786] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,17] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,17] due to: No other replicas in ISR 1 for [__consumer_offsets,17] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,17] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 23 more
[2017-06-26 23:42:38,788] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,48] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:38,788] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,48] (state.change.logger)
[2017-06-26 23:42:38,788] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,48] (state.change.logger)
[2017-06-26 23:42:38,788] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-48 (state.change.logger)
[2017-06-26 23:42:38,788] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 353 from controller 0 epoch 8 for partition [__consumer_offsets,48] (state.change.logger)
[2017-06-26 23:42:38,788] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 353 epoch 8 for partition [__consumer_offsets,48] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:38,789] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=48,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:38,789] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-48 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 354 (state.change.logger)
[2017-06-26 23:42:38,789] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:38,790] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,26] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:38,790] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,26] (state.change.logger)
[2017-06-26 23:42:38,790] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,26] (state.change.logger)
[2017-06-26 23:42:38,790] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-26 (state.change.logger)
[2017-06-26 23:42:38,790] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=8, replicas=[0, 1, 2]) correlation id 355 from controller 0 epoch 8 for partition [__consumer_offsets,26] (state.change.logger)
[2017-06-26 23:42:38,790] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 355 epoch 8 for partition [__consumer_offsets,26] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:42:38,790] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=26,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:38,791] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-26 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 356 (state.change.logger)
[2017-06-26 23:42:38,791] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:38,792] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,33] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:38,792] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,33] (state.change.logger)
[2017-06-26 23:42:38,792] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,33] (state.change.logger)
[2017-06-26 23:42:38,792] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-33 (state.change.logger)
[2017-06-26 23:42:38,792] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,41] (state.change.logger)
[2017-06-26 23:42:38,792] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 357 from controller 0 epoch 8 for partition [__consumer_offsets,33] (state.change.logger)
[2017-06-26 23:42:38,792] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 357 epoch 8 for partition [__consumer_offsets,33] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:38,793] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=33,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:38,793] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-33 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 358 (state.change.logger)
[2017-06-26 23:42:38,793] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:38,794] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,41] due to: No other replicas in ISR 1 for [__consumer_offsets,41] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:38,794] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,41] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,41] due to: No other replicas in ISR 1 for [__consumer_offsets,41] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,41] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 23:42:38,797] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,45] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:38,797] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,45] (state.change.logger)
[2017-06-26 23:42:38,797] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,45] (state.change.logger)
[2017-06-26 23:42:38,797] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-45 (state.change.logger)
[2017-06-26 23:42:38,797] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,35] (state.change.logger)
[2017-06-26 23:42:38,797] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 359 from controller 0 epoch 8 for partition [__consumer_offsets,45] (state.change.logger)
[2017-06-26 23:42:38,797] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 359 epoch 8 for partition [__consumer_offsets,45] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:38,797] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=45,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:38,798] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-45 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 360 (state.change.logger)
[2017-06-26 23:42:38,798] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:38,799] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,35] due to: No other replicas in ISR 1 for [__consumer_offsets,35] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:38,799] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,35] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,35] due to: No other replicas in ISR 1 for [__consumer_offsets,35] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,35] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:42:38,799] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,46] (state.change.logger)
[2017-06-26 23:42:38,801] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,46] due to: No other replicas in ISR 1 for [__consumer_offsets,46] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:38,801] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,46] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,46] due to: No other replicas in ISR 1 for [__consumer_offsets,46] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,46] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:42:38,802] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,19] (state.change.logger)
[2017-06-26 23:42:38,803] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,19] due to: No other replicas in ISR 1 for [__consumer_offsets,19] besides shutting down brokers 1. (state.change.logger)
[2017-06-26 23:42:38,803] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,19] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,19] due to: No other replicas in ISR 1 for [__consumer_offsets,19] besides shutting down brokers 1.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [__consumer_offsets,19] besides shutting down brokers 1
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:42:38,805] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,30] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:38,805] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,30] (state.change.logger)
[2017-06-26 23:42:38,806] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,30] (state.change.logger)
[2017-06-26 23:42:38,806] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0, 1) for partition __consumer_offsets-30 (state.change.logger)
[2017-06-26 23:42:38,806] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 361 from controller 0 epoch 8 for partition [__consumer_offsets,30] (state.change.logger)
[2017-06-26 23:42:38,806] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 361 epoch 8 for partition [__consumer_offsets,30] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:42:38,806] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=30,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:38,806] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-30 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 362 (state.change.logger)
[2017-06-26 23:42:38,807] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:42:58,900] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,19] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 23:42:58,900] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,47] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 23:42:58,900] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,41] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 23:42:58,900] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,29] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 23:42:58,900] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,17] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 23:42:58,901] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,10] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 23:42:58,901] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,40] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 23:42:58,901] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,22] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 23:42:58,901] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,5] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 23:42:58,901] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,23] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 23:42:58,901] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,11] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 23:42:58,901] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,13] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 23:42:58,901] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,49] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 23:42:58,901] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,28] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 23:42:58,901] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,4] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 23:42:58,901] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,37] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 23:42:58,901] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,31] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 23:42:58,901] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,34] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 23:42:58,901] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,46] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 23:42:58,901] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,25] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 23:42:58,901] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,43] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 23:42:58,901] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,35] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 23:42:58,901] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,7] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 23:42:58,901] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,1] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 23:42:58,901] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,16] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 23:42:58,901] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,19] (state.change.logger)
[2017-06-26 23:42:58,905] TRACE Controller 0 epoch 8 elected leader 0 for Offline partition [__consumer_offsets,19] (state.change.logger)
[2017-06-26 23:42:58,906] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,19] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-06-26 23:42:58,906] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,47] (state.change.logger)
[2017-06-26 23:42:58,910] TRACE Controller 0 epoch 8 elected leader 0 for Offline partition [__consumer_offsets,47] (state.change.logger)
[2017-06-26 23:42:58,910] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,47] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-06-26 23:42:58,910] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,29] (state.change.logger)
[2017-06-26 23:42:58,914] TRACE Controller 0 epoch 8 elected leader 0 for Offline partition [__consumer_offsets,29] (state.change.logger)
[2017-06-26 23:42:58,915] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,29] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-06-26 23:42:58,915] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,41] (state.change.logger)
[2017-06-26 23:42:58,919] TRACE Controller 0 epoch 8 elected leader 0 for Offline partition [__consumer_offsets,41] (state.change.logger)
[2017-06-26 23:42:58,920] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,41] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-06-26 23:42:58,920] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,17] (state.change.logger)
[2017-06-26 23:42:58,924] TRACE Controller 0 epoch 8 elected leader 0 for Offline partition [__consumer_offsets,17] (state.change.logger)
[2017-06-26 23:42:58,925] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,17] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-06-26 23:42:58,925] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,10] (state.change.logger)
[2017-06-26 23:42:58,930] TRACE Controller 0 epoch 8 elected leader 0 for Offline partition [__consumer_offsets,10] (state.change.logger)
[2017-06-26 23:42:58,930] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,10] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-06-26 23:42:58,930] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,40] (state.change.logger)
[2017-06-26 23:42:58,935] TRACE Controller 0 epoch 8 elected leader 0 for Offline partition [__consumer_offsets,40] (state.change.logger)
[2017-06-26 23:42:58,935] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,40] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-06-26 23:42:58,935] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,22] (state.change.logger)
[2017-06-26 23:42:58,941] TRACE Controller 0 epoch 8 elected leader 0 for Offline partition [__consumer_offsets,22] (state.change.logger)
[2017-06-26 23:42:58,941] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,22] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-06-26 23:42:58,941] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,5] (state.change.logger)
[2017-06-26 23:42:58,946] TRACE Controller 0 epoch 8 elected leader 0 for Offline partition [__consumer_offsets,5] (state.change.logger)
[2017-06-26 23:42:58,946] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,5] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-06-26 23:42:58,946] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,23] (state.change.logger)
[2017-06-26 23:42:58,950] TRACE Controller 0 epoch 8 elected leader 0 for Offline partition [__consumer_offsets,23] (state.change.logger)
[2017-06-26 23:42:58,951] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,23] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-06-26 23:42:58,951] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,11] (state.change.logger)
[2017-06-26 23:42:58,955] TRACE Controller 0 epoch 8 elected leader 0 for Offline partition [__consumer_offsets,11] (state.change.logger)
[2017-06-26 23:42:58,955] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,11] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-06-26 23:42:58,955] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,13] (state.change.logger)
[2017-06-26 23:42:58,959] TRACE Controller 0 epoch 8 elected leader 0 for Offline partition [__consumer_offsets,13] (state.change.logger)
[2017-06-26 23:42:58,960] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,13] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-06-26 23:42:58,960] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,49] (state.change.logger)
[2017-06-26 23:42:58,964] TRACE Controller 0 epoch 8 elected leader 0 for Offline partition [__consumer_offsets,49] (state.change.logger)
[2017-06-26 23:42:58,964] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,49] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-06-26 23:42:58,964] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,4] (state.change.logger)
[2017-06-26 23:42:58,968] TRACE Controller 0 epoch 8 elected leader 0 for Offline partition [__consumer_offsets,4] (state.change.logger)
[2017-06-26 23:42:58,969] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,4] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-06-26 23:42:58,969] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,28] (state.change.logger)
[2017-06-26 23:42:58,974] TRACE Controller 0 epoch 8 elected leader 0 for Offline partition [__consumer_offsets,28] (state.change.logger)
[2017-06-26 23:42:58,975] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,28] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-06-26 23:42:58,975] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,37] (state.change.logger)
[2017-06-26 23:42:58,979] TRACE Controller 0 epoch 8 elected leader 0 for Offline partition [__consumer_offsets,37] (state.change.logger)
[2017-06-26 23:42:58,980] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,37] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-06-26 23:42:58,980] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,31] (state.change.logger)
[2017-06-26 23:42:58,984] TRACE Controller 0 epoch 8 elected leader 0 for Offline partition [__consumer_offsets,31] (state.change.logger)
[2017-06-26 23:42:58,985] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,31] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-06-26 23:42:58,985] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,34] (state.change.logger)
[2017-06-26 23:42:58,989] TRACE Controller 0 epoch 8 elected leader 0 for Offline partition [__consumer_offsets,34] (state.change.logger)
[2017-06-26 23:42:58,989] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,34] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-06-26 23:42:58,989] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,46] (state.change.logger)
[2017-06-26 23:42:58,993] TRACE Controller 0 epoch 8 elected leader 0 for Offline partition [__consumer_offsets,46] (state.change.logger)
[2017-06-26 23:42:58,993] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,46] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-06-26 23:42:58,994] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,25] (state.change.logger)
[2017-06-26 23:42:58,999] TRACE Controller 0 epoch 8 elected leader 0 for Offline partition [__consumer_offsets,25] (state.change.logger)
[2017-06-26 23:42:59,000] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,25] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-06-26 23:42:59,000] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,43] (state.change.logger)
[2017-06-26 23:42:59,004] TRACE Controller 0 epoch 8 elected leader 0 for Offline partition [__consumer_offsets,43] (state.change.logger)
[2017-06-26 23:42:59,005] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,43] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-06-26 23:42:59,005] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,35] (state.change.logger)
[2017-06-26 23:42:59,009] TRACE Controller 0 epoch 8 elected leader 0 for Offline partition [__consumer_offsets,35] (state.change.logger)
[2017-06-26 23:42:59,009] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,35] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-06-26 23:42:59,009] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,7] (state.change.logger)
[2017-06-26 23:42:59,013] TRACE Controller 0 epoch 8 elected leader 0 for Offline partition [__consumer_offsets,7] (state.change.logger)
[2017-06-26 23:42:59,014] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,7] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-06-26 23:42:59,014] TRACE Controller 0 epoch 8 started leader election for partition [rf1p1,0] (state.change.logger)
[2017-06-26 23:42:59,016] ERROR Controller 0 epoch 8 initiated state change for partition [rf1p1,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [rf1p1,0] is alive. Live brokers are: [Set(0)], Assigned replicas are: [List(2)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 23:42:59,016] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,1] (state.change.logger)
[2017-06-26 23:42:59,020] TRACE Controller 0 epoch 8 elected leader 0 for Offline partition [__consumer_offsets,1] (state.change.logger)
[2017-06-26 23:42:59,021] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,1] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-06-26 23:42:59,021] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,16] (state.change.logger)
[2017-06-26 23:42:59,025] TRACE Controller 0 epoch 8 elected leader 0 for Offline partition [__consumer_offsets,16] (state.change.logger)
[2017-06-26 23:42:59,025] TRACE Controller 0 epoch 8 changed partition [__consumer_offsets,16] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-06-26 23:42:59,025] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,49] (state.change.logger)
[2017-06-26 23:42:59,025] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,16] (state.change.logger)
[2017-06-26 23:42:59,025] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,19] (state.change.logger)
[2017-06-26 23:42:59,025] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,13] (state.change.logger)
[2017-06-26 23:42:59,025] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,46] (state.change.logger)
[2017-06-26 23:42:59,025] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,35] (state.change.logger)
[2017-06-26 23:42:59,025] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,5] (state.change.logger)
[2017-06-26 23:42:59,025] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,43] (state.change.logger)
[2017-06-26 23:42:59,025] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,10] (state.change.logger)
[2017-06-26 23:42:59,025] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,37] (state.change.logger)
[2017-06-26 23:42:59,025] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,40] (state.change.logger)
[2017-06-26 23:42:59,025] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,29] (state.change.logger)
[2017-06-26 23:42:59,025] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,7] (state.change.logger)
[2017-06-26 23:42:59,025] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,23] (state.change.logger)
[2017-06-26 23:42:59,025] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,34] (state.change.logger)
[2017-06-26 23:42:59,025] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,4] (state.change.logger)
[2017-06-26 23:42:59,025] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,31] (state.change.logger)
[2017-06-26 23:42:59,026] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,1] (state.change.logger)
[2017-06-26 23:42:59,026] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,17] (state.change.logger)
[2017-06-26 23:42:59,026] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,28] (state.change.logger)
[2017-06-26 23:42:59,026] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,47] (state.change.logger)
[2017-06-26 23:42:59,026] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,25] (state.change.logger)
[2017-06-26 23:42:59,026] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,41] (state.change.logger)
[2017-06-26 23:42:59,026] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,11] (state.change.logger)
[2017-06-26 23:42:59,026] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,22] (state.change.logger)
[2017-06-26 23:42:59,026] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-49 (state.change.logger)
[2017-06-26 23:42:59,026] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-16 (state.change.logger)
[2017-06-26 23:42:59,026] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-19 (state.change.logger)
[2017-06-26 23:42:59,026] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-13 (state.change.logger)
[2017-06-26 23:42:59,026] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-35 (state.change.logger)
[2017-06-26 23:42:59,026] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-46 (state.change.logger)
[2017-06-26 23:42:59,026] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-5 (state.change.logger)
[2017-06-26 23:42:59,026] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-43 (state.change.logger)
[2017-06-26 23:42:59,026] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-10 (state.change.logger)
[2017-06-26 23:42:59,026] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-37 (state.change.logger)
[2017-06-26 23:42:59,026] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-40 (state.change.logger)
[2017-06-26 23:42:59,026] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-29 (state.change.logger)
[2017-06-26 23:42:59,026] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-7 (state.change.logger)
[2017-06-26 23:42:59,026] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-34 (state.change.logger)
[2017-06-26 23:42:59,026] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-23 (state.change.logger)
[2017-06-26 23:42:59,026] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-4 (state.change.logger)
[2017-06-26 23:42:59,026] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-31 (state.change.logger)
[2017-06-26 23:42:59,026] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-1 (state.change.logger)
[2017-06-26 23:42:59,026] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-28 (state.change.logger)
[2017-06-26 23:42:59,026] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-17 (state.change.logger)
[2017-06-26 23:42:59,026] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=9, replicas=[0, 1, 2]) correlation id 363 from controller 0 epoch 8 for partition [__consumer_offsets,13] (state.change.logger)
[2017-06-26 23:42:59,026] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-47 (state.change.logger)
[2017-06-26 23:42:59,026] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 363 from controller 0 epoch 8 for partition [__consumer_offsets,46] (state.change.logger)
[2017-06-26 23:42:59,026] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-25 (state.change.logger)
[2017-06-26 23:42:59,026] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=6, isr=[0], zkVersion=9, replicas=[0, 1, 2]) correlation id 363 from controller 0 epoch 8 for partition [__consumer_offsets,11] (state.change.logger)
[2017-06-26 23:42:59,026] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-41 (state.change.logger)
[2017-06-26 23:42:59,026] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=6, isr=[0], zkVersion=9, replicas=[0, 1, 2]) correlation id 363 from controller 0 epoch 8 for partition [__consumer_offsets,23] (state.change.logger)
[2017-06-26 23:42:59,026] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-11 (state.change.logger)
[2017-06-26 23:42:59,026] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 363 from controller 0 epoch 8 for partition [__consumer_offsets,19] (state.change.logger)
[2017-06-26 23:42:59,026] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-22 (state.change.logger)
[2017-06-26 23:42:59,026] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=6, isr=[0], zkVersion=9, replicas=[0, 1, 2]) correlation id 363 from controller 0 epoch 8 for partition [__consumer_offsets,17] (state.change.logger)
[2017-06-26 23:42:59,026] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 363 from controller 0 epoch 8 for partition [__consumer_offsets,28] (state.change.logger)
[2017-06-26 23:42:59,026] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 363 from controller 0 epoch 8 for partition [__consumer_offsets,7] (state.change.logger)
[2017-06-26 23:42:59,026] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 363 from controller 0 epoch 8 for partition [__consumer_offsets,40] (state.change.logger)
[2017-06-26 23:42:59,026] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=6, isr=[0], zkVersion=9, replicas=[0, 1, 2]) correlation id 363 from controller 0 epoch 8 for partition [__consumer_offsets,5] (state.change.logger)
[2017-06-26 23:42:59,026] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 363 from controller 0 epoch 8 for partition [__consumer_offsets,1] (state.change.logger)
[2017-06-26 23:42:59,026] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 363 from controller 0 epoch 8 for partition [__consumer_offsets,34] (state.change.logger)
[2017-06-26 23:42:59,026] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=6, isr=[0], zkVersion=9, replicas=[0, 1, 2]) correlation id 363 from controller 0 epoch 8 for partition [__consumer_offsets,47] (state.change.logger)
[2017-06-26 23:42:59,026] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 363 from controller 0 epoch 8 for partition [__consumer_offsets,16] (state.change.logger)
[2017-06-26 23:42:59,026] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 363 from controller 0 epoch 8 for partition [__consumer_offsets,43] (state.change.logger)
[2017-06-26 23:42:59,026] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=6, isr=[0], zkVersion=9, replicas=[0, 1, 2]) correlation id 363 from controller 0 epoch 8 for partition [__consumer_offsets,41] (state.change.logger)
[2017-06-26 23:42:59,026] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 363 from controller 0 epoch 8 for partition [__consumer_offsets,10] (state.change.logger)
[2017-06-26 23:42:59,026] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=8, replicas=[0, 1, 2]) correlation id 363 from controller 0 epoch 8 for partition [__consumer_offsets,22] (state.change.logger)
[2017-06-26 23:42:59,026] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 363 from controller 0 epoch 8 for partition [__consumer_offsets,49] (state.change.logger)
[2017-06-26 23:42:59,026] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 363 from controller 0 epoch 8 for partition [__consumer_offsets,31] (state.change.logger)
[2017-06-26 23:42:59,026] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=6, isr=[0], zkVersion=9, replicas=[0, 1, 2]) correlation id 363 from controller 0 epoch 8 for partition [__consumer_offsets,29] (state.change.logger)
[2017-06-26 23:42:59,027] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 363 from controller 0 epoch 8 for partition [__consumer_offsets,25] (state.change.logger)
[2017-06-26 23:42:59,027] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=8, replicas=[0, 1, 2]) correlation id 363 from controller 0 epoch 8 for partition [__consumer_offsets,37] (state.change.logger)
[2017-06-26 23:42:59,027] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=6, isr=[0], zkVersion=9, replicas=[0, 1, 2]) correlation id 363 from controller 0 epoch 8 for partition [__consumer_offsets,35] (state.change.logger)
[2017-06-26 23:42:59,027] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=8, replicas=[0, 1, 2]) correlation id 363 from controller 0 epoch 8 for partition [__consumer_offsets,4] (state.change.logger)
[2017-06-26 23:42:59,027] TRACE Broker 0 handling LeaderAndIsr request correlationId 363 from controller 0 epoch 8 starting the become-leader transition for partition __consumer_offsets-29 (state.change.logger)
[2017-06-26 23:42:59,027] TRACE Broker 0 handling LeaderAndIsr request correlationId 363 from controller 0 epoch 8 starting the become-leader transition for partition __consumer_offsets-10 (state.change.logger)
[2017-06-26 23:42:59,027] TRACE Broker 0 handling LeaderAndIsr request correlationId 363 from controller 0 epoch 8 starting the become-leader transition for partition __consumer_offsets-7 (state.change.logger)
[2017-06-26 23:42:59,027] TRACE Broker 0 handling LeaderAndIsr request correlationId 363 from controller 0 epoch 8 starting the become-leader transition for partition __consumer_offsets-4 (state.change.logger)
[2017-06-26 23:42:59,027] TRACE Broker 0 handling LeaderAndIsr request correlationId 363 from controller 0 epoch 8 starting the become-leader transition for partition __consumer_offsets-23 (state.change.logger)
[2017-06-26 23:42:59,027] TRACE Broker 0 handling LeaderAndIsr request correlationId 363 from controller 0 epoch 8 starting the become-leader transition for partition __consumer_offsets-1 (state.change.logger)
[2017-06-26 23:42:59,027] TRACE Broker 0 handling LeaderAndIsr request correlationId 363 from controller 0 epoch 8 starting the become-leader transition for partition __consumer_offsets-17 (state.change.logger)
[2017-06-26 23:42:59,027] TRACE Broker 0 handling LeaderAndIsr request correlationId 363 from controller 0 epoch 8 starting the become-leader transition for partition __consumer_offsets-49 (state.change.logger)
[2017-06-26 23:42:59,027] TRACE Broker 0 handling LeaderAndIsr request correlationId 363 from controller 0 epoch 8 starting the become-leader transition for partition __consumer_offsets-11 (state.change.logger)
[2017-06-26 23:42:59,027] TRACE Broker 0 handling LeaderAndIsr request correlationId 363 from controller 0 epoch 8 starting the become-leader transition for partition __consumer_offsets-46 (state.change.logger)
[2017-06-26 23:42:59,027] TRACE Broker 0 handling LeaderAndIsr request correlationId 363 from controller 0 epoch 8 starting the become-leader transition for partition __consumer_offsets-43 (state.change.logger)
[2017-06-26 23:42:59,027] TRACE Broker 0 handling LeaderAndIsr request correlationId 363 from controller 0 epoch 8 starting the become-leader transition for partition __consumer_offsets-5 (state.change.logger)
[2017-06-26 23:42:59,027] TRACE Broker 0 handling LeaderAndIsr request correlationId 363 from controller 0 epoch 8 starting the become-leader transition for partition __consumer_offsets-40 (state.change.logger)
[2017-06-26 23:42:59,027] TRACE Broker 0 handling LeaderAndIsr request correlationId 363 from controller 0 epoch 8 starting the become-leader transition for partition __consumer_offsets-37 (state.change.logger)
[2017-06-26 23:42:59,027] TRACE Broker 0 handling LeaderAndIsr request correlationId 363 from controller 0 epoch 8 starting the become-leader transition for partition __consumer_offsets-34 (state.change.logger)
[2017-06-26 23:42:59,027] TRACE Broker 0 handling LeaderAndIsr request correlationId 363 from controller 0 epoch 8 starting the become-leader transition for partition __consumer_offsets-31 (state.change.logger)
[2017-06-26 23:42:59,027] TRACE Broker 0 handling LeaderAndIsr request correlationId 363 from controller 0 epoch 8 starting the become-leader transition for partition __consumer_offsets-47 (state.change.logger)
[2017-06-26 23:42:59,027] TRACE Broker 0 handling LeaderAndIsr request correlationId 363 from controller 0 epoch 8 starting the become-leader transition for partition __consumer_offsets-19 (state.change.logger)
[2017-06-26 23:42:59,027] TRACE Broker 0 handling LeaderAndIsr request correlationId 363 from controller 0 epoch 8 starting the become-leader transition for partition __consumer_offsets-28 (state.change.logger)
[2017-06-26 23:42:59,027] TRACE Broker 0 handling LeaderAndIsr request correlationId 363 from controller 0 epoch 8 starting the become-leader transition for partition __consumer_offsets-35 (state.change.logger)
[2017-06-26 23:42:59,027] TRACE Broker 0 handling LeaderAndIsr request correlationId 363 from controller 0 epoch 8 starting the become-leader transition for partition __consumer_offsets-16 (state.change.logger)
[2017-06-26 23:42:59,027] TRACE Broker 0 handling LeaderAndIsr request correlationId 363 from controller 0 epoch 8 starting the become-leader transition for partition __consumer_offsets-25 (state.change.logger)
[2017-06-26 23:42:59,027] TRACE Broker 0 handling LeaderAndIsr request correlationId 363 from controller 0 epoch 8 starting the become-leader transition for partition __consumer_offsets-22 (state.change.logger)
[2017-06-26 23:42:59,027] TRACE Broker 0 handling LeaderAndIsr request correlationId 363 from controller 0 epoch 8 starting the become-leader transition for partition __consumer_offsets-41 (state.change.logger)
[2017-06-26 23:42:59,027] TRACE Broker 0 handling LeaderAndIsr request correlationId 363 from controller 0 epoch 8 starting the become-leader transition for partition __consumer_offsets-13 (state.change.logger)
[2017-06-26 23:42:59,029] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,28] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:59,030] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 8 with correlation id 363 for partition __consumer_offsets-22 (state.change.logger)
[2017-06-26 23:42:59,030] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 8 with correlation id 363 for partition __consumer_offsets-25 (state.change.logger)
[2017-06-26 23:42:59,030] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 8 with correlation id 363 for partition __consumer_offsets-28 (state.change.logger)
[2017-06-26 23:42:59,030] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 8 with correlation id 363 for partition __consumer_offsets-31 (state.change.logger)
[2017-06-26 23:42:59,030] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 8 with correlation id 363 for partition __consumer_offsets-34 (state.change.logger)
[2017-06-26 23:42:59,030] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 8 with correlation id 363 for partition __consumer_offsets-37 (state.change.logger)
[2017-06-26 23:42:59,030] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 8 with correlation id 363 for partition __consumer_offsets-40 (state.change.logger)
[2017-06-26 23:42:59,030] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 8 with correlation id 363 for partition __consumer_offsets-43 (state.change.logger)
[2017-06-26 23:42:59,030] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 8 with correlation id 363 for partition __consumer_offsets-46 (state.change.logger)
[2017-06-26 23:42:59,030] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 8 with correlation id 363 for partition __consumer_offsets-49 (state.change.logger)
[2017-06-26 23:42:59,030] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 8 with correlation id 363 for partition __consumer_offsets-11 (state.change.logger)
[2017-06-26 23:42:59,030] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 8 with correlation id 363 for partition __consumer_offsets-17 (state.change.logger)
[2017-06-26 23:42:59,031] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 8 with correlation id 363 for partition __consumer_offsets-5 (state.change.logger)
[2017-06-26 23:42:59,031] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 8 with correlation id 363 for partition __consumer_offsets-23 (state.change.logger)
[2017-06-26 23:42:59,031] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 8 with correlation id 363 for partition __consumer_offsets-29 (state.change.logger)
[2017-06-26 23:42:59,031] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 8 with correlation id 363 for partition __consumer_offsets-35 (state.change.logger)
[2017-06-26 23:42:59,031] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 8 with correlation id 363 for partition __consumer_offsets-41 (state.change.logger)
[2017-06-26 23:42:59,031] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 8 with correlation id 363 for partition __consumer_offsets-47 (state.change.logger)
[2017-06-26 23:42:59,031] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 8 with correlation id 363 for partition __consumer_offsets-1 (state.change.logger)
[2017-06-26 23:42:59,031] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 8 with correlation id 363 for partition __consumer_offsets-4 (state.change.logger)
[2017-06-26 23:42:59,031] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 8 with correlation id 363 for partition __consumer_offsets-7 (state.change.logger)
[2017-06-26 23:42:59,031] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 8 with correlation id 363 for partition __consumer_offsets-10 (state.change.logger)
[2017-06-26 23:42:59,031] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 8 with correlation id 363 for partition __consumer_offsets-13 (state.change.logger)
[2017-06-26 23:42:59,031] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 8 with correlation id 363 for partition __consumer_offsets-16 (state.change.logger)
[2017-06-26 23:42:59,031] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 8 with correlation id 363 for partition __consumer_offsets-19 (state.change.logger)
[2017-06-26 23:42:59,031] TRACE Broker 0 completed LeaderAndIsr request correlationId 363 from controller 0 epoch 8 for the become-leader transition for partition __consumer_offsets-29 (state.change.logger)
[2017-06-26 23:42:59,031] TRACE Broker 0 completed LeaderAndIsr request correlationId 363 from controller 0 epoch 8 for the become-leader transition for partition __consumer_offsets-10 (state.change.logger)
[2017-06-26 23:42:59,031] TRACE Broker 0 completed LeaderAndIsr request correlationId 363 from controller 0 epoch 8 for the become-leader transition for partition __consumer_offsets-7 (state.change.logger)
[2017-06-26 23:42:59,031] TRACE Broker 0 completed LeaderAndIsr request correlationId 363 from controller 0 epoch 8 for the become-leader transition for partition __consumer_offsets-4 (state.change.logger)
[2017-06-26 23:42:59,031] TRACE Broker 0 completed LeaderAndIsr request correlationId 363 from controller 0 epoch 8 for the become-leader transition for partition __consumer_offsets-23 (state.change.logger)
[2017-06-26 23:42:59,031] TRACE Broker 0 completed LeaderAndIsr request correlationId 363 from controller 0 epoch 8 for the become-leader transition for partition __consumer_offsets-1 (state.change.logger)
[2017-06-26 23:42:59,031] TRACE Broker 0 completed LeaderAndIsr request correlationId 363 from controller 0 epoch 8 for the become-leader transition for partition __consumer_offsets-17 (state.change.logger)
[2017-06-26 23:42:59,031] TRACE Broker 0 completed LeaderAndIsr request correlationId 363 from controller 0 epoch 8 for the become-leader transition for partition __consumer_offsets-49 (state.change.logger)
[2017-06-26 23:42:59,031] TRACE Broker 0 completed LeaderAndIsr request correlationId 363 from controller 0 epoch 8 for the become-leader transition for partition __consumer_offsets-11 (state.change.logger)
[2017-06-26 23:42:59,031] TRACE Broker 0 completed LeaderAndIsr request correlationId 363 from controller 0 epoch 8 for the become-leader transition for partition __consumer_offsets-46 (state.change.logger)
[2017-06-26 23:42:59,031] TRACE Broker 0 completed LeaderAndIsr request correlationId 363 from controller 0 epoch 8 for the become-leader transition for partition __consumer_offsets-43 (state.change.logger)
[2017-06-26 23:42:59,031] TRACE Broker 0 completed LeaderAndIsr request correlationId 363 from controller 0 epoch 8 for the become-leader transition for partition __consumer_offsets-5 (state.change.logger)
[2017-06-26 23:42:59,032] TRACE Broker 0 completed LeaderAndIsr request correlationId 363 from controller 0 epoch 8 for the become-leader transition for partition __consumer_offsets-40 (state.change.logger)
[2017-06-26 23:42:59,032] TRACE Broker 0 completed LeaderAndIsr request correlationId 363 from controller 0 epoch 8 for the become-leader transition for partition __consumer_offsets-37 (state.change.logger)
[2017-06-26 23:42:59,032] TRACE Broker 0 completed LeaderAndIsr request correlationId 363 from controller 0 epoch 8 for the become-leader transition for partition __consumer_offsets-34 (state.change.logger)
[2017-06-26 23:42:59,032] TRACE Broker 0 completed LeaderAndIsr request correlationId 363 from controller 0 epoch 8 for the become-leader transition for partition __consumer_offsets-31 (state.change.logger)
[2017-06-26 23:42:59,032] TRACE Broker 0 completed LeaderAndIsr request correlationId 363 from controller 0 epoch 8 for the become-leader transition for partition __consumer_offsets-47 (state.change.logger)
[2017-06-26 23:42:59,032] TRACE Broker 0 completed LeaderAndIsr request correlationId 363 from controller 0 epoch 8 for the become-leader transition for partition __consumer_offsets-19 (state.change.logger)
[2017-06-26 23:42:59,032] TRACE Broker 0 completed LeaderAndIsr request correlationId 363 from controller 0 epoch 8 for the become-leader transition for partition __consumer_offsets-28 (state.change.logger)
[2017-06-26 23:42:59,032] TRACE Broker 0 completed LeaderAndIsr request correlationId 363 from controller 0 epoch 8 for the become-leader transition for partition __consumer_offsets-35 (state.change.logger)
[2017-06-26 23:42:59,032] TRACE Broker 0 completed LeaderAndIsr request correlationId 363 from controller 0 epoch 8 for the become-leader transition for partition __consumer_offsets-16 (state.change.logger)
[2017-06-26 23:42:59,032] TRACE Broker 0 completed LeaderAndIsr request correlationId 363 from controller 0 epoch 8 for the become-leader transition for partition __consumer_offsets-25 (state.change.logger)
[2017-06-26 23:42:59,032] TRACE Broker 0 completed LeaderAndIsr request correlationId 363 from controller 0 epoch 8 for the become-leader transition for partition __consumer_offsets-22 (state.change.logger)
[2017-06-26 23:42:59,032] TRACE Broker 0 completed LeaderAndIsr request correlationId 363 from controller 0 epoch 8 for the become-leader transition for partition __consumer_offsets-41 (state.change.logger)
[2017-06-26 23:42:59,032] TRACE Broker 0 completed LeaderAndIsr request correlationId 363 from controller 0 epoch 8 for the become-leader transition for partition __consumer_offsets-13 (state.change.logger)
[2017-06-26 23:42:59,032] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,48] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:59,035] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,5] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:59,036] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,21] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:59,037] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,2] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:59,038] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,18] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:59,039] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,23] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:59,040] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,9] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:59,041] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,39] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:59,042] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,31] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:59,043] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,19] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:59,045] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,10] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:59,046] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,22] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:59,047] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,43] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:59,048] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,40] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:59,049] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,27] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:59,050] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,6] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:59,051] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,1] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:59,052] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,47] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:59,053] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,30] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:59,054] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,42] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:59,055] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,41] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:59,056] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,3] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:59,056] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,13] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:59,057] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,4] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:59,058] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,16] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:59,059] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,46] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:59,060] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,49] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:59,061] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,14] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:59,062] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,45] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:59,063] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,37] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:59,064] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,29] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:59,065] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,20] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:59,065] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,8] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:59,066] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,38] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:59,067] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,7] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:59,068] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,0] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:59,069] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,34] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:59,070] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,33] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:59,070] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,26] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:59,071] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,44] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:59,072] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,32] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:59,073] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,25] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:59,074] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,11] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:59,075] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,36] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:59,076] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,12] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:59,077] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,35] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:59,078] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,15] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:59,079] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,17] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:59,079] TRACE Controller 0 epoch 8 changed state of replica 1 for partition [__consumer_offsets,24] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 23:42:59,079] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,49] (state.change.logger)
[2017-06-26 23:42:59,079] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,38] (state.change.logger)
[2017-06-26 23:42:59,079] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,27] (state.change.logger)
[2017-06-26 23:42:59,079] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,16] (state.change.logger)
[2017-06-26 23:42:59,079] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,19] (state.change.logger)
[2017-06-26 23:42:59,079] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,8] (state.change.logger)
[2017-06-26 23:42:59,079] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,13] (state.change.logger)
[2017-06-26 23:42:59,079] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,2] (state.change.logger)
[2017-06-26 23:42:59,079] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,24] (state.change.logger)
[2017-06-26 23:42:59,079] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,46] (state.change.logger)
[2017-06-26 23:42:59,079] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,35] (state.change.logger)
[2017-06-26 23:42:59,079] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,5] (state.change.logger)
[2017-06-26 23:42:59,079] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,43] (state.change.logger)
[2017-06-26 23:42:59,079] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,21] (state.change.logger)
[2017-06-26 23:42:59,079] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,32] (state.change.logger)
[2017-06-26 23:42:59,079] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,10] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,37] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,48] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,40] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,18] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,29] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,7] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,23] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,45] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,34] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,26] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,4] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,15] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,42] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,9] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,31] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,20] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,1] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,12] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,28] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,17] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,6] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,39] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,44] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,47] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,36] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,3] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,14] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,25] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,41] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,30] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,22] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,33] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,11] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-follower LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 2 for partition [__consumer_offsets,0] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,49] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,38] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,27] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,16] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,19] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,8] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,13] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,2] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,24] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,46] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,35] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,5] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,43] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,21] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,32] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,10] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,37] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,48] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,40] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,18] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,29] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,7] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,23] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,45] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,34] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,26] (state.change.logger)
[2017-06-26 23:42:59,080] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,4] (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,15] (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,42] (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,9] (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,31] (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,20] (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,1] (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,12] (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,28] (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,17] (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,6] (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,39] (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,44] (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,47] (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,36] (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,3] (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,14] (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,25] (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,41] (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,30] (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,22] (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,33] (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,11] (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to broker 0 for partition [__consumer_offsets,0] (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-49 (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-38 (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-16 (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-27 (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-8 (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-19 (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-13 (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-2 (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-24 (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-35 (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-46 (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-5 (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-43 (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-32 (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-21 (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-10 (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-37 (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-48 (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-29 (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-40 (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-18 (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-7 (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-34 (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-45 (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-23 (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-26 (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-15 (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-4 (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-42 (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-20 (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-31 (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-9 (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-12 (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-1 (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-17 (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-28 (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-6 (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-39 (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-44 (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-36 (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-47 (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-25 (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-14 (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-3 (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-41 (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-30 (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-11 (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-33 (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-22 (state.change.logger)
[2017-06-26 23:42:59,081] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8) to brokers Set(0) for partition __consumer_offsets-0 (state.change.logger)
[2017-06-26 23:43:24,934] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,43] (state.change.logger)
[2017-06-26 23:43:24,935] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,43] due to: No other replicas in ISR 0 for [__consumer_offsets,43] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:24,935] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,43] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,43] due to: No other replicas in ISR 0 for [__consumer_offsets,43] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,43] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:24,935] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,14] (state.change.logger)
[2017-06-26 23:43:24,936] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,14] due to: No other replicas in ISR 0 for [__consumer_offsets,14] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:24,936] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,14] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,14] due to: No other replicas in ISR 0 for [__consumer_offsets,14] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,14] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:24,937] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,28] (state.change.logger)
[2017-06-26 23:43:24,938] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,28] due to: No other replicas in ISR 0 for [__consumer_offsets,28] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:24,938] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,28] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,28] due to: No other replicas in ISR 0 for [__consumer_offsets,28] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,28] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:24,938] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,4] (state.change.logger)
[2017-06-26 23:43:24,939] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,4] due to: No other replicas in ISR 0 for [__consumer_offsets,4] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:24,939] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,4] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,4] due to: No other replicas in ISR 0 for [__consumer_offsets,4] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,4] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:24,939] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,36] (state.change.logger)
[2017-06-26 23:43:24,940] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,36] due to: No other replicas in ISR 0 for [__consumer_offsets,36] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:24,940] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,36] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,36] due to: No other replicas in ISR 0 for [__consumer_offsets,36] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,36] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:24,941] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,6] (state.change.logger)
[2017-06-26 23:43:24,942] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,6] due to: No other replicas in ISR 0 for [__consumer_offsets,6] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:24,942] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,6] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,6] due to: No other replicas in ISR 0 for [__consumer_offsets,6] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,6] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:24,942] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,39] (state.change.logger)
[2017-06-26 23:43:24,943] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,39] due to: No other replicas in ISR 0 for [__consumer_offsets,39] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:24,943] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,39] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,39] due to: No other replicas in ISR 0 for [__consumer_offsets,39] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,39] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 23:43:24,943] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,23] (state.change.logger)
[2017-06-26 23:43:24,944] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,23] due to: No other replicas in ISR 0 for [__consumer_offsets,23] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:24,944] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,23] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,23] due to: No other replicas in ISR 0 for [__consumer_offsets,23] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,23] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 23:43:24,944] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,24] (state.change.logger)
[2017-06-26 23:43:24,945] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,24] due to: No other replicas in ISR 0 for [__consumer_offsets,24] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:24,945] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,24] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,24] due to: No other replicas in ISR 0 for [__consumer_offsets,24] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,24] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:24,945] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,38] (state.change.logger)
[2017-06-26 23:43:24,946] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,38] due to: No other replicas in ISR 0 for [__consumer_offsets,38] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:24,946] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,38] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,38] due to: No other replicas in ISR 0 for [__consumer_offsets,38] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,38] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:24,946] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,16] (state.change.logger)
[2017-06-26 23:43:24,947] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,16] due to: No other replicas in ISR 0 for [__consumer_offsets,16] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:24,947] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,16] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,16] due to: No other replicas in ISR 0 for [__consumer_offsets,16] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,16] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 24 more
[2017-06-26 23:43:24,948] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,3] (state.change.logger)
[2017-06-26 23:43:24,948] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,3] due to: No other replicas in ISR 0 for [__consumer_offsets,3] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:24,949] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,3] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,3] due to: No other replicas in ISR 0 for [__consumer_offsets,3] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,3] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 24 more
[2017-06-26 23:43:24,949] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,21] (state.change.logger)
[2017-06-26 23:43:24,950] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,21] due to: No other replicas in ISR 0 for [__consumer_offsets,21] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:24,950] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,21] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,21] due to: No other replicas in ISR 0 for [__consumer_offsets,21] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,21] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:24,950] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,10] (state.change.logger)
[2017-06-26 23:43:24,952] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,10] due to: No other replicas in ISR 0 for [__consumer_offsets,10] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:24,952] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,10] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,10] due to: No other replicas in ISR 0 for [__consumer_offsets,10] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,10] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:24,952] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,40] (state.change.logger)
[2017-06-26 23:43:24,953] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,40] due to: No other replicas in ISR 0 for [__consumer_offsets,40] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:24,953] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,40] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,40] due to: No other replicas in ISR 0 for [__consumer_offsets,40] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,40] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:24,953] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,34] (state.change.logger)
[2017-06-26 23:43:24,954] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,34] due to: No other replicas in ISR 0 for [__consumer_offsets,34] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:24,954] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,34] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,34] due to: No other replicas in ISR 0 for [__consumer_offsets,34] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,34] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 23:43:24,954] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,25] (state.change.logger)
[2017-06-26 23:43:24,963] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,25] due to: No other replicas in ISR 0 for [__consumer_offsets,25] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:24,963] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,25] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,25] due to: No other replicas in ISR 0 for [__consumer_offsets,25] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,25] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:24,963] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,27] (state.change.logger)
[2017-06-26 23:43:24,964] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,27] due to: No other replicas in ISR 0 for [__consumer_offsets,27] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:24,964] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,27] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,27] due to: No other replicas in ISR 0 for [__consumer_offsets,27] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,27] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:24,964] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,42] (state.change.logger)
[2017-06-26 23:43:24,965] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,42] due to: No other replicas in ISR 0 for [__consumer_offsets,42] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:24,965] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,42] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,42] due to: No other replicas in ISR 0 for [__consumer_offsets,42] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,42] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:24,965] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,11] (state.change.logger)
[2017-06-26 23:43:24,965] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,11] due to: No other replicas in ISR 0 for [__consumer_offsets,11] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:24,965] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,11] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,11] due to: No other replicas in ISR 0 for [__consumer_offsets,11] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,11] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:24,965] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,7] (state.change.logger)
[2017-06-26 23:43:24,966] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,7] due to: No other replicas in ISR 0 for [__consumer_offsets,7] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:24,966] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,7] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,7] due to: No other replicas in ISR 0 for [__consumer_offsets,7] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,7] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:24,966] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,47] (state.change.logger)
[2017-06-26 23:43:24,966] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,47] due to: No other replicas in ISR 0 for [__consumer_offsets,47] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:24,966] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,47] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,47] due to: No other replicas in ISR 0 for [__consumer_offsets,47] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,47] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:24,967] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,9] (state.change.logger)
[2017-06-26 23:43:24,967] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,9] due to: No other replicas in ISR 0 for [__consumer_offsets,9] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:24,967] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,9] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,9] due to: No other replicas in ISR 0 for [__consumer_offsets,9] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,9] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:24,967] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,13] (state.change.logger)
[2017-06-26 23:43:24,968] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,13] due to: No other replicas in ISR 0 for [__consumer_offsets,13] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:24,968] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,13] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,13] due to: No other replicas in ISR 0 for [__consumer_offsets,13] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,13] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 23:43:24,968] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,29] (state.change.logger)
[2017-06-26 23:43:24,968] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,29] due to: No other replicas in ISR 0 for [__consumer_offsets,29] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:24,968] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,29] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,29] due to: No other replicas in ISR 0 for [__consumer_offsets,29] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,29] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:24,968] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,8] (state.change.logger)
[2017-06-26 23:43:24,969] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,8] due to: No other replicas in ISR 0 for [__consumer_offsets,8] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:24,969] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,8] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,8] due to: No other replicas in ISR 0 for [__consumer_offsets,8] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,8] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:24,969] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,22] (state.change.logger)
[2017-06-26 23:43:24,969] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,22] due to: No other replicas in ISR 0 for [__consumer_offsets,22] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:24,969] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,22] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,22] due to: No other replicas in ISR 0 for [__consumer_offsets,22] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,22] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:24,970] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,31] (state.change.logger)
[2017-06-26 23:43:24,970] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,31] due to: No other replicas in ISR 0 for [__consumer_offsets,31] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:24,970] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,31] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,31] due to: No other replicas in ISR 0 for [__consumer_offsets,31] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,31] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 23:43:24,970] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,18] (state.change.logger)
[2017-06-26 23:43:24,971] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,18] due to: No other replicas in ISR 0 for [__consumer_offsets,18] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:24,971] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,18] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,18] due to: No other replicas in ISR 0 for [__consumer_offsets,18] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,18] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:24,971] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,20] (state.change.logger)
[2017-06-26 23:43:24,971] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,20] due to: No other replicas in ISR 0 for [__consumer_offsets,20] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:24,971] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,20] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,20] due to: No other replicas in ISR 0 for [__consumer_offsets,20] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,20] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:24,972] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,37] (state.change.logger)
[2017-06-26 23:43:24,972] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,37] due to: No other replicas in ISR 0 for [__consumer_offsets,37] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:24,972] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,37] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,37] due to: No other replicas in ISR 0 for [__consumer_offsets,37] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,37] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 23:43:24,972] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,49] (state.change.logger)
[2017-06-26 23:43:24,973] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,49] due to: No other replicas in ISR 0 for [__consumer_offsets,49] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:24,973] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,49] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,49] due to: No other replicas in ISR 0 for [__consumer_offsets,49] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,49] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:24,973] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,12] (state.change.logger)
[2017-06-26 23:43:24,973] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,12] due to: No other replicas in ISR 0 for [__consumer_offsets,12] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:24,973] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,12] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,12] due to: No other replicas in ISR 0 for [__consumer_offsets,12] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,12] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:24,973] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,5] (state.change.logger)
[2017-06-26 23:43:24,974] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,5] due to: No other replicas in ISR 0 for [__consumer_offsets,5] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:24,974] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,5] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,5] due to: No other replicas in ISR 0 for [__consumer_offsets,5] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,5] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:24,974] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,32] (state.change.logger)
[2017-06-26 23:43:24,974] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,32] due to: No other replicas in ISR 0 for [__consumer_offsets,32] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:24,975] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,32] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,32] due to: No other replicas in ISR 0 for [__consumer_offsets,32] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,32] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:24,975] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,2] (state.change.logger)
[2017-06-26 23:43:24,975] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,2] due to: No other replicas in ISR 0 for [__consumer_offsets,2] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:24,975] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,2] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,2] due to: No other replicas in ISR 0 for [__consumer_offsets,2] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,2] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:24,975] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,1] (state.change.logger)
[2017-06-26 23:43:24,976] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,1] due to: No other replicas in ISR 0 for [__consumer_offsets,1] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:24,976] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,1] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,1] due to: No other replicas in ISR 0 for [__consumer_offsets,1] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,1] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:24,976] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,0] (state.change.logger)
[2017-06-26 23:43:24,977] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,0] due to: No other replicas in ISR 0 for [__consumer_offsets,0] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:24,977] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,0] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,0] due to: No other replicas in ISR 0 for [__consumer_offsets,0] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,0] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:24,977] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,15] (state.change.logger)
[2017-06-26 23:43:24,977] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,15] due to: No other replicas in ISR 0 for [__consumer_offsets,15] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:24,977] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,15] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,15] due to: No other replicas in ISR 0 for [__consumer_offsets,15] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,15] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:24,977] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,44] (state.change.logger)
[2017-06-26 23:43:24,978] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,44] due to: No other replicas in ISR 0 for [__consumer_offsets,44] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:24,978] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,44] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,44] due to: No other replicas in ISR 0 for [__consumer_offsets,44] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,44] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 23 more
[2017-06-26 23:43:24,978] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,17] (state.change.logger)
[2017-06-26 23:43:24,979] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,17] due to: No other replicas in ISR 0 for [__consumer_offsets,17] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:24,979] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,17] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,17] due to: No other replicas in ISR 0 for [__consumer_offsets,17] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,17] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 23 more
[2017-06-26 23:43:24,979] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,48] (state.change.logger)
[2017-06-26 23:43:24,979] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,48] due to: No other replicas in ISR 0 for [__consumer_offsets,48] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:24,979] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,48] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,48] due to: No other replicas in ISR 0 for [__consumer_offsets,48] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,48] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 23:43:24,980] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,26] (state.change.logger)
[2017-06-26 23:43:24,980] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,26] due to: No other replicas in ISR 0 for [__consumer_offsets,26] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:24,980] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,26] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,26] due to: No other replicas in ISR 0 for [__consumer_offsets,26] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,26] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:24,980] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,33] (state.change.logger)
[2017-06-26 23:43:24,981] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,33] due to: No other replicas in ISR 0 for [__consumer_offsets,33] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:24,981] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,33] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,33] due to: No other replicas in ISR 0 for [__consumer_offsets,33] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,33] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:24,981] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,41] (state.change.logger)
[2017-06-26 23:43:24,982] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,41] due to: No other replicas in ISR 0 for [__consumer_offsets,41] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:24,982] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,41] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,41] due to: No other replicas in ISR 0 for [__consumer_offsets,41] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,41] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 23:43:24,982] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,45] (state.change.logger)
[2017-06-26 23:43:24,982] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,45] due to: No other replicas in ISR 0 for [__consumer_offsets,45] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:24,982] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,45] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,45] due to: No other replicas in ISR 0 for [__consumer_offsets,45] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,45] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 23:43:24,982] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,35] (state.change.logger)
[2017-06-26 23:43:24,983] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,35] due to: No other replicas in ISR 0 for [__consumer_offsets,35] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:24,983] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,35] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,35] due to: No other replicas in ISR 0 for [__consumer_offsets,35] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,35] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:24,983] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,46] (state.change.logger)
[2017-06-26 23:43:24,984] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,46] due to: No other replicas in ISR 0 for [__consumer_offsets,46] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:24,984] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,46] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,46] due to: No other replicas in ISR 0 for [__consumer_offsets,46] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,46] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:24,984] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,19] (state.change.logger)
[2017-06-26 23:43:24,984] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,19] due to: No other replicas in ISR 0 for [__consumer_offsets,19] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:24,984] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,19] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,19] due to: No other replicas in ISR 0 for [__consumer_offsets,19] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,19] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:24,984] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,30] (state.change.logger)
[2017-06-26 23:43:24,985] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,30] due to: No other replicas in ISR 0 for [__consumer_offsets,30] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:24,985] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,30] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,30] due to: No other replicas in ISR 0 for [__consumer_offsets,30] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,30] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 23:43:27,969] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=49,error_code=0},{topic=__consumer_offsets,partition=16,error_code=0},{topic=__consumer_offsets,partition=19,error_code=0},{topic=__consumer_offsets,partition=13,error_code=0},{topic=__consumer_offsets,partition=46,error_code=0},{topic=__consumer_offsets,partition=35,error_code=0},{topic=__consumer_offsets,partition=5,error_code=0},{topic=__consumer_offsets,partition=43,error_code=0},{topic=__consumer_offsets,partition=10,error_code=0},{topic=__consumer_offsets,partition=37,error_code=0},{topic=__consumer_offsets,partition=40,error_code=0},{topic=__consumer_offsets,partition=29,error_code=0},{topic=__consumer_offsets,partition=7,error_code=0},{topic=__consumer_offsets,partition=23,error_code=0},{topic=__consumer_offsets,partition=34,error_code=0},{topic=__consumer_offsets,partition=4,error_code=0},{topic=__consumer_offsets,partition=31,error_code=0},{topic=__consumer_offsets,partition=1,error_code=0},{topic=__consumer_offsets,partition=17,error_code=0},{topic=__consumer_offsets,partition=28,error_code=0},{topic=__consumer_offsets,partition=47,error_code=0},{topic=__consumer_offsets,partition=25,error_code=0},{topic=__consumer_offsets,partition=41,error_code=0},{topic=__consumer_offsets,partition=11,error_code=0},{topic=__consumer_offsets,partition=22,error_code=0}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:43:27,969] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-13 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 364 (state.change.logger)
[2017-06-26 23:43:27,969] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-46 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 364 (state.change.logger)
[2017-06-26 23:43:27,969] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-11 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 364 (state.change.logger)
[2017-06-26 23:43:27,969] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-23 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 364 (state.change.logger)
[2017-06-26 23:43:27,969] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-19 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 364 (state.change.logger)
[2017-06-26 23:43:27,969] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-17 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 364 (state.change.logger)
[2017-06-26 23:43:27,969] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-28 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 364 (state.change.logger)
[2017-06-26 23:43:27,969] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-7 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 364 (state.change.logger)
[2017-06-26 23:43:27,969] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-40 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 364 (state.change.logger)
[2017-06-26 23:43:27,969] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-5 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 364 (state.change.logger)
[2017-06-26 23:43:27,969] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-1 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 364 (state.change.logger)
[2017-06-26 23:43:27,969] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-34 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 364 (state.change.logger)
[2017-06-26 23:43:27,969] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-47 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 364 (state.change.logger)
[2017-06-26 23:43:27,969] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-16 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 364 (state.change.logger)
[2017-06-26 23:43:27,969] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-43 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 364 (state.change.logger)
[2017-06-26 23:43:27,969] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-41 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 364 (state.change.logger)
[2017-06-26 23:43:27,969] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-10 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 364 (state.change.logger)
[2017-06-26 23:43:27,969] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-22 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 364 (state.change.logger)
[2017-06-26 23:43:27,969] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-49 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 364 (state.change.logger)
[2017-06-26 23:43:27,969] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-31 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 364 (state.change.logger)
[2017-06-26 23:43:27,969] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-29 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 364 (state.change.logger)
[2017-06-26 23:43:27,969] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-25 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 364 (state.change.logger)
[2017-06-26 23:43:27,969] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-37 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 364 (state.change.logger)
[2017-06-26 23:43:27,969] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-35 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 364 (state.change.logger)
[2017-06-26 23:43:27,969] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-4 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 364 (state.change.logger)
[2017-06-26 23:43:27,969] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:43:27,972] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=9, replicas=[0, 1, 2]) correlation id 365 from controller 0 epoch 8 for partition [__consumer_offsets,13] (state.change.logger)
[2017-06-26 23:43:27,972] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 365 from controller 0 epoch 8 for partition [__consumer_offsets,46] (state.change.logger)
[2017-06-26 23:43:27,972] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 365 from controller 0 epoch 8 for partition [__consumer_offsets,9] (state.change.logger)
[2017-06-26 23:43:27,972] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 365 from controller 0 epoch 8 for partition [__consumer_offsets,42] (state.change.logger)
[2017-06-26 23:43:27,972] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 365 from controller 0 epoch 8 for partition [__consumer_offsets,21] (state.change.logger)
[2017-06-26 23:43:27,972] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=6, isr=[0], zkVersion=9, replicas=[0, 1, 2]) correlation id 365 from controller 0 epoch 8 for partition [__consumer_offsets,17] (state.change.logger)
[2017-06-26 23:43:27,972] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 365 from controller 0 epoch 8 for partition [__consumer_offsets,30] (state.change.logger)
[2017-06-26 23:43:27,972] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=8, replicas=[0, 1, 2]) correlation id 365 from controller 0 epoch 8 for partition [__consumer_offsets,26] (state.change.logger)
[2017-06-26 23:43:27,972] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=6, isr=[0], zkVersion=9, replicas=[0, 1, 2]) correlation id 365 from controller 0 epoch 8 for partition [__consumer_offsets,5] (state.change.logger)
[2017-06-26 23:43:27,972] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=8, replicas=[0, 1, 2]) correlation id 365 from controller 0 epoch 8 for partition [__consumer_offsets,38] (state.change.logger)
[2017-06-26 23:43:27,972] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 365 from controller 0 epoch 8 for partition [__consumer_offsets,1] (state.change.logger)
[2017-06-26 23:43:27,972] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 365 from controller 0 epoch 8 for partition [__consumer_offsets,34] (state.change.logger)
[2017-06-26 23:43:27,972] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 365 from controller 0 epoch 8 for partition [__consumer_offsets,16] (state.change.logger)
[2017-06-26 23:43:27,972] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 365 from controller 0 epoch 8 for partition [__consumer_offsets,45] (state.change.logger)
[2017-06-26 23:43:27,972] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 365 from controller 0 epoch 8 for partition [__consumer_offsets,12] (state.change.logger)
[2017-06-26 23:43:27,972] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=6, isr=[0], zkVersion=9, replicas=[0, 1, 2]) correlation id 365 from controller 0 epoch 8 for partition [__consumer_offsets,41] (state.change.logger)
[2017-06-26 23:43:27,972] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 365 from controller 0 epoch 8 for partition [__consumer_offsets,24] (state.change.logger)
[2017-06-26 23:43:27,972] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=8, replicas=[0, 1, 2]) correlation id 365 from controller 0 epoch 8 for partition [__consumer_offsets,20] (state.change.logger)
[2017-06-26 23:43:27,972] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 365 from controller 0 epoch 8 for partition [__consumer_offsets,49] (state.change.logger)
[2017-06-26 23:43:27,972] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 365 from controller 0 epoch 8 for partition [__consumer_offsets,0] (state.change.logger)
[2017-06-26 23:43:27,972] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=6, isr=[0], zkVersion=9, replicas=[0, 1, 2]) correlation id 365 from controller 0 epoch 8 for partition [__consumer_offsets,29] (state.change.logger)
[2017-06-26 23:43:27,972] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 365 from controller 0 epoch 8 for partition [__consumer_offsets,25] (state.change.logger)
[2017-06-26 23:43:27,972] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=8, replicas=[0, 1, 2]) correlation id 365 from controller 0 epoch 8 for partition [__consumer_offsets,8] (state.change.logger)
[2017-06-26 23:43:27,972] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=8, replicas=[0, 1, 2]) correlation id 365 from controller 0 epoch 8 for partition [__consumer_offsets,37] (state.change.logger)
[2017-06-26 23:43:27,972] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=8, replicas=[0, 1, 2]) correlation id 365 from controller 0 epoch 8 for partition [__consumer_offsets,4] (state.change.logger)
[2017-06-26 23:43:27,972] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 365 from controller 0 epoch 8 for partition [__consumer_offsets,33] (state.change.logger)
[2017-06-26 23:43:27,972] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 365 from controller 0 epoch 8 for partition [__consumer_offsets,15] (state.change.logger)
[2017-06-26 23:43:27,972] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 365 from controller 0 epoch 8 for partition [__consumer_offsets,48] (state.change.logger)
[2017-06-26 23:43:27,972] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=6, isr=[0], zkVersion=9, replicas=[0, 1, 2]) correlation id 365 from controller 0 epoch 8 for partition [__consumer_offsets,11] (state.change.logger)
[2017-06-26 23:43:27,972] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=8, replicas=[0, 1, 2]) correlation id 365 from controller 0 epoch 8 for partition [__consumer_offsets,44] (state.change.logger)
[2017-06-26 23:43:27,972] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=6, isr=[0], zkVersion=9, replicas=[0, 1, 2]) correlation id 365 from controller 0 epoch 8 for partition [__consumer_offsets,23] (state.change.logger)
[2017-06-26 23:43:27,972] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 365 from controller 0 epoch 8 for partition [__consumer_offsets,19] (state.change.logger)
[2017-06-26 23:43:27,972] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=8, replicas=[0, 1, 2]) correlation id 365 from controller 0 epoch 8 for partition [__consumer_offsets,32] (state.change.logger)
[2017-06-26 23:43:27,972] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 365 from controller 0 epoch 8 for partition [__consumer_offsets,28] (state.change.logger)
[2017-06-26 23:43:27,972] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 365 from controller 0 epoch 8 for partition [__consumer_offsets,7] (state.change.logger)
[2017-06-26 23:43:27,972] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 365 from controller 0 epoch 8 for partition [__consumer_offsets,40] (state.change.logger)
[2017-06-26 23:43:27,972] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 365 from controller 0 epoch 8 for partition [__consumer_offsets,3] (state.change.logger)
[2017-06-26 23:43:27,972] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 365 from controller 0 epoch 8 for partition [__consumer_offsets,36] (state.change.logger)
[2017-06-26 23:43:27,972] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=6, isr=[0], zkVersion=9, replicas=[0, 1, 2]) correlation id 365 from controller 0 epoch 8 for partition [__consumer_offsets,47] (state.change.logger)
[2017-06-26 23:43:27,972] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=8, replicas=[0, 1, 2]) correlation id 365 from controller 0 epoch 8 for partition [__consumer_offsets,14] (state.change.logger)
[2017-06-26 23:43:27,972] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 365 from controller 0 epoch 8 for partition [__consumer_offsets,43] (state.change.logger)
[2017-06-26 23:43:27,972] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 365 from controller 0 epoch 8 for partition [__consumer_offsets,10] (state.change.logger)
[2017-06-26 23:43:27,972] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=8, replicas=[0, 1, 2]) correlation id 365 from controller 0 epoch 8 for partition [__consumer_offsets,22] (state.change.logger)
[2017-06-26 23:43:27,972] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 365 from controller 0 epoch 8 for partition [__consumer_offsets,18] (state.change.logger)
[2017-06-26 23:43:27,972] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 365 from controller 0 epoch 8 for partition [__consumer_offsets,31] (state.change.logger)
[2017-06-26 23:43:27,972] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 365 from controller 0 epoch 8 for partition [__consumer_offsets,27] (state.change.logger)
[2017-06-26 23:43:27,972] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 365 from controller 0 epoch 8 for partition [__consumer_offsets,39] (state.change.logger)
[2017-06-26 23:43:27,972] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=4, isr=[0], zkVersion=6, replicas=[0, 1, 2]) correlation id 365 from controller 0 epoch 8 for partition [__consumer_offsets,6] (state.change.logger)
[2017-06-26 23:43:27,972] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=6, isr=[0], zkVersion=9, replicas=[0, 1, 2]) correlation id 365 from controller 0 epoch 8 for partition [__consumer_offsets,35] (state.change.logger)
[2017-06-26 23:43:27,972] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=8, replicas=[0, 1, 2]) correlation id 365 from controller 0 epoch 8 for partition [__consumer_offsets,2] (state.change.logger)
[2017-06-26 23:43:27,972] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 365 epoch 8 for partition [__consumer_offsets,13] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:43:27,972] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 365 epoch 8 for partition [__consumer_offsets,46] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:43:27,972] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 365 epoch 8 for partition [__consumer_offsets,9] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:43:27,972] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 365 epoch 8 for partition [__consumer_offsets,42] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:43:27,972] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 365 epoch 8 for partition [__consumer_offsets,21] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:43:27,972] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 365 epoch 8 for partition [__consumer_offsets,17] since its associated leader epoch 6 is not higher than the current leader epoch 6 (state.change.logger)
[2017-06-26 23:43:27,972] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 365 epoch 8 for partition [__consumer_offsets,30] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:43:27,972] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 365 epoch 8 for partition [__consumer_offsets,26] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:43:27,972] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 365 epoch 8 for partition [__consumer_offsets,5] since its associated leader epoch 6 is not higher than the current leader epoch 6 (state.change.logger)
[2017-06-26 23:43:27,973] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 365 epoch 8 for partition [__consumer_offsets,38] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:43:27,973] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 365 epoch 8 for partition [__consumer_offsets,1] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:43:27,973] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 365 epoch 8 for partition [__consumer_offsets,34] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:43:27,973] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 365 epoch 8 for partition [__consumer_offsets,16] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:43:27,973] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 365 epoch 8 for partition [__consumer_offsets,45] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:43:27,973] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 365 epoch 8 for partition [__consumer_offsets,12] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:43:27,973] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 365 epoch 8 for partition [__consumer_offsets,41] since its associated leader epoch 6 is not higher than the current leader epoch 6 (state.change.logger)
[2017-06-26 23:43:27,973] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 365 epoch 8 for partition [__consumer_offsets,24] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:43:27,973] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 365 epoch 8 for partition [__consumer_offsets,20] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:43:27,973] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 365 epoch 8 for partition [__consumer_offsets,49] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:43:27,973] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 365 epoch 8 for partition [__consumer_offsets,0] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:43:27,973] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 365 epoch 8 for partition [__consumer_offsets,29] since its associated leader epoch 6 is not higher than the current leader epoch 6 (state.change.logger)
[2017-06-26 23:43:27,973] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 365 epoch 8 for partition [__consumer_offsets,25] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:43:27,973] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 365 epoch 8 for partition [__consumer_offsets,8] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:43:27,973] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 365 epoch 8 for partition [__consumer_offsets,37] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:43:27,973] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 365 epoch 8 for partition [__consumer_offsets,4] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:43:27,973] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 365 epoch 8 for partition [__consumer_offsets,33] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:43:27,973] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 365 epoch 8 for partition [__consumer_offsets,15] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:43:27,973] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 365 epoch 8 for partition [__consumer_offsets,48] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:43:27,973] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 365 epoch 8 for partition [__consumer_offsets,11] since its associated leader epoch 6 is not higher than the current leader epoch 6 (state.change.logger)
[2017-06-26 23:43:27,973] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 365 epoch 8 for partition [__consumer_offsets,44] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:43:27,973] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 365 epoch 8 for partition [__consumer_offsets,23] since its associated leader epoch 6 is not higher than the current leader epoch 6 (state.change.logger)
[2017-06-26 23:43:27,973] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 365 epoch 8 for partition [__consumer_offsets,19] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:43:27,973] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 365 epoch 8 for partition [__consumer_offsets,32] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:43:27,973] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 365 epoch 8 for partition [__consumer_offsets,28] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:43:27,973] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 365 epoch 8 for partition [__consumer_offsets,7] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:43:27,973] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 365 epoch 8 for partition [__consumer_offsets,40] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:43:27,973] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 365 epoch 8 for partition [__consumer_offsets,3] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:43:27,973] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 365 epoch 8 for partition [__consumer_offsets,36] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:43:27,973] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 365 epoch 8 for partition [__consumer_offsets,47] since its associated leader epoch 6 is not higher than the current leader epoch 6 (state.change.logger)
[2017-06-26 23:43:27,973] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 365 epoch 8 for partition [__consumer_offsets,14] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:43:27,973] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 365 epoch 8 for partition [__consumer_offsets,43] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:43:27,973] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 365 epoch 8 for partition [__consumer_offsets,10] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:43:27,973] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 365 epoch 8 for partition [__consumer_offsets,22] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:43:27,973] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 365 epoch 8 for partition [__consumer_offsets,18] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:43:27,973] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 365 epoch 8 for partition [__consumer_offsets,31] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:43:27,973] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 365 epoch 8 for partition [__consumer_offsets,27] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:43:27,973] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 365 epoch 8 for partition [__consumer_offsets,39] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:43:27,973] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 365 epoch 8 for partition [__consumer_offsets,6] since its associated leader epoch 4 is not higher than the current leader epoch 4 (state.change.logger)
[2017-06-26 23:43:27,973] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 365 epoch 8 for partition [__consumer_offsets,35] since its associated leader epoch 6 is not higher than the current leader epoch 6 (state.change.logger)
[2017-06-26 23:43:27,973] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 365 epoch 8 for partition [__consumer_offsets,2] since its associated leader epoch 5 is not higher than the current leader epoch 5 (state.change.logger)
[2017-06-26 23:43:27,973] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=49,error_code=11},{topic=__consumer_offsets,partition=38,error_code=11},{topic=__consumer_offsets,partition=16,error_code=11},{topic=__consumer_offsets,partition=27,error_code=11},{topic=__consumer_offsets,partition=8,error_code=11},{topic=__consumer_offsets,partition=19,error_code=11},{topic=__consumer_offsets,partition=2,error_code=11},{topic=__consumer_offsets,partition=13,error_code=11},{topic=__consumer_offsets,partition=24,error_code=11},{topic=__consumer_offsets,partition=46,error_code=11},{topic=__consumer_offsets,partition=35,error_code=11},{topic=__consumer_offsets,partition=5,error_code=11},{topic=__consumer_offsets,partition=43,error_code=11},{topic=__consumer_offsets,partition=21,error_code=11},{topic=__consumer_offsets,partition=32,error_code=11},{topic=__consumer_offsets,partition=10,error_code=11},{topic=__consumer_offsets,partition=37,error_code=11},{topic=__consumer_offsets,partition=48,error_code=11},{topic=__consumer_offsets,partition=29,error_code=11},{topic=__consumer_offsets,partition=40,error_code=11},{topic=__consumer_offsets,partition=18,error_code=11},{topic=__consumer_offsets,partition=7,error_code=11},{topic=__consumer_offsets,partition=45,error_code=11},{topic=__consumer_offsets,partition=34,error_code=11},{topic=__consumer_offsets,partition=23,error_code=11},{topic=__consumer_offsets,partition=26,error_code=11},{topic=__consumer_offsets,partition=4,error_code=11},{topic=__consumer_offsets,partition=15,error_code=11},{topic=__consumer_offsets,partition=42,error_code=11},{topic=__consumer_offsets,partition=20,error_code=11},{topic=__consumer_offsets,partition=9,error_code=11},{topic=__consumer_offsets,partition=31,error_code=11},{topic=__consumer_offsets,partition=12,error_code=11},{topic=__consumer_offsets,partition=1,error_code=11},{topic=__consumer_offsets,partition=17,error_code=11},{topic=__consumer_offsets,partition=28,error_code=11},{topic=__consumer_offsets,partition=6,error_code=11},{topic=__consumer_offsets,partition=39,error_code=11},{topic=__consumer_offsets,partition=44,error_code=11},{topic=__consumer_offsets,partition=36,error_code=11},{topic=__consumer_offsets,partition=47,error_code=11},{topic=__consumer_offsets,partition=25,error_code=11},{topic=__consumer_offsets,partition=3,error_code=11},{topic=__consumer_offsets,partition=14,error_code=11},{topic=__consumer_offsets,partition=41,error_code=11},{topic=__consumer_offsets,partition=30,error_code=11},{topic=__consumer_offsets,partition=33,error_code=11},{topic=__consumer_offsets,partition=11,error_code=11},{topic=__consumer_offsets,partition=22,error_code=11},{topic=__consumer_offsets,partition=0,error_code=11}]} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:43:27,973] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-13 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 366 (state.change.logger)
[2017-06-26 23:43:27,973] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-46 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 366 (state.change.logger)
[2017-06-26 23:43:27,974] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-9 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 366 (state.change.logger)
[2017-06-26 23:43:27,974] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-42 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 366 (state.change.logger)
[2017-06-26 23:43:27,974] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-21 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 366 (state.change.logger)
[2017-06-26 23:43:27,974] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-17 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 366 (state.change.logger)
[2017-06-26 23:43:27,974] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-30 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 366 (state.change.logger)
[2017-06-26 23:43:27,974] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-26 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 366 (state.change.logger)
[2017-06-26 23:43:27,974] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-5 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 366 (state.change.logger)
[2017-06-26 23:43:27,974] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-38 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 366 (state.change.logger)
[2017-06-26 23:43:27,974] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-1 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 366 (state.change.logger)
[2017-06-26 23:43:27,974] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-34 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 366 (state.change.logger)
[2017-06-26 23:43:27,974] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-16 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 366 (state.change.logger)
[2017-06-26 23:43:27,974] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-45 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 366 (state.change.logger)
[2017-06-26 23:43:27,974] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-12 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 366 (state.change.logger)
[2017-06-26 23:43:27,974] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-41 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 366 (state.change.logger)
[2017-06-26 23:43:27,974] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-24 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 366 (state.change.logger)
[2017-06-26 23:43:27,974] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-20 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 366 (state.change.logger)
[2017-06-26 23:43:27,974] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-49 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 366 (state.change.logger)
[2017-06-26 23:43:27,974] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-0 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 366 (state.change.logger)
[2017-06-26 23:43:27,974] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-29 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 366 (state.change.logger)
[2017-06-26 23:43:27,974] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-25 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 366 (state.change.logger)
[2017-06-26 23:43:27,974] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-8 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 366 (state.change.logger)
[2017-06-26 23:43:27,974] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-37 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 366 (state.change.logger)
[2017-06-26 23:43:27,974] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-4 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 366 (state.change.logger)
[2017-06-26 23:43:27,974] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-33 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 366 (state.change.logger)
[2017-06-26 23:43:27,974] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-15 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 366 (state.change.logger)
[2017-06-26 23:43:27,974] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-48 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 366 (state.change.logger)
[2017-06-26 23:43:27,974] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-11 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 366 (state.change.logger)
[2017-06-26 23:43:27,974] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-44 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 366 (state.change.logger)
[2017-06-26 23:43:27,974] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-23 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 366 (state.change.logger)
[2017-06-26 23:43:27,974] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-19 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 366 (state.change.logger)
[2017-06-26 23:43:27,974] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-32 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 366 (state.change.logger)
[2017-06-26 23:43:27,974] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-28 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 366 (state.change.logger)
[2017-06-26 23:43:27,974] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-7 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 366 (state.change.logger)
[2017-06-26 23:43:27,974] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-40 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 366 (state.change.logger)
[2017-06-26 23:43:27,974] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-3 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 366 (state.change.logger)
[2017-06-26 23:43:27,974] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-36 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 366 (state.change.logger)
[2017-06-26 23:43:27,974] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-47 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 366 (state.change.logger)
[2017-06-26 23:43:27,974] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-14 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 366 (state.change.logger)
[2017-06-26 23:43:27,974] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-43 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 366 (state.change.logger)
[2017-06-26 23:43:27,974] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-10 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 366 (state.change.logger)
[2017-06-26 23:43:27,974] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-22 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 366 (state.change.logger)
[2017-06-26 23:43:27,974] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-18 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 366 (state.change.logger)
[2017-06-26 23:43:27,974] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-31 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 366 (state.change.logger)
[2017-06-26 23:43:27,974] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-27 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 366 (state.change.logger)
[2017-06-26 23:43:27,974] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-39 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 366 (state.change.logger)
[2017-06-26 23:43:27,974] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-6 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 366 (state.change.logger)
[2017-06-26 23:43:27,974] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-35 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 366 (state.change.logger)
[2017-06-26 23:43:27,974] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-2 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 366 (state.change.logger)
[2017-06-26 23:43:27,974] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker 192.168.0.101:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 23:43:29,995] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,43] (state.change.logger)
[2017-06-26 23:43:29,995] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,43] due to: No other replicas in ISR 0 for [__consumer_offsets,43] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:29,995] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,43] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,43] due to: No other replicas in ISR 0 for [__consumer_offsets,43] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,43] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:29,996] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,14] (state.change.logger)
[2017-06-26 23:43:29,996] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,14] due to: No other replicas in ISR 0 for [__consumer_offsets,14] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:29,996] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,14] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,14] due to: No other replicas in ISR 0 for [__consumer_offsets,14] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,14] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:29,997] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,28] (state.change.logger)
[2017-06-26 23:43:29,997] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,28] due to: No other replicas in ISR 0 for [__consumer_offsets,28] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:29,997] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,28] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,28] due to: No other replicas in ISR 0 for [__consumer_offsets,28] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,28] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:29,997] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,4] (state.change.logger)
[2017-06-26 23:43:29,998] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,4] due to: No other replicas in ISR 0 for [__consumer_offsets,4] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:29,998] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,4] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,4] due to: No other replicas in ISR 0 for [__consumer_offsets,4] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,4] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:29,998] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,36] (state.change.logger)
[2017-06-26 23:43:29,999] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,36] due to: No other replicas in ISR 0 for [__consumer_offsets,36] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:29,999] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,36] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,36] due to: No other replicas in ISR 0 for [__consumer_offsets,36] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,36] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:29,999] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,6] (state.change.logger)
[2017-06-26 23:43:30,000] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,6] due to: No other replicas in ISR 0 for [__consumer_offsets,6] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:30,000] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,6] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,6] due to: No other replicas in ISR 0 for [__consumer_offsets,6] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,6] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:30,000] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,39] (state.change.logger)
[2017-06-26 23:43:30,000] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,39] due to: No other replicas in ISR 0 for [__consumer_offsets,39] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:30,000] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,39] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,39] due to: No other replicas in ISR 0 for [__consumer_offsets,39] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,39] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 23:43:30,001] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,23] (state.change.logger)
[2017-06-26 23:43:30,002] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,23] due to: No other replicas in ISR 0 for [__consumer_offsets,23] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:30,002] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,23] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,23] due to: No other replicas in ISR 0 for [__consumer_offsets,23] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,23] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 23:43:30,002] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,24] (state.change.logger)
[2017-06-26 23:43:30,002] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,24] due to: No other replicas in ISR 0 for [__consumer_offsets,24] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:30,002] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,24] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,24] due to: No other replicas in ISR 0 for [__consumer_offsets,24] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,24] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:30,002] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,38] (state.change.logger)
[2017-06-26 23:43:30,003] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,38] due to: No other replicas in ISR 0 for [__consumer_offsets,38] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:30,003] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,38] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,38] due to: No other replicas in ISR 0 for [__consumer_offsets,38] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,38] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:30,004] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,16] (state.change.logger)
[2017-06-26 23:43:30,004] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,16] due to: No other replicas in ISR 0 for [__consumer_offsets,16] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:30,004] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,16] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,16] due to: No other replicas in ISR 0 for [__consumer_offsets,16] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,16] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 24 more
[2017-06-26 23:43:30,004] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,3] (state.change.logger)
[2017-06-26 23:43:30,005] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,3] due to: No other replicas in ISR 0 for [__consumer_offsets,3] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:30,005] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,3] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,3] due to: No other replicas in ISR 0 for [__consumer_offsets,3] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,3] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 24 more
[2017-06-26 23:43:30,005] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,21] (state.change.logger)
[2017-06-26 23:43:30,006] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,21] due to: No other replicas in ISR 0 for [__consumer_offsets,21] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:30,006] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,21] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,21] due to: No other replicas in ISR 0 for [__consumer_offsets,21] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,21] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:30,006] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,10] (state.change.logger)
[2017-06-26 23:43:30,007] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,10] due to: No other replicas in ISR 0 for [__consumer_offsets,10] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:30,007] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,10] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,10] due to: No other replicas in ISR 0 for [__consumer_offsets,10] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,10] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:30,007] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,40] (state.change.logger)
[2017-06-26 23:43:30,011] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,40] due to: No other replicas in ISR 0 for [__consumer_offsets,40] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:30,011] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,40] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,40] due to: No other replicas in ISR 0 for [__consumer_offsets,40] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,40] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:30,011] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,34] (state.change.logger)
[2017-06-26 23:43:30,012] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,34] due to: No other replicas in ISR 0 for [__consumer_offsets,34] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:30,012] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,34] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,34] due to: No other replicas in ISR 0 for [__consumer_offsets,34] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,34] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 23:43:30,012] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,25] (state.change.logger)
[2017-06-26 23:43:30,012] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,25] due to: No other replicas in ISR 0 for [__consumer_offsets,25] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:30,012] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,25] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,25] due to: No other replicas in ISR 0 for [__consumer_offsets,25] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,25] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:30,012] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,27] (state.change.logger)
[2017-06-26 23:43:30,013] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,27] due to: No other replicas in ISR 0 for [__consumer_offsets,27] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:30,013] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,27] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,27] due to: No other replicas in ISR 0 for [__consumer_offsets,27] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,27] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:30,013] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,42] (state.change.logger)
[2017-06-26 23:43:30,014] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,42] due to: No other replicas in ISR 0 for [__consumer_offsets,42] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:30,014] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,42] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,42] due to: No other replicas in ISR 0 for [__consumer_offsets,42] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,42] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:30,014] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,11] (state.change.logger)
[2017-06-26 23:43:30,014] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,11] due to: No other replicas in ISR 0 for [__consumer_offsets,11] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:30,014] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,11] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,11] due to: No other replicas in ISR 0 for [__consumer_offsets,11] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,11] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:30,015] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,7] (state.change.logger)
[2017-06-26 23:43:30,015] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,7] due to: No other replicas in ISR 0 for [__consumer_offsets,7] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:30,015] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,7] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,7] due to: No other replicas in ISR 0 for [__consumer_offsets,7] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,7] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:30,015] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,47] (state.change.logger)
[2017-06-26 23:43:30,016] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,47] due to: No other replicas in ISR 0 for [__consumer_offsets,47] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:30,016] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,47] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,47] due to: No other replicas in ISR 0 for [__consumer_offsets,47] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,47] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:30,016] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,9] (state.change.logger)
[2017-06-26 23:43:30,016] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,9] due to: No other replicas in ISR 0 for [__consumer_offsets,9] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:30,016] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,9] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,9] due to: No other replicas in ISR 0 for [__consumer_offsets,9] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,9] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:30,017] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,13] (state.change.logger)
[2017-06-26 23:43:30,017] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,13] due to: No other replicas in ISR 0 for [__consumer_offsets,13] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:30,017] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,13] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,13] due to: No other replicas in ISR 0 for [__consumer_offsets,13] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,13] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 23:43:30,017] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,29] (state.change.logger)
[2017-06-26 23:43:30,018] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,29] due to: No other replicas in ISR 0 for [__consumer_offsets,29] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:30,018] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,29] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,29] due to: No other replicas in ISR 0 for [__consumer_offsets,29] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,29] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:30,018] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,8] (state.change.logger)
[2017-06-26 23:43:30,018] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,8] due to: No other replicas in ISR 0 for [__consumer_offsets,8] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:30,018] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,8] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,8] due to: No other replicas in ISR 0 for [__consumer_offsets,8] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,8] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:30,018] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,22] (state.change.logger)
[2017-06-26 23:43:30,019] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,22] due to: No other replicas in ISR 0 for [__consumer_offsets,22] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:30,019] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,22] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,22] due to: No other replicas in ISR 0 for [__consumer_offsets,22] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,22] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:30,019] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,31] (state.change.logger)
[2017-06-26 23:43:30,019] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,31] due to: No other replicas in ISR 0 for [__consumer_offsets,31] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:30,019] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,31] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,31] due to: No other replicas in ISR 0 for [__consumer_offsets,31] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,31] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 23:43:30,020] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,18] (state.change.logger)
[2017-06-26 23:43:30,020] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,18] due to: No other replicas in ISR 0 for [__consumer_offsets,18] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:30,020] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,18] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,18] due to: No other replicas in ISR 0 for [__consumer_offsets,18] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,18] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:30,020] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,20] (state.change.logger)
[2017-06-26 23:43:30,021] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,20] due to: No other replicas in ISR 0 for [__consumer_offsets,20] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:30,021] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,20] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,20] due to: No other replicas in ISR 0 for [__consumer_offsets,20] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,20] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:30,021] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,37] (state.change.logger)
[2017-06-26 23:43:30,022] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,37] due to: No other replicas in ISR 0 for [__consumer_offsets,37] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:30,022] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,37] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,37] due to: No other replicas in ISR 0 for [__consumer_offsets,37] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,37] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 23:43:30,022] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,49] (state.change.logger)
[2017-06-26 23:43:30,022] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,49] due to: No other replicas in ISR 0 for [__consumer_offsets,49] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:30,022] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,49] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,49] due to: No other replicas in ISR 0 for [__consumer_offsets,49] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,49] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:30,023] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,12] (state.change.logger)
[2017-06-26 23:43:30,023] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,12] due to: No other replicas in ISR 0 for [__consumer_offsets,12] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:30,023] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,12] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,12] due to: No other replicas in ISR 0 for [__consumer_offsets,12] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,12] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:30,024] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,5] (state.change.logger)
[2017-06-26 23:43:30,024] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,5] due to: No other replicas in ISR 0 for [__consumer_offsets,5] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:30,024] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,5] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,5] due to: No other replicas in ISR 0 for [__consumer_offsets,5] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,5] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:30,024] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,32] (state.change.logger)
[2017-06-26 23:43:30,025] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,32] due to: No other replicas in ISR 0 for [__consumer_offsets,32] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:30,025] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,32] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,32] due to: No other replicas in ISR 0 for [__consumer_offsets,32] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,32] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:30,025] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,2] (state.change.logger)
[2017-06-26 23:43:30,025] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,2] due to: No other replicas in ISR 0 for [__consumer_offsets,2] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:30,025] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,2] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,2] due to: No other replicas in ISR 0 for [__consumer_offsets,2] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,2] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:30,026] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,1] (state.change.logger)
[2017-06-26 23:43:30,026] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,1] due to: No other replicas in ISR 0 for [__consumer_offsets,1] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:30,026] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,1] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,1] due to: No other replicas in ISR 0 for [__consumer_offsets,1] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,1] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:30,026] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,0] (state.change.logger)
[2017-06-26 23:43:30,027] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,0] due to: No other replicas in ISR 0 for [__consumer_offsets,0] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:30,027] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,0] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,0] due to: No other replicas in ISR 0 for [__consumer_offsets,0] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,0] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:30,027] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,15] (state.change.logger)
[2017-06-26 23:43:30,028] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,15] due to: No other replicas in ISR 0 for [__consumer_offsets,15] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:30,028] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,15] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,15] due to: No other replicas in ISR 0 for [__consumer_offsets,15] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,15] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:30,028] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,44] (state.change.logger)
[2017-06-26 23:43:30,028] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,44] due to: No other replicas in ISR 0 for [__consumer_offsets,44] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:30,028] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,44] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,44] due to: No other replicas in ISR 0 for [__consumer_offsets,44] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,44] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 23 more
[2017-06-26 23:43:30,028] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,17] (state.change.logger)
[2017-06-26 23:43:30,029] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,17] due to: No other replicas in ISR 0 for [__consumer_offsets,17] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:30,029] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,17] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,17] due to: No other replicas in ISR 0 for [__consumer_offsets,17] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,17] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 23 more
[2017-06-26 23:43:30,029] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,48] (state.change.logger)
[2017-06-26 23:43:30,030] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,48] due to: No other replicas in ISR 0 for [__consumer_offsets,48] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:30,030] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,48] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,48] due to: No other replicas in ISR 0 for [__consumer_offsets,48] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,48] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 23:43:30,030] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,26] (state.change.logger)
[2017-06-26 23:43:30,032] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,26] due to: No other replicas in ISR 0 for [__consumer_offsets,26] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:30,032] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,26] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,26] due to: No other replicas in ISR 0 for [__consumer_offsets,26] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,26] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:30,032] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,33] (state.change.logger)
[2017-06-26 23:43:30,033] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,33] due to: No other replicas in ISR 0 for [__consumer_offsets,33] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:30,033] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,33] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,33] due to: No other replicas in ISR 0 for [__consumer_offsets,33] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,33] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:30,033] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,41] (state.change.logger)
[2017-06-26 23:43:30,034] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,41] due to: No other replicas in ISR 0 for [__consumer_offsets,41] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:30,034] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,41] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,41] due to: No other replicas in ISR 0 for [__consumer_offsets,41] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,41] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 23:43:30,035] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,45] (state.change.logger)
[2017-06-26 23:43:30,035] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,45] due to: No other replicas in ISR 0 for [__consumer_offsets,45] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:30,035] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,45] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,45] due to: No other replicas in ISR 0 for [__consumer_offsets,45] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,45] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 23:43:30,036] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,35] (state.change.logger)
[2017-06-26 23:43:30,036] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,35] due to: No other replicas in ISR 0 for [__consumer_offsets,35] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:30,036] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,35] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,35] due to: No other replicas in ISR 0 for [__consumer_offsets,35] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,35] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:30,037] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,46] (state.change.logger)
[2017-06-26 23:43:30,037] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,46] due to: No other replicas in ISR 0 for [__consumer_offsets,46] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:30,037] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,46] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,46] due to: No other replicas in ISR 0 for [__consumer_offsets,46] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,46] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:30,038] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,19] (state.change.logger)
[2017-06-26 23:43:30,039] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,19] due to: No other replicas in ISR 0 for [__consumer_offsets,19] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:30,039] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,19] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,19] due to: No other replicas in ISR 0 for [__consumer_offsets,19] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,19] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:30,039] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,30] (state.change.logger)
[2017-06-26 23:43:30,039] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,30] due to: No other replicas in ISR 0 for [__consumer_offsets,30] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:30,039] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,30] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,30] due to: No other replicas in ISR 0 for [__consumer_offsets,30] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,30] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 23:43:35,047] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,43] (state.change.logger)
[2017-06-26 23:43:35,048] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,43] due to: No other replicas in ISR 0 for [__consumer_offsets,43] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:35,048] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,43] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,43] due to: No other replicas in ISR 0 for [__consumer_offsets,43] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,43] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:35,048] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,14] (state.change.logger)
[2017-06-26 23:43:35,049] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,14] due to: No other replicas in ISR 0 for [__consumer_offsets,14] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:35,049] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,14] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,14] due to: No other replicas in ISR 0 for [__consumer_offsets,14] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,14] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:35,049] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,28] (state.change.logger)
[2017-06-26 23:43:35,050] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,28] due to: No other replicas in ISR 0 for [__consumer_offsets,28] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:35,050] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,28] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,28] due to: No other replicas in ISR 0 for [__consumer_offsets,28] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,28] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:35,050] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,4] (state.change.logger)
[2017-06-26 23:43:35,051] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,4] due to: No other replicas in ISR 0 for [__consumer_offsets,4] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:35,051] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,4] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,4] due to: No other replicas in ISR 0 for [__consumer_offsets,4] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,4] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:35,051] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,36] (state.change.logger)
[2017-06-26 23:43:35,052] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,36] due to: No other replicas in ISR 0 for [__consumer_offsets,36] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:35,052] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,36] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,36] due to: No other replicas in ISR 0 for [__consumer_offsets,36] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,36] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:35,052] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,6] (state.change.logger)
[2017-06-26 23:43:35,052] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,6] due to: No other replicas in ISR 0 for [__consumer_offsets,6] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:35,052] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,6] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,6] due to: No other replicas in ISR 0 for [__consumer_offsets,6] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,6] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:35,052] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,39] (state.change.logger)
[2017-06-26 23:43:35,053] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,39] due to: No other replicas in ISR 0 for [__consumer_offsets,39] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:35,053] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,39] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,39] due to: No other replicas in ISR 0 for [__consumer_offsets,39] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,39] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 23:43:35,053] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,23] (state.change.logger)
[2017-06-26 23:43:35,054] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,23] due to: No other replicas in ISR 0 for [__consumer_offsets,23] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:35,054] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,23] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,23] due to: No other replicas in ISR 0 for [__consumer_offsets,23] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,23] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 23:43:35,054] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,24] (state.change.logger)
[2017-06-26 23:43:35,054] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,24] due to: No other replicas in ISR 0 for [__consumer_offsets,24] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:35,054] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,24] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,24] due to: No other replicas in ISR 0 for [__consumer_offsets,24] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,24] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:35,055] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,38] (state.change.logger)
[2017-06-26 23:43:35,055] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,38] due to: No other replicas in ISR 0 for [__consumer_offsets,38] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:35,055] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,38] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,38] due to: No other replicas in ISR 0 for [__consumer_offsets,38] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,38] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:35,055] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,16] (state.change.logger)
[2017-06-26 23:43:35,056] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,16] due to: No other replicas in ISR 0 for [__consumer_offsets,16] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:35,056] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,16] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,16] due to: No other replicas in ISR 0 for [__consumer_offsets,16] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,16] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 24 more
[2017-06-26 23:43:35,056] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,3] (state.change.logger)
[2017-06-26 23:43:35,057] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,3] due to: No other replicas in ISR 0 for [__consumer_offsets,3] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:35,057] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,3] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,3] due to: No other replicas in ISR 0 for [__consumer_offsets,3] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,3] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 24 more
[2017-06-26 23:43:35,057] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,21] (state.change.logger)
[2017-06-26 23:43:35,057] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,21] due to: No other replicas in ISR 0 for [__consumer_offsets,21] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:35,057] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,21] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,21] due to: No other replicas in ISR 0 for [__consumer_offsets,21] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,21] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:35,058] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,10] (state.change.logger)
[2017-06-26 23:43:35,058] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,10] due to: No other replicas in ISR 0 for [__consumer_offsets,10] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:35,058] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,10] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,10] due to: No other replicas in ISR 0 for [__consumer_offsets,10] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,10] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:35,058] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,40] (state.change.logger)
[2017-06-26 23:43:35,059] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,40] due to: No other replicas in ISR 0 for [__consumer_offsets,40] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:35,059] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,40] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,40] due to: No other replicas in ISR 0 for [__consumer_offsets,40] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,40] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:35,059] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,34] (state.change.logger)
[2017-06-26 23:43:35,060] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,34] due to: No other replicas in ISR 0 for [__consumer_offsets,34] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:35,060] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,34] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,34] due to: No other replicas in ISR 0 for [__consumer_offsets,34] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,34] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 23:43:35,060] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,25] (state.change.logger)
[2017-06-26 23:43:35,061] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,25] due to: No other replicas in ISR 0 for [__consumer_offsets,25] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:35,061] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,25] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,25] due to: No other replicas in ISR 0 for [__consumer_offsets,25] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,25] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:35,061] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,27] (state.change.logger)
[2017-06-26 23:43:35,061] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,27] due to: No other replicas in ISR 0 for [__consumer_offsets,27] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:35,061] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,27] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,27] due to: No other replicas in ISR 0 for [__consumer_offsets,27] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,27] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:35,061] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,42] (state.change.logger)
[2017-06-26 23:43:35,062] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,42] due to: No other replicas in ISR 0 for [__consumer_offsets,42] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:35,062] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,42] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,42] due to: No other replicas in ISR 0 for [__consumer_offsets,42] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,42] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:35,062] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,11] (state.change.logger)
[2017-06-26 23:43:35,063] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,11] due to: No other replicas in ISR 0 for [__consumer_offsets,11] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:35,063] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,11] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,11] due to: No other replicas in ISR 0 for [__consumer_offsets,11] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,11] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:35,063] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,7] (state.change.logger)
[2017-06-26 23:43:35,063] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,7] due to: No other replicas in ISR 0 for [__consumer_offsets,7] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:35,063] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,7] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,7] due to: No other replicas in ISR 0 for [__consumer_offsets,7] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,7] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:35,064] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,47] (state.change.logger)
[2017-06-26 23:43:35,064] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,47] due to: No other replicas in ISR 0 for [__consumer_offsets,47] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:35,064] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,47] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,47] due to: No other replicas in ISR 0 for [__consumer_offsets,47] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,47] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:35,064] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,9] (state.change.logger)
[2017-06-26 23:43:35,065] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,9] due to: No other replicas in ISR 0 for [__consumer_offsets,9] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:35,065] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,9] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,9] due to: No other replicas in ISR 0 for [__consumer_offsets,9] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,9] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:35,065] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,13] (state.change.logger)
[2017-06-26 23:43:35,066] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,13] due to: No other replicas in ISR 0 for [__consumer_offsets,13] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:35,066] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,13] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,13] due to: No other replicas in ISR 0 for [__consumer_offsets,13] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,13] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 23:43:35,066] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,29] (state.change.logger)
[2017-06-26 23:43:35,066] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,29] due to: No other replicas in ISR 0 for [__consumer_offsets,29] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:35,066] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,29] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,29] due to: No other replicas in ISR 0 for [__consumer_offsets,29] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,29] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:35,066] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,8] (state.change.logger)
[2017-06-26 23:43:35,067] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,8] due to: No other replicas in ISR 0 for [__consumer_offsets,8] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:35,067] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,8] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,8] due to: No other replicas in ISR 0 for [__consumer_offsets,8] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,8] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:35,067] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,22] (state.change.logger)
[2017-06-26 23:43:35,068] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,22] due to: No other replicas in ISR 0 for [__consumer_offsets,22] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:35,068] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,22] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,22] due to: No other replicas in ISR 0 for [__consumer_offsets,22] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,22] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:35,069] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,31] (state.change.logger)
[2017-06-26 23:43:35,069] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,31] due to: No other replicas in ISR 0 for [__consumer_offsets,31] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:35,069] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,31] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,31] due to: No other replicas in ISR 0 for [__consumer_offsets,31] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,31] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 23:43:35,070] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,18] (state.change.logger)
[2017-06-26 23:43:35,070] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,18] due to: No other replicas in ISR 0 for [__consumer_offsets,18] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:35,070] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,18] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,18] due to: No other replicas in ISR 0 for [__consumer_offsets,18] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,18] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:35,070] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,20] (state.change.logger)
[2017-06-26 23:43:35,071] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,20] due to: No other replicas in ISR 0 for [__consumer_offsets,20] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:35,071] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,20] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,20] due to: No other replicas in ISR 0 for [__consumer_offsets,20] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,20] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:35,071] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,37] (state.change.logger)
[2017-06-26 23:43:35,071] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,37] due to: No other replicas in ISR 0 for [__consumer_offsets,37] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:35,071] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,37] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,37] due to: No other replicas in ISR 0 for [__consumer_offsets,37] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,37] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 23:43:35,072] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,49] (state.change.logger)
[2017-06-26 23:43:35,072] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,49] due to: No other replicas in ISR 0 for [__consumer_offsets,49] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:35,072] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,49] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,49] due to: No other replicas in ISR 0 for [__consumer_offsets,49] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,49] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:35,072] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,12] (state.change.logger)
[2017-06-26 23:43:35,073] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,12] due to: No other replicas in ISR 0 for [__consumer_offsets,12] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:35,073] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,12] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,12] due to: No other replicas in ISR 0 for [__consumer_offsets,12] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,12] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:35,073] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,5] (state.change.logger)
[2017-06-26 23:43:35,073] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,5] due to: No other replicas in ISR 0 for [__consumer_offsets,5] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:35,073] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,5] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,5] due to: No other replicas in ISR 0 for [__consumer_offsets,5] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,5] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:35,074] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,32] (state.change.logger)
[2017-06-26 23:43:35,074] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,32] due to: No other replicas in ISR 0 for [__consumer_offsets,32] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:35,074] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,32] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,32] due to: No other replicas in ISR 0 for [__consumer_offsets,32] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,32] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:35,074] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,2] (state.change.logger)
[2017-06-26 23:43:35,075] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,2] due to: No other replicas in ISR 0 for [__consumer_offsets,2] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:35,075] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,2] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,2] due to: No other replicas in ISR 0 for [__consumer_offsets,2] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,2] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:35,075] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,1] (state.change.logger)
[2017-06-26 23:43:35,076] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,1] due to: No other replicas in ISR 0 for [__consumer_offsets,1] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:35,076] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,1] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,1] due to: No other replicas in ISR 0 for [__consumer_offsets,1] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,1] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:35,076] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,0] (state.change.logger)
[2017-06-26 23:43:35,076] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,0] due to: No other replicas in ISR 0 for [__consumer_offsets,0] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:35,076] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,0] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,0] due to: No other replicas in ISR 0 for [__consumer_offsets,0] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,0] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:35,076] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,15] (state.change.logger)
[2017-06-26 23:43:35,077] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,15] due to: No other replicas in ISR 0 for [__consumer_offsets,15] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:35,077] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,15] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,15] due to: No other replicas in ISR 0 for [__consumer_offsets,15] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,15] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:35,077] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,44] (state.change.logger)
[2017-06-26 23:43:35,078] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,44] due to: No other replicas in ISR 0 for [__consumer_offsets,44] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:35,078] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,44] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,44] due to: No other replicas in ISR 0 for [__consumer_offsets,44] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,44] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 23 more
[2017-06-26 23:43:35,078] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,17] (state.change.logger)
[2017-06-26 23:43:35,078] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,17] due to: No other replicas in ISR 0 for [__consumer_offsets,17] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:35,078] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,17] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,17] due to: No other replicas in ISR 0 for [__consumer_offsets,17] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,17] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 23 more
[2017-06-26 23:43:35,078] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,48] (state.change.logger)
[2017-06-26 23:43:35,079] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,48] due to: No other replicas in ISR 0 for [__consumer_offsets,48] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:35,079] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,48] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,48] due to: No other replicas in ISR 0 for [__consumer_offsets,48] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,48] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 23:43:35,079] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,26] (state.change.logger)
[2017-06-26 23:43:35,079] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,26] due to: No other replicas in ISR 0 for [__consumer_offsets,26] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:35,079] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,26] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,26] due to: No other replicas in ISR 0 for [__consumer_offsets,26] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,26] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:35,080] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,33] (state.change.logger)
[2017-06-26 23:43:35,080] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,33] due to: No other replicas in ISR 0 for [__consumer_offsets,33] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:35,080] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,33] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,33] due to: No other replicas in ISR 0 for [__consumer_offsets,33] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,33] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:35,081] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,41] (state.change.logger)
[2017-06-26 23:43:35,081] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,41] due to: No other replicas in ISR 0 for [__consumer_offsets,41] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:35,081] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,41] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,41] due to: No other replicas in ISR 0 for [__consumer_offsets,41] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,41] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 23:43:35,081] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,45] (state.change.logger)
[2017-06-26 23:43:35,082] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,45] due to: No other replicas in ISR 0 for [__consumer_offsets,45] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:35,082] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,45] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,45] due to: No other replicas in ISR 0 for [__consumer_offsets,45] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,45] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 23:43:35,082] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,35] (state.change.logger)
[2017-06-26 23:43:35,082] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,35] due to: No other replicas in ISR 0 for [__consumer_offsets,35] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:35,082] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,35] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,35] due to: No other replicas in ISR 0 for [__consumer_offsets,35] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,35] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:35,083] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,46] (state.change.logger)
[2017-06-26 23:43:35,083] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,46] due to: No other replicas in ISR 0 for [__consumer_offsets,46] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:35,083] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,46] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,46] due to: No other replicas in ISR 0 for [__consumer_offsets,46] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,46] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:35,083] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,19] (state.change.logger)
[2017-06-26 23:43:35,084] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,19] due to: No other replicas in ISR 0 for [__consumer_offsets,19] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:35,084] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,19] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,19] due to: No other replicas in ISR 0 for [__consumer_offsets,19] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,19] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 23:43:35,084] TRACE Controller 0 epoch 8 started leader election for partition [__consumer_offsets,30] (state.change.logger)
[2017-06-26 23:43:35,085] ERROR Controller 0 epoch 8 encountered error while electing leader for partition [__consumer_offsets,30] due to: No other replicas in ISR 0 for [__consumer_offsets,30] besides shutting down brokers 0. (state.change.logger)
[2017-06-26 23:43:35,085] ERROR Controller 0 epoch 8 initiated state change for partition [__consumer_offsets,30] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,30] due to: No other replicas in ISR 0 for [__consumer_offsets,30] besides shutting down brokers 0.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for [__consumer_offsets,30] besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
