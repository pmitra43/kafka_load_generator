[2017-06-27 13:05:48,598] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=11, replicas=[0, 1, 2]) correlation id 74 from controller 0 epoch 9 for partition [__consumer_offsets,43] (state.change.logger)
[2017-06-27 13:05:48,598] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=11, replicas=[0, 1, 2]) correlation id 72 from controller 0 epoch 9 for partition [__consumer_offsets,43] (state.change.logger)
[2017-06-27 13:05:48,599] TRACE Broker 1 handling LeaderAndIsr request correlationId 74 from controller 0 epoch 9 starting the become-leader transition for partition __consumer_offsets-43 (state.change.logger)
[2017-06-27 13:05:48,599] TRACE Broker 2 handling LeaderAndIsr request correlationId 72 from controller 0 epoch 9 starting the become-follower transition for partition __consumer_offsets-43 (state.change.logger)
[2017-06-27 13:05:48,600] INFO Broker 2 skipped the become-follower state change after marking its partition as follower with correlation id 72 from controller 0 epoch 9 for partition __consumer_offsets-43 since the new leader 1 is the same as the old leader (state.change.logger)
[2017-06-27 13:05:48,601] INFO Broker 1 skipped the become-leader state change after marking its partition as leader with correlation id 74 from controller 0 epoch 9 for partition __consumer_offsets-43 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:05:48,601] TRACE Broker 1 completed LeaderAndIsr request correlationId 74 from controller 0 epoch 9 for the become-leader transition for partition __consumer_offsets-43 (state.change.logger)
[2017-06-27 13:05:48,602] TRACE Broker 2 completed LeaderAndIsr request correlationId 72 from controller 0 epoch 9 for the become-follower transition for partition __consumer_offsets-43 (state.change.logger)
[2017-06-27 13:05:48,603] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-43 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 73 (state.change.logger)
[2017-06-27 13:05:48,603] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-43 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 75 (state.change.logger)
[2017-06-27 13:05:48,604] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=8, isr=[1, 2], zkVersion=13, replicas=[0, 1, 2]) correlation id 76 from controller 0 epoch 9 for partition [__consumer_offsets,14] (state.change.logger)
[2017-06-27 13:05:48,604] TRACE Broker 1 handling LeaderAndIsr request correlationId 76 from controller 0 epoch 9 starting the become-follower transition for partition __consumer_offsets-14 (state.change.logger)
[2017-06-27 13:05:48,605] INFO Broker 1 skipped the become-follower state change after marking its partition as follower with correlation id 76 from controller 0 epoch 9 for partition __consumer_offsets-14 since the new leader 2 is the same as the old leader (state.change.logger)
[2017-06-27 13:05:48,606] TRACE Broker 1 completed LeaderAndIsr request correlationId 76 from controller 0 epoch 9 for the become-follower transition for partition __consumer_offsets-14 (state.change.logger)
[2017-06-27 13:05:48,606] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=8, isr=[1, 2], zkVersion=13, replicas=[0, 1, 2]) correlation id 74 from controller 0 epoch 9 for partition [__consumer_offsets,14] (state.change.logger)
[2017-06-27 13:05:48,606] TRACE Broker 2 handling LeaderAndIsr request correlationId 74 from controller 0 epoch 9 starting the become-leader transition for partition __consumer_offsets-14 (state.change.logger)
[2017-06-27 13:05:48,607] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-14 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 77 (state.change.logger)
[2017-06-27 13:05:48,607] INFO Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 74 from controller 0 epoch 9 for partition __consumer_offsets-14 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:05:48,607] TRACE Broker 2 completed LeaderAndIsr request correlationId 74 from controller 0 epoch 9 for the become-leader transition for partition __consumer_offsets-14 (state.change.logger)
[2017-06-27 13:05:48,608] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=11, replicas=[0, 1, 2]) correlation id 78 from controller 0 epoch 9 for partition [__consumer_offsets,28] (state.change.logger)
[2017-06-27 13:05:48,608] TRACE Broker 1 handling LeaderAndIsr request correlationId 78 from controller 0 epoch 9 starting the become-leader transition for partition __consumer_offsets-28 (state.change.logger)
[2017-06-27 13:05:48,608] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-14 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 75 (state.change.logger)
[2017-06-27 13:05:48,608] INFO Broker 1 skipped the become-leader state change after marking its partition as leader with correlation id 78 from controller 0 epoch 9 for partition __consumer_offsets-28 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:05:48,608] TRACE Broker 1 completed LeaderAndIsr request correlationId 78 from controller 0 epoch 9 for the become-leader transition for partition __consumer_offsets-28 (state.change.logger)
[2017-06-27 13:05:48,609] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=11, replicas=[0, 1, 2]) correlation id 76 from controller 0 epoch 9 for partition [__consumer_offsets,28] (state.change.logger)
[2017-06-27 13:05:48,609] TRACE Broker 2 handling LeaderAndIsr request correlationId 76 from controller 0 epoch 9 starting the become-follower transition for partition __consumer_offsets-28 (state.change.logger)
[2017-06-27 13:05:48,609] INFO Broker 2 skipped the become-follower state change after marking its partition as follower with correlation id 76 from controller 0 epoch 9 for partition __consumer_offsets-28 since the new leader 1 is the same as the old leader (state.change.logger)
[2017-06-27 13:05:48,610] TRACE Broker 2 completed LeaderAndIsr request correlationId 76 from controller 0 epoch 9 for the become-follower transition for partition __consumer_offsets-28 (state.change.logger)
[2017-06-27 13:05:48,610] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-28 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 77 (state.change.logger)
[2017-06-27 13:05:48,611] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-28 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 79 (state.change.logger)
[2017-06-27 13:05:48,611] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=13, replicas=[0, 1, 2]) correlation id 78 from controller 0 epoch 9 for partition [__consumer_offsets,4] (state.change.logger)
[2017-06-27 13:05:48,611] TRACE Broker 2 handling LeaderAndIsr request correlationId 78 from controller 0 epoch 9 starting the become-follower transition for partition __consumer_offsets-4 (state.change.logger)
[2017-06-27 13:05:48,612] INFO Broker 2 skipped the become-follower state change after marking its partition as follower with correlation id 78 from controller 0 epoch 9 for partition __consumer_offsets-4 since the new leader 1 is the same as the old leader (state.change.logger)
[2017-06-27 13:05:48,612] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=13, replicas=[0, 1, 2]) correlation id 80 from controller 0 epoch 9 for partition [__consumer_offsets,4] (state.change.logger)
[2017-06-27 13:05:48,612] TRACE Broker 1 handling LeaderAndIsr request correlationId 80 from controller 0 epoch 9 starting the become-leader transition for partition __consumer_offsets-4 (state.change.logger)
[2017-06-27 13:05:48,612] INFO Broker 1 skipped the become-leader state change after marking its partition as leader with correlation id 80 from controller 0 epoch 9 for partition __consumer_offsets-4 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:05:48,612] TRACE Broker 1 completed LeaderAndIsr request correlationId 80 from controller 0 epoch 9 for the become-leader transition for partition __consumer_offsets-4 (state.change.logger)
[2017-06-27 13:05:48,612] TRACE Broker 2 completed LeaderAndIsr request correlationId 78 from controller 0 epoch 9 for the become-follower transition for partition __consumer_offsets-4 (state.change.logger)
[2017-06-27 13:05:48,614] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-4 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 81 (state.change.logger)
[2017-06-27 13:05:48,614] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-4 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 79 (state.change.logger)
[2017-06-27 13:05:48,616] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 82 from controller 0 epoch 9 for partition [__consumer_offsets,36] (state.change.logger)
[2017-06-27 13:05:48,616] TRACE Broker 1 handling LeaderAndIsr request correlationId 82 from controller 0 epoch 9 starting the become-leader transition for partition __consumer_offsets-36 (state.change.logger)
[2017-06-27 13:05:48,616] TRACE Broker 1 stopped fetchers as part of become-leader request from controller 0 epoch 9 with correlation id 82 for partition __consumer_offsets-36 (state.change.logger)
[2017-06-27 13:05:48,617] TRACE Broker 1 completed LeaderAndIsr request correlationId 82 from controller 0 epoch 9 for the become-leader transition for partition __consumer_offsets-36 (state.change.logger)
[2017-06-27 13:05:48,617] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 80 from controller 0 epoch 9 for partition [__consumer_offsets,36] (state.change.logger)
[2017-06-27 13:05:48,617] TRACE Broker 2 handling LeaderAndIsr request correlationId 80 from controller 0 epoch 9 starting the become-follower transition for partition __consumer_offsets-36 (state.change.logger)
[2017-06-27 13:05:48,617] TRACE Broker 2 stopped fetchers as part of become-follower request from controller 0 epoch 9 with correlation id 80 for partition __consumer_offsets-36 (state.change.logger)
[2017-06-27 13:05:48,618] TRACE Broker 2 truncated logs and checkpointed recovery boundaries for partition __consumer_offsets-36 as part of become-follower request with correlation id 80 from controller 0 epoch 9 (state.change.logger)
[2017-06-27 13:05:48,619] TRACE Broker 2 started fetcher to new leader as part of become-follower request from controller 0 epoch 9 with correlation id 80 for partition __consumer_offsets-36 (state.change.logger)
[2017-06-27 13:05:48,619] TRACE Broker 2 completed LeaderAndIsr request correlationId 80 from controller 0 epoch 9 for the become-follower transition for partition __consumer_offsets-36 (state.change.logger)
[2017-06-27 13:05:48,621] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-36 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 83 (state.change.logger)
[2017-06-27 13:05:48,622] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-36 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 81 (state.change.logger)
[2017-06-27 13:05:48,622] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 84 from controller 0 epoch 9 for partition [__consumer_offsets,6] (state.change.logger)
[2017-06-27 13:05:48,622] TRACE Broker 1 handling LeaderAndIsr request correlationId 84 from controller 0 epoch 9 starting the become-leader transition for partition __consumer_offsets-6 (state.change.logger)
[2017-06-27 13:05:48,623] TRACE Broker 1 stopped fetchers as part of become-leader request from controller 0 epoch 9 with correlation id 84 for partition __consumer_offsets-6 (state.change.logger)
[2017-06-27 13:05:48,623] TRACE Broker 1 completed LeaderAndIsr request correlationId 84 from controller 0 epoch 9 for the become-leader transition for partition __consumer_offsets-6 (state.change.logger)
[2017-06-27 13:05:48,623] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 82 from controller 0 epoch 9 for partition [__consumer_offsets,6] (state.change.logger)
[2017-06-27 13:05:48,623] TRACE Broker 2 handling LeaderAndIsr request correlationId 82 from controller 0 epoch 9 starting the become-follower transition for partition __consumer_offsets-6 (state.change.logger)
[2017-06-27 13:05:48,624] TRACE Broker 2 stopped fetchers as part of become-follower request from controller 0 epoch 9 with correlation id 82 for partition __consumer_offsets-6 (state.change.logger)
[2017-06-27 13:05:48,625] TRACE Broker 2 truncated logs and checkpointed recovery boundaries for partition __consumer_offsets-6 as part of become-follower request with correlation id 82 from controller 0 epoch 9 (state.change.logger)
[2017-06-27 13:05:48,625] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-6 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 85 (state.change.logger)
[2017-06-27 13:05:48,626] TRACE Broker 2 started fetcher to new leader as part of become-follower request from controller 0 epoch 9 with correlation id 82 for partition __consumer_offsets-6 (state.change.logger)
[2017-06-27 13:05:48,626] TRACE Broker 2 completed LeaderAndIsr request correlationId 82 from controller 0 epoch 9 for the become-follower transition for partition __consumer_offsets-6 (state.change.logger)
[2017-06-27 13:05:48,627] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-6 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 83 (state.change.logger)
[2017-06-27 13:05:48,627] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 86 from controller 0 epoch 9 for partition [__consumer_offsets,39] (state.change.logger)
[2017-06-27 13:05:48,627] TRACE Broker 1 handling LeaderAndIsr request correlationId 86 from controller 0 epoch 9 starting the become-follower transition for partition __consumer_offsets-39 (state.change.logger)
[2017-06-27 13:05:48,627] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 84 from controller 0 epoch 9 for partition [__consumer_offsets,39] (state.change.logger)
[2017-06-27 13:05:48,627] TRACE Broker 2 handling LeaderAndIsr request correlationId 84 from controller 0 epoch 9 starting the become-leader transition for partition __consumer_offsets-39 (state.change.logger)
[2017-06-27 13:05:48,627] TRACE Broker 1 stopped fetchers as part of become-follower request from controller 0 epoch 9 with correlation id 86 for partition __consumer_offsets-39 (state.change.logger)
[2017-06-27 13:05:48,628] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 0 epoch 9 with correlation id 84 for partition __consumer_offsets-39 (state.change.logger)
[2017-06-27 13:05:48,628] TRACE Broker 2 completed LeaderAndIsr request correlationId 84 from controller 0 epoch 9 for the become-leader transition for partition __consumer_offsets-39 (state.change.logger)
[2017-06-27 13:05:48,628] TRACE Broker 1 truncated logs and checkpointed recovery boundaries for partition __consumer_offsets-39 as part of become-follower request with correlation id 86 from controller 0 epoch 9 (state.change.logger)
[2017-06-27 13:05:48,629] TRACE Broker 1 started fetcher to new leader as part of become-follower request from controller 0 epoch 9 with correlation id 86 for partition __consumer_offsets-39 (state.change.logger)
[2017-06-27 13:05:48,629] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-39 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 85 (state.change.logger)
[2017-06-27 13:05:48,629] TRACE Broker 1 completed LeaderAndIsr request correlationId 86 from controller 0 epoch 9 for the become-follower transition for partition __consumer_offsets-39 (state.change.logger)
[2017-06-27 13:05:48,629] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-39 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 87 (state.change.logger)
[2017-06-27 13:05:48,633] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=9, isr=[1, 2], zkVersion=14, replicas=[0, 1, 2]) correlation id 86 from controller 0 epoch 9 for partition [__consumer_offsets,23] (state.change.logger)
[2017-06-27 13:05:48,633] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=9, isr=[1, 2], zkVersion=14, replicas=[0, 1, 2]) correlation id 88 from controller 0 epoch 9 for partition [__consumer_offsets,23] (state.change.logger)
[2017-06-27 13:05:48,633] TRACE Broker 2 handling LeaderAndIsr request correlationId 86 from controller 0 epoch 9 starting the become-leader transition for partition __consumer_offsets-23 (state.change.logger)
[2017-06-27 13:05:48,633] TRACE Broker 1 handling LeaderAndIsr request correlationId 88 from controller 0 epoch 9 starting the become-follower transition for partition __consumer_offsets-23 (state.change.logger)
[2017-06-27 13:05:48,633] INFO Broker 1 skipped the become-follower state change after marking its partition as follower with correlation id 88 from controller 0 epoch 9 for partition __consumer_offsets-23 since the new leader 2 is the same as the old leader (state.change.logger)
[2017-06-27 13:05:48,633] INFO Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 86 from controller 0 epoch 9 for partition __consumer_offsets-23 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:05:48,633] TRACE Broker 2 completed LeaderAndIsr request correlationId 86 from controller 0 epoch 9 for the become-leader transition for partition __consumer_offsets-23 (state.change.logger)
[2017-06-27 13:05:48,634] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-23 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 87 (state.change.logger)
[2017-06-27 13:05:48,634] TRACE Broker 1 completed LeaderAndIsr request correlationId 88 from controller 0 epoch 9 for the become-follower transition for partition __consumer_offsets-23 (state.change.logger)
[2017-06-27 13:05:48,635] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-23 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 89 (state.change.logger)
[2017-06-27 13:05:48,637] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 88 from controller 0 epoch 9 for partition [__consumer_offsets,24] (state.change.logger)
[2017-06-27 13:05:48,637] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 90 from controller 0 epoch 9 for partition [__consumer_offsets,24] (state.change.logger)
[2017-06-27 13:05:48,638] TRACE Broker 2 handling LeaderAndIsr request correlationId 88 from controller 0 epoch 9 starting the become-follower transition for partition __consumer_offsets-24 (state.change.logger)
[2017-06-27 13:05:48,638] TRACE Broker 1 handling LeaderAndIsr request correlationId 90 from controller 0 epoch 9 starting the become-leader transition for partition __consumer_offsets-24 (state.change.logger)
[2017-06-27 13:05:48,638] TRACE Broker 2 stopped fetchers as part of become-follower request from controller 0 epoch 9 with correlation id 88 for partition __consumer_offsets-24 (state.change.logger)
[2017-06-27 13:05:48,638] TRACE Broker 1 stopped fetchers as part of become-leader request from controller 0 epoch 9 with correlation id 90 for partition __consumer_offsets-24 (state.change.logger)
[2017-06-27 13:05:48,638] TRACE Broker 1 completed LeaderAndIsr request correlationId 90 from controller 0 epoch 9 for the become-leader transition for partition __consumer_offsets-24 (state.change.logger)
[2017-06-27 13:05:48,639] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-24 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 91 (state.change.logger)
[2017-06-27 13:05:48,639] TRACE Broker 2 truncated logs and checkpointed recovery boundaries for partition __consumer_offsets-24 as part of become-follower request with correlation id 88 from controller 0 epoch 9 (state.change.logger)
[2017-06-27 13:05:48,639] TRACE Broker 2 started fetcher to new leader as part of become-follower request from controller 0 epoch 9 with correlation id 88 for partition __consumer_offsets-24 (state.change.logger)
[2017-06-27 13:05:48,639] TRACE Broker 2 completed LeaderAndIsr request correlationId 88 from controller 0 epoch 9 for the become-follower transition for partition __consumer_offsets-24 (state.change.logger)
[2017-06-27 13:05:48,641] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-24 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 89 (state.change.logger)
[2017-06-27 13:05:48,643] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=8, isr=[1, 2], zkVersion=13, replicas=[0, 1, 2]) correlation id 90 from controller 0 epoch 9 for partition [__consumer_offsets,38] (state.change.logger)
[2017-06-27 13:05:48,643] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=8, isr=[1, 2], zkVersion=13, replicas=[0, 1, 2]) correlation id 92 from controller 0 epoch 9 for partition [__consumer_offsets,38] (state.change.logger)
[2017-06-27 13:05:48,643] TRACE Broker 2 handling LeaderAndIsr request correlationId 90 from controller 0 epoch 9 starting the become-leader transition for partition __consumer_offsets-38 (state.change.logger)
[2017-06-27 13:05:48,643] TRACE Broker 1 handling LeaderAndIsr request correlationId 92 from controller 0 epoch 9 starting the become-follower transition for partition __consumer_offsets-38 (state.change.logger)
[2017-06-27 13:05:48,644] INFO Broker 1 skipped the become-follower state change after marking its partition as follower with correlation id 92 from controller 0 epoch 9 for partition __consumer_offsets-38 since the new leader 2 is the same as the old leader (state.change.logger)
[2017-06-27 13:05:48,644] INFO Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 90 from controller 0 epoch 9 for partition __consumer_offsets-38 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:05:48,644] TRACE Broker 2 completed LeaderAndIsr request correlationId 90 from controller 0 epoch 9 for the become-leader transition for partition __consumer_offsets-38 (state.change.logger)
[2017-06-27 13:05:48,644] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-38 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 91 (state.change.logger)
[2017-06-27 13:05:48,644] TRACE Broker 1 completed LeaderAndIsr request correlationId 92 from controller 0 epoch 9 for the become-follower transition for partition __consumer_offsets-38 (state.change.logger)
[2017-06-27 13:05:48,645] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-38 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 93 (state.change.logger)
[2017-06-27 13:05:48,647] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=11, replicas=[0, 1, 2]) correlation id 92 from controller 0 epoch 9 for partition [__consumer_offsets,16] (state.change.logger)
[2017-06-27 13:05:48,647] TRACE Broker 2 handling LeaderAndIsr request correlationId 92 from controller 0 epoch 9 starting the become-follower transition for partition __consumer_offsets-16 (state.change.logger)
[2017-06-27 13:05:48,647] INFO Broker 2 skipped the become-follower state change after marking its partition as follower with correlation id 92 from controller 0 epoch 9 for partition __consumer_offsets-16 since the new leader 1 is the same as the old leader (state.change.logger)
[2017-06-27 13:05:48,648] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=11, replicas=[0, 1, 2]) correlation id 94 from controller 0 epoch 9 for partition [__consumer_offsets,16] (state.change.logger)
[2017-06-27 13:05:48,648] TRACE Broker 1 handling LeaderAndIsr request correlationId 94 from controller 0 epoch 9 starting the become-leader transition for partition __consumer_offsets-16 (state.change.logger)
[2017-06-27 13:05:48,648] TRACE Broker 2 completed LeaderAndIsr request correlationId 92 from controller 0 epoch 9 for the become-follower transition for partition __consumer_offsets-16 (state.change.logger)
[2017-06-27 13:05:48,648] INFO Broker 1 skipped the become-leader state change after marking its partition as leader with correlation id 94 from controller 0 epoch 9 for partition __consumer_offsets-16 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:05:48,648] TRACE Broker 1 completed LeaderAndIsr request correlationId 94 from controller 0 epoch 9 for the become-leader transition for partition __consumer_offsets-16 (state.change.logger)
[2017-06-27 13:05:48,649] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-16 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 93 (state.change.logger)
[2017-06-27 13:05:48,649] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-16 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 95 (state.change.logger)
[2017-06-27 13:05:48,652] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 94 from controller 0 epoch 9 for partition [__consumer_offsets,3] (state.change.logger)
[2017-06-27 13:05:48,652] TRACE Broker 2 handling LeaderAndIsr request correlationId 94 from controller 0 epoch 9 starting the become-leader transition for partition __consumer_offsets-3 (state.change.logger)
[2017-06-27 13:05:48,652] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 96 from controller 0 epoch 9 for partition [__consumer_offsets,3] (state.change.logger)
[2017-06-27 13:05:48,652] TRACE Broker 1 handling LeaderAndIsr request correlationId 96 from controller 0 epoch 9 starting the become-follower transition for partition __consumer_offsets-3 (state.change.logger)
[2017-06-27 13:05:48,652] TRACE Broker 1 stopped fetchers as part of become-follower request from controller 0 epoch 9 with correlation id 96 for partition __consumer_offsets-3 (state.change.logger)
[2017-06-27 13:05:48,653] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 0 epoch 9 with correlation id 94 for partition __consumer_offsets-3 (state.change.logger)
[2017-06-27 13:05:48,653] TRACE Broker 2 completed LeaderAndIsr request correlationId 94 from controller 0 epoch 9 for the become-leader transition for partition __consumer_offsets-3 (state.change.logger)
[2017-06-27 13:05:48,653] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-3 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 95 (state.change.logger)
[2017-06-27 13:05:48,653] TRACE Broker 1 truncated logs and checkpointed recovery boundaries for partition __consumer_offsets-3 as part of become-follower request with correlation id 96 from controller 0 epoch 9 (state.change.logger)
[2017-06-27 13:05:48,654] TRACE Broker 1 started fetcher to new leader as part of become-follower request from controller 0 epoch 9 with correlation id 96 for partition __consumer_offsets-3 (state.change.logger)
[2017-06-27 13:05:48,654] TRACE Broker 1 completed LeaderAndIsr request correlationId 96 from controller 0 epoch 9 for the become-follower transition for partition __consumer_offsets-3 (state.change.logger)
[2017-06-27 13:05:48,654] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-3 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 97 (state.change.logger)
[2017-06-27 13:05:48,656] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 96 from controller 0 epoch 9 for partition [__consumer_offsets,21] (state.change.logger)
[2017-06-27 13:05:48,656] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 98 from controller 0 epoch 9 for partition [__consumer_offsets,21] (state.change.logger)
[2017-06-27 13:05:48,656] TRACE Broker 2 handling LeaderAndIsr request correlationId 96 from controller 0 epoch 9 starting the become-leader transition for partition __consumer_offsets-21 (state.change.logger)
[2017-06-27 13:05:48,656] TRACE Broker 1 handling LeaderAndIsr request correlationId 98 from controller 0 epoch 9 starting the become-follower transition for partition __consumer_offsets-21 (state.change.logger)
[2017-06-27 13:05:48,657] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 0 epoch 9 with correlation id 96 for partition __consumer_offsets-21 (state.change.logger)
[2017-06-27 13:05:48,657] TRACE Broker 1 stopped fetchers as part of become-follower request from controller 0 epoch 9 with correlation id 98 for partition __consumer_offsets-21 (state.change.logger)
[2017-06-27 13:05:48,657] TRACE Broker 2 completed LeaderAndIsr request correlationId 96 from controller 0 epoch 9 for the become-leader transition for partition __consumer_offsets-21 (state.change.logger)
[2017-06-27 13:05:48,658] TRACE Broker 1 truncated logs and checkpointed recovery boundaries for partition __consumer_offsets-21 as part of become-follower request with correlation id 98 from controller 0 epoch 9 (state.change.logger)
[2017-06-27 13:05:48,658] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-21 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 97 (state.change.logger)
[2017-06-27 13:05:48,658] TRACE Broker 1 started fetcher to new leader as part of become-follower request from controller 0 epoch 9 with correlation id 98 for partition __consumer_offsets-21 (state.change.logger)
[2017-06-27 13:05:48,658] TRACE Broker 1 completed LeaderAndIsr request correlationId 98 from controller 0 epoch 9 for the become-follower transition for partition __consumer_offsets-21 (state.change.logger)
[2017-06-27 13:05:48,659] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-21 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 99 (state.change.logger)
[2017-06-27 13:05:48,661] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=11, replicas=[0, 1, 2]) correlation id 98 from controller 0 epoch 9 for partition [__consumer_offsets,10] (state.change.logger)
[2017-06-27 13:05:48,661] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=11, replicas=[0, 1, 2]) correlation id 100 from controller 0 epoch 9 for partition [__consumer_offsets,10] (state.change.logger)
[2017-06-27 13:05:48,661] TRACE Broker 2 handling LeaderAndIsr request correlationId 98 from controller 0 epoch 9 starting the become-follower transition for partition __consumer_offsets-10 (state.change.logger)
[2017-06-27 13:05:48,661] TRACE Broker 1 handling LeaderAndIsr request correlationId 100 from controller 0 epoch 9 starting the become-leader transition for partition __consumer_offsets-10 (state.change.logger)
[2017-06-27 13:05:48,661] INFO Broker 2 skipped the become-follower state change after marking its partition as follower with correlation id 98 from controller 0 epoch 9 for partition __consumer_offsets-10 since the new leader 1 is the same as the old leader (state.change.logger)
[2017-06-27 13:05:48,661] INFO Broker 1 skipped the become-leader state change after marking its partition as leader with correlation id 100 from controller 0 epoch 9 for partition __consumer_offsets-10 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:05:48,661] TRACE Broker 1 completed LeaderAndIsr request correlationId 100 from controller 0 epoch 9 for the become-leader transition for partition __consumer_offsets-10 (state.change.logger)
[2017-06-27 13:05:48,662] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-10 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 101 (state.change.logger)
[2017-06-27 13:05:48,662] TRACE Broker 2 completed LeaderAndIsr request correlationId 98 from controller 0 epoch 9 for the become-follower transition for partition __consumer_offsets-10 (state.change.logger)
[2017-06-27 13:05:48,662] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-10 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 99 (state.change.logger)
[2017-06-27 13:05:48,663] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=11, replicas=[0, 1, 2]) correlation id 100 from controller 0 epoch 9 for partition [__consumer_offsets,40] (state.change.logger)
[2017-06-27 13:05:48,663] TRACE Broker 2 handling LeaderAndIsr request correlationId 100 from controller 0 epoch 9 starting the become-follower transition for partition __consumer_offsets-40 (state.change.logger)
[2017-06-27 13:05:48,663] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=11, replicas=[0, 1, 2]) correlation id 102 from controller 0 epoch 9 for partition [__consumer_offsets,40] (state.change.logger)
[2017-06-27 13:05:48,664] TRACE Broker 1 handling LeaderAndIsr request correlationId 102 from controller 0 epoch 9 starting the become-leader transition for partition __consumer_offsets-40 (state.change.logger)
[2017-06-27 13:05:48,664] INFO Broker 2 skipped the become-follower state change after marking its partition as follower with correlation id 100 from controller 0 epoch 9 for partition __consumer_offsets-40 since the new leader 1 is the same as the old leader (state.change.logger)
[2017-06-27 13:05:48,664] INFO Broker 1 skipped the become-leader state change after marking its partition as leader with correlation id 102 from controller 0 epoch 9 for partition __consumer_offsets-40 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:05:48,664] TRACE Broker 1 completed LeaderAndIsr request correlationId 102 from controller 0 epoch 9 for the become-leader transition for partition __consumer_offsets-40 (state.change.logger)
[2017-06-27 13:05:48,664] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-40 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 103 (state.change.logger)
[2017-06-27 13:05:48,664] TRACE Broker 2 completed LeaderAndIsr request correlationId 100 from controller 0 epoch 9 for the become-follower transition for partition __consumer_offsets-40 (state.change.logger)
[2017-06-27 13:05:48,665] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-40 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 101 (state.change.logger)
[2017-06-27 13:05:48,667] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=11, replicas=[0, 1, 2]) correlation id 102 from controller 0 epoch 9 for partition [__consumer_offsets,34] (state.change.logger)
[2017-06-27 13:05:48,667] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=11, replicas=[0, 1, 2]) correlation id 104 from controller 0 epoch 9 for partition [__consumer_offsets,34] (state.change.logger)
[2017-06-27 13:05:48,667] TRACE Broker 2 handling LeaderAndIsr request correlationId 102 from controller 0 epoch 9 starting the become-follower transition for partition __consumer_offsets-34 (state.change.logger)
[2017-06-27 13:05:48,667] TRACE Broker 1 handling LeaderAndIsr request correlationId 104 from controller 0 epoch 9 starting the become-leader transition for partition __consumer_offsets-34 (state.change.logger)
[2017-06-27 13:05:48,668] INFO Broker 2 skipped the become-follower state change after marking its partition as follower with correlation id 102 from controller 0 epoch 9 for partition __consumer_offsets-34 since the new leader 1 is the same as the old leader (state.change.logger)
[2017-06-27 13:05:48,668] INFO Broker 1 skipped the become-leader state change after marking its partition as leader with correlation id 104 from controller 0 epoch 9 for partition __consumer_offsets-34 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:05:48,668] TRACE Broker 1 completed LeaderAndIsr request correlationId 104 from controller 0 epoch 9 for the become-leader transition for partition __consumer_offsets-34 (state.change.logger)
[2017-06-27 13:05:48,670] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-34 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 105 (state.change.logger)
[2017-06-27 13:05:48,670] TRACE Broker 2 completed LeaderAndIsr request correlationId 102 from controller 0 epoch 9 for the become-follower transition for partition __consumer_offsets-34 (state.change.logger)
[2017-06-27 13:05:48,671] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-34 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 103 (state.change.logger)
[2017-06-27 13:05:48,674] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=11, replicas=[0, 1, 2]) correlation id 104 from controller 0 epoch 9 for partition [__consumer_offsets,25] (state.change.logger)
[2017-06-27 13:05:48,674] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=11, replicas=[0, 1, 2]) correlation id 106 from controller 0 epoch 9 for partition [__consumer_offsets,25] (state.change.logger)
[2017-06-27 13:05:48,674] TRACE Broker 2 handling LeaderAndIsr request correlationId 104 from controller 0 epoch 9 starting the become-follower transition for partition __consumer_offsets-25 (state.change.logger)
[2017-06-27 13:05:48,674] TRACE Broker 1 handling LeaderAndIsr request correlationId 106 from controller 0 epoch 9 starting the become-leader transition for partition __consumer_offsets-25 (state.change.logger)
[2017-06-27 13:05:48,674] INFO Broker 2 skipped the become-follower state change after marking its partition as follower with correlation id 104 from controller 0 epoch 9 for partition __consumer_offsets-25 since the new leader 1 is the same as the old leader (state.change.logger)
[2017-06-27 13:05:48,674] INFO Broker 1 skipped the become-leader state change after marking its partition as leader with correlation id 106 from controller 0 epoch 9 for partition __consumer_offsets-25 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:05:48,674] TRACE Broker 1 completed LeaderAndIsr request correlationId 106 from controller 0 epoch 9 for the become-leader transition for partition __consumer_offsets-25 (state.change.logger)
[2017-06-27 13:05:48,675] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-25 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 107 (state.change.logger)
[2017-06-27 13:05:48,675] TRACE Broker 2 completed LeaderAndIsr request correlationId 104 from controller 0 epoch 9 for the become-follower transition for partition __consumer_offsets-25 (state.change.logger)
[2017-06-27 13:05:48,675] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-25 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 105 (state.change.logger)
[2017-06-27 13:05:48,678] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 106 from controller 0 epoch 9 for partition [__consumer_offsets,27] (state.change.logger)
[2017-06-27 13:05:48,678] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 108 from controller 0 epoch 9 for partition [__consumer_offsets,27] (state.change.logger)
[2017-06-27 13:05:48,679] TRACE Broker 2 handling LeaderAndIsr request correlationId 106 from controller 0 epoch 9 starting the become-leader transition for partition __consumer_offsets-27 (state.change.logger)
[2017-06-27 13:05:48,679] TRACE Broker 1 handling LeaderAndIsr request correlationId 108 from controller 0 epoch 9 starting the become-follower transition for partition __consumer_offsets-27 (state.change.logger)
[2017-06-27 13:05:48,679] TRACE Broker 1 stopped fetchers as part of become-follower request from controller 0 epoch 9 with correlation id 108 for partition __consumer_offsets-27 (state.change.logger)
[2017-06-27 13:05:48,679] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 0 epoch 9 with correlation id 106 for partition __consumer_offsets-27 (state.change.logger)
[2017-06-27 13:05:48,679] TRACE Broker 2 completed LeaderAndIsr request correlationId 106 from controller 0 epoch 9 for the become-leader transition for partition __consumer_offsets-27 (state.change.logger)
[2017-06-27 13:05:48,680] TRACE Broker 1 truncated logs and checkpointed recovery boundaries for partition __consumer_offsets-27 as part of become-follower request with correlation id 108 from controller 0 epoch 9 (state.change.logger)
[2017-06-27 13:05:48,680] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-27 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 107 (state.change.logger)
[2017-06-27 13:05:48,680] TRACE Broker 1 started fetcher to new leader as part of become-follower request from controller 0 epoch 9 with correlation id 108 for partition __consumer_offsets-27 (state.change.logger)
[2017-06-27 13:05:48,680] TRACE Broker 1 completed LeaderAndIsr request correlationId 108 from controller 0 epoch 9 for the become-follower transition for partition __consumer_offsets-27 (state.change.logger)
[2017-06-27 13:05:48,681] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-27 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 109 (state.change.logger)
[2017-06-27 13:05:48,685] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 108 from controller 0 epoch 9 for partition [__consumer_offsets,42] (state.change.logger)
[2017-06-27 13:05:48,685] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 110 from controller 0 epoch 9 for partition [__consumer_offsets,42] (state.change.logger)
[2017-06-27 13:05:48,685] TRACE Broker 2 handling LeaderAndIsr request correlationId 108 from controller 0 epoch 9 starting the become-follower transition for partition __consumer_offsets-42 (state.change.logger)
[2017-06-27 13:05:48,685] TRACE Broker 1 handling LeaderAndIsr request correlationId 110 from controller 0 epoch 9 starting the become-leader transition for partition __consumer_offsets-42 (state.change.logger)
[2017-06-27 13:05:48,685] TRACE Broker 2 stopped fetchers as part of become-follower request from controller 0 epoch 9 with correlation id 108 for partition __consumer_offsets-42 (state.change.logger)
[2017-06-27 13:05:48,685] TRACE Broker 1 stopped fetchers as part of become-leader request from controller 0 epoch 9 with correlation id 110 for partition __consumer_offsets-42 (state.change.logger)
[2017-06-27 13:05:48,686] TRACE Broker 1 completed LeaderAndIsr request correlationId 110 from controller 0 epoch 9 for the become-leader transition for partition __consumer_offsets-42 (state.change.logger)
[2017-06-27 13:05:48,687] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-42 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 111 (state.change.logger)
[2017-06-27 13:05:48,687] TRACE Broker 2 truncated logs and checkpointed recovery boundaries for partition __consumer_offsets-42 as part of become-follower request with correlation id 108 from controller 0 epoch 9 (state.change.logger)
[2017-06-27 13:05:48,692] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=9, isr=[1, 2], zkVersion=14, replicas=[0, 1, 2]) correlation id 112 from controller 0 epoch 9 for partition [__consumer_offsets,11] (state.change.logger)
[2017-06-27 13:05:48,693] TRACE Broker 1 handling LeaderAndIsr request correlationId 112 from controller 0 epoch 9 starting the become-follower transition for partition __consumer_offsets-11 (state.change.logger)
[2017-06-27 13:05:48,693] INFO Broker 1 skipped the become-follower state change after marking its partition as follower with correlation id 112 from controller 0 epoch 9 for partition __consumer_offsets-11 since the new leader 2 is the same as the old leader (state.change.logger)
[2017-06-27 13:05:48,693] TRACE Broker 2 started fetcher to new leader as part of become-follower request from controller 0 epoch 9 with correlation id 108 for partition __consumer_offsets-42 (state.change.logger)
[2017-06-27 13:05:48,693] TRACE Broker 2 completed LeaderAndIsr request correlationId 108 from controller 0 epoch 9 for the become-follower transition for partition __consumer_offsets-42 (state.change.logger)
[2017-06-27 13:05:48,693] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-42 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 109 (state.change.logger)
[2017-06-27 13:05:48,694] TRACE Broker 1 completed LeaderAndIsr request correlationId 112 from controller 0 epoch 9 for the become-follower transition for partition __consumer_offsets-11 (state.change.logger)
[2017-06-27 13:05:48,694] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=9, isr=[1, 2], zkVersion=14, replicas=[0, 1, 2]) correlation id 110 from controller 0 epoch 9 for partition [__consumer_offsets,11] (state.change.logger)
[2017-06-27 13:05:48,694] TRACE Broker 2 handling LeaderAndIsr request correlationId 110 from controller 0 epoch 9 starting the become-leader transition for partition __consumer_offsets-11 (state.change.logger)
[2017-06-27 13:05:48,694] INFO Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 110 from controller 0 epoch 9 for partition __consumer_offsets-11 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:05:48,694] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-11 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 113 (state.change.logger)
[2017-06-27 13:05:48,694] TRACE Broker 2 completed LeaderAndIsr request correlationId 110 from controller 0 epoch 9 for the become-leader transition for partition __consumer_offsets-11 (state.change.logger)
[2017-06-27 13:05:48,695] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-11 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 111 (state.change.logger)
[2017-06-27 13:05:48,697] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=11, replicas=[0, 1, 2]) correlation id 112 from controller 0 epoch 9 for partition [__consumer_offsets,7] (state.change.logger)
[2017-06-27 13:05:48,697] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=11, replicas=[0, 1, 2]) correlation id 114 from controller 0 epoch 9 for partition [__consumer_offsets,7] (state.change.logger)
[2017-06-27 13:05:48,697] TRACE Broker 2 handling LeaderAndIsr request correlationId 112 from controller 0 epoch 9 starting the become-follower transition for partition __consumer_offsets-7 (state.change.logger)
[2017-06-27 13:05:48,697] TRACE Broker 1 handling LeaderAndIsr request correlationId 114 from controller 0 epoch 9 starting the become-leader transition for partition __consumer_offsets-7 (state.change.logger)
[2017-06-27 13:05:48,697] INFO Broker 2 skipped the become-follower state change after marking its partition as follower with correlation id 112 from controller 0 epoch 9 for partition __consumer_offsets-7 since the new leader 1 is the same as the old leader (state.change.logger)
[2017-06-27 13:05:48,697] INFO Broker 1 skipped the become-leader state change after marking its partition as leader with correlation id 114 from controller 0 epoch 9 for partition __consumer_offsets-7 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:05:48,697] TRACE Broker 1 completed LeaderAndIsr request correlationId 114 from controller 0 epoch 9 for the become-leader transition for partition __consumer_offsets-7 (state.change.logger)
[2017-06-27 13:05:48,697] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-7 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 115 (state.change.logger)
[2017-06-27 13:05:48,698] TRACE Broker 2 completed LeaderAndIsr request correlationId 112 from controller 0 epoch 9 for the become-follower transition for partition __consumer_offsets-7 (state.change.logger)
[2017-06-27 13:05:48,698] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-7 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 113 (state.change.logger)
[2017-06-27 13:05:48,704] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=9, isr=[1, 2], zkVersion=14, replicas=[0, 1, 2]) correlation id 114 from controller 0 epoch 9 for partition [__consumer_offsets,47] (state.change.logger)
[2017-06-27 13:05:48,704] TRACE Broker 2 handling LeaderAndIsr request correlationId 114 from controller 0 epoch 9 starting the become-leader transition for partition __consumer_offsets-47 (state.change.logger)
[2017-06-27 13:05:48,704] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=9, isr=[1, 2], zkVersion=14, replicas=[0, 1, 2]) correlation id 116 from controller 0 epoch 9 for partition [__consumer_offsets,47] (state.change.logger)
[2017-06-27 13:05:48,704] INFO Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 114 from controller 0 epoch 9 for partition __consumer_offsets-47 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:05:48,704] TRACE Broker 2 completed LeaderAndIsr request correlationId 114 from controller 0 epoch 9 for the become-leader transition for partition __consumer_offsets-47 (state.change.logger)
[2017-06-27 13:05:48,704] TRACE Broker 1 handling LeaderAndIsr request correlationId 116 from controller 0 epoch 9 starting the become-follower transition for partition __consumer_offsets-47 (state.change.logger)
[2017-06-27 13:05:48,704] INFO Broker 1 skipped the become-follower state change after marking its partition as follower with correlation id 116 from controller 0 epoch 9 for partition __consumer_offsets-47 since the new leader 2 is the same as the old leader (state.change.logger)
[2017-06-27 13:05:48,705] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-47 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 115 (state.change.logger)
[2017-06-27 13:05:48,706] TRACE Broker 1 completed LeaderAndIsr request correlationId 116 from controller 0 epoch 9 for the become-follower transition for partition __consumer_offsets-47 (state.change.logger)
[2017-06-27 13:05:48,706] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-47 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 117 (state.change.logger)
[2017-06-27 13:05:48,707] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 116 from controller 0 epoch 9 for partition [__consumer_offsets,9] (state.change.logger)
[2017-06-27 13:05:48,708] TRACE Broker 2 handling LeaderAndIsr request correlationId 116 from controller 0 epoch 9 starting the become-leader transition for partition __consumer_offsets-9 (state.change.logger)
[2017-06-27 13:05:48,708] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 118 from controller 0 epoch 9 for partition [__consumer_offsets,9] (state.change.logger)
[2017-06-27 13:05:48,708] TRACE Broker 1 handling LeaderAndIsr request correlationId 118 from controller 0 epoch 9 starting the become-follower transition for partition __consumer_offsets-9 (state.change.logger)
[2017-06-27 13:05:48,708] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 0 epoch 9 with correlation id 116 for partition __consumer_offsets-9 (state.change.logger)
[2017-06-27 13:05:48,708] TRACE Broker 1 stopped fetchers as part of become-follower request from controller 0 epoch 9 with correlation id 118 for partition __consumer_offsets-9 (state.change.logger)
[2017-06-27 13:05:48,708] TRACE Broker 2 completed LeaderAndIsr request correlationId 116 from controller 0 epoch 9 for the become-leader transition for partition __consumer_offsets-9 (state.change.logger)
[2017-06-27 13:05:48,709] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-9 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 117 (state.change.logger)
[2017-06-27 13:05:48,709] TRACE Broker 1 truncated logs and checkpointed recovery boundaries for partition __consumer_offsets-9 as part of become-follower request with correlation id 118 from controller 0 epoch 9 (state.change.logger)
[2017-06-27 13:05:48,709] TRACE Broker 1 started fetcher to new leader as part of become-follower request from controller 0 epoch 9 with correlation id 118 for partition __consumer_offsets-9 (state.change.logger)
[2017-06-27 13:05:48,709] TRACE Broker 1 completed LeaderAndIsr request correlationId 118 from controller 0 epoch 9 for the become-follower transition for partition __consumer_offsets-9 (state.change.logger)
[2017-06-27 13:05:48,710] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-9 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 119 (state.change.logger)
[2017-06-27 13:05:48,713] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=14, replicas=[0, 1, 2]) correlation id 118 from controller 0 epoch 9 for partition [__consumer_offsets,13] (state.change.logger)
[2017-06-27 13:05:48,713] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=14, replicas=[0, 1, 2]) correlation id 120 from controller 0 epoch 9 for partition [__consumer_offsets,13] (state.change.logger)
[2017-06-27 13:05:48,713] TRACE Broker 2 handling LeaderAndIsr request correlationId 118 from controller 0 epoch 9 starting the become-follower transition for partition __consumer_offsets-13 (state.change.logger)
[2017-06-27 13:05:48,713] TRACE Broker 1 handling LeaderAndIsr request correlationId 120 from controller 0 epoch 9 starting the become-leader transition for partition __consumer_offsets-13 (state.change.logger)
[2017-06-27 13:05:48,713] INFO Broker 2 skipped the become-follower state change after marking its partition as follower with correlation id 118 from controller 0 epoch 9 for partition __consumer_offsets-13 since the new leader 1 is the same as the old leader (state.change.logger)
[2017-06-27 13:05:48,713] INFO Broker 1 skipped the become-leader state change after marking its partition as leader with correlation id 120 from controller 0 epoch 9 for partition __consumer_offsets-13 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:05:48,713] TRACE Broker 1 completed LeaderAndIsr request correlationId 120 from controller 0 epoch 9 for the become-leader transition for partition __consumer_offsets-13 (state.change.logger)
[2017-06-27 13:05:48,714] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-13 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 121 (state.change.logger)
[2017-06-27 13:05:48,714] TRACE Broker 2 completed LeaderAndIsr request correlationId 118 from controller 0 epoch 9 for the become-follower transition for partition __consumer_offsets-13 (state.change.logger)
[2017-06-27 13:05:48,714] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-13 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 119 (state.change.logger)
[2017-06-27 13:05:48,717] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=9, isr=[1, 2], zkVersion=14, replicas=[0, 1, 2]) correlation id 120 from controller 0 epoch 9 for partition [__consumer_offsets,29] (state.change.logger)
[2017-06-27 13:05:48,718] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=9, isr=[1, 2], zkVersion=14, replicas=[0, 1, 2]) correlation id 122 from controller 0 epoch 9 for partition [__consumer_offsets,29] (state.change.logger)
[2017-06-27 13:05:48,718] TRACE Broker 2 handling LeaderAndIsr request correlationId 120 from controller 0 epoch 9 starting the become-leader transition for partition __consumer_offsets-29 (state.change.logger)
[2017-06-27 13:05:48,718] TRACE Broker 1 handling LeaderAndIsr request correlationId 122 from controller 0 epoch 9 starting the become-follower transition for partition __consumer_offsets-29 (state.change.logger)
[2017-06-27 13:05:48,718] INFO Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 120 from controller 0 epoch 9 for partition __consumer_offsets-29 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:05:48,718] INFO Broker 1 skipped the become-follower state change after marking its partition as follower with correlation id 122 from controller 0 epoch 9 for partition __consumer_offsets-29 since the new leader 2 is the same as the old leader (state.change.logger)
[2017-06-27 13:05:48,718] TRACE Broker 2 completed LeaderAndIsr request correlationId 120 from controller 0 epoch 9 for the become-leader transition for partition __consumer_offsets-29 (state.change.logger)
[2017-06-27 13:05:48,718] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-29 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 121 (state.change.logger)
[2017-06-27 13:05:48,719] TRACE Broker 1 completed LeaderAndIsr request correlationId 122 from controller 0 epoch 9 for the become-follower transition for partition __consumer_offsets-29 (state.change.logger)
[2017-06-27 13:05:48,719] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-29 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 123 (state.change.logger)
[2017-06-27 13:05:48,723] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=8, isr=[1, 2], zkVersion=13, replicas=[0, 1, 2]) correlation id 122 from controller 0 epoch 9 for partition [__consumer_offsets,8] (state.change.logger)
[2017-06-27 13:05:48,723] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=8, isr=[1, 2], zkVersion=13, replicas=[0, 1, 2]) correlation id 124 from controller 0 epoch 9 for partition [__consumer_offsets,8] (state.change.logger)
[2017-06-27 13:05:48,723] TRACE Broker 2 handling LeaderAndIsr request correlationId 122 from controller 0 epoch 9 starting the become-leader transition for partition __consumer_offsets-8 (state.change.logger)
[2017-06-27 13:05:48,723] TRACE Broker 1 handling LeaderAndIsr request correlationId 124 from controller 0 epoch 9 starting the become-follower transition for partition __consumer_offsets-8 (state.change.logger)
[2017-06-27 13:05:48,723] INFO Broker 1 skipped the become-follower state change after marking its partition as follower with correlation id 124 from controller 0 epoch 9 for partition __consumer_offsets-8 since the new leader 2 is the same as the old leader (state.change.logger)
[2017-06-27 13:05:48,724] INFO Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 122 from controller 0 epoch 9 for partition __consumer_offsets-8 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:05:48,724] TRACE Broker 2 completed LeaderAndIsr request correlationId 122 from controller 0 epoch 9 for the become-leader transition for partition __consumer_offsets-8 (state.change.logger)
[2017-06-27 13:05:48,724] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-8 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 123 (state.change.logger)
[2017-06-27 13:05:48,725] TRACE Broker 1 completed LeaderAndIsr request correlationId 124 from controller 0 epoch 9 for the become-follower transition for partition __consumer_offsets-8 (state.change.logger)
[2017-06-27 13:05:48,725] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-8 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 125 (state.change.logger)
[2017-06-27 13:05:48,728] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=13, replicas=[0, 1, 2]) correlation id 124 from controller 0 epoch 9 for partition [__consumer_offsets,22] (state.change.logger)
[2017-06-27 13:05:48,728] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=13, replicas=[0, 1, 2]) correlation id 126 from controller 0 epoch 9 for partition [__consumer_offsets,22] (state.change.logger)
[2017-06-27 13:05:48,728] TRACE Broker 2 handling LeaderAndIsr request correlationId 124 from controller 0 epoch 9 starting the become-follower transition for partition __consumer_offsets-22 (state.change.logger)
[2017-06-27 13:05:48,728] TRACE Broker 1 handling LeaderAndIsr request correlationId 126 from controller 0 epoch 9 starting the become-leader transition for partition __consumer_offsets-22 (state.change.logger)
[2017-06-27 13:05:48,728] INFO Broker 2 skipped the become-follower state change after marking its partition as follower with correlation id 124 from controller 0 epoch 9 for partition __consumer_offsets-22 since the new leader 1 is the same as the old leader (state.change.logger)
[2017-06-27 13:05:48,728] INFO Broker 1 skipped the become-leader state change after marking its partition as leader with correlation id 126 from controller 0 epoch 9 for partition __consumer_offsets-22 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:05:48,728] TRACE Broker 1 completed LeaderAndIsr request correlationId 126 from controller 0 epoch 9 for the become-leader transition for partition __consumer_offsets-22 (state.change.logger)
[2017-06-27 13:05:48,728] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-22 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 127 (state.change.logger)
[2017-06-27 13:05:48,729] TRACE Broker 2 completed LeaderAndIsr request correlationId 124 from controller 0 epoch 9 for the become-follower transition for partition __consumer_offsets-22 (state.change.logger)
[2017-06-27 13:05:48,729] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-22 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 125 (state.change.logger)
[2017-06-27 13:05:48,730] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=11, replicas=[0, 1, 2]) correlation id 126 from controller 0 epoch 9 for partition [__consumer_offsets,31] (state.change.logger)
[2017-06-27 13:05:48,730] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=11, replicas=[0, 1, 2]) correlation id 128 from controller 0 epoch 9 for partition [__consumer_offsets,31] (state.change.logger)
[2017-06-27 13:05:48,730] TRACE Broker 2 handling LeaderAndIsr request correlationId 126 from controller 0 epoch 9 starting the become-follower transition for partition __consumer_offsets-31 (state.change.logger)
[2017-06-27 13:05:48,730] TRACE Broker 1 handling LeaderAndIsr request correlationId 128 from controller 0 epoch 9 starting the become-leader transition for partition __consumer_offsets-31 (state.change.logger)
[2017-06-27 13:05:48,730] INFO Broker 2 skipped the become-follower state change after marking its partition as follower with correlation id 126 from controller 0 epoch 9 for partition __consumer_offsets-31 since the new leader 1 is the same as the old leader (state.change.logger)
[2017-06-27 13:05:48,730] INFO Broker 1 skipped the become-leader state change after marking its partition as leader with correlation id 128 from controller 0 epoch 9 for partition __consumer_offsets-31 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:05:48,730] TRACE Broker 1 completed LeaderAndIsr request correlationId 128 from controller 0 epoch 9 for the become-leader transition for partition __consumer_offsets-31 (state.change.logger)
[2017-06-27 13:05:48,731] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-31 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 129 (state.change.logger)
[2017-06-27 13:05:48,731] TRACE Broker 2 completed LeaderAndIsr request correlationId 126 from controller 0 epoch 9 for the become-follower transition for partition __consumer_offsets-31 (state.change.logger)
[2017-06-27 13:05:48,731] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-31 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 127 (state.change.logger)
[2017-06-27 13:05:48,733] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 128 from controller 0 epoch 9 for partition [__consumer_offsets,18] (state.change.logger)
[2017-06-27 13:05:48,733] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 130 from controller 0 epoch 9 for partition [__consumer_offsets,18] (state.change.logger)
[2017-06-27 13:05:48,733] TRACE Broker 2 handling LeaderAndIsr request correlationId 128 from controller 0 epoch 9 starting the become-follower transition for partition __consumer_offsets-18 (state.change.logger)
[2017-06-27 13:05:48,733] TRACE Broker 1 handling LeaderAndIsr request correlationId 130 from controller 0 epoch 9 starting the become-leader transition for partition __consumer_offsets-18 (state.change.logger)
[2017-06-27 13:05:48,733] TRACE Broker 2 stopped fetchers as part of become-follower request from controller 0 epoch 9 with correlation id 128 for partition __consumer_offsets-18 (state.change.logger)
[2017-06-27 13:05:48,733] TRACE Broker 1 stopped fetchers as part of become-leader request from controller 0 epoch 9 with correlation id 130 for partition __consumer_offsets-18 (state.change.logger)
[2017-06-27 13:05:48,734] TRACE Broker 1 completed LeaderAndIsr request correlationId 130 from controller 0 epoch 9 for the become-leader transition for partition __consumer_offsets-18 (state.change.logger)
[2017-06-27 13:05:48,734] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-18 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 131 (state.change.logger)
[2017-06-27 13:05:48,737] TRACE Broker 2 truncated logs and checkpointed recovery boundaries for partition __consumer_offsets-18 as part of become-follower request with correlation id 128 from controller 0 epoch 9 (state.change.logger)
[2017-06-27 13:05:48,737] TRACE Broker 2 started fetcher to new leader as part of become-follower request from controller 0 epoch 9 with correlation id 128 for partition __consumer_offsets-18 (state.change.logger)
[2017-06-27 13:05:48,737] TRACE Broker 2 completed LeaderAndIsr request correlationId 128 from controller 0 epoch 9 for the become-follower transition for partition __consumer_offsets-18 (state.change.logger)
[2017-06-27 13:05:48,738] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-18 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 129 (state.change.logger)
[2017-06-27 13:05:48,738] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=8, isr=[1, 2], zkVersion=13, replicas=[0, 1, 2]) correlation id 130 from controller 0 epoch 9 for partition [__consumer_offsets,20] (state.change.logger)
[2017-06-27 13:05:48,739] TRACE Broker 2 handling LeaderAndIsr request correlationId 130 from controller 0 epoch 9 starting the become-leader transition for partition __consumer_offsets-20 (state.change.logger)
[2017-06-27 13:05:48,739] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=8, isr=[1, 2], zkVersion=13, replicas=[0, 1, 2]) correlation id 132 from controller 0 epoch 9 for partition [__consumer_offsets,20] (state.change.logger)
[2017-06-27 13:05:48,739] TRACE Broker 1 handling LeaderAndIsr request correlationId 132 from controller 0 epoch 9 starting the become-follower transition for partition __consumer_offsets-20 (state.change.logger)
[2017-06-27 13:05:48,739] INFO Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 130 from controller 0 epoch 9 for partition __consumer_offsets-20 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:05:48,739] INFO Broker 1 skipped the become-follower state change after marking its partition as follower with correlation id 132 from controller 0 epoch 9 for partition __consumer_offsets-20 since the new leader 2 is the same as the old leader (state.change.logger)
[2017-06-27 13:05:48,739] TRACE Broker 2 completed LeaderAndIsr request correlationId 130 from controller 0 epoch 9 for the become-leader transition for partition __consumer_offsets-20 (state.change.logger)
[2017-06-27 13:05:48,739] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-20 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 131 (state.change.logger)
[2017-06-27 13:05:48,740] TRACE Broker 1 completed LeaderAndIsr request correlationId 132 from controller 0 epoch 9 for the become-follower transition for partition __consumer_offsets-20 (state.change.logger)
[2017-06-27 13:05:48,740] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-20 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 133 (state.change.logger)
[2017-06-27 13:05:48,741] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=13, replicas=[0, 1, 2]) correlation id 132 from controller 0 epoch 9 for partition [__consumer_offsets,37] (state.change.logger)
[2017-06-27 13:05:48,741] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=13, replicas=[0, 1, 2]) correlation id 134 from controller 0 epoch 9 for partition [__consumer_offsets,37] (state.change.logger)
[2017-06-27 13:05:48,741] TRACE Broker 2 handling LeaderAndIsr request correlationId 132 from controller 0 epoch 9 starting the become-follower transition for partition __consumer_offsets-37 (state.change.logger)
[2017-06-27 13:05:48,741] TRACE Broker 1 handling LeaderAndIsr request correlationId 134 from controller 0 epoch 9 starting the become-leader transition for partition __consumer_offsets-37 (state.change.logger)
[2017-06-27 13:05:48,741] INFO Broker 2 skipped the become-follower state change after marking its partition as follower with correlation id 132 from controller 0 epoch 9 for partition __consumer_offsets-37 since the new leader 1 is the same as the old leader (state.change.logger)
[2017-06-27 13:05:48,741] INFO Broker 1 skipped the become-leader state change after marking its partition as leader with correlation id 134 from controller 0 epoch 9 for partition __consumer_offsets-37 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:05:48,741] TRACE Broker 1 completed LeaderAndIsr request correlationId 134 from controller 0 epoch 9 for the become-leader transition for partition __consumer_offsets-37 (state.change.logger)
[2017-06-27 13:05:48,742] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-37 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 135 (state.change.logger)
[2017-06-27 13:05:48,742] TRACE Broker 2 completed LeaderAndIsr request correlationId 132 from controller 0 epoch 9 for the become-follower transition for partition __consumer_offsets-37 (state.change.logger)
[2017-06-27 13:05:48,742] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-37 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 133 (state.change.logger)
[2017-06-27 13:05:48,745] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=11, replicas=[0, 1, 2]) correlation id 134 from controller 0 epoch 9 for partition [__consumer_offsets,49] (state.change.logger)
[2017-06-27 13:05:48,745] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=11, replicas=[0, 1, 2]) correlation id 136 from controller 0 epoch 9 for partition [__consumer_offsets,49] (state.change.logger)
[2017-06-27 13:05:48,745] TRACE Broker 2 handling LeaderAndIsr request correlationId 134 from controller 0 epoch 9 starting the become-follower transition for partition __consumer_offsets-49 (state.change.logger)
[2017-06-27 13:05:48,745] TRACE Broker 1 handling LeaderAndIsr request correlationId 136 from controller 0 epoch 9 starting the become-leader transition for partition __consumer_offsets-49 (state.change.logger)
[2017-06-27 13:05:48,745] INFO Broker 2 skipped the become-follower state change after marking its partition as follower with correlation id 134 from controller 0 epoch 9 for partition __consumer_offsets-49 since the new leader 1 is the same as the old leader (state.change.logger)
[2017-06-27 13:05:48,745] INFO Broker 1 skipped the become-leader state change after marking its partition as leader with correlation id 136 from controller 0 epoch 9 for partition __consumer_offsets-49 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:05:48,746] TRACE Broker 1 completed LeaderAndIsr request correlationId 136 from controller 0 epoch 9 for the become-leader transition for partition __consumer_offsets-49 (state.change.logger)
[2017-06-27 13:05:48,746] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-49 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 137 (state.change.logger)
[2017-06-27 13:05:48,746] TRACE Broker 2 completed LeaderAndIsr request correlationId 134 from controller 0 epoch 9 for the become-follower transition for partition __consumer_offsets-49 (state.change.logger)
[2017-06-27 13:05:48,747] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-49 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 135 (state.change.logger)
[2017-06-27 13:05:48,749] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 136 from controller 0 epoch 9 for partition [__consumer_offsets,12] (state.change.logger)
[2017-06-27 13:05:48,749] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 138 from controller 0 epoch 9 for partition [__consumer_offsets,12] (state.change.logger)
[2017-06-27 13:05:48,749] TRACE Broker 2 handling LeaderAndIsr request correlationId 136 from controller 0 epoch 9 starting the become-follower transition for partition __consumer_offsets-12 (state.change.logger)
[2017-06-27 13:05:48,749] TRACE Broker 1 handling LeaderAndIsr request correlationId 138 from controller 0 epoch 9 starting the become-leader transition for partition __consumer_offsets-12 (state.change.logger)
[2017-06-27 13:05:48,750] TRACE Broker 2 stopped fetchers as part of become-follower request from controller 0 epoch 9 with correlation id 136 for partition __consumer_offsets-12 (state.change.logger)
[2017-06-27 13:05:48,750] TRACE Broker 1 stopped fetchers as part of become-leader request from controller 0 epoch 9 with correlation id 138 for partition __consumer_offsets-12 (state.change.logger)
[2017-06-27 13:05:48,750] TRACE Broker 1 completed LeaderAndIsr request correlationId 138 from controller 0 epoch 9 for the become-leader transition for partition __consumer_offsets-12 (state.change.logger)
[2017-06-27 13:05:48,750] TRACE Broker 2 truncated logs and checkpointed recovery boundaries for partition __consumer_offsets-12 as part of become-follower request with correlation id 136 from controller 0 epoch 9 (state.change.logger)
[2017-06-27 13:05:48,750] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-12 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 139 (state.change.logger)
[2017-06-27 13:05:48,752] TRACE Broker 2 started fetcher to new leader as part of become-follower request from controller 0 epoch 9 with correlation id 136 for partition __consumer_offsets-12 (state.change.logger)
[2017-06-27 13:05:48,752] TRACE Broker 2 completed LeaderAndIsr request correlationId 136 from controller 0 epoch 9 for the become-follower transition for partition __consumer_offsets-12 (state.change.logger)
[2017-06-27 13:05:48,753] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-12 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 137 (state.change.logger)
[2017-06-27 13:05:48,753] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=9, isr=[1, 2], zkVersion=14, replicas=[0, 1, 2]) correlation id 138 from controller 0 epoch 9 for partition [__consumer_offsets,5] (state.change.logger)
[2017-06-27 13:05:48,753] TRACE Broker 2 handling LeaderAndIsr request correlationId 138 from controller 0 epoch 9 starting the become-leader transition for partition __consumer_offsets-5 (state.change.logger)
[2017-06-27 13:05:48,753] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=9, isr=[1, 2], zkVersion=14, replicas=[0, 1, 2]) correlation id 140 from controller 0 epoch 9 for partition [__consumer_offsets,5] (state.change.logger)
[2017-06-27 13:05:48,753] TRACE Broker 1 handling LeaderAndIsr request correlationId 140 from controller 0 epoch 9 starting the become-follower transition for partition __consumer_offsets-5 (state.change.logger)
[2017-06-27 13:05:48,753] INFO Broker 1 skipped the become-follower state change after marking its partition as follower with correlation id 140 from controller 0 epoch 9 for partition __consumer_offsets-5 since the new leader 2 is the same as the old leader (state.change.logger)
[2017-06-27 13:05:48,753] INFO Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 138 from controller 0 epoch 9 for partition __consumer_offsets-5 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:05:48,754] TRACE Broker 2 completed LeaderAndIsr request correlationId 138 from controller 0 epoch 9 for the become-leader transition for partition __consumer_offsets-5 (state.change.logger)
[2017-06-27 13:05:48,754] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-5 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 139 (state.change.logger)
[2017-06-27 13:05:48,755] TRACE Broker 1 completed LeaderAndIsr request correlationId 140 from controller 0 epoch 9 for the become-follower transition for partition __consumer_offsets-5 (state.change.logger)
[2017-06-27 13:05:48,755] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-5 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 141 (state.change.logger)
[2017-06-27 13:05:48,757] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=8, isr=[1, 2], zkVersion=13, replicas=[0, 1, 2]) correlation id 142 from controller 0 epoch 9 for partition [__consumer_offsets,32] (state.change.logger)
[2017-06-27 13:05:48,757] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=8, isr=[1, 2], zkVersion=13, replicas=[0, 1, 2]) correlation id 140 from controller 0 epoch 9 for partition [__consumer_offsets,32] (state.change.logger)
[2017-06-27 13:05:48,757] TRACE Broker 1 handling LeaderAndIsr request correlationId 142 from controller 0 epoch 9 starting the become-follower transition for partition __consumer_offsets-32 (state.change.logger)
[2017-06-27 13:05:48,757] TRACE Broker 2 handling LeaderAndIsr request correlationId 140 from controller 0 epoch 9 starting the become-leader transition for partition __consumer_offsets-32 (state.change.logger)
[2017-06-27 13:05:48,757] INFO Broker 1 skipped the become-follower state change after marking its partition as follower with correlation id 142 from controller 0 epoch 9 for partition __consumer_offsets-32 since the new leader 2 is the same as the old leader (state.change.logger)
[2017-06-27 13:05:48,757] INFO Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 140 from controller 0 epoch 9 for partition __consumer_offsets-32 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:05:48,757] TRACE Broker 2 completed LeaderAndIsr request correlationId 140 from controller 0 epoch 9 for the become-leader transition for partition __consumer_offsets-32 (state.change.logger)
[2017-06-27 13:05:48,758] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-32 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 141 (state.change.logger)
[2017-06-27 13:05:48,758] TRACE Broker 1 completed LeaderAndIsr request correlationId 142 from controller 0 epoch 9 for the become-follower transition for partition __consumer_offsets-32 (state.change.logger)
[2017-06-27 13:05:48,758] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-32 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 143 (state.change.logger)
[2017-06-27 13:05:48,760] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=8, isr=[1, 2], zkVersion=13, replicas=[0, 1, 2]) correlation id 142 from controller 0 epoch 9 for partition [__consumer_offsets,2] (state.change.logger)
[2017-06-27 13:05:48,760] TRACE Broker 2 handling LeaderAndIsr request correlationId 142 from controller 0 epoch 9 starting the become-leader transition for partition __consumer_offsets-2 (state.change.logger)
[2017-06-27 13:05:48,760] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=8, isr=[1, 2], zkVersion=13, replicas=[0, 1, 2]) correlation id 144 from controller 0 epoch 9 for partition [__consumer_offsets,2] (state.change.logger)
[2017-06-27 13:05:48,760] TRACE Broker 1 handling LeaderAndIsr request correlationId 144 from controller 0 epoch 9 starting the become-follower transition for partition __consumer_offsets-2 (state.change.logger)
[2017-06-27 13:05:48,761] INFO Broker 1 skipped the become-follower state change after marking its partition as follower with correlation id 144 from controller 0 epoch 9 for partition __consumer_offsets-2 since the new leader 2 is the same as the old leader (state.change.logger)
[2017-06-27 13:05:48,761] INFO Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 142 from controller 0 epoch 9 for partition __consumer_offsets-2 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:05:48,761] TRACE Broker 2 completed LeaderAndIsr request correlationId 142 from controller 0 epoch 9 for the become-leader transition for partition __consumer_offsets-2 (state.change.logger)
[2017-06-27 13:05:48,761] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-2 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 143 (state.change.logger)
[2017-06-27 13:05:48,762] TRACE Broker 1 completed LeaderAndIsr request correlationId 144 from controller 0 epoch 9 for the become-follower transition for partition __consumer_offsets-2 (state.change.logger)
[2017-06-27 13:05:48,762] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-2 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 145 (state.change.logger)
[2017-06-27 13:05:48,763] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=11, replicas=[0, 1, 2]) correlation id 144 from controller 0 epoch 9 for partition [__consumer_offsets,1] (state.change.logger)
[2017-06-27 13:05:48,763] TRACE Broker 2 handling LeaderAndIsr request correlationId 144 from controller 0 epoch 9 starting the become-follower transition for partition __consumer_offsets-1 (state.change.logger)
[2017-06-27 13:05:48,763] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=11, replicas=[0, 1, 2]) correlation id 146 from controller 0 epoch 9 for partition [__consumer_offsets,1] (state.change.logger)
[2017-06-27 13:05:48,763] TRACE Broker 1 handling LeaderAndIsr request correlationId 146 from controller 0 epoch 9 starting the become-leader transition for partition __consumer_offsets-1 (state.change.logger)
[2017-06-27 13:05:48,763] INFO Broker 2 skipped the become-follower state change after marking its partition as follower with correlation id 144 from controller 0 epoch 9 for partition __consumer_offsets-1 since the new leader 1 is the same as the old leader (state.change.logger)
[2017-06-27 13:05:48,763] INFO Broker 1 skipped the become-leader state change after marking its partition as leader with correlation id 146 from controller 0 epoch 9 for partition __consumer_offsets-1 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:05:48,763] TRACE Broker 1 completed LeaderAndIsr request correlationId 146 from controller 0 epoch 9 for the become-leader transition for partition __consumer_offsets-1 (state.change.logger)
[2017-06-27 13:05:48,764] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-1 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 147 (state.change.logger)
[2017-06-27 13:05:48,764] TRACE Broker 2 completed LeaderAndIsr request correlationId 144 from controller 0 epoch 9 for the become-follower transition for partition __consumer_offsets-1 (state.change.logger)
[2017-06-27 13:05:48,764] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-1 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 145 (state.change.logger)
[2017-06-27 13:05:48,766] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 146 from controller 0 epoch 9 for partition [__consumer_offsets,0] (state.change.logger)
[2017-06-27 13:05:48,766] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 148 from controller 0 epoch 9 for partition [__consumer_offsets,0] (state.change.logger)
[2017-06-27 13:05:48,766] TRACE Broker 2 handling LeaderAndIsr request correlationId 146 from controller 0 epoch 9 starting the become-follower transition for partition __consumer_offsets-0 (state.change.logger)
[2017-06-27 13:05:48,767] TRACE Broker 1 handling LeaderAndIsr request correlationId 148 from controller 0 epoch 9 starting the become-leader transition for partition __consumer_offsets-0 (state.change.logger)
[2017-06-27 13:05:48,767] TRACE Broker 2 stopped fetchers as part of become-follower request from controller 0 epoch 9 with correlation id 146 for partition __consumer_offsets-0 (state.change.logger)
[2017-06-27 13:05:48,767] TRACE Broker 1 stopped fetchers as part of become-leader request from controller 0 epoch 9 with correlation id 148 for partition __consumer_offsets-0 (state.change.logger)
[2017-06-27 13:05:48,767] TRACE Broker 1 completed LeaderAndIsr request correlationId 148 from controller 0 epoch 9 for the become-leader transition for partition __consumer_offsets-0 (state.change.logger)
[2017-06-27 13:05:48,769] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-0 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 149 (state.change.logger)
[2017-06-27 13:05:48,769] TRACE Broker 2 truncated logs and checkpointed recovery boundaries for partition __consumer_offsets-0 as part of become-follower request with correlation id 146 from controller 0 epoch 9 (state.change.logger)
[2017-06-27 13:05:48,771] TRACE Broker 2 started fetcher to new leader as part of become-follower request from controller 0 epoch 9 with correlation id 146 for partition __consumer_offsets-0 (state.change.logger)
[2017-06-27 13:05:48,771] TRACE Broker 2 completed LeaderAndIsr request correlationId 146 from controller 0 epoch 9 for the become-follower transition for partition __consumer_offsets-0 (state.change.logger)
[2017-06-27 13:05:48,772] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-0 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 147 (state.change.logger)
[2017-06-27 13:05:48,776] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 148 from controller 0 epoch 9 for partition [__consumer_offsets,15] (state.change.logger)
[2017-06-27 13:05:48,776] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 150 from controller 0 epoch 9 for partition [__consumer_offsets,15] (state.change.logger)
[2017-06-27 13:05:48,776] TRACE Broker 2 handling LeaderAndIsr request correlationId 148 from controller 0 epoch 9 starting the become-leader transition for partition __consumer_offsets-15 (state.change.logger)
[2017-06-27 13:05:48,776] TRACE Broker 1 handling LeaderAndIsr request correlationId 150 from controller 0 epoch 9 starting the become-follower transition for partition __consumer_offsets-15 (state.change.logger)
[2017-06-27 13:05:48,776] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 0 epoch 9 with correlation id 148 for partition __consumer_offsets-15 (state.change.logger)
[2017-06-27 13:05:48,776] TRACE Broker 1 stopped fetchers as part of become-follower request from controller 0 epoch 9 with correlation id 150 for partition __consumer_offsets-15 (state.change.logger)
[2017-06-27 13:05:48,776] TRACE Broker 2 completed LeaderAndIsr request correlationId 148 from controller 0 epoch 9 for the become-leader transition for partition __consumer_offsets-15 (state.change.logger)
[2017-06-27 13:05:48,777] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-15 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 149 (state.change.logger)
[2017-06-27 13:05:48,778] TRACE Broker 1 truncated logs and checkpointed recovery boundaries for partition __consumer_offsets-15 as part of become-follower request with correlation id 150 from controller 0 epoch 9 (state.change.logger)
[2017-06-27 13:05:48,779] TRACE Broker 1 started fetcher to new leader as part of become-follower request from controller 0 epoch 9 with correlation id 150 for partition __consumer_offsets-15 (state.change.logger)
[2017-06-27 13:05:48,779] TRACE Broker 1 completed LeaderAndIsr request correlationId 150 from controller 0 epoch 9 for the become-follower transition for partition __consumer_offsets-15 (state.change.logger)
[2017-06-27 13:05:48,779] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-15 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 151 (state.change.logger)
[2017-06-27 13:05:48,783] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=8, isr=[1, 2], zkVersion=13, replicas=[0, 1, 2]) correlation id 150 from controller 0 epoch 9 for partition [__consumer_offsets,44] (state.change.logger)
[2017-06-27 13:05:48,783] TRACE Broker 2 handling LeaderAndIsr request correlationId 150 from controller 0 epoch 9 starting the become-leader transition for partition __consumer_offsets-44 (state.change.logger)
[2017-06-27 13:05:48,783] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=8, isr=[1, 2], zkVersion=13, replicas=[0, 1, 2]) correlation id 152 from controller 0 epoch 9 for partition [__consumer_offsets,44] (state.change.logger)
[2017-06-27 13:05:48,783] TRACE Broker 1 handling LeaderAndIsr request correlationId 152 from controller 0 epoch 9 starting the become-follower transition for partition __consumer_offsets-44 (state.change.logger)
[2017-06-27 13:05:48,783] INFO Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 150 from controller 0 epoch 9 for partition __consumer_offsets-44 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:05:48,783] INFO Broker 1 skipped the become-follower state change after marking its partition as follower with correlation id 152 from controller 0 epoch 9 for partition __consumer_offsets-44 since the new leader 2 is the same as the old leader (state.change.logger)
[2017-06-27 13:05:48,783] TRACE Broker 2 completed LeaderAndIsr request correlationId 150 from controller 0 epoch 9 for the become-leader transition for partition __consumer_offsets-44 (state.change.logger)
[2017-06-27 13:05:48,783] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-44 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 151 (state.change.logger)
[2017-06-27 13:05:48,784] TRACE Broker 1 completed LeaderAndIsr request correlationId 152 from controller 0 epoch 9 for the become-follower transition for partition __consumer_offsets-44 (state.change.logger)
[2017-06-27 13:05:48,785] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-44 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 153 (state.change.logger)
[2017-06-27 13:05:48,787] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=9, isr=[1, 2], zkVersion=14, replicas=[0, 1, 2]) correlation id 152 from controller 0 epoch 9 for partition [__consumer_offsets,17] (state.change.logger)
[2017-06-27 13:05:48,787] TRACE Broker 2 handling LeaderAndIsr request correlationId 152 from controller 0 epoch 9 starting the become-leader transition for partition __consumer_offsets-17 (state.change.logger)
[2017-06-27 13:05:48,787] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=9, isr=[1, 2], zkVersion=14, replicas=[0, 1, 2]) correlation id 154 from controller 0 epoch 9 for partition [__consumer_offsets,17] (state.change.logger)
[2017-06-27 13:05:48,787] TRACE Broker 1 handling LeaderAndIsr request correlationId 154 from controller 0 epoch 9 starting the become-follower transition for partition __consumer_offsets-17 (state.change.logger)
[2017-06-27 13:05:48,788] INFO Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 152 from controller 0 epoch 9 for partition __consumer_offsets-17 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:05:48,788] INFO Broker 1 skipped the become-follower state change after marking its partition as follower with correlation id 154 from controller 0 epoch 9 for partition __consumer_offsets-17 since the new leader 2 is the same as the old leader (state.change.logger)
[2017-06-27 13:05:48,788] TRACE Broker 2 completed LeaderAndIsr request correlationId 152 from controller 0 epoch 9 for the become-leader transition for partition __consumer_offsets-17 (state.change.logger)
[2017-06-27 13:05:48,788] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-17 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 153 (state.change.logger)
[2017-06-27 13:05:48,788] TRACE Broker 1 completed LeaderAndIsr request correlationId 154 from controller 0 epoch 9 for the become-follower transition for partition __consumer_offsets-17 (state.change.logger)
[2017-06-27 13:05:48,789] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-17 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 155 (state.change.logger)
[2017-06-27 13:05:48,791] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 154 from controller 0 epoch 9 for partition [__consumer_offsets,48] (state.change.logger)
[2017-06-27 13:05:48,791] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 156 from controller 0 epoch 9 for partition [__consumer_offsets,48] (state.change.logger)
[2017-06-27 13:05:48,791] TRACE Broker 2 handling LeaderAndIsr request correlationId 154 from controller 0 epoch 9 starting the become-follower transition for partition __consumer_offsets-48 (state.change.logger)
[2017-06-27 13:05:48,791] TRACE Broker 1 handling LeaderAndIsr request correlationId 156 from controller 0 epoch 9 starting the become-leader transition for partition __consumer_offsets-48 (state.change.logger)
[2017-06-27 13:05:48,791] TRACE Broker 2 stopped fetchers as part of become-follower request from controller 0 epoch 9 with correlation id 154 for partition __consumer_offsets-48 (state.change.logger)
[2017-06-27 13:05:48,791] TRACE Broker 1 stopped fetchers as part of become-leader request from controller 0 epoch 9 with correlation id 156 for partition __consumer_offsets-48 (state.change.logger)
[2017-06-27 13:05:48,791] TRACE Broker 1 completed LeaderAndIsr request correlationId 156 from controller 0 epoch 9 for the become-leader transition for partition __consumer_offsets-48 (state.change.logger)
[2017-06-27 13:05:48,792] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-48 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 157 (state.change.logger)
[2017-06-27 13:05:48,792] TRACE Broker 2 truncated logs and checkpointed recovery boundaries for partition __consumer_offsets-48 as part of become-follower request with correlation id 154 from controller 0 epoch 9 (state.change.logger)
[2017-06-27 13:05:48,793] TRACE Broker 2 started fetcher to new leader as part of become-follower request from controller 0 epoch 9 with correlation id 154 for partition __consumer_offsets-48 (state.change.logger)
[2017-06-27 13:05:48,793] TRACE Broker 2 completed LeaderAndIsr request correlationId 154 from controller 0 epoch 9 for the become-follower transition for partition __consumer_offsets-48 (state.change.logger)
[2017-06-27 13:05:48,793] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-48 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 155 (state.change.logger)
[2017-06-27 13:05:48,797] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=8, isr=[1, 2], zkVersion=13, replicas=[0, 1, 2]) correlation id 156 from controller 0 epoch 9 for partition [__consumer_offsets,26] (state.change.logger)
[2017-06-27 13:05:48,797] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=8, isr=[1, 2], zkVersion=13, replicas=[0, 1, 2]) correlation id 158 from controller 0 epoch 9 for partition [__consumer_offsets,26] (state.change.logger)
[2017-06-27 13:05:48,797] TRACE Broker 2 handling LeaderAndIsr request correlationId 156 from controller 0 epoch 9 starting the become-leader transition for partition __consumer_offsets-26 (state.change.logger)
[2017-06-27 13:05:48,797] TRACE Broker 1 handling LeaderAndIsr request correlationId 158 from controller 0 epoch 9 starting the become-follower transition for partition __consumer_offsets-26 (state.change.logger)
[2017-06-27 13:05:48,797] INFO Broker 1 skipped the become-follower state change after marking its partition as follower with correlation id 158 from controller 0 epoch 9 for partition __consumer_offsets-26 since the new leader 2 is the same as the old leader (state.change.logger)
[2017-06-27 13:05:48,797] INFO Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 156 from controller 0 epoch 9 for partition __consumer_offsets-26 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:05:48,797] TRACE Broker 2 completed LeaderAndIsr request correlationId 156 from controller 0 epoch 9 for the become-leader transition for partition __consumer_offsets-26 (state.change.logger)
[2017-06-27 13:05:48,798] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-26 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 157 (state.change.logger)
[2017-06-27 13:05:48,798] TRACE Broker 1 completed LeaderAndIsr request correlationId 158 from controller 0 epoch 9 for the become-follower transition for partition __consumer_offsets-26 (state.change.logger)
[2017-06-27 13:05:48,799] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-26 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 159 (state.change.logger)
[2017-06-27 13:05:48,803] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 158 from controller 0 epoch 9 for partition [__consumer_offsets,33] (state.change.logger)
[2017-06-27 13:05:48,803] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 160 from controller 0 epoch 9 for partition [__consumer_offsets,33] (state.change.logger)
[2017-06-27 13:05:48,804] TRACE Broker 2 handling LeaderAndIsr request correlationId 158 from controller 0 epoch 9 starting the become-leader transition for partition __consumer_offsets-33 (state.change.logger)
[2017-06-27 13:05:48,804] TRACE Broker 1 handling LeaderAndIsr request correlationId 160 from controller 0 epoch 9 starting the become-follower transition for partition __consumer_offsets-33 (state.change.logger)
[2017-06-27 13:05:48,804] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 0 epoch 9 with correlation id 158 for partition __consumer_offsets-33 (state.change.logger)
[2017-06-27 13:05:48,804] TRACE Broker 1 stopped fetchers as part of become-follower request from controller 0 epoch 9 with correlation id 160 for partition __consumer_offsets-33 (state.change.logger)
[2017-06-27 13:05:48,804] TRACE Broker 2 completed LeaderAndIsr request correlationId 158 from controller 0 epoch 9 for the become-leader transition for partition __consumer_offsets-33 (state.change.logger)
[2017-06-27 13:05:48,805] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-33 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 159 (state.change.logger)
[2017-06-27 13:05:48,805] TRACE Broker 1 truncated logs and checkpointed recovery boundaries for partition __consumer_offsets-33 as part of become-follower request with correlation id 160 from controller 0 epoch 9 (state.change.logger)
[2017-06-27 13:05:48,806] TRACE Broker 1 started fetcher to new leader as part of become-follower request from controller 0 epoch 9 with correlation id 160 for partition __consumer_offsets-33 (state.change.logger)
[2017-06-27 13:05:48,806] TRACE Broker 1 completed LeaderAndIsr request correlationId 160 from controller 0 epoch 9 for the become-follower transition for partition __consumer_offsets-33 (state.change.logger)
[2017-06-27 13:05:48,807] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-33 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 161 (state.change.logger)
[2017-06-27 13:05:48,808] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=9, isr=[1, 2], zkVersion=14, replicas=[0, 1, 2]) correlation id 162 from controller 0 epoch 9 for partition [__consumer_offsets,41] (state.change.logger)
[2017-06-27 13:05:48,808] TRACE Broker 1 handling LeaderAndIsr request correlationId 162 from controller 0 epoch 9 starting the become-follower transition for partition __consumer_offsets-41 (state.change.logger)
[2017-06-27 13:05:48,808] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=9, isr=[1, 2], zkVersion=14, replicas=[0, 1, 2]) correlation id 160 from controller 0 epoch 9 for partition [__consumer_offsets,41] (state.change.logger)
[2017-06-27 13:05:48,808] INFO Broker 1 skipped the become-follower state change after marking its partition as follower with correlation id 162 from controller 0 epoch 9 for partition __consumer_offsets-41 since the new leader 2 is the same as the old leader (state.change.logger)
[2017-06-27 13:05:48,808] TRACE Broker 2 handling LeaderAndIsr request correlationId 160 from controller 0 epoch 9 starting the become-leader transition for partition __consumer_offsets-41 (state.change.logger)
[2017-06-27 13:05:48,808] INFO Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 160 from controller 0 epoch 9 for partition __consumer_offsets-41 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:05:48,809] TRACE Broker 2 completed LeaderAndIsr request correlationId 160 from controller 0 epoch 9 for the become-leader transition for partition __consumer_offsets-41 (state.change.logger)
[2017-06-27 13:05:48,809] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-41 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 161 (state.change.logger)
[2017-06-27 13:05:48,809] TRACE Broker 1 completed LeaderAndIsr request correlationId 162 from controller 0 epoch 9 for the become-follower transition for partition __consumer_offsets-41 (state.change.logger)
[2017-06-27 13:05:48,810] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-41 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 163 (state.change.logger)
[2017-06-27 13:05:48,811] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 162 from controller 0 epoch 9 for partition [__consumer_offsets,45] (state.change.logger)
[2017-06-27 13:05:48,811] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 164 from controller 0 epoch 9 for partition [__consumer_offsets,45] (state.change.logger)
[2017-06-27 13:05:48,811] TRACE Broker 2 handling LeaderAndIsr request correlationId 162 from controller 0 epoch 9 starting the become-leader transition for partition __consumer_offsets-45 (state.change.logger)
[2017-06-27 13:05:48,811] TRACE Broker 1 handling LeaderAndIsr request correlationId 164 from controller 0 epoch 9 starting the become-follower transition for partition __consumer_offsets-45 (state.change.logger)
[2017-06-27 13:05:48,811] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 0 epoch 9 with correlation id 162 for partition __consumer_offsets-45 (state.change.logger)
[2017-06-27 13:05:48,811] TRACE Broker 1 stopped fetchers as part of become-follower request from controller 0 epoch 9 with correlation id 164 for partition __consumer_offsets-45 (state.change.logger)
[2017-06-27 13:05:48,811] TRACE Broker 2 completed LeaderAndIsr request correlationId 162 from controller 0 epoch 9 for the become-leader transition for partition __consumer_offsets-45 (state.change.logger)
[2017-06-27 13:05:48,812] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-45 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 163 (state.change.logger)
[2017-06-27 13:05:48,812] TRACE Broker 1 truncated logs and checkpointed recovery boundaries for partition __consumer_offsets-45 as part of become-follower request with correlation id 164 from controller 0 epoch 9 (state.change.logger)
[2017-06-27 13:05:48,813] TRACE Broker 1 started fetcher to new leader as part of become-follower request from controller 0 epoch 9 with correlation id 164 for partition __consumer_offsets-45 (state.change.logger)
[2017-06-27 13:05:48,813] TRACE Broker 1 completed LeaderAndIsr request correlationId 164 from controller 0 epoch 9 for the become-follower transition for partition __consumer_offsets-45 (state.change.logger)
[2017-06-27 13:05:48,813] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-45 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 165 (state.change.logger)
[2017-06-27 13:05:48,813] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=9, isr=[1, 2], zkVersion=14, replicas=[0, 1, 2]) correlation id 164 from controller 0 epoch 9 for partition [__consumer_offsets,35] (state.change.logger)
[2017-06-27 13:05:48,813] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=9, isr=[1, 2], zkVersion=14, replicas=[0, 1, 2]) correlation id 166 from controller 0 epoch 9 for partition [__consumer_offsets,35] (state.change.logger)
[2017-06-27 13:05:48,813] TRACE Broker 2 handling LeaderAndIsr request correlationId 164 from controller 0 epoch 9 starting the become-leader transition for partition __consumer_offsets-35 (state.change.logger)
[2017-06-27 13:05:48,813] TRACE Broker 1 handling LeaderAndIsr request correlationId 166 from controller 0 epoch 9 starting the become-follower transition for partition __consumer_offsets-35 (state.change.logger)
[2017-06-27 13:05:48,814] INFO Broker 1 skipped the become-follower state change after marking its partition as follower with correlation id 166 from controller 0 epoch 9 for partition __consumer_offsets-35 since the new leader 2 is the same as the old leader (state.change.logger)
[2017-06-27 13:05:48,814] INFO Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 164 from controller 0 epoch 9 for partition __consumer_offsets-35 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:05:48,814] TRACE Broker 2 completed LeaderAndIsr request correlationId 164 from controller 0 epoch 9 for the become-leader transition for partition __consumer_offsets-35 (state.change.logger)
[2017-06-27 13:05:48,814] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-35 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 165 (state.change.logger)
[2017-06-27 13:05:48,815] TRACE Broker 1 completed LeaderAndIsr request correlationId 166 from controller 0 epoch 9 for the become-follower transition for partition __consumer_offsets-35 (state.change.logger)
[2017-06-27 13:05:48,815] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-35 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 167 (state.change.logger)
[2017-06-27 13:05:48,818] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=11, replicas=[0, 1, 2]) correlation id 166 from controller 0 epoch 9 for partition [__consumer_offsets,46] (state.change.logger)
[2017-06-27 13:05:48,818] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=11, replicas=[0, 1, 2]) correlation id 168 from controller 0 epoch 9 for partition [__consumer_offsets,46] (state.change.logger)
[2017-06-27 13:05:48,818] TRACE Broker 2 handling LeaderAndIsr request correlationId 166 from controller 0 epoch 9 starting the become-follower transition for partition __consumer_offsets-46 (state.change.logger)
[2017-06-27 13:05:48,819] TRACE Broker 1 handling LeaderAndIsr request correlationId 168 from controller 0 epoch 9 starting the become-leader transition for partition __consumer_offsets-46 (state.change.logger)
[2017-06-27 13:05:48,819] INFO Broker 2 skipped the become-follower state change after marking its partition as follower with correlation id 166 from controller 0 epoch 9 for partition __consumer_offsets-46 since the new leader 1 is the same as the old leader (state.change.logger)
[2017-06-27 13:05:48,819] INFO Broker 1 skipped the become-leader state change after marking its partition as leader with correlation id 168 from controller 0 epoch 9 for partition __consumer_offsets-46 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:05:48,819] TRACE Broker 1 completed LeaderAndIsr request correlationId 168 from controller 0 epoch 9 for the become-leader transition for partition __consumer_offsets-46 (state.change.logger)
[2017-06-27 13:05:48,819] TRACE Broker 2 completed LeaderAndIsr request correlationId 166 from controller 0 epoch 9 for the become-follower transition for partition __consumer_offsets-46 (state.change.logger)
[2017-06-27 13:05:48,820] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-46 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 169 (state.change.logger)
[2017-06-27 13:05:48,820] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-46 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 167 (state.change.logger)
[2017-06-27 13:05:48,820] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=11, replicas=[0, 1, 2]) correlation id 170 from controller 0 epoch 9 for partition [__consumer_offsets,19] (state.change.logger)
[2017-06-27 13:05:48,820] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=11, replicas=[0, 1, 2]) correlation id 168 from controller 0 epoch 9 for partition [__consumer_offsets,19] (state.change.logger)
[2017-06-27 13:05:48,820] TRACE Broker 1 handling LeaderAndIsr request correlationId 170 from controller 0 epoch 9 starting the become-leader transition for partition __consumer_offsets-19 (state.change.logger)
[2017-06-27 13:05:48,820] TRACE Broker 2 handling LeaderAndIsr request correlationId 168 from controller 0 epoch 9 starting the become-follower transition for partition __consumer_offsets-19 (state.change.logger)
[2017-06-27 13:05:48,820] INFO Broker 2 skipped the become-follower state change after marking its partition as follower with correlation id 168 from controller 0 epoch 9 for partition __consumer_offsets-19 since the new leader 1 is the same as the old leader (state.change.logger)
[2017-06-27 13:05:48,821] INFO Broker 1 skipped the become-leader state change after marking its partition as leader with correlation id 170 from controller 0 epoch 9 for partition __consumer_offsets-19 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:05:48,821] TRACE Broker 1 completed LeaderAndIsr request correlationId 170 from controller 0 epoch 9 for the become-leader transition for partition __consumer_offsets-19 (state.change.logger)
[2017-06-27 13:05:48,821] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-19 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 171 (state.change.logger)
[2017-06-27 13:05:48,822] TRACE Broker 2 completed LeaderAndIsr request correlationId 168 from controller 0 epoch 9 for the become-follower transition for partition __consumer_offsets-19 (state.change.logger)
[2017-06-27 13:05:48,822] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-19 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 169 (state.change.logger)
[2017-06-27 13:05:48,823] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 170 from controller 0 epoch 9 for partition [__consumer_offsets,30] (state.change.logger)
[2017-06-27 13:05:48,823] TRACE Broker 2 handling LeaderAndIsr request correlationId 170 from controller 0 epoch 9 starting the become-follower transition for partition __consumer_offsets-30 (state.change.logger)
[2017-06-27 13:05:48,823] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 172 from controller 0 epoch 9 for partition [__consumer_offsets,30] (state.change.logger)
[2017-06-27 13:05:48,823] TRACE Broker 1 handling LeaderAndIsr request correlationId 172 from controller 0 epoch 9 starting the become-leader transition for partition __consumer_offsets-30 (state.change.logger)
[2017-06-27 13:05:48,823] TRACE Broker 2 stopped fetchers as part of become-follower request from controller 0 epoch 9 with correlation id 170 for partition __consumer_offsets-30 (state.change.logger)
[2017-06-27 13:05:48,823] TRACE Broker 1 stopped fetchers as part of become-leader request from controller 0 epoch 9 with correlation id 172 for partition __consumer_offsets-30 (state.change.logger)
[2017-06-27 13:05:48,823] TRACE Broker 1 completed LeaderAndIsr request correlationId 172 from controller 0 epoch 9 for the become-leader transition for partition __consumer_offsets-30 (state.change.logger)
[2017-06-27 13:05:48,824] TRACE Broker 2 truncated logs and checkpointed recovery boundaries for partition __consumer_offsets-30 as part of become-follower request with correlation id 170 from controller 0 epoch 9 (state.change.logger)
[2017-06-27 13:05:48,824] TRACE Broker 2 started fetcher to new leader as part of become-follower request from controller 0 epoch 9 with correlation id 170 for partition __consumer_offsets-30 (state.change.logger)
[2017-06-27 13:05:48,824] TRACE Broker 2 completed LeaderAndIsr request correlationId 170 from controller 0 epoch 9 for the become-follower transition for partition __consumer_offsets-30 (state.change.logger)
[2017-06-27 13:05:48,843] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-30 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 171 (state.change.logger)
[2017-06-27 13:05:48,843] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-30 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 173 (state.change.logger)
[2017-06-27 13:05:49,452] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,0,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-46 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 174 (state.change.logger)
[2017-06-27 13:05:49,452] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,0,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-19 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 174 (state.change.logger)
[2017-06-27 13:05:49,452] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,0,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-46 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 172 (state.change.logger)
[2017-06-27 13:05:49,452] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,0,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-19 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 172 (state.change.logger)
[2017-06-27 13:05:52,805] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-49 (state.change.logger)
[2017-06-27 13:05:52,805] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-38 (state.change.logger)
[2017-06-27 13:05:52,805] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-16 (state.change.logger)
[2017-06-27 13:05:52,805] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-27 (state.change.logger)
[2017-06-27 13:05:52,805] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-8 (state.change.logger)
[2017-06-27 13:05:52,805] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:1,ISR:1,2,0,LeaderEpoch:8,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-19 (state.change.logger)
[2017-06-27 13:05:52,805] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-2 (state.change.logger)
[2017-06-27 13:05:52,805] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-13 (state.change.logger)
[2017-06-27 13:05:52,805] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-24 (state.change.logger)
[2017-06-27 13:05:52,805] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:1,ISR:1,2,0,LeaderEpoch:8,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-46 (state.change.logger)
[2017-06-27 13:05:52,805] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-35 (state.change.logger)
[2017-06-27 13:05:52,805] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-5 (state.change.logger)
[2017-06-27 13:05:52,805] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-43 (state.change.logger)
[2017-06-27 13:05:52,805] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-21 (state.change.logger)
[2017-06-27 13:05:52,805] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-32 (state.change.logger)
[2017-06-27 13:05:52,805] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-10 (state.change.logger)
[2017-06-27 13:05:52,805] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-37 (state.change.logger)
[2017-06-27 13:05:52,805] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-48 (state.change.logger)
[2017-06-27 13:05:52,805] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-29 (state.change.logger)
[2017-06-27 13:05:52,805] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-40 (state.change.logger)
[2017-06-27 13:05:52,805] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-18 (state.change.logger)
[2017-06-27 13:05:52,805] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-7 (state.change.logger)
[2017-06-27 13:05:52,805] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-23 (state.change.logger)
[2017-06-27 13:05:52,805] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-34 (state.change.logger)
[2017-06-27 13:05:52,805] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-45 (state.change.logger)
[2017-06-27 13:05:52,805] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-26 (state.change.logger)
[2017-06-27 13:05:52,805] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-15 (state.change.logger)
[2017-06-27 13:05:52,805] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-4 (state.change.logger)
[2017-06-27 13:05:52,805] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-42 (state.change.logger)
[2017-06-27 13:05:52,805] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-20 (state.change.logger)
[2017-06-27 13:05:52,805] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-31 (state.change.logger)
[2017-06-27 13:05:52,805] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-9 (state.change.logger)
[2017-06-27 13:05:52,805] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-12 (state.change.logger)
[2017-06-27 13:05:52,805] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-1 (state.change.logger)
[2017-06-27 13:05:52,805] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-17 (state.change.logger)
[2017-06-27 13:05:52,805] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-28 (state.change.logger)
[2017-06-27 13:05:52,806] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-6 (state.change.logger)
[2017-06-27 13:05:52,806] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-39 (state.change.logger)
[2017-06-27 13:05:52,806] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-44 (state.change.logger)
[2017-06-27 13:05:52,806] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-47 (state.change.logger)
[2017-06-27 13:05:52,806] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-36 (state.change.logger)
[2017-06-27 13:05:52,806] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:9) to brokers Set(1, 2) for partition rf1p1-0 (state.change.logger)
[2017-06-27 13:05:52,806] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-3 (state.change.logger)
[2017-06-27 13:05:52,806] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-14 (state.change.logger)
[2017-06-27 13:05:52,806] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-25 (state.change.logger)
[2017-06-27 13:05:52,806] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-30 (state.change.logger)
[2017-06-27 13:05:52,806] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-41 (state.change.logger)
[2017-06-27 13:05:52,806] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-22 (state.change.logger)
[2017-06-27 13:05:52,806] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-33 (state.change.logger)
[2017-06-27 13:05:52,806] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-11 (state.change.logger)
[2017-06-27 13:05:52,806] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-0 (state.change.logger)
[2017-06-27 13:05:52,811] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-13 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,811] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,0,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-46 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,811] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-9 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,811] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-13 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,811] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-42 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,811] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,0,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-46 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,811] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-21 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,811] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-17 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,811] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-9 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,811] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-30 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,811] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-42 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,811] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-26 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,811] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-21 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,811] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-5 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,811] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-17 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,811] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-38 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-30 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-1 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-34 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-26 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-16 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-5 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-45 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-38 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-12 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-1 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-41 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-34 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-24 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-16 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-20 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-45 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-49 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-12 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-0 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-41 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-29 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-24 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-25 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-8 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-37 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-4 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-33 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-15 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-48 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-11 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-44 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-23 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:2) for partition rf1p1-0 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,0,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-19 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-32 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-20 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-28 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-7 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-49 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-40 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-3 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-0 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-36 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-47 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-29 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-14 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-25 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-43 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-10 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-8 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-22 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-37 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-18 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-31 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-4 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-27 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-33 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,812] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-39 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,813] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-6 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,813] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-15 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,813] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-35 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,813] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-48 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,813] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-2 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,813] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-11 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,813] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-44 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,813] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-23 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,813] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:2) for partition rf1p1-0 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,813] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,0,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-19 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,813] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-32 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,813] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-28 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,813] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-7 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,813] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-40 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,813] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-3 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,813] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-36 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,813] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-47 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,813] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-14 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,813] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-43 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,813] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-10 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,813] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-22 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,813] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-18 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,813] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-31 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,813] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-27 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,813] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-39 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,813] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-6 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,813] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-35 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,813] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-2 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2017-06-27 13:05:52,813] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:05:52,814] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:05:52,818] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,28] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,818] TRACE Controller 1 epoch 10 changed state of replica 2 for partition [__consumer_offsets,17] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,819] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,48] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,819] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,5] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,819] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,21] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,819] TRACE Controller 1 epoch 10 changed state of replica 2 for partition [__consumer_offsets,38] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,819] TRACE Controller 1 epoch 10 changed state of replica 2 for partition [__consumer_offsets,39] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,819] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,2] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,819] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,18] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,819] TRACE Controller 1 epoch 10 changed state of replica 2 for partition [__consumer_offsets,23] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,819] TRACE Controller 1 epoch 10 changed state of replica 2 for partition [__consumer_offsets,48] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,819] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,23] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,819] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,9] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,819] TRACE Controller 1 epoch 10 changed state of replica 2 for partition [__consumer_offsets,42] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,819] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,39] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,820] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,31] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,820] TRACE Controller 1 epoch 10 changed state of replica 2 for partition [__consumer_offsets,2] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,820] TRACE Controller 1 epoch 10 changed state of replica 2 for partition [__consumer_offsets,22] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,820] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,19] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,820] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,10] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,820] TRACE Controller 1 epoch 10 changed state of replica 2 for partition [__consumer_offsets,13] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,820] TRACE Controller 1 epoch 10 changed state of replica 2 for partition [__consumer_offsets,34] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,820] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,22] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,820] TRACE Controller 1 epoch 10 changed state of replica 2 for partition [__consumer_offsets,40] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,820] TRACE Controller 1 epoch 10 changed state of replica 2 for partition [__consumer_offsets,33] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,820] TRACE Controller 1 epoch 10 changed state of replica 2 for partition [__consumer_offsets,3] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,820] TRACE Controller 1 epoch 10 changed state of replica 2 for partition [__consumer_offsets,37] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,820] TRACE Controller 1 epoch 10 changed state of replica 2 for partition [__consumer_offsets,24] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,820] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,43] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,821] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,40] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,821] TRACE Controller 1 epoch 10 changed state of replica 2 for partition [__consumer_offsets,11] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,821] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,27] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,821] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,6] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,821] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,1] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,821] TRACE Controller 1 epoch 10 changed state of replica 2 for partition [__consumer_offsets,20] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,821] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,47] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,821] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,30] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,821] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,42] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,821] TRACE Controller 1 epoch 10 changed state of replica 2 for partition [__consumer_offsets,27] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,821] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,41] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,821] TRACE Controller 1 epoch 10 changed state of replica 2 for partition [__consumer_offsets,30] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,821] TRACE Controller 1 epoch 10 changed state of replica 2 for partition [__consumer_offsets,15] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,821] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,3] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,821] TRACE Controller 1 epoch 10 changed state of replica 2 for partition [__consumer_offsets,28] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,821] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,13] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,821] TRACE Controller 1 epoch 10 changed state of replica 2 for partition [__consumer_offsets,7] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,821] TRACE Controller 1 epoch 10 changed state of replica 2 for partition [__consumer_offsets,43] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,821] TRACE Controller 1 epoch 10 changed state of replica 2 for partition [__consumer_offsets,10] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,821] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,4] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,821] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,16] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,821] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,46] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,821] TRACE Controller 1 epoch 10 changed state of replica 2 for partition [__consumer_offsets,12] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,821] TRACE Controller 1 epoch 10 changed state of replica 2 for partition [__consumer_offsets,32] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,822] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,49] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,822] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,14] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,822] TRACE Controller 1 epoch 10 changed state of replica 2 for partition [__consumer_offsets,4] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,822] TRACE Controller 1 epoch 10 changed state of replica 2 for partition [__consumer_offsets,26] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,822] TRACE Controller 1 epoch 10 changed state of replica 2 for partition [__consumer_offsets,35] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,822] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,45] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,822] TRACE Controller 1 epoch 10 changed state of replica 2 for partition [__consumer_offsets,46] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,822] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,37] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,822] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,29] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,822] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,20] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,822] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,8] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,822] TRACE Controller 1 epoch 10 changed state of replica 2 for partition [__consumer_offsets,6] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,822] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,38] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,822] TRACE Controller 1 epoch 10 changed state of replica 2 for partition [__consumer_offsets,8] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,822] TRACE Controller 1 epoch 10 changed state of replica 2 for partition [__consumer_offsets,44] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,822] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,7] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,822] TRACE Controller 1 epoch 10 changed state of replica 2 for partition [__consumer_offsets,45] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,822] TRACE Controller 1 epoch 10 changed state of replica 2 for partition [__consumer_offsets,49] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,822] TRACE Controller 1 epoch 10 changed state of replica 2 for partition [__consumer_offsets,1] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,823] TRACE Controller 1 epoch 10 changed state of replica 2 for partition [__consumer_offsets,19] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,823] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,0] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,823] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,34] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,823] TRACE Controller 1 epoch 10 changed state of replica 2 for partition [__consumer_offsets,36] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,823] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,33] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,823] TRACE Controller 1 epoch 10 changed state of replica 2 for partition [__consumer_offsets,14] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,823] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,26] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,823] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,44] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,823] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,32] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,823] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,25] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,823] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,11] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,823] TRACE Controller 1 epoch 10 changed state of replica 2 for partition [__consumer_offsets,31] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,823] TRACE Controller 1 epoch 10 changed state of replica 2 for partition [__consumer_offsets,21] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,823] TRACE Controller 1 epoch 10 changed state of replica 2 for partition [__consumer_offsets,25] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,823] TRACE Controller 1 epoch 10 changed state of replica 2 for partition [__consumer_offsets,5] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,823] TRACE Controller 1 epoch 10 changed state of replica 2 for partition [__consumer_offsets,41] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,823] TRACE Controller 1 epoch 10 changed state of replica 2 for partition [__consumer_offsets,47] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,823] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,36] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,823] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,12] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,823] TRACE Controller 1 epoch 10 changed state of replica 2 for partition [__consumer_offsets,16] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,823] TRACE Controller 1 epoch 10 changed state of replica 2 for partition [__consumer_offsets,0] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,823] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,35] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,824] TRACE Controller 1 epoch 10 changed state of replica 2 for partition [__consumer_offsets,29] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,824] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,15] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,824] TRACE Controller 1 epoch 10 changed state of replica 2 for partition [__consumer_offsets,18] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,824] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,17] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,824] TRACE Controller 1 epoch 10 changed state of replica 2 for partition [rf1p1,0] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,824] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,24] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,824] TRACE Controller 1 epoch 10 changed state of replica 2 for partition [__consumer_offsets,9] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:05:52,825] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to broker 2 for partition [__consumer_offsets,49] (state.change.logger)
[2017-06-27 13:05:52,825] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to broker 2 for partition [__consumer_offsets,38] (state.change.logger)
[2017-06-27 13:05:52,825] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to broker 2 for partition [__consumer_offsets,27] (state.change.logger)
[2017-06-27 13:05:52,825] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to broker 2 for partition [__consumer_offsets,16] (state.change.logger)
[2017-06-27 13:05:52,825] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to broker 2 for partition [__consumer_offsets,8] (state.change.logger)
[2017-06-27 13:05:52,825] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,2,0,LeaderEpoch:8,ControllerEpoch:9) to broker 2 for partition [__consumer_offsets,19] (state.change.logger)
[2017-06-27 13:05:52,825] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to broker 2 for partition [__consumer_offsets,2] (state.change.logger)
[2017-06-27 13:05:52,825] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to broker 2 for partition [__consumer_offsets,13] (state.change.logger)
[2017-06-27 13:05:52,825] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to broker 2 for partition [__consumer_offsets,24] (state.change.logger)
[2017-06-27 13:05:52,825] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9) to broker 2 for partition [__consumer_offsets,35] (state.change.logger)
[2017-06-27 13:05:52,825] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,2,0,LeaderEpoch:8,ControllerEpoch:9) to broker 2 for partition [__consumer_offsets,46] (state.change.logger)
[2017-06-27 13:05:52,825] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9) to broker 2 for partition [__consumer_offsets,5] (state.change.logger)
[2017-06-27 13:05:52,825] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to broker 2 for partition [__consumer_offsets,43] (state.change.logger)
[2017-06-27 13:05:52,825] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to broker 2 for partition [__consumer_offsets,32] (state.change.logger)
[2017-06-27 13:05:52,825] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to broker 2 for partition [__consumer_offsets,21] (state.change.logger)
[2017-06-27 13:05:52,825] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to broker 2 for partition [__consumer_offsets,10] (state.change.logger)
[2017-06-27 13:05:52,825] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to broker 2 for partition [__consumer_offsets,37] (state.change.logger)
[2017-06-27 13:05:52,825] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to broker 2 for partition [__consumer_offsets,48] (state.change.logger)
[2017-06-27 13:05:52,825] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to broker 2 for partition [__consumer_offsets,40] (state.change.logger)
[2017-06-27 13:05:52,825] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9) to broker 2 for partition [__consumer_offsets,29] (state.change.logger)
[2017-06-27 13:05:52,825] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to broker 2 for partition [__consumer_offsets,18] (state.change.logger)
[2017-06-27 13:05:52,825] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to broker 2 for partition [__consumer_offsets,7] (state.change.logger)
[2017-06-27 13:05:52,825] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9) to broker 2 for partition [__consumer_offsets,23] (state.change.logger)
[2017-06-27 13:05:52,825] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to broker 2 for partition [__consumer_offsets,34] (state.change.logger)
[2017-06-27 13:05:52,825] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to broker 2 for partition [__consumer_offsets,45] (state.change.logger)
[2017-06-27 13:05:52,825] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to broker 2 for partition [__consumer_offsets,26] (state.change.logger)
[2017-06-27 13:05:52,825] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to broker 2 for partition [__consumer_offsets,15] (state.change.logger)
[2017-06-27 13:05:52,825] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to broker 2 for partition [__consumer_offsets,4] (state.change.logger)
[2017-06-27 13:05:52,825] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to broker 2 for partition [__consumer_offsets,42] (state.change.logger)
[2017-06-27 13:05:52,825] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to broker 2 for partition [__consumer_offsets,9] (state.change.logger)
[2017-06-27 13:05:52,825] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to broker 2 for partition [__consumer_offsets,20] (state.change.logger)
[2017-06-27 13:05:52,825] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to broker 2 for partition [__consumer_offsets,31] (state.change.logger)
[2017-06-27 13:05:52,825] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to broker 2 for partition [__consumer_offsets,12] (state.change.logger)
[2017-06-27 13:05:52,825] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to broker 2 for partition [__consumer_offsets,1] (state.change.logger)
[2017-06-27 13:05:52,825] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to broker 2 for partition [__consumer_offsets,28] (state.change.logger)
[2017-06-27 13:05:52,825] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9) to broker 2 for partition [__consumer_offsets,17] (state.change.logger)
[2017-06-27 13:05:52,825] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to broker 2 for partition [__consumer_offsets,6] (state.change.logger)
[2017-06-27 13:05:52,825] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to broker 2 for partition [__consumer_offsets,39] (state.change.logger)
[2017-06-27 13:05:52,825] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to broker 2 for partition [__consumer_offsets,44] (state.change.logger)
[2017-06-27 13:05:52,825] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to broker 2 for partition [__consumer_offsets,36] (state.change.logger)
[2017-06-27 13:05:52,825] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9) to broker 2 for partition [__consumer_offsets,47] (state.change.logger)
[2017-06-27 13:05:52,825] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:9) to broker 2 for partition [rf1p1,0] (state.change.logger)
[2017-06-27 13:05:52,825] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to broker 2 for partition [__consumer_offsets,3] (state.change.logger)
[2017-06-27 13:05:52,825] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to broker 2 for partition [__consumer_offsets,14] (state.change.logger)
[2017-06-27 13:05:52,825] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to broker 2 for partition [__consumer_offsets,25] (state.change.logger)
[2017-06-27 13:05:52,825] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to broker 2 for partition [__consumer_offsets,30] (state.change.logger)
[2017-06-27 13:05:52,825] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9) to broker 2 for partition [__consumer_offsets,41] (state.change.logger)
[2017-06-27 13:05:52,825] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9) to broker 2 for partition [__consumer_offsets,11] (state.change.logger)
[2017-06-27 13:05:52,825] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to broker 2 for partition [__consumer_offsets,22] (state.change.logger)
[2017-06-27 13:05:52,825] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to broker 2 for partition [__consumer_offsets,33] (state.change.logger)
[2017-06-27 13:05:52,825] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to broker 2 for partition [__consumer_offsets,0] (state.change.logger)
[2017-06-27 13:05:52,827] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to broker 1 for partition [__consumer_offsets,49] (state.change.logger)
[2017-06-27 13:05:52,827] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to broker 1 for partition [__consumer_offsets,38] (state.change.logger)
[2017-06-27 13:05:52,827] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to broker 1 for partition [__consumer_offsets,27] (state.change.logger)
[2017-06-27 13:05:52,827] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to broker 1 for partition [__consumer_offsets,16] (state.change.logger)
[2017-06-27 13:05:52,827] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,2,0,LeaderEpoch:8,ControllerEpoch:9) to broker 1 for partition [__consumer_offsets,19] (state.change.logger)
[2017-06-27 13:05:52,827] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to broker 1 for partition [__consumer_offsets,8] (state.change.logger)
[2017-06-27 13:05:52,827] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to broker 1 for partition [__consumer_offsets,13] (state.change.logger)
[2017-06-27 13:05:52,827] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to broker 1 for partition [__consumer_offsets,2] (state.change.logger)
[2017-06-27 13:05:52,827] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to broker 1 for partition [__consumer_offsets,24] (state.change.logger)
[2017-06-27 13:05:52,827] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,2,0,LeaderEpoch:8,ControllerEpoch:9) to broker 1 for partition [__consumer_offsets,46] (state.change.logger)
[2017-06-27 13:05:52,827] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9) to broker 1 for partition [__consumer_offsets,35] (state.change.logger)
[2017-06-27 13:05:52,827] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9) to broker 1 for partition [__consumer_offsets,5] (state.change.logger)
[2017-06-27 13:05:52,827] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to broker 1 for partition [__consumer_offsets,43] (state.change.logger)
[2017-06-27 13:05:52,827] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to broker 1 for partition [__consumer_offsets,21] (state.change.logger)
[2017-06-27 13:05:52,827] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to broker 1 for partition [__consumer_offsets,32] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to broker 1 for partition [__consumer_offsets,10] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to broker 1 for partition [__consumer_offsets,37] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to broker 1 for partition [__consumer_offsets,48] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to broker 1 for partition [__consumer_offsets,40] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to broker 1 for partition [__consumer_offsets,18] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9) to broker 1 for partition [__consumer_offsets,29] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to broker 1 for partition [__consumer_offsets,7] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9) to broker 1 for partition [__consumer_offsets,23] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to broker 1 for partition [__consumer_offsets,45] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to broker 1 for partition [__consumer_offsets,34] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to broker 1 for partition [__consumer_offsets,26] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to broker 1 for partition [__consumer_offsets,4] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to broker 1 for partition [__consumer_offsets,15] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to broker 1 for partition [__consumer_offsets,42] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to broker 1 for partition [__consumer_offsets,9] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to broker 1 for partition [__consumer_offsets,31] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to broker 1 for partition [__consumer_offsets,20] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to broker 1 for partition [__consumer_offsets,1] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to broker 1 for partition [__consumer_offsets,12] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to broker 1 for partition [__consumer_offsets,28] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9) to broker 1 for partition [__consumer_offsets,17] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to broker 1 for partition [__consumer_offsets,6] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to broker 1 for partition [__consumer_offsets,39] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=14, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,13] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to broker 1 for partition [__consumer_offsets,44] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9) to broker 1 for partition [__consumer_offsets,47] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2, 0], zkVersion=12, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,46] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to broker 1 for partition [__consumer_offsets,36] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to broker 1 for partition [__consumer_offsets,3] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,9] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to broker 1 for partition [__consumer_offsets,14] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,42] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to broker 1 for partition [__consumer_offsets,25] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,21] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9) to broker 1 for partition [__consumer_offsets,41] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=9, isr=[1, 2], zkVersion=14, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,17] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to broker 1 for partition [__consumer_offsets,30] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,30] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to broker 1 for partition [__consumer_offsets,22] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=8, isr=[1, 2], zkVersion=13, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,26] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to broker 1 for partition [__consumer_offsets,33] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=9, isr=[1, 2], zkVersion=14, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,5] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9) to broker 1 for partition [__consumer_offsets,11] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=8, isr=[1, 2], zkVersion=13, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,38] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to broker 1 for partition [__consumer_offsets,0] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=11, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,1] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=11, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,34] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=11, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,16] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,45] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,12] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=9, isr=[1, 2], zkVersion=14, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,41] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,24] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=8, isr=[1, 2], zkVersion=13, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,20] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=11, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,49] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,0] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=9, isr=[1, 2], zkVersion=14, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,29] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=11, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,25] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=8, isr=[1, 2], zkVersion=13, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,8] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=13, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,37] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=13, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,4] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,33] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,15] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,48] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=9, isr=[1, 2], zkVersion=14, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,11] (state.change.logger)
[2017-06-27 13:05:52,828] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=8, isr=[1, 2], zkVersion=13, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,44] (state.change.logger)
[2017-06-27 13:05:52,829] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=9, isr=[1, 2], zkVersion=14, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,23] (state.change.logger)
[2017-06-27 13:05:52,829] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=9, isr=[2], zkVersion=9, replicas=[2]) correlation id 1 from controller 1 epoch 10 for partition [rf1p1,0] (state.change.logger)
[2017-06-27 13:05:52,829] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2, 0], zkVersion=12, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,19] (state.change.logger)
[2017-06-27 13:05:52,829] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=8, isr=[1, 2], zkVersion=13, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,32] (state.change.logger)
[2017-06-27 13:05:52,829] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=11, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,28] (state.change.logger)
[2017-06-27 13:05:52,829] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=11, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,7] (state.change.logger)
[2017-06-27 13:05:52,829] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=11, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,40] (state.change.logger)
[2017-06-27 13:05:52,829] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,3] (state.change.logger)
[2017-06-27 13:05:52,829] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,36] (state.change.logger)
[2017-06-27 13:05:52,829] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=9, isr=[1, 2], zkVersion=14, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,47] (state.change.logger)
[2017-06-27 13:05:52,829] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=8, isr=[1, 2], zkVersion=13, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,14] (state.change.logger)
[2017-06-27 13:05:52,829] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=11, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,43] (state.change.logger)
[2017-06-27 13:05:52,829] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-49 (state.change.logger)
[2017-06-27 13:05:52,829] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=11, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,10] (state.change.logger)
[2017-06-27 13:05:52,829] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=13, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,22] (state.change.logger)
[2017-06-27 13:05:52,829] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-38 (state.change.logger)
[2017-06-27 13:05:52,829] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,18] (state.change.logger)
[2017-06-27 13:05:52,829] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-27 (state.change.logger)
[2017-06-27 13:05:52,829] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=11, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,31] (state.change.logger)
[2017-06-27 13:05:52,829] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-16 (state.change.logger)
[2017-06-27 13:05:52,829] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,27] (state.change.logger)
[2017-06-27 13:05:52,829] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:1,ISR:1,2,0,LeaderEpoch:8,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-19 (state.change.logger)
[2017-06-27 13:05:52,829] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-8 (state.change.logger)
[2017-06-27 13:05:52,829] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,39] (state.change.logger)
[2017-06-27 13:05:52,829] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-13 (state.change.logger)
[2017-06-27 13:05:52,829] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,6] (state.change.logger)
[2017-06-27 13:05:52,829] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-2 (state.change.logger)
[2017-06-27 13:05:52,829] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=9, isr=[1, 2], zkVersion=14, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,35] (state.change.logger)
[2017-06-27 13:05:52,829] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-24 (state.change.logger)
[2017-06-27 13:05:52,829] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=8, isr=[1, 2], zkVersion=13, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,2] (state.change.logger)
[2017-06-27 13:05:52,829] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:1,ISR:1,2,0,LeaderEpoch:8,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-46 (state.change.logger)
[2017-06-27 13:05:52,829] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-35 (state.change.logger)
[2017-06-27 13:05:52,829] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-5 (state.change.logger)
[2017-06-27 13:05:52,829] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-43 (state.change.logger)
[2017-06-27 13:05:52,829] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-21 (state.change.logger)
[2017-06-27 13:05:52,829] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-32 (state.change.logger)
[2017-06-27 13:05:52,829] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-10 (state.change.logger)
[2017-06-27 13:05:52,829] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-37 (state.change.logger)
[2017-06-27 13:05:52,829] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-48 (state.change.logger)
[2017-06-27 13:05:52,829] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-40 (state.change.logger)
[2017-06-27 13:05:52,829] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-18 (state.change.logger)
[2017-06-27 13:05:52,829] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-29 (state.change.logger)
[2017-06-27 13:05:52,829] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=14, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,13] (state.change.logger)
[2017-06-27 13:05:52,829] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-7 (state.change.logger)
[2017-06-27 13:05:52,829] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2, 0], zkVersion=12, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,46] (state.change.logger)
[2017-06-27 13:05:52,829] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-34 (state.change.logger)
[2017-06-27 13:05:52,829] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,9] (state.change.logger)
[2017-06-27 13:05:52,829] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-23 (state.change.logger)
[2017-06-27 13:05:52,829] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,42] (state.change.logger)
[2017-06-27 13:05:52,829] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-45 (state.change.logger)
[2017-06-27 13:05:52,829] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,21] (state.change.logger)
[2017-06-27 13:05:52,829] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-26 (state.change.logger)
[2017-06-27 13:05:52,829] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=9, isr=[1, 2], zkVersion=14, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,17] (state.change.logger)
[2017-06-27 13:05:52,829] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-15 (state.change.logger)
[2017-06-27 13:05:52,829] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,30] (state.change.logger)
[2017-06-27 13:05:52,830] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-4 (state.change.logger)
[2017-06-27 13:05:52,830] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=8, isr=[1, 2], zkVersion=13, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,26] (state.change.logger)
[2017-06-27 13:05:52,830] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-42 (state.change.logger)
[2017-06-27 13:05:52,830] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=9, isr=[1, 2], zkVersion=14, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,5] (state.change.logger)
[2017-06-27 13:05:52,830] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-9 (state.change.logger)
[2017-06-27 13:05:52,830] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=8, isr=[1, 2], zkVersion=13, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,38] (state.change.logger)
[2017-06-27 13:05:52,830] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-31 (state.change.logger)
[2017-06-27 13:05:52,830] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=11, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,1] (state.change.logger)
[2017-06-27 13:05:52,830] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-20 (state.change.logger)
[2017-06-27 13:05:52,830] WARN Broker 2 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,13] since its associated leader epoch 8 is not higher than the current leader epoch 8 (state.change.logger)
[2017-06-27 13:05:52,830] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=11, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,34] (state.change.logger)
[2017-06-27 13:05:52,830] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-1 (state.change.logger)
[2017-06-27 13:05:52,830] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=11, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,16] (state.change.logger)
[2017-06-27 13:05:52,830] WARN Broker 2 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,46] since its associated leader epoch 8 is not higher than the current leader epoch 8 (state.change.logger)
[2017-06-27 13:05:52,830] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-12 (state.change.logger)
[2017-06-27 13:05:52,830] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,45] (state.change.logger)
[2017-06-27 13:05:52,830] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-28 (state.change.logger)
[2017-06-27 13:05:52,830] WARN Broker 2 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,9] since its associated leader epoch 6 is not higher than the current leader epoch 6 (state.change.logger)
[2017-06-27 13:05:52,830] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,12] (state.change.logger)
[2017-06-27 13:05:52,830] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-17 (state.change.logger)
[2017-06-27 13:05:52,830] WARN Broker 2 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,42] since its associated leader epoch 6 is not higher than the current leader epoch 6 (state.change.logger)
[2017-06-27 13:05:52,830] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=9, isr=[1, 2], zkVersion=14, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,41] (state.change.logger)
[2017-06-27 13:05:52,830] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-6 (state.change.logger)
[2017-06-27 13:05:52,830] WARN Broker 2 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,21] since its associated leader epoch 6 is not higher than the current leader epoch 6 (state.change.logger)
[2017-06-27 13:05:52,830] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,24] (state.change.logger)
[2017-06-27 13:05:52,830] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-39 (state.change.logger)
[2017-06-27 13:05:52,830] WARN Broker 2 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,17] since its associated leader epoch 9 is not higher than the current leader epoch 9 (state.change.logger)
[2017-06-27 13:05:52,830] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=8, isr=[1, 2], zkVersion=13, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,20] (state.change.logger)
[2017-06-27 13:05:52,830] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-44 (state.change.logger)
[2017-06-27 13:05:52,830] WARN Broker 2 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,30] since its associated leader epoch 6 is not higher than the current leader epoch 6 (state.change.logger)
[2017-06-27 13:05:52,830] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=11, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,49] (state.change.logger)
[2017-06-27 13:05:52,830] WARN Broker 2 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,26] since its associated leader epoch 8 is not higher than the current leader epoch 8 (state.change.logger)
[2017-06-27 13:05:52,830] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-47 (state.change.logger)
[2017-06-27 13:05:52,830] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,0] (state.change.logger)
[2017-06-27 13:05:52,830] WARN Broker 2 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,5] since its associated leader epoch 9 is not higher than the current leader epoch 9 (state.change.logger)
[2017-06-27 13:05:52,830] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-36 (state.change.logger)
[2017-06-27 13:05:52,830] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=9, isr=[1, 2], zkVersion=14, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,29] (state.change.logger)
[2017-06-27 13:05:52,830] WARN Broker 2 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,38] since its associated leader epoch 8 is not higher than the current leader epoch 8 (state.change.logger)
[2017-06-27 13:05:52,830] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:9) to brokers Set(1, 2) for partition rf1p1-0 (state.change.logger)
[2017-06-27 13:05:52,830] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=11, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,25] (state.change.logger)
[2017-06-27 13:05:52,830] WARN Broker 2 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,1] since its associated leader epoch 8 is not higher than the current leader epoch 8 (state.change.logger)
[2017-06-27 13:05:52,830] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-25 (state.change.logger)
[2017-06-27 13:05:52,830] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=8, isr=[1, 2], zkVersion=13, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,8] (state.change.logger)
[2017-06-27 13:05:52,830] WARN Broker 2 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,34] since its associated leader epoch 8 is not higher than the current leader epoch 8 (state.change.logger)
[2017-06-27 13:05:52,830] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-3 (state.change.logger)
[2017-06-27 13:05:52,830] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=13, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,37] (state.change.logger)
[2017-06-27 13:05:52,830] WARN Broker 2 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,16] since its associated leader epoch 8 is not higher than the current leader epoch 8 (state.change.logger)
[2017-06-27 13:05:52,830] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-14 (state.change.logger)
[2017-06-27 13:05:52,830] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=13, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,4] (state.change.logger)
[2017-06-27 13:05:52,830] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-30 (state.change.logger)
[2017-06-27 13:05:52,830] WARN Broker 2 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,45] since its associated leader epoch 6 is not higher than the current leader epoch 6 (state.change.logger)
[2017-06-27 13:05:52,830] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,33] (state.change.logger)
[2017-06-27 13:05:52,830] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-41 (state.change.logger)
[2017-06-27 13:05:52,830] WARN Broker 2 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,12] since its associated leader epoch 6 is not higher than the current leader epoch 6 (state.change.logger)
[2017-06-27 13:05:52,830] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,15] (state.change.logger)
[2017-06-27 13:05:52,830] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-11 (state.change.logger)
[2017-06-27 13:05:52,830] WARN Broker 2 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,41] since its associated leader epoch 9 is not higher than the current leader epoch 9 (state.change.logger)
[2017-06-27 13:05:52,830] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,48] (state.change.logger)
[2017-06-27 13:05:52,830] WARN Broker 2 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,24] since its associated leader epoch 6 is not higher than the current leader epoch 6 (state.change.logger)
[2017-06-27 13:05:52,830] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-33 (state.change.logger)
[2017-06-27 13:05:52,830] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=9, isr=[1, 2], zkVersion=14, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,11] (state.change.logger)
[2017-06-27 13:05:52,830] WARN Broker 2 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,20] since its associated leader epoch 8 is not higher than the current leader epoch 8 (state.change.logger)
[2017-06-27 13:05:52,830] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-22 (state.change.logger)
[2017-06-27 13:05:52,830] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=8, isr=[1, 2], zkVersion=13, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,44] (state.change.logger)
[2017-06-27 13:05:52,830] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9) to brokers Set(1, 2) for partition __consumer_offsets-0 (state.change.logger)
[2017-06-27 13:05:52,830] WARN Broker 2 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,49] since its associated leader epoch 8 is not higher than the current leader epoch 8 (state.change.logger)
[2017-06-27 13:05:52,830] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=9, isr=[1, 2], zkVersion=14, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,23] (state.change.logger)
[2017-06-27 13:05:52,830] WARN Broker 2 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,0] since its associated leader epoch 6 is not higher than the current leader epoch 6 (state.change.logger)
[2017-06-27 13:05:52,830] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2, 0], zkVersion=12, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,19] (state.change.logger)
[2017-06-27 13:05:52,830] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=8, isr=[1, 2], zkVersion=13, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,32] (state.change.logger)
[2017-06-27 13:05:52,830] WARN Broker 2 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,29] since its associated leader epoch 9 is not higher than the current leader epoch 9 (state.change.logger)
[2017-06-27 13:05:52,830] WARN Broker 2 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,25] since its associated leader epoch 8 is not higher than the current leader epoch 8 (state.change.logger)
[2017-06-27 13:05:52,830] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=11, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,28] (state.change.logger)
[2017-06-27 13:05:52,830] WARN Broker 2 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,8] since its associated leader epoch 8 is not higher than the current leader epoch 8 (state.change.logger)
[2017-06-27 13:05:52,830] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=11, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,7] (state.change.logger)
[2017-06-27 13:05:52,830] WARN Broker 2 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,37] since its associated leader epoch 8 is not higher than the current leader epoch 8 (state.change.logger)
[2017-06-27 13:05:52,830] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=11, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,40] (state.change.logger)
[2017-06-27 13:05:52,830] WARN Broker 2 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,4] since its associated leader epoch 8 is not higher than the current leader epoch 8 (state.change.logger)
[2017-06-27 13:05:52,830] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,3] (state.change.logger)
[2017-06-27 13:05:52,830] WARN Broker 2 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,33] since its associated leader epoch 6 is not higher than the current leader epoch 6 (state.change.logger)
[2017-06-27 13:05:52,830] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,36] (state.change.logger)
[2017-06-27 13:05:52,831] WARN Broker 2 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,15] since its associated leader epoch 6 is not higher than the current leader epoch 6 (state.change.logger)
[2017-06-27 13:05:52,831] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=9, isr=[1, 2], zkVersion=14, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,47] (state.change.logger)
[2017-06-27 13:05:52,831] WARN Broker 2 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,48] since its associated leader epoch 6 is not higher than the current leader epoch 6 (state.change.logger)
[2017-06-27 13:05:52,831] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=8, isr=[1, 2], zkVersion=13, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,14] (state.change.logger)
[2017-06-27 13:05:52,831] WARN Broker 2 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,11] since its associated leader epoch 9 is not higher than the current leader epoch 9 (state.change.logger)
[2017-06-27 13:05:52,831] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=11, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,43] (state.change.logger)
[2017-06-27 13:05:52,831] WARN Broker 2 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,44] since its associated leader epoch 8 is not higher than the current leader epoch 8 (state.change.logger)
[2017-06-27 13:05:52,831] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=11, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,10] (state.change.logger)
[2017-06-27 13:05:52,831] WARN Broker 2 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,23] since its associated leader epoch 9 is not higher than the current leader epoch 9 (state.change.logger)
[2017-06-27 13:05:52,831] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=13, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,22] (state.change.logger)
[2017-06-27 13:05:52,831] WARN Broker 2 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [rf1p1,0] since its associated leader epoch 9 is not higher than the current leader epoch 9 (state.change.logger)
[2017-06-27 13:05:52,831] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,18] (state.change.logger)
[2017-06-27 13:05:52,831] WARN Broker 2 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,19] since its associated leader epoch 8 is not higher than the current leader epoch 8 (state.change.logger)
[2017-06-27 13:05:52,831] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=8, isr=[1, 2], zkVersion=11, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,31] (state.change.logger)
[2017-06-27 13:05:52,831] WARN Broker 2 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,32] since its associated leader epoch 8 is not higher than the current leader epoch 8 (state.change.logger)
[2017-06-27 13:05:52,831] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,27] (state.change.logger)
[2017-06-27 13:05:52,831] WARN Broker 2 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,28] since its associated leader epoch 8 is not higher than the current leader epoch 8 (state.change.logger)
[2017-06-27 13:05:52,831] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,39] (state.change.logger)
[2017-06-27 13:05:52,831] WARN Broker 2 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,7] since its associated leader epoch 8 is not higher than the current leader epoch 8 (state.change.logger)
[2017-06-27 13:05:52,831] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=1, leaderEpoch=6, isr=[1, 2], zkVersion=10, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,6] (state.change.logger)
[2017-06-27 13:05:52,831] WARN Broker 2 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,40] since its associated leader epoch 8 is not higher than the current leader epoch 8 (state.change.logger)
[2017-06-27 13:05:52,831] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=9, isr=[1, 2], zkVersion=14, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,35] (state.change.logger)
[2017-06-27 13:05:52,831] WARN Broker 2 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,3] since its associated leader epoch 6 is not higher than the current leader epoch 6 (state.change.logger)
[2017-06-27 13:05:52,831] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=8, isr=[1, 2], zkVersion=13, replicas=[0, 1, 2]) correlation id 1 from controller 1 epoch 10 for partition [__consumer_offsets,2] (state.change.logger)
[2017-06-27 13:05:52,831] WARN Broker 2 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,36] since its associated leader epoch 6 is not higher than the current leader epoch 6 (state.change.logger)
[2017-06-27 13:05:52,831] WARN Broker 2 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,47] since its associated leader epoch 9 is not higher than the current leader epoch 9 (state.change.logger)
[2017-06-27 13:05:52,831] WARN Broker 2 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,14] since its associated leader epoch 8 is not higher than the current leader epoch 8 (state.change.logger)
[2017-06-27 13:05:52,831] WARN Broker 2 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,43] since its associated leader epoch 8 is not higher than the current leader epoch 8 (state.change.logger)
[2017-06-27 13:05:52,831] WARN Broker 2 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,10] since its associated leader epoch 8 is not higher than the current leader epoch 8 (state.change.logger)
[2017-06-27 13:05:52,831] WARN Broker 2 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,22] since its associated leader epoch 8 is not higher than the current leader epoch 8 (state.change.logger)
[2017-06-27 13:05:52,831] WARN Broker 2 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,18] since its associated leader epoch 6 is not higher than the current leader epoch 6 (state.change.logger)
[2017-06-27 13:05:52,831] WARN Broker 2 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,31] since its associated leader epoch 8 is not higher than the current leader epoch 8 (state.change.logger)
[2017-06-27 13:05:52,831] WARN Broker 2 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,27] since its associated leader epoch 6 is not higher than the current leader epoch 6 (state.change.logger)
[2017-06-27 13:05:52,831] WARN Broker 2 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,39] since its associated leader epoch 6 is not higher than the current leader epoch 6 (state.change.logger)
[2017-06-27 13:05:52,831] WARN Broker 2 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,6] since its associated leader epoch 6 is not higher than the current leader epoch 6 (state.change.logger)
[2017-06-27 13:05:52,831] WARN Broker 2 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,35] since its associated leader epoch 9 is not higher than the current leader epoch 9 (state.change.logger)
[2017-06-27 13:05:52,831] WARN Broker 2 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,2] since its associated leader epoch 8 is not higher than the current leader epoch 8 (state.change.logger)
[2017-06-27 13:05:52,831] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,13] since its associated leader epoch 8 is not higher than the current leader epoch 8 (state.change.logger)
[2017-06-27 13:05:52,831] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,46] since its associated leader epoch 8 is not higher than the current leader epoch 8 (state.change.logger)
[2017-06-27 13:05:52,831] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,9] since its associated leader epoch 6 is not higher than the current leader epoch 6 (state.change.logger)
[2017-06-27 13:05:52,831] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,42] since its associated leader epoch 6 is not higher than the current leader epoch 6 (state.change.logger)
[2017-06-27 13:05:52,831] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,21] since its associated leader epoch 6 is not higher than the current leader epoch 6 (state.change.logger)
[2017-06-27 13:05:52,831] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,17] since its associated leader epoch 9 is not higher than the current leader epoch 9 (state.change.logger)
[2017-06-27 13:05:52,831] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,30] since its associated leader epoch 6 is not higher than the current leader epoch 6 (state.change.logger)
[2017-06-27 13:05:52,831] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,26] since its associated leader epoch 8 is not higher than the current leader epoch 8 (state.change.logger)
[2017-06-27 13:05:52,831] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,5] since its associated leader epoch 9 is not higher than the current leader epoch 9 (state.change.logger)
[2017-06-27 13:05:52,831] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,38] since its associated leader epoch 8 is not higher than the current leader epoch 8 (state.change.logger)
[2017-06-27 13:05:52,831] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,1] since its associated leader epoch 8 is not higher than the current leader epoch 8 (state.change.logger)
[2017-06-27 13:05:52,832] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,34] since its associated leader epoch 8 is not higher than the current leader epoch 8 (state.change.logger)
[2017-06-27 13:05:52,832] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,16] since its associated leader epoch 8 is not higher than the current leader epoch 8 (state.change.logger)
[2017-06-27 13:05:52,832] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,45] since its associated leader epoch 6 is not higher than the current leader epoch 6 (state.change.logger)
[2017-06-27 13:05:52,832] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,12] since its associated leader epoch 6 is not higher than the current leader epoch 6 (state.change.logger)
[2017-06-27 13:05:52,832] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,41] since its associated leader epoch 9 is not higher than the current leader epoch 9 (state.change.logger)
[2017-06-27 13:05:52,832] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,24] since its associated leader epoch 6 is not higher than the current leader epoch 6 (state.change.logger)
[2017-06-27 13:05:52,832] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,20] since its associated leader epoch 8 is not higher than the current leader epoch 8 (state.change.logger)
[2017-06-27 13:05:52,832] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,49] since its associated leader epoch 8 is not higher than the current leader epoch 8 (state.change.logger)
[2017-06-27 13:05:52,832] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,0] since its associated leader epoch 6 is not higher than the current leader epoch 6 (state.change.logger)
[2017-06-27 13:05:52,832] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,29] since its associated leader epoch 9 is not higher than the current leader epoch 9 (state.change.logger)
[2017-06-27 13:05:52,832] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,25] since its associated leader epoch 8 is not higher than the current leader epoch 8 (state.change.logger)
[2017-06-27 13:05:52,832] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=49,error_code=11},{topic=__consumer_offsets,partition=38,error_code=11},{topic=__consumer_offsets,partition=16,error_code=11},{topic=__consumer_offsets,partition=27,error_code=11},{topic=__consumer_offsets,partition=8,error_code=11},{topic=__consumer_offsets,partition=19,error_code=11},{topic=__consumer_offsets,partition=2,error_code=11},{topic=__consumer_offsets,partition=13,error_code=11},{topic=__consumer_offsets,partition=35,error_code=11},{topic=__consumer_offsets,partition=24,error_code=11},{topic=__consumer_offsets,partition=46,error_code=11},{topic=__consumer_offsets,partition=5,error_code=11},{topic=__consumer_offsets,partition=43,error_code=11},{topic=__consumer_offsets,partition=21,error_code=11},{topic=__consumer_offsets,partition=32,error_code=11},{topic=__consumer_offsets,partition=10,error_code=11},{topic=__consumer_offsets,partition=37,error_code=11},{topic=__consumer_offsets,partition=48,error_code=11},{topic=__consumer_offsets,partition=29,error_code=11},{topic=__consumer_offsets,partition=40,error_code=11},{topic=__consumer_offsets,partition=18,error_code=11},{topic=__consumer_offsets,partition=7,error_code=11},{topic=__consumer_offsets,partition=45,error_code=11},{topic=__consumer_offsets,partition=34,error_code=11},{topic=__consumer_offsets,partition=23,error_code=11},{topic=__consumer_offsets,partition=26,error_code=11},{topic=__consumer_offsets,partition=4,error_code=11},{topic=__consumer_offsets,partition=15,error_code=11},{topic=__consumer_offsets,partition=42,error_code=11},{topic=__consumer_offsets,partition=20,error_code=11},{topic=__consumer_offsets,partition=9,error_code=11},{topic=__consumer_offsets,partition=31,error_code=11},{topic=__consumer_offsets,partition=12,error_code=11},{topic=__consumer_offsets,partition=1,error_code=11},{topic=__consumer_offsets,partition=17,error_code=11},{topic=__consumer_offsets,partition=28,error_code=11},{topic=__consumer_offsets,partition=6,error_code=11},{topic=__consumer_offsets,partition=39,error_code=11},{topic=__consumer_offsets,partition=44,error_code=11},{topic=__consumer_offsets,partition=36,error_code=11},{topic=__consumer_offsets,partition=47,error_code=11},{topic=rf1p1,partition=0,error_code=11},{topic=__consumer_offsets,partition=25,error_code=11},{topic=__consumer_offsets,partition=3,error_code=11},{topic=__consumer_offsets,partition=14,error_code=11},{topic=__consumer_offsets,partition=41,error_code=11},{topic=__consumer_offsets,partition=30,error_code=11},{topic=__consumer_offsets,partition=33,error_code=11},{topic=__consumer_offsets,partition=11,error_code=11},{topic=__consumer_offsets,partition=22,error_code=11},{topic=__consumer_offsets,partition=0,error_code=11}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:05:52,832] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,8] since its associated leader epoch 8 is not higher than the current leader epoch 8 (state.change.logger)
[2017-06-27 13:05:52,832] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,37] since its associated leader epoch 8 is not higher than the current leader epoch 8 (state.change.logger)
[2017-06-27 13:05:52,832] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,4] since its associated leader epoch 8 is not higher than the current leader epoch 8 (state.change.logger)
[2017-06-27 13:05:52,832] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,33] since its associated leader epoch 6 is not higher than the current leader epoch 6 (state.change.logger)
[2017-06-27 13:05:52,832] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,15] since its associated leader epoch 6 is not higher than the current leader epoch 6 (state.change.logger)
[2017-06-27 13:05:52,832] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,48] since its associated leader epoch 6 is not higher than the current leader epoch 6 (state.change.logger)
[2017-06-27 13:05:52,832] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,11] since its associated leader epoch 9 is not higher than the current leader epoch 9 (state.change.logger)
[2017-06-27 13:05:52,832] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,44] since its associated leader epoch 8 is not higher than the current leader epoch 8 (state.change.logger)
[2017-06-27 13:05:52,832] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,23] since its associated leader epoch 9 is not higher than the current leader epoch 9 (state.change.logger)
[2017-06-27 13:05:52,832] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,19] since its associated leader epoch 8 is not higher than the current leader epoch 8 (state.change.logger)
[2017-06-27 13:05:52,832] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,32] since its associated leader epoch 8 is not higher than the current leader epoch 8 (state.change.logger)
[2017-06-27 13:05:52,832] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,28] since its associated leader epoch 8 is not higher than the current leader epoch 8 (state.change.logger)
[2017-06-27 13:05:52,832] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,7] since its associated leader epoch 8 is not higher than the current leader epoch 8 (state.change.logger)
[2017-06-27 13:05:52,832] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,40] since its associated leader epoch 8 is not higher than the current leader epoch 8 (state.change.logger)
[2017-06-27 13:05:52,832] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,3] since its associated leader epoch 6 is not higher than the current leader epoch 6 (state.change.logger)
[2017-06-27 13:05:52,832] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,36] since its associated leader epoch 6 is not higher than the current leader epoch 6 (state.change.logger)
[2017-06-27 13:05:52,832] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,47] since its associated leader epoch 9 is not higher than the current leader epoch 9 (state.change.logger)
[2017-06-27 13:05:52,832] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,14] since its associated leader epoch 8 is not higher than the current leader epoch 8 (state.change.logger)
[2017-06-27 13:05:52,832] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,43] since its associated leader epoch 8 is not higher than the current leader epoch 8 (state.change.logger)
[2017-06-27 13:05:52,832] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,10] since its associated leader epoch 8 is not higher than the current leader epoch 8 (state.change.logger)
[2017-06-27 13:05:52,832] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,22] since its associated leader epoch 8 is not higher than the current leader epoch 8 (state.change.logger)
[2017-06-27 13:05:52,832] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,18] since its associated leader epoch 6 is not higher than the current leader epoch 6 (state.change.logger)
[2017-06-27 13:05:52,832] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,31] since its associated leader epoch 8 is not higher than the current leader epoch 8 (state.change.logger)
[2017-06-27 13:05:52,832] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,27] since its associated leader epoch 6 is not higher than the current leader epoch 6 (state.change.logger)
[2017-06-27 13:05:52,832] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-13 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,832] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,39] since its associated leader epoch 6 is not higher than the current leader epoch 6 (state.change.logger)
[2017-06-27 13:05:52,833] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,0,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-46 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,833] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-9 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,833] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,6] since its associated leader epoch 6 is not higher than the current leader epoch 6 (state.change.logger)
[2017-06-27 13:05:52,833] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-42 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,833] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-21 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,833] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,35] since its associated leader epoch 9 is not higher than the current leader epoch 9 (state.change.logger)
[2017-06-27 13:05:52,833] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-17 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,833] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-30 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,833] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-26 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,833] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition [__consumer_offsets,2] since its associated leader epoch 8 is not higher than the current leader epoch 8 (state.change.logger)
[2017-06-27 13:05:52,833] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-5 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,833] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-38 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,833] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-1 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,833] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-34 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,833] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-16 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,833] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-45 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,833] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-12 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,833] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-41 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,833] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-24 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,833] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-20 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,833] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-49 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,833] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-0 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,833] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-29 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,833] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-25 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,833] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-8 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,833] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-37 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,833] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-4 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,833] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-33 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,833] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-15 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,833] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-48 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,833] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-11 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,833] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-44 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,833] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-23 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,833] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:2) for partition rf1p1-0 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,833] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,0,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-19 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,833] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-32 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,833] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-28 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,833] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-7 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,833] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-40 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,833] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-3 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,833] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-36 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,833] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-47 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,833] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=49,error_code=11},{topic=__consumer_offsets,partition=38,error_code=11},{topic=__consumer_offsets,partition=16,error_code=11},{topic=__consumer_offsets,partition=27,error_code=11},{topic=__consumer_offsets,partition=8,error_code=11},{topic=__consumer_offsets,partition=19,error_code=11},{topic=__consumer_offsets,partition=2,error_code=11},{topic=__consumer_offsets,partition=13,error_code=11},{topic=__consumer_offsets,partition=24,error_code=11},{topic=__consumer_offsets,partition=46,error_code=11},{topic=__consumer_offsets,partition=35,error_code=11},{topic=__consumer_offsets,partition=5,error_code=11},{topic=__consumer_offsets,partition=43,error_code=11},{topic=__consumer_offsets,partition=21,error_code=11},{topic=__consumer_offsets,partition=32,error_code=11},{topic=__consumer_offsets,partition=10,error_code=11},{topic=__consumer_offsets,partition=37,error_code=11},{topic=__consumer_offsets,partition=48,error_code=11},{topic=__consumer_offsets,partition=29,error_code=11},{topic=__consumer_offsets,partition=40,error_code=11},{topic=__consumer_offsets,partition=18,error_code=11},{topic=__consumer_offsets,partition=7,error_code=11},{topic=__consumer_offsets,partition=45,error_code=11},{topic=__consumer_offsets,partition=34,error_code=11},{topic=__consumer_offsets,partition=23,error_code=11},{topic=__consumer_offsets,partition=26,error_code=11},{topic=__consumer_offsets,partition=4,error_code=11},{topic=__consumer_offsets,partition=15,error_code=11},{topic=__consumer_offsets,partition=42,error_code=11},{topic=__consumer_offsets,partition=20,error_code=11},{topic=__consumer_offsets,partition=9,error_code=11},{topic=__consumer_offsets,partition=31,error_code=11},{topic=__consumer_offsets,partition=12,error_code=11},{topic=__consumer_offsets,partition=1,error_code=11},{topic=__consumer_offsets,partition=17,error_code=11},{topic=__consumer_offsets,partition=28,error_code=11},{topic=__consumer_offsets,partition=6,error_code=11},{topic=__consumer_offsets,partition=39,error_code=11},{topic=__consumer_offsets,partition=44,error_code=11},{topic=__consumer_offsets,partition=36,error_code=11},{topic=__consumer_offsets,partition=47,error_code=11},{topic=__consumer_offsets,partition=25,error_code=11},{topic=__consumer_offsets,partition=3,error_code=11},{topic=__consumer_offsets,partition=14,error_code=11},{topic=__consumer_offsets,partition=41,error_code=11},{topic=__consumer_offsets,partition=30,error_code=11},{topic=__consumer_offsets,partition=33,error_code=11},{topic=__consumer_offsets,partition=11,error_code=11},{topic=__consumer_offsets,partition=22,error_code=11},{topic=__consumer_offsets,partition=0,error_code=11}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:05:52,833] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-14 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,833] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-43 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,833] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-10 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,833] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-22 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,833] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-18 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,833] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-31 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,833] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-27 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,833] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-39 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,833] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-6 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,833] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-35 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,833] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-2 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,834] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:05:52,834] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-13 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,834] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,0,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-46 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,834] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-9 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,834] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-42 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,834] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-21 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,834] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-17 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,834] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-30 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,834] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-26 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,834] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-5 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,834] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-38 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,834] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-1 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,834] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-34 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,834] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-16 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,834] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-45 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,835] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-12 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,835] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-41 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,835] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-24 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,835] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-20 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,835] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-49 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,835] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-0 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,835] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-29 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,835] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-25 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,835] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-8 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,835] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-37 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,835] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-4 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,835] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-33 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,835] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-15 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,835] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-48 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,835] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-11 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,835] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-44 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,835] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-23 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,835] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:2) for partition rf1p1-0 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,835] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,0,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-19 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,835] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-32 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,835] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-28 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,835] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-7 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,835] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-40 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,835] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-3 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,835] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-36 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,835] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-47 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,835] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-14 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,835] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-43 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,835] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-10 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,836] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-22 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,836] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-18 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,836] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-31 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,836] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-27 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,836] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-39 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,836] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-6 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,836] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-35 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,836] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:1,2,LeaderEpoch:8,ControllerEpoch:9),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-2 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2017-06-27 13:05:52,836] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,835] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,43] (state.change.logger)
[2017-06-27 13:06:05,840] TRACE Controller 1 epoch 10 elected leader 2 for Offline partition [__consumer_offsets,43] (state.change.logger)
[2017-06-27 13:06:05,841] TRACE Controller 1 epoch 10 changed partition [__consumer_offsets,43] from OnlinePartition to OnlinePartition with leader 2 (state.change.logger)
[2017-06-27 13:06:05,841] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,43] (state.change.logger)
[2017-06-27 13:06:05,842] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 1 for partition [__consumer_offsets,43] (state.change.logger)
[2017-06-27 13:06:05,842] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(1, 2) for partition __consumer_offsets-43 (state.change.logger)
[2017-06-27 13:06:05,842] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=12, replicas=[0, 1, 2]) correlation id 3 from controller 1 epoch 10 for partition [__consumer_offsets,43] (state.change.logger)
[2017-06-27 13:06:05,842] TRACE Broker 1 handling LeaderAndIsr request correlationId 3 from controller 1 epoch 10 starting the become-follower transition for partition __consumer_offsets-43 (state.change.logger)
[2017-06-27 13:06:05,842] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=12, replicas=[0, 1, 2]) correlation id 3 from controller 1 epoch 10 for partition [__consumer_offsets,43] (state.change.logger)
[2017-06-27 13:06:05,842] TRACE Broker 2 handling LeaderAndIsr request correlationId 3 from controller 1 epoch 10 starting the become-leader transition for partition __consumer_offsets-43 (state.change.logger)
[2017-06-27 13:06:05,842] TRACE Broker 1 stopped fetchers as part of become-follower request from controller 1 epoch 10 with correlation id 3 for partition __consumer_offsets-43 (state.change.logger)
[2017-06-27 13:06:05,843] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 10 with correlation id 3 for partition __consumer_offsets-43 (state.change.logger)
[2017-06-27 13:06:05,843] TRACE Broker 2 completed LeaderAndIsr request correlationId 3 from controller 1 epoch 10 for the become-leader transition for partition __consumer_offsets-43 (state.change.logger)
[2017-06-27 13:06:05,843] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=43,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,843] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-43 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 4 (state.change.logger)
[2017-06-27 13:06:05,844] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,844] TRACE Broker 1 truncated logs and checkpointed recovery boundaries for partition __consumer_offsets-43 as part of become-follower request with correlation id 3 from controller 1 epoch 10 (state.change.logger)
[2017-06-27 13:06:05,845] TRACE Broker 1 skipped the adding-fetcher step of the become-follower state change with correlation id 3 from controller 1 epoch 10 for partition __consumer_offsets-43 since it is shutting down (state.change.logger)
[2017-06-27 13:06:05,845] TRACE Broker 1 completed LeaderAndIsr request correlationId 3 from controller 1 epoch 10 for the become-follower transition for partition __consumer_offsets-43 (state.change.logger)
[2017-06-27 13:06:05,845] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=43,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,845] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-43 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 4 (state.change.logger)
[2017-06-27 13:06:05,845] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,847] TRACE Broker 1 handling stop replica (delete=false) for partition __consumer_offsets-14 (state.change.logger)
[2017-06-27 13:06:05,848] TRACE Broker 1 finished handling stop replica (delete=false) for partition __consumer_offsets-14 (state.change.logger)
[2017-06-27 13:06:05,848] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=14,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,850] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,14] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-27 13:06:05,850] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,14] (state.change.logger)
[2017-06-27 13:06:05,850] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 0 for partition [__consumer_offsets,14] (state.change.logger)
[2017-06-27 13:06:05,851] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=14, replicas=[0, 1, 2]) correlation id 5 from controller 1 epoch 10 for partition [__consumer_offsets,14] (state.change.logger)
[2017-06-27 13:06:05,851] TRACE Broker 2 handling LeaderAndIsr request correlationId 5 from controller 1 epoch 10 starting the become-leader transition for partition __consumer_offsets-14 (state.change.logger)
[2017-06-27 13:06:05,851] INFO Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 5 from controller 1 epoch 10 for partition __consumer_offsets-14 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:06:05,851] TRACE Broker 2 completed LeaderAndIsr request correlationId 5 from controller 1 epoch 10 for the become-leader transition for partition __consumer_offsets-14 (state.change.logger)
[2017-06-27 13:06:05,851] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(1, 2) for partition __consumer_offsets-14 (state.change.logger)
[2017-06-27 13:06:05,851] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=14,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,851] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,28] (state.change.logger)
[2017-06-27 13:06:05,851] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-14 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 6 (state.change.logger)
[2017-06-27 13:06:05,852] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,852] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-14 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 6 (state.change.logger)
[2017-06-27 13:06:05,852] TRACE Broker 1 handling stop replica (delete=false) for partition __consumer_offsets-14 (state.change.logger)
[2017-06-27 13:06:05,852] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,852] TRACE Broker 1 finished handling stop replica (delete=false) for partition __consumer_offsets-14 (state.change.logger)
[2017-06-27 13:06:05,852] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=14,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,853] TRACE Controller 1 epoch 10 elected leader 2 for Offline partition [__consumer_offsets,28] (state.change.logger)
[2017-06-27 13:06:05,854] TRACE Controller 1 epoch 10 changed partition [__consumer_offsets,28] from OnlinePartition to OnlinePartition with leader 2 (state.change.logger)
[2017-06-27 13:06:05,854] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,28] (state.change.logger)
[2017-06-27 13:06:05,854] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 1 for partition [__consumer_offsets,28] (state.change.logger)
[2017-06-27 13:06:05,854] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(1, 2) for partition __consumer_offsets-28 (state.change.logger)
[2017-06-27 13:06:05,855] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,4] (state.change.logger)
[2017-06-27 13:06:05,855] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=12, replicas=[0, 1, 2]) correlation id 7 from controller 1 epoch 10 for partition [__consumer_offsets,28] (state.change.logger)
[2017-06-27 13:06:05,855] TRACE Broker 2 handling LeaderAndIsr request correlationId 7 from controller 1 epoch 10 starting the become-leader transition for partition __consumer_offsets-28 (state.change.logger)
[2017-06-27 13:06:05,855] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=12, replicas=[0, 1, 2]) correlation id 8 from controller 1 epoch 10 for partition [__consumer_offsets,28] (state.change.logger)
[2017-06-27 13:06:05,856] TRACE Broker 1 handling LeaderAndIsr request correlationId 8 from controller 1 epoch 10 starting the become-follower transition for partition __consumer_offsets-28 (state.change.logger)
[2017-06-27 13:06:05,856] TRACE Broker 1 stopped fetchers as part of become-follower request from controller 1 epoch 10 with correlation id 8 for partition __consumer_offsets-28 (state.change.logger)
[2017-06-27 13:06:05,856] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 10 with correlation id 7 for partition __consumer_offsets-28 (state.change.logger)
[2017-06-27 13:06:05,856] TRACE Broker 2 completed LeaderAndIsr request correlationId 7 from controller 1 epoch 10 for the become-leader transition for partition __consumer_offsets-28 (state.change.logger)
[2017-06-27 13:06:05,856] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=28,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,857] TRACE Broker 1 truncated logs and checkpointed recovery boundaries for partition __consumer_offsets-28 as part of become-follower request with correlation id 8 from controller 1 epoch 10 (state.change.logger)
[2017-06-27 13:06:05,857] TRACE Broker 1 skipped the adding-fetcher step of the become-follower state change with correlation id 8 from controller 1 epoch 10 for partition __consumer_offsets-28 since it is shutting down (state.change.logger)
[2017-06-27 13:06:05,857] TRACE Broker 1 completed LeaderAndIsr request correlationId 8 from controller 1 epoch 10 for the become-follower transition for partition __consumer_offsets-28 (state.change.logger)
[2017-06-27 13:06:05,857] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=28,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,858] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-28 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 9 (state.change.logger)
[2017-06-27 13:06:05,858] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,858] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-28 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 8 (state.change.logger)
[2017-06-27 13:06:05,858] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,859] TRACE Controller 1 epoch 10 elected leader 2 for Offline partition [__consumer_offsets,4] (state.change.logger)
[2017-06-27 13:06:05,860] TRACE Controller 1 epoch 10 changed partition [__consumer_offsets,4] from OnlinePartition to OnlinePartition with leader 2 (state.change.logger)
[2017-06-27 13:06:05,860] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,4] (state.change.logger)
[2017-06-27 13:06:05,860] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 1 for partition [__consumer_offsets,4] (state.change.logger)
[2017-06-27 13:06:05,860] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(1, 2) for partition __consumer_offsets-4 (state.change.logger)
[2017-06-27 13:06:05,860] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=14, replicas=[0, 1, 2]) correlation id 9 from controller 1 epoch 10 for partition [__consumer_offsets,4] (state.change.logger)
[2017-06-27 13:06:05,860] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=14, replicas=[0, 1, 2]) correlation id 10 from controller 1 epoch 10 for partition [__consumer_offsets,4] (state.change.logger)
[2017-06-27 13:06:05,860] TRACE Broker 2 handling LeaderAndIsr request correlationId 9 from controller 1 epoch 10 starting the become-leader transition for partition __consumer_offsets-4 (state.change.logger)
[2017-06-27 13:06:05,860] TRACE Broker 1 handling LeaderAndIsr request correlationId 10 from controller 1 epoch 10 starting the become-follower transition for partition __consumer_offsets-4 (state.change.logger)
[2017-06-27 13:06:05,860] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,36] (state.change.logger)
[2017-06-27 13:06:05,861] TRACE Broker 1 stopped fetchers as part of become-follower request from controller 1 epoch 10 with correlation id 10 for partition __consumer_offsets-4 (state.change.logger)
[2017-06-27 13:06:05,861] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 10 with correlation id 9 for partition __consumer_offsets-4 (state.change.logger)
[2017-06-27 13:06:05,861] TRACE Broker 2 completed LeaderAndIsr request correlationId 9 from controller 1 epoch 10 for the become-leader transition for partition __consumer_offsets-4 (state.change.logger)
[2017-06-27 13:06:05,861] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=4,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,861] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-4 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 10 (state.change.logger)
[2017-06-27 13:06:05,862] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,862] TRACE Broker 1 truncated logs and checkpointed recovery boundaries for partition __consumer_offsets-4 as part of become-follower request with correlation id 10 from controller 1 epoch 10 (state.change.logger)
[2017-06-27 13:06:05,862] TRACE Broker 1 skipped the adding-fetcher step of the become-follower state change with correlation id 10 from controller 1 epoch 10 for partition __consumer_offsets-4 since it is shutting down (state.change.logger)
[2017-06-27 13:06:05,862] TRACE Broker 1 completed LeaderAndIsr request correlationId 10 from controller 1 epoch 10 for the become-follower transition for partition __consumer_offsets-4 (state.change.logger)
[2017-06-27 13:06:05,862] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=4,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,862] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-4 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 11 (state.change.logger)
[2017-06-27 13:06:05,862] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,864] TRACE Controller 1 epoch 10 elected leader 2 for Offline partition [__consumer_offsets,36] (state.change.logger)
[2017-06-27 13:06:05,865] TRACE Controller 1 epoch 10 changed partition [__consumer_offsets,36] from OnlinePartition to OnlinePartition with leader 2 (state.change.logger)
[2017-06-27 13:06:05,865] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,36] (state.change.logger)
[2017-06-27 13:06:05,865] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to broker 1 for partition [__consumer_offsets,36] (state.change.logger)
[2017-06-27 13:06:05,865] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to brokers Set(1, 2) for partition __consumer_offsets-36 (state.change.logger)
[2017-06-27 13:06:05,865] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=7, isr=[2], zkVersion=11, replicas=[0, 1, 2]) correlation id 11 from controller 1 epoch 10 for partition [__consumer_offsets,36] (state.change.logger)
[2017-06-27 13:06:05,865] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=7, isr=[2], zkVersion=11, replicas=[0, 1, 2]) correlation id 12 from controller 1 epoch 10 for partition [__consumer_offsets,36] (state.change.logger)
[2017-06-27 13:06:05,865] TRACE Broker 2 handling LeaderAndIsr request correlationId 11 from controller 1 epoch 10 starting the become-leader transition for partition __consumer_offsets-36 (state.change.logger)
[2017-06-27 13:06:05,865] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,6] (state.change.logger)
[2017-06-27 13:06:05,865] TRACE Broker 1 handling LeaderAndIsr request correlationId 12 from controller 1 epoch 10 starting the become-follower transition for partition __consumer_offsets-36 (state.change.logger)
[2017-06-27 13:06:05,865] TRACE Broker 1 stopped fetchers as part of become-follower request from controller 1 epoch 10 with correlation id 12 for partition __consumer_offsets-36 (state.change.logger)
[2017-06-27 13:06:05,865] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 10 with correlation id 11 for partition __consumer_offsets-36 (state.change.logger)
[2017-06-27 13:06:05,865] TRACE Broker 2 completed LeaderAndIsr request correlationId 11 from controller 1 epoch 10 for the become-leader transition for partition __consumer_offsets-36 (state.change.logger)
[2017-06-27 13:06:05,866] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=36,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,866] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-36 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 12 (state.change.logger)
[2017-06-27 13:06:05,866] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,866] TRACE Broker 1 truncated logs and checkpointed recovery boundaries for partition __consumer_offsets-36 as part of become-follower request with correlation id 12 from controller 1 epoch 10 (state.change.logger)
[2017-06-27 13:06:05,866] TRACE Broker 1 skipped the adding-fetcher step of the become-follower state change with correlation id 12 from controller 1 epoch 10 for partition __consumer_offsets-36 since it is shutting down (state.change.logger)
[2017-06-27 13:06:05,866] TRACE Broker 1 completed LeaderAndIsr request correlationId 12 from controller 1 epoch 10 for the become-follower transition for partition __consumer_offsets-36 (state.change.logger)
[2017-06-27 13:06:05,867] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=36,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,867] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-36 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 13 (state.change.logger)
[2017-06-27 13:06:05,867] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,868] TRACE Controller 1 epoch 10 elected leader 2 for Offline partition [__consumer_offsets,6] (state.change.logger)
[2017-06-27 13:06:05,869] TRACE Controller 1 epoch 10 changed partition [__consumer_offsets,6] from OnlinePartition to OnlinePartition with leader 2 (state.change.logger)
[2017-06-27 13:06:05,869] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,6] (state.change.logger)
[2017-06-27 13:06:05,869] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to broker 1 for partition [__consumer_offsets,6] (state.change.logger)
[2017-06-27 13:06:05,869] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to brokers Set(1, 2) for partition __consumer_offsets-6 (state.change.logger)
[2017-06-27 13:06:05,869] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=7, isr=[2], zkVersion=11, replicas=[0, 1, 2]) correlation id 13 from controller 1 epoch 10 for partition [__consumer_offsets,6] (state.change.logger)
[2017-06-27 13:06:05,869] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=7, isr=[2], zkVersion=11, replicas=[0, 1, 2]) correlation id 14 from controller 1 epoch 10 for partition [__consumer_offsets,6] (state.change.logger)
[2017-06-27 13:06:05,869] TRACE Broker 2 handling LeaderAndIsr request correlationId 13 from controller 1 epoch 10 starting the become-leader transition for partition __consumer_offsets-6 (state.change.logger)
[2017-06-27 13:06:05,869] TRACE Broker 1 handling LeaderAndIsr request correlationId 14 from controller 1 epoch 10 starting the become-follower transition for partition __consumer_offsets-6 (state.change.logger)
[2017-06-27 13:06:05,870] TRACE Broker 1 stopped fetchers as part of become-follower request from controller 1 epoch 10 with correlation id 14 for partition __consumer_offsets-6 (state.change.logger)
[2017-06-27 13:06:05,870] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 10 with correlation id 13 for partition __consumer_offsets-6 (state.change.logger)
[2017-06-27 13:06:05,870] TRACE Broker 2 completed LeaderAndIsr request correlationId 13 from controller 1 epoch 10 for the become-leader transition for partition __consumer_offsets-6 (state.change.logger)
[2017-06-27 13:06:05,870] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=6,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,870] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-6 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 14 (state.change.logger)
[2017-06-27 13:06:05,871] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,871] TRACE Broker 1 truncated logs and checkpointed recovery boundaries for partition __consumer_offsets-6 as part of become-follower request with correlation id 14 from controller 1 epoch 10 (state.change.logger)
[2017-06-27 13:06:05,871] TRACE Broker 1 skipped the adding-fetcher step of the become-follower state change with correlation id 14 from controller 1 epoch 10 for partition __consumer_offsets-6 since it is shutting down (state.change.logger)
[2017-06-27 13:06:05,871] TRACE Broker 1 completed LeaderAndIsr request correlationId 14 from controller 1 epoch 10 for the become-follower transition for partition __consumer_offsets-6 (state.change.logger)
[2017-06-27 13:06:05,872] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=6,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,872] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-6 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 15 (state.change.logger)
[2017-06-27 13:06:05,873] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,873] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,39] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-27 13:06:05,873] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,39] (state.change.logger)
[2017-06-27 13:06:05,873] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to broker 0 for partition [__consumer_offsets,39] (state.change.logger)
[2017-06-27 13:06:05,873] TRACE Broker 1 handling stop replica (delete=false) for partition __consumer_offsets-39 (state.change.logger)
[2017-06-27 13:06:05,873] TRACE Broker 1 finished handling stop replica (delete=false) for partition __consumer_offsets-39 (state.change.logger)
[2017-06-27 13:06:05,873] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to brokers Set(1, 2) for partition __consumer_offsets-39 (state.change.logger)
[2017-06-27 13:06:05,873] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=7, isr=[2], zkVersion=11, replicas=[0, 1, 2]) correlation id 15 from controller 1 epoch 10 for partition [__consumer_offsets,39] (state.change.logger)
[2017-06-27 13:06:05,874] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=39,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,874] TRACE Broker 2 handling LeaderAndIsr request correlationId 15 from controller 1 epoch 10 starting the become-leader transition for partition __consumer_offsets-39 (state.change.logger)
[2017-06-27 13:06:05,874] INFO Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 15 from controller 1 epoch 10 for partition __consumer_offsets-39 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:06:05,874] TRACE Broker 2 completed LeaderAndIsr request correlationId 15 from controller 1 epoch 10 for the become-leader transition for partition __consumer_offsets-39 (state.change.logger)
[2017-06-27 13:06:05,874] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-39 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 17 (state.change.logger)
[2017-06-27 13:06:05,874] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,874] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=39,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,874] TRACE Broker 1 handling stop replica (delete=false) for partition __consumer_offsets-39 (state.change.logger)
[2017-06-27 13:06:05,874] TRACE Broker 1 finished handling stop replica (delete=false) for partition __consumer_offsets-39 (state.change.logger)
[2017-06-27 13:06:05,874] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-39 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 16 (state.change.logger)
[2017-06-27 13:06:05,874] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=39,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,874] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,875] TRACE Broker 1 handling stop replica (delete=false) for partition __consumer_offsets-23 (state.change.logger)
[2017-06-27 13:06:05,875] TRACE Broker 1 finished handling stop replica (delete=false) for partition __consumer_offsets-23 (state.change.logger)
[2017-06-27 13:06:05,875] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=23,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,876] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,23] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-27 13:06:05,876] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,23] (state.change.logger)
[2017-06-27 13:06:05,876] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10) to broker 0 for partition [__consumer_offsets,23] (state.change.logger)
[2017-06-27 13:06:05,876] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10) to brokers Set(1, 2) for partition __consumer_offsets-23 (state.change.logger)
[2017-06-27 13:06:05,876] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=10, isr=[2], zkVersion=15, replicas=[0, 1, 2]) correlation id 17 from controller 1 epoch 10 for partition [__consumer_offsets,23] (state.change.logger)
[2017-06-27 13:06:05,876] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,24] (state.change.logger)
[2017-06-27 13:06:05,876] TRACE Broker 2 handling LeaderAndIsr request correlationId 17 from controller 1 epoch 10 starting the become-leader transition for partition __consumer_offsets-23 (state.change.logger)
[2017-06-27 13:06:05,876] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-23 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 20 (state.change.logger)
[2017-06-27 13:06:05,876] INFO Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 17 from controller 1 epoch 10 for partition __consumer_offsets-23 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:06:05,876] TRACE Broker 2 completed LeaderAndIsr request correlationId 17 from controller 1 epoch 10 for the become-leader transition for partition __consumer_offsets-23 (state.change.logger)
[2017-06-27 13:06:05,876] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,877] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=23,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,877] TRACE Broker 1 handling stop replica (delete=false) for partition __consumer_offsets-23 (state.change.logger)
[2017-06-27 13:06:05,877] TRACE Broker 1 finished handling stop replica (delete=false) for partition __consumer_offsets-23 (state.change.logger)
[2017-06-27 13:06:05,877] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-23 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 18 (state.change.logger)
[2017-06-27 13:06:05,877] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=23,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,877] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,878] TRACE Controller 1 epoch 10 elected leader 2 for Offline partition [__consumer_offsets,24] (state.change.logger)
[2017-06-27 13:06:05,879] TRACE Controller 1 epoch 10 changed partition [__consumer_offsets,24] from OnlinePartition to OnlinePartition with leader 2 (state.change.logger)
[2017-06-27 13:06:05,879] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,24] (state.change.logger)
[2017-06-27 13:06:05,879] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to broker 1 for partition [__consumer_offsets,24] (state.change.logger)
[2017-06-27 13:06:05,879] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to brokers Set(1, 2) for partition __consumer_offsets-24 (state.change.logger)
[2017-06-27 13:06:05,879] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=7, isr=[2], zkVersion=11, replicas=[0, 1, 2]) correlation id 19 from controller 1 epoch 10 for partition [__consumer_offsets,24] (state.change.logger)
[2017-06-27 13:06:05,879] TRACE Broker 2 handling LeaderAndIsr request correlationId 19 from controller 1 epoch 10 starting the become-leader transition for partition __consumer_offsets-24 (state.change.logger)
[2017-06-27 13:06:05,879] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=7, isr=[2], zkVersion=11, replicas=[0, 1, 2]) correlation id 22 from controller 1 epoch 10 for partition [__consumer_offsets,24] (state.change.logger)
[2017-06-27 13:06:05,879] TRACE Broker 1 handling LeaderAndIsr request correlationId 22 from controller 1 epoch 10 starting the become-follower transition for partition __consumer_offsets-24 (state.change.logger)
[2017-06-27 13:06:05,879] TRACE Broker 1 stopped fetchers as part of become-follower request from controller 1 epoch 10 with correlation id 22 for partition __consumer_offsets-24 (state.change.logger)
[2017-06-27 13:06:05,879] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 10 with correlation id 19 for partition __consumer_offsets-24 (state.change.logger)
[2017-06-27 13:06:05,879] TRACE Broker 2 completed LeaderAndIsr request correlationId 19 from controller 1 epoch 10 for the become-leader transition for partition __consumer_offsets-24 (state.change.logger)
[2017-06-27 13:06:05,880] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=24,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,880] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-24 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 20 (state.change.logger)
[2017-06-27 13:06:05,880] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,880] TRACE Broker 1 truncated logs and checkpointed recovery boundaries for partition __consumer_offsets-24 as part of become-follower request with correlation id 22 from controller 1 epoch 10 (state.change.logger)
[2017-06-27 13:06:05,880] TRACE Broker 1 skipped the adding-fetcher step of the become-follower state change with correlation id 22 from controller 1 epoch 10 for partition __consumer_offsets-24 since it is shutting down (state.change.logger)
[2017-06-27 13:06:05,880] TRACE Broker 1 completed LeaderAndIsr request correlationId 22 from controller 1 epoch 10 for the become-follower transition for partition __consumer_offsets-24 (state.change.logger)
[2017-06-27 13:06:05,881] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=24,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,881] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-24 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 23 (state.change.logger)
[2017-06-27 13:06:05,881] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,882] TRACE Broker 1 handling stop replica (delete=false) for partition __consumer_offsets-38 (state.change.logger)
[2017-06-27 13:06:05,882] TRACE Broker 1 finished handling stop replica (delete=false) for partition __consumer_offsets-38 (state.change.logger)
[2017-06-27 13:06:05,882] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,38] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-27 13:06:05,882] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=38,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,882] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,38] (state.change.logger)
[2017-06-27 13:06:05,882] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 0 for partition [__consumer_offsets,38] (state.change.logger)
[2017-06-27 13:06:05,882] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(1, 2) for partition __consumer_offsets-38 (state.change.logger)
[2017-06-27 13:06:05,882] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=14, replicas=[0, 1, 2]) correlation id 21 from controller 1 epoch 10 for partition [__consumer_offsets,38] (state.change.logger)
[2017-06-27 13:06:05,882] TRACE Broker 2 handling LeaderAndIsr request correlationId 21 from controller 1 epoch 10 starting the become-leader transition for partition __consumer_offsets-38 (state.change.logger)
[2017-06-27 13:06:05,882] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,16] (state.change.logger)
[2017-06-27 13:06:05,882] INFO Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 21 from controller 1 epoch 10 for partition __consumer_offsets-38 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:06:05,882] TRACE Broker 2 completed LeaderAndIsr request correlationId 21 from controller 1 epoch 10 for the become-leader transition for partition __consumer_offsets-38 (state.change.logger)
[2017-06-27 13:06:05,882] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-38 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 25 (state.change.logger)
[2017-06-27 13:06:05,883] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,883] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=38,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,883] TRACE Broker 1 handling stop replica (delete=false) for partition __consumer_offsets-38 (state.change.logger)
[2017-06-27 13:06:05,883] TRACE Broker 1 finished handling stop replica (delete=false) for partition __consumer_offsets-38 (state.change.logger)
[2017-06-27 13:06:05,883] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-38 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 22 (state.change.logger)
[2017-06-27 13:06:05,883] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=38,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,883] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,884] TRACE Controller 1 epoch 10 elected leader 2 for Offline partition [__consumer_offsets,16] (state.change.logger)
[2017-06-27 13:06:05,885] TRACE Controller 1 epoch 10 changed partition [__consumer_offsets,16] from OnlinePartition to OnlinePartition with leader 2 (state.change.logger)
[2017-06-27 13:06:05,885] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,16] (state.change.logger)
[2017-06-27 13:06:05,885] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 1 for partition [__consumer_offsets,16] (state.change.logger)
[2017-06-27 13:06:05,885] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(1, 2) for partition __consumer_offsets-16 (state.change.logger)
[2017-06-27 13:06:05,885] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=12, replicas=[0, 1, 2]) correlation id 23 from controller 1 epoch 10 for partition [__consumer_offsets,16] (state.change.logger)
[2017-06-27 13:06:05,885] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=12, replicas=[0, 1, 2]) correlation id 27 from controller 1 epoch 10 for partition [__consumer_offsets,16] (state.change.logger)
[2017-06-27 13:06:05,885] TRACE Broker 2 handling LeaderAndIsr request correlationId 23 from controller 1 epoch 10 starting the become-leader transition for partition __consumer_offsets-16 (state.change.logger)
[2017-06-27 13:06:05,885] TRACE Broker 1 handling LeaderAndIsr request correlationId 27 from controller 1 epoch 10 starting the become-follower transition for partition __consumer_offsets-16 (state.change.logger)
[2017-06-27 13:06:05,885] TRACE Broker 1 stopped fetchers as part of become-follower request from controller 1 epoch 10 with correlation id 27 for partition __consumer_offsets-16 (state.change.logger)
[2017-06-27 13:06:05,885] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 10 with correlation id 23 for partition __consumer_offsets-16 (state.change.logger)
[2017-06-27 13:06:05,885] TRACE Broker 2 completed LeaderAndIsr request correlationId 23 from controller 1 epoch 10 for the become-leader transition for partition __consumer_offsets-16 (state.change.logger)
[2017-06-27 13:06:05,885] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=16,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,886] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-16 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 24 (state.change.logger)
[2017-06-27 13:06:05,886] TRACE Broker 1 truncated logs and checkpointed recovery boundaries for partition __consumer_offsets-16 as part of become-follower request with correlation id 27 from controller 1 epoch 10 (state.change.logger)
[2017-06-27 13:06:05,886] TRACE Broker 1 skipped the adding-fetcher step of the become-follower state change with correlation id 27 from controller 1 epoch 10 for partition __consumer_offsets-16 since it is shutting down (state.change.logger)
[2017-06-27 13:06:05,886] TRACE Broker 1 completed LeaderAndIsr request correlationId 27 from controller 1 epoch 10 for the become-follower transition for partition __consumer_offsets-16 (state.change.logger)
[2017-06-27 13:06:05,886] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,886] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=16,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,886] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-16 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 28 (state.change.logger)
[2017-06-27 13:06:05,886] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,887] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,3] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-27 13:06:05,887] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,3] (state.change.logger)
[2017-06-27 13:06:05,887] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to broker 0 for partition [__consumer_offsets,3] (state.change.logger)
[2017-06-27 13:06:05,887] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to brokers Set(1, 2) for partition __consumer_offsets-3 (state.change.logger)
[2017-06-27 13:06:05,888] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=7, isr=[2], zkVersion=11, replicas=[0, 1, 2]) correlation id 25 from controller 1 epoch 10 for partition [__consumer_offsets,3] (state.change.logger)
[2017-06-27 13:06:05,888] TRACE Broker 2 handling LeaderAndIsr request correlationId 25 from controller 1 epoch 10 starting the become-leader transition for partition __consumer_offsets-3 (state.change.logger)
[2017-06-27 13:06:05,889] TRACE Broker 1 handling stop replica (delete=false) for partition __consumer_offsets-3 (state.change.logger)
[2017-06-27 13:06:05,889] TRACE Broker 1 finished handling stop replica (delete=false) for partition __consumer_offsets-3 (state.change.logger)
[2017-06-27 13:06:05,889] INFO Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 25 from controller 1 epoch 10 for partition __consumer_offsets-3 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:06:05,889] TRACE Broker 2 completed LeaderAndIsr request correlationId 25 from controller 1 epoch 10 for the become-leader transition for partition __consumer_offsets-3 (state.change.logger)
[2017-06-27 13:06:05,889] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=3,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,889] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=3,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,889] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-3 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 30 (state.change.logger)
[2017-06-27 13:06:05,889] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-3 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 26 (state.change.logger)
[2017-06-27 13:06:05,889] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,890] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,890] TRACE Broker 1 handling stop replica (delete=false) for partition __consumer_offsets-3 (state.change.logger)
[2017-06-27 13:06:05,890] TRACE Broker 1 finished handling stop replica (delete=false) for partition __consumer_offsets-3 (state.change.logger)
[2017-06-27 13:06:05,890] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=3,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,890] TRACE Broker 1 handling stop replica (delete=false) for partition __consumer_offsets-21 (state.change.logger)
[2017-06-27 13:06:05,890] TRACE Broker 1 finished handling stop replica (delete=false) for partition __consumer_offsets-21 (state.change.logger)
[2017-06-27 13:06:05,890] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=21,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,891] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,21] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-27 13:06:05,891] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,21] (state.change.logger)
[2017-06-27 13:06:05,891] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to broker 0 for partition [__consumer_offsets,21] (state.change.logger)
[2017-06-27 13:06:05,891] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to brokers Set(1, 2) for partition __consumer_offsets-21 (state.change.logger)
[2017-06-27 13:06:05,891] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=7, isr=[2], zkVersion=11, replicas=[0, 1, 2]) correlation id 27 from controller 1 epoch 10 for partition [__consumer_offsets,21] (state.change.logger)
[2017-06-27 13:06:05,891] TRACE Broker 2 handling LeaderAndIsr request correlationId 27 from controller 1 epoch 10 starting the become-leader transition for partition __consumer_offsets-21 (state.change.logger)
[2017-06-27 13:06:05,891] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,10] (state.change.logger)
[2017-06-27 13:06:05,891] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-21 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 33 (state.change.logger)
[2017-06-27 13:06:05,891] INFO Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 27 from controller 1 epoch 10 for partition __consumer_offsets-21 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:06:05,891] TRACE Broker 2 completed LeaderAndIsr request correlationId 27 from controller 1 epoch 10 for the become-leader transition for partition __consumer_offsets-21 (state.change.logger)
[2017-06-27 13:06:05,891] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,891] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=21,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,891] TRACE Broker 1 handling stop replica (delete=false) for partition __consumer_offsets-21 (state.change.logger)
[2017-06-27 13:06:05,891] TRACE Broker 1 finished handling stop replica (delete=false) for partition __consumer_offsets-21 (state.change.logger)
[2017-06-27 13:06:05,892] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=21,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,892] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-21 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 28 (state.change.logger)
[2017-06-27 13:06:05,892] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,892] TRACE Controller 1 epoch 10 elected leader 2 for Offline partition [__consumer_offsets,10] (state.change.logger)
[2017-06-27 13:06:05,893] TRACE Controller 1 epoch 10 changed partition [__consumer_offsets,10] from OnlinePartition to OnlinePartition with leader 2 (state.change.logger)
[2017-06-27 13:06:05,893] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,10] (state.change.logger)
[2017-06-27 13:06:05,893] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 1 for partition [__consumer_offsets,10] (state.change.logger)
[2017-06-27 13:06:05,893] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(1, 2) for partition __consumer_offsets-10 (state.change.logger)
[2017-06-27 13:06:05,893] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,40] (state.change.logger)
[2017-06-27 13:06:05,893] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=12, replicas=[0, 1, 2]) correlation id 29 from controller 1 epoch 10 for partition [__consumer_offsets,10] (state.change.logger)
[2017-06-27 13:06:05,893] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=12, replicas=[0, 1, 2]) correlation id 35 from controller 1 epoch 10 for partition [__consumer_offsets,10] (state.change.logger)
[2017-06-27 13:06:05,893] TRACE Broker 2 handling LeaderAndIsr request correlationId 29 from controller 1 epoch 10 starting the become-leader transition for partition __consumer_offsets-10 (state.change.logger)
[2017-06-27 13:06:05,893] TRACE Broker 1 handling LeaderAndIsr request correlationId 35 from controller 1 epoch 10 starting the become-follower transition for partition __consumer_offsets-10 (state.change.logger)
[2017-06-27 13:06:05,893] TRACE Broker 1 stopped fetchers as part of become-follower request from controller 1 epoch 10 with correlation id 35 for partition __consumer_offsets-10 (state.change.logger)
[2017-06-27 13:06:05,893] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 10 with correlation id 29 for partition __consumer_offsets-10 (state.change.logger)
[2017-06-27 13:06:05,894] TRACE Broker 2 completed LeaderAndIsr request correlationId 29 from controller 1 epoch 10 for the become-leader transition for partition __consumer_offsets-10 (state.change.logger)
[2017-06-27 13:06:05,894] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=10,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,894] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-10 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 30 (state.change.logger)
[2017-06-27 13:06:05,894] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,894] TRACE Broker 1 truncated logs and checkpointed recovery boundaries for partition __consumer_offsets-10 as part of become-follower request with correlation id 35 from controller 1 epoch 10 (state.change.logger)
[2017-06-27 13:06:05,894] TRACE Broker 1 skipped the adding-fetcher step of the become-follower state change with correlation id 35 from controller 1 epoch 10 for partition __consumer_offsets-10 since it is shutting down (state.change.logger)
[2017-06-27 13:06:05,894] TRACE Broker 1 completed LeaderAndIsr request correlationId 35 from controller 1 epoch 10 for the become-follower transition for partition __consumer_offsets-10 (state.change.logger)
[2017-06-27 13:06:05,895] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=10,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,895] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-10 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 36 (state.change.logger)
[2017-06-27 13:06:05,895] TRACE Controller 1 epoch 10 elected leader 2 for Offline partition [__consumer_offsets,40] (state.change.logger)
[2017-06-27 13:06:05,895] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,896] TRACE Controller 1 epoch 10 changed partition [__consumer_offsets,40] from OnlinePartition to OnlinePartition with leader 2 (state.change.logger)
[2017-06-27 13:06:05,896] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,40] (state.change.logger)
[2017-06-27 13:06:05,896] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 1 for partition [__consumer_offsets,40] (state.change.logger)
[2017-06-27 13:06:05,896] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(1, 2) for partition __consumer_offsets-40 (state.change.logger)
[2017-06-27 13:06:05,896] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,34] (state.change.logger)
[2017-06-27 13:06:05,896] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=12, replicas=[0, 1, 2]) correlation id 31 from controller 1 epoch 10 for partition [__consumer_offsets,40] (state.change.logger)
[2017-06-27 13:06:05,896] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=12, replicas=[0, 1, 2]) correlation id 37 from controller 1 epoch 10 for partition [__consumer_offsets,40] (state.change.logger)
[2017-06-27 13:06:05,896] TRACE Broker 1 handling LeaderAndIsr request correlationId 37 from controller 1 epoch 10 starting the become-follower transition for partition __consumer_offsets-40 (state.change.logger)
[2017-06-27 13:06:05,896] TRACE Broker 2 handling LeaderAndIsr request correlationId 31 from controller 1 epoch 10 starting the become-leader transition for partition __consumer_offsets-40 (state.change.logger)
[2017-06-27 13:06:05,896] TRACE Broker 1 stopped fetchers as part of become-follower request from controller 1 epoch 10 with correlation id 37 for partition __consumer_offsets-40 (state.change.logger)
[2017-06-27 13:06:05,896] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 10 with correlation id 31 for partition __consumer_offsets-40 (state.change.logger)
[2017-06-27 13:06:05,896] TRACE Broker 2 completed LeaderAndIsr request correlationId 31 from controller 1 epoch 10 for the become-leader transition for partition __consumer_offsets-40 (state.change.logger)
[2017-06-27 13:06:05,897] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=40,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,897] TRACE Broker 1 truncated logs and checkpointed recovery boundaries for partition __consumer_offsets-40 as part of become-follower request with correlation id 37 from controller 1 epoch 10 (state.change.logger)
[2017-06-27 13:06:05,897] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-40 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 32 (state.change.logger)
[2017-06-27 13:06:05,897] TRACE Broker 1 skipped the adding-fetcher step of the become-follower state change with correlation id 37 from controller 1 epoch 10 for partition __consumer_offsets-40 since it is shutting down (state.change.logger)
[2017-06-27 13:06:05,897] TRACE Broker 1 completed LeaderAndIsr request correlationId 37 from controller 1 epoch 10 for the become-follower transition for partition __consumer_offsets-40 (state.change.logger)
[2017-06-27 13:06:05,897] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,897] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=40,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,897] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-40 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 38 (state.change.logger)
[2017-06-27 13:06:05,898] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,898] TRACE Controller 1 epoch 10 elected leader 2 for Offline partition [__consumer_offsets,34] (state.change.logger)
[2017-06-27 13:06:05,898] TRACE Controller 1 epoch 10 changed partition [__consumer_offsets,34] from OnlinePartition to OnlinePartition with leader 2 (state.change.logger)
[2017-06-27 13:06:05,898] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,34] (state.change.logger)
[2017-06-27 13:06:05,899] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 1 for partition [__consumer_offsets,34] (state.change.logger)
[2017-06-27 13:06:05,899] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(1, 2) for partition __consumer_offsets-34 (state.change.logger)
[2017-06-27 13:06:05,899] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=12, replicas=[0, 1, 2]) correlation id 33 from controller 1 epoch 10 for partition [__consumer_offsets,34] (state.change.logger)
[2017-06-27 13:06:05,899] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,25] (state.change.logger)
[2017-06-27 13:06:05,899] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=12, replicas=[0, 1, 2]) correlation id 39 from controller 1 epoch 10 for partition [__consumer_offsets,34] (state.change.logger)
[2017-06-27 13:06:05,899] TRACE Broker 2 handling LeaderAndIsr request correlationId 33 from controller 1 epoch 10 starting the become-leader transition for partition __consumer_offsets-34 (state.change.logger)
[2017-06-27 13:06:05,899] TRACE Broker 1 handling LeaderAndIsr request correlationId 39 from controller 1 epoch 10 starting the become-follower transition for partition __consumer_offsets-34 (state.change.logger)
[2017-06-27 13:06:05,899] TRACE Broker 1 stopped fetchers as part of become-follower request from controller 1 epoch 10 with correlation id 39 for partition __consumer_offsets-34 (state.change.logger)
[2017-06-27 13:06:05,899] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 10 with correlation id 33 for partition __consumer_offsets-34 (state.change.logger)
[2017-06-27 13:06:05,899] TRACE Broker 2 completed LeaderAndIsr request correlationId 33 from controller 1 epoch 10 for the become-leader transition for partition __consumer_offsets-34 (state.change.logger)
[2017-06-27 13:06:05,899] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=34,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,900] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-34 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 34 (state.change.logger)
[2017-06-27 13:06:05,900] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,900] TRACE Broker 1 truncated logs and checkpointed recovery boundaries for partition __consumer_offsets-34 as part of become-follower request with correlation id 39 from controller 1 epoch 10 (state.change.logger)
[2017-06-27 13:06:05,900] TRACE Broker 1 skipped the adding-fetcher step of the become-follower state change with correlation id 39 from controller 1 epoch 10 for partition __consumer_offsets-34 since it is shutting down (state.change.logger)
[2017-06-27 13:06:05,900] TRACE Broker 1 completed LeaderAndIsr request correlationId 39 from controller 1 epoch 10 for the become-follower transition for partition __consumer_offsets-34 (state.change.logger)
[2017-06-27 13:06:05,900] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=34,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,900] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-34 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 40 (state.change.logger)
[2017-06-27 13:06:05,901] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,901] TRACE Controller 1 epoch 10 elected leader 2 for Offline partition [__consumer_offsets,25] (state.change.logger)
[2017-06-27 13:06:05,901] TRACE Controller 1 epoch 10 changed partition [__consumer_offsets,25] from OnlinePartition to OnlinePartition with leader 2 (state.change.logger)
[2017-06-27 13:06:05,901] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,25] (state.change.logger)
[2017-06-27 13:06:05,901] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 1 for partition [__consumer_offsets,25] (state.change.logger)
[2017-06-27 13:06:05,901] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(1, 2) for partition __consumer_offsets-25 (state.change.logger)
[2017-06-27 13:06:05,902] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=12, replicas=[0, 1, 2]) correlation id 35 from controller 1 epoch 10 for partition [__consumer_offsets,25] (state.change.logger)
[2017-06-27 13:06:05,902] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=12, replicas=[0, 1, 2]) correlation id 41 from controller 1 epoch 10 for partition [__consumer_offsets,25] (state.change.logger)
[2017-06-27 13:06:05,902] TRACE Broker 2 handling LeaderAndIsr request correlationId 35 from controller 1 epoch 10 starting the become-leader transition for partition __consumer_offsets-25 (state.change.logger)
[2017-06-27 13:06:05,902] TRACE Broker 1 handling LeaderAndIsr request correlationId 41 from controller 1 epoch 10 starting the become-follower transition for partition __consumer_offsets-25 (state.change.logger)
[2017-06-27 13:06:05,902] TRACE Broker 1 stopped fetchers as part of become-follower request from controller 1 epoch 10 with correlation id 41 for partition __consumer_offsets-25 (state.change.logger)
[2017-06-27 13:06:05,902] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 10 with correlation id 35 for partition __consumer_offsets-25 (state.change.logger)
[2017-06-27 13:06:05,902] TRACE Broker 2 completed LeaderAndIsr request correlationId 35 from controller 1 epoch 10 for the become-leader transition for partition __consumer_offsets-25 (state.change.logger)
[2017-06-27 13:06:05,902] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=25,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,902] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-25 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 36 (state.change.logger)
[2017-06-27 13:06:05,903] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,903] TRACE Broker 1 truncated logs and checkpointed recovery boundaries for partition __consumer_offsets-25 as part of become-follower request with correlation id 41 from controller 1 epoch 10 (state.change.logger)
[2017-06-27 13:06:05,903] TRACE Broker 1 skipped the adding-fetcher step of the become-follower state change with correlation id 41 from controller 1 epoch 10 for partition __consumer_offsets-25 since it is shutting down (state.change.logger)
[2017-06-27 13:06:05,903] TRACE Broker 1 completed LeaderAndIsr request correlationId 41 from controller 1 epoch 10 for the become-follower transition for partition __consumer_offsets-25 (state.change.logger)
[2017-06-27 13:06:05,903] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=25,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,903] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-25 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 42 (state.change.logger)
[2017-06-27 13:06:05,903] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,904] TRACE Broker 1 handling stop replica (delete=false) for partition __consumer_offsets-27 (state.change.logger)
[2017-06-27 13:06:05,904] TRACE Broker 1 finished handling stop replica (delete=false) for partition __consumer_offsets-27 (state.change.logger)
[2017-06-27 13:06:05,904] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,27] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-27 13:06:05,904] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,27] (state.change.logger)
[2017-06-27 13:06:05,904] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to broker 0 for partition [__consumer_offsets,27] (state.change.logger)
[2017-06-27 13:06:05,904] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=27,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,904] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to brokers Set(1, 2) for partition __consumer_offsets-27 (state.change.logger)
[2017-06-27 13:06:05,904] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=7, isr=[2], zkVersion=11, replicas=[0, 1, 2]) correlation id 37 from controller 1 epoch 10 for partition [__consumer_offsets,27] (state.change.logger)
[2017-06-27 13:06:05,904] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,42] (state.change.logger)
[2017-06-27 13:06:05,905] TRACE Broker 2 handling LeaderAndIsr request correlationId 37 from controller 1 epoch 10 starting the become-leader transition for partition __consumer_offsets-27 (state.change.logger)
[2017-06-27 13:06:05,905] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-27 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 44 (state.change.logger)
[2017-06-27 13:06:05,905] INFO Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 37 from controller 1 epoch 10 for partition __consumer_offsets-27 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:06:05,905] TRACE Broker 2 completed LeaderAndIsr request correlationId 37 from controller 1 epoch 10 for the become-leader transition for partition __consumer_offsets-27 (state.change.logger)
[2017-06-27 13:06:05,905] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,906] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=27,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,906] TRACE Broker 1 handling stop replica (delete=false) for partition __consumer_offsets-27 (state.change.logger)
[2017-06-27 13:06:05,906] TRACE Broker 1 finished handling stop replica (delete=false) for partition __consumer_offsets-27 (state.change.logger)
[2017-06-27 13:06:05,906] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-27 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 38 (state.change.logger)
[2017-06-27 13:06:05,907] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=27,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,907] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,908] TRACE Controller 1 epoch 10 elected leader 2 for Offline partition [__consumer_offsets,42] (state.change.logger)
[2017-06-27 13:06:05,909] TRACE Controller 1 epoch 10 changed partition [__consumer_offsets,42] from OnlinePartition to OnlinePartition with leader 2 (state.change.logger)
[2017-06-27 13:06:05,909] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,42] (state.change.logger)
[2017-06-27 13:06:05,909] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to broker 1 for partition [__consumer_offsets,42] (state.change.logger)
[2017-06-27 13:06:05,909] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to brokers Set(1, 2) for partition __consumer_offsets-42 (state.change.logger)
[2017-06-27 13:06:05,909] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=7, isr=[2], zkVersion=11, replicas=[0, 1, 2]) correlation id 39 from controller 1 epoch 10 for partition [__consumer_offsets,42] (state.change.logger)
[2017-06-27 13:06:05,909] TRACE Broker 2 handling LeaderAndIsr request correlationId 39 from controller 1 epoch 10 starting the become-leader transition for partition __consumer_offsets-42 (state.change.logger)
[2017-06-27 13:06:05,909] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=7, isr=[2], zkVersion=11, replicas=[0, 1, 2]) correlation id 46 from controller 1 epoch 10 for partition [__consumer_offsets,42] (state.change.logger)
[2017-06-27 13:06:05,909] TRACE Broker 1 handling LeaderAndIsr request correlationId 46 from controller 1 epoch 10 starting the become-follower transition for partition __consumer_offsets-42 (state.change.logger)
[2017-06-27 13:06:05,910] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 10 with correlation id 39 for partition __consumer_offsets-42 (state.change.logger)
[2017-06-27 13:06:05,910] TRACE Broker 2 completed LeaderAndIsr request correlationId 39 from controller 1 epoch 10 for the become-leader transition for partition __consumer_offsets-42 (state.change.logger)
[2017-06-27 13:06:05,910] TRACE Broker 1 stopped fetchers as part of become-follower request from controller 1 epoch 10 with correlation id 46 for partition __consumer_offsets-42 (state.change.logger)
[2017-06-27 13:06:05,910] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=42,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,910] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-42 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 40 (state.change.logger)
[2017-06-27 13:06:05,911] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,912] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,11] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-27 13:06:05,912] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,11] (state.change.logger)
[2017-06-27 13:06:05,913] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10) to broker 0 for partition [__consumer_offsets,11] (state.change.logger)
[2017-06-27 13:06:05,913] TRACE Broker 1 truncated logs and checkpointed recovery boundaries for partition __consumer_offsets-42 as part of become-follower request with correlation id 46 from controller 1 epoch 10 (state.change.logger)
[2017-06-27 13:06:05,913] TRACE Broker 1 skipped the adding-fetcher step of the become-follower state change with correlation id 46 from controller 1 epoch 10 for partition __consumer_offsets-42 since it is shutting down (state.change.logger)
[2017-06-27 13:06:05,913] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10) to brokers Set(1, 2) for partition __consumer_offsets-11 (state.change.logger)
[2017-06-27 13:06:05,913] TRACE Broker 1 completed LeaderAndIsr request correlationId 46 from controller 1 epoch 10 for the become-follower transition for partition __consumer_offsets-42 (state.change.logger)
[2017-06-27 13:06:05,913] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=10, isr=[2], zkVersion=15, replicas=[0, 1, 2]) correlation id 41 from controller 1 epoch 10 for partition [__consumer_offsets,11] (state.change.logger)
[2017-06-27 13:06:05,913] TRACE Broker 2 handling LeaderAndIsr request correlationId 41 from controller 1 epoch 10 starting the become-leader transition for partition __consumer_offsets-11 (state.change.logger)
[2017-06-27 13:06:05,913] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,7] (state.change.logger)
[2017-06-27 13:06:05,913] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=42,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,913] INFO Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 41 from controller 1 epoch 10 for partition __consumer_offsets-11 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:06:05,913] TRACE Broker 2 completed LeaderAndIsr request correlationId 41 from controller 1 epoch 10 for the become-leader transition for partition __consumer_offsets-11 (state.change.logger)
[2017-06-27 13:06:05,913] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-42 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 47 (state.change.logger)
[2017-06-27 13:06:05,913] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=11,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,913] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,914] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-11 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 42 (state.change.logger)
[2017-06-27 13:06:05,914] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,914] TRACE Broker 1 handling stop replica (delete=false) for partition __consumer_offsets-11 (state.change.logger)
[2017-06-27 13:06:05,914] TRACE Broker 1 finished handling stop replica (delete=false) for partition __consumer_offsets-11 (state.change.logger)
[2017-06-27 13:06:05,914] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=11,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,914] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-11 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 49 (state.change.logger)
[2017-06-27 13:06:05,914] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,915] TRACE Broker 1 handling stop replica (delete=false) for partition __consumer_offsets-11 (state.change.logger)
[2017-06-27 13:06:05,915] TRACE Broker 1 finished handling stop replica (delete=false) for partition __consumer_offsets-11 (state.change.logger)
[2017-06-27 13:06:05,915] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=11,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,915] TRACE Controller 1 epoch 10 elected leader 2 for Offline partition [__consumer_offsets,7] (state.change.logger)
[2017-06-27 13:06:05,915] TRACE Controller 1 epoch 10 changed partition [__consumer_offsets,7] from OnlinePartition to OnlinePartition with leader 2 (state.change.logger)
[2017-06-27 13:06:05,915] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,7] (state.change.logger)
[2017-06-27 13:06:05,916] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 1 for partition [__consumer_offsets,7] (state.change.logger)
[2017-06-27 13:06:05,916] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(1, 2) for partition __consumer_offsets-7 (state.change.logger)
[2017-06-27 13:06:05,916] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=12, replicas=[0, 1, 2]) correlation id 51 from controller 1 epoch 10 for partition [__consumer_offsets,7] (state.change.logger)
[2017-06-27 13:06:05,916] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=12, replicas=[0, 1, 2]) correlation id 43 from controller 1 epoch 10 for partition [__consumer_offsets,7] (state.change.logger)
[2017-06-27 13:06:05,916] TRACE Broker 1 handling LeaderAndIsr request correlationId 51 from controller 1 epoch 10 starting the become-follower transition for partition __consumer_offsets-7 (state.change.logger)
[2017-06-27 13:06:05,916] TRACE Broker 2 handling LeaderAndIsr request correlationId 43 from controller 1 epoch 10 starting the become-leader transition for partition __consumer_offsets-7 (state.change.logger)
[2017-06-27 13:06:05,916] TRACE Broker 1 stopped fetchers as part of become-follower request from controller 1 epoch 10 with correlation id 51 for partition __consumer_offsets-7 (state.change.logger)
[2017-06-27 13:06:05,916] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 10 with correlation id 43 for partition __consumer_offsets-7 (state.change.logger)
[2017-06-27 13:06:05,916] TRACE Broker 2 completed LeaderAndIsr request correlationId 43 from controller 1 epoch 10 for the become-leader transition for partition __consumer_offsets-7 (state.change.logger)
[2017-06-27 13:06:05,916] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=7,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,917] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-7 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 44 (state.change.logger)
[2017-06-27 13:06:05,917] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,917] TRACE Broker 1 truncated logs and checkpointed recovery boundaries for partition __consumer_offsets-7 as part of become-follower request with correlation id 51 from controller 1 epoch 10 (state.change.logger)
[2017-06-27 13:06:05,917] TRACE Broker 1 skipped the adding-fetcher step of the become-follower state change with correlation id 51 from controller 1 epoch 10 for partition __consumer_offsets-7 since it is shutting down (state.change.logger)
[2017-06-27 13:06:05,917] TRACE Broker 1 completed LeaderAndIsr request correlationId 51 from controller 1 epoch 10 for the become-follower transition for partition __consumer_offsets-7 (state.change.logger)
[2017-06-27 13:06:05,917] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=7,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,918] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-7 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 52 (state.change.logger)
[2017-06-27 13:06:05,918] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,918] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,47] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-27 13:06:05,918] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,47] (state.change.logger)
[2017-06-27 13:06:05,918] TRACE Broker 1 handling stop replica (delete=false) for partition __consumer_offsets-47 (state.change.logger)
[2017-06-27 13:06:05,918] TRACE Broker 1 finished handling stop replica (delete=false) for partition __consumer_offsets-47 (state.change.logger)
[2017-06-27 13:06:05,918] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10) to broker 0 for partition [__consumer_offsets,47] (state.change.logger)
[2017-06-27 13:06:05,918] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10) to brokers Set(1, 2) for partition __consumer_offsets-47 (state.change.logger)
[2017-06-27 13:06:05,918] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=47,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,919] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-47 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 54 (state.change.logger)
[2017-06-27 13:06:05,919] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=10, isr=[2], zkVersion=15, replicas=[0, 1, 2]) correlation id 45 from controller 1 epoch 10 for partition [__consumer_offsets,47] (state.change.logger)
[2017-06-27 13:06:05,919] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,919] TRACE Broker 2 handling LeaderAndIsr request correlationId 45 from controller 1 epoch 10 starting the become-leader transition for partition __consumer_offsets-47 (state.change.logger)
[2017-06-27 13:06:05,919] INFO Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 45 from controller 1 epoch 10 for partition __consumer_offsets-47 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:06:05,919] TRACE Broker 2 completed LeaderAndIsr request correlationId 45 from controller 1 epoch 10 for the become-leader transition for partition __consumer_offsets-47 (state.change.logger)
[2017-06-27 13:06:05,919] TRACE Broker 1 handling stop replica (delete=false) for partition __consumer_offsets-47 (state.change.logger)
[2017-06-27 13:06:05,919] TRACE Broker 1 finished handling stop replica (delete=false) for partition __consumer_offsets-47 (state.change.logger)
[2017-06-27 13:06:05,919] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=47,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,919] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=47,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,920] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-47 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 46 (state.change.logger)
[2017-06-27 13:06:05,920] TRACE Broker 1 handling stop replica (delete=false) for partition __consumer_offsets-9 (state.change.logger)
[2017-06-27 13:06:05,920] TRACE Broker 1 finished handling stop replica (delete=false) for partition __consumer_offsets-9 (state.change.logger)
[2017-06-27 13:06:05,920] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,920] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=9,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,922] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,9] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-27 13:06:05,922] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,9] (state.change.logger)
[2017-06-27 13:06:05,923] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to broker 0 for partition [__consumer_offsets,9] (state.change.logger)
[2017-06-27 13:06:05,923] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to brokers Set(1, 2) for partition __consumer_offsets-9 (state.change.logger)
[2017-06-27 13:06:05,923] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=7, isr=[2], zkVersion=11, replicas=[0, 1, 2]) correlation id 47 from controller 1 epoch 10 for partition [__consumer_offsets,9] (state.change.logger)
[2017-06-27 13:06:05,923] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,13] (state.change.logger)
[2017-06-27 13:06:05,923] TRACE Broker 2 handling LeaderAndIsr request correlationId 47 from controller 1 epoch 10 starting the become-leader transition for partition __consumer_offsets-9 (state.change.logger)
[2017-06-27 13:06:05,923] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-9 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 57 (state.change.logger)
[2017-06-27 13:06:05,923] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,923] INFO Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 47 from controller 1 epoch 10 for partition __consumer_offsets-9 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:06:05,923] TRACE Broker 2 completed LeaderAndIsr request correlationId 47 from controller 1 epoch 10 for the become-leader transition for partition __consumer_offsets-9 (state.change.logger)
[2017-06-27 13:06:05,923] TRACE Broker 1 handling stop replica (delete=false) for partition __consumer_offsets-9 (state.change.logger)
[2017-06-27 13:06:05,923] TRACE Broker 1 finished handling stop replica (delete=false) for partition __consumer_offsets-9 (state.change.logger)
[2017-06-27 13:06:05,924] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=9,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,924] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=9,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,924] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-9 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 48 (state.change.logger)
[2017-06-27 13:06:05,924] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,925] TRACE Controller 1 epoch 10 elected leader 2 for Offline partition [__consumer_offsets,13] (state.change.logger)
[2017-06-27 13:06:05,926] TRACE Controller 1 epoch 10 changed partition [__consumer_offsets,13] from OnlinePartition to OnlinePartition with leader 2 (state.change.logger)
[2017-06-27 13:06:05,926] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,13] (state.change.logger)
[2017-06-27 13:06:05,926] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 1 for partition [__consumer_offsets,13] (state.change.logger)
[2017-06-27 13:06:05,926] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(1, 2) for partition __consumer_offsets-13 (state.change.logger)
[2017-06-27 13:06:05,926] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=15, replicas=[0, 1, 2]) correlation id 49 from controller 1 epoch 10 for partition [__consumer_offsets,13] (state.change.logger)
[2017-06-27 13:06:05,926] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=15, replicas=[0, 1, 2]) correlation id 59 from controller 1 epoch 10 for partition [__consumer_offsets,13] (state.change.logger)
[2017-06-27 13:06:05,926] TRACE Broker 2 handling LeaderAndIsr request correlationId 49 from controller 1 epoch 10 starting the become-leader transition for partition __consumer_offsets-13 (state.change.logger)
[2017-06-27 13:06:05,926] TRACE Broker 1 handling LeaderAndIsr request correlationId 59 from controller 1 epoch 10 starting the become-follower transition for partition __consumer_offsets-13 (state.change.logger)
[2017-06-27 13:06:05,926] TRACE Broker 1 stopped fetchers as part of become-follower request from controller 1 epoch 10 with correlation id 59 for partition __consumer_offsets-13 (state.change.logger)
[2017-06-27 13:06:05,926] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 10 with correlation id 49 for partition __consumer_offsets-13 (state.change.logger)
[2017-06-27 13:06:05,926] TRACE Broker 2 completed LeaderAndIsr request correlationId 49 from controller 1 epoch 10 for the become-leader transition for partition __consumer_offsets-13 (state.change.logger)
[2017-06-27 13:06:05,927] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=13,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,927] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-13 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 50 (state.change.logger)
[2017-06-27 13:06:05,927] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,927] TRACE Broker 1 truncated logs and checkpointed recovery boundaries for partition __consumer_offsets-13 as part of become-follower request with correlation id 59 from controller 1 epoch 10 (state.change.logger)
[2017-06-27 13:06:05,927] TRACE Broker 1 skipped the adding-fetcher step of the become-follower state change with correlation id 59 from controller 1 epoch 10 for partition __consumer_offsets-13 since it is shutting down (state.change.logger)
[2017-06-27 13:06:05,927] TRACE Broker 1 completed LeaderAndIsr request correlationId 59 from controller 1 epoch 10 for the become-follower transition for partition __consumer_offsets-13 (state.change.logger)
[2017-06-27 13:06:05,927] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=13,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,928] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-13 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 60 (state.change.logger)
[2017-06-27 13:06:05,928] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,928] TRACE Broker 1 handling stop replica (delete=false) for partition __consumer_offsets-29 (state.change.logger)
[2017-06-27 13:06:05,928] TRACE Broker 1 finished handling stop replica (delete=false) for partition __consumer_offsets-29 (state.change.logger)
[2017-06-27 13:06:05,928] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,29] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-27 13:06:05,928] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,29] (state.change.logger)
[2017-06-27 13:06:05,928] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=29,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,928] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10) to broker 0 for partition [__consumer_offsets,29] (state.change.logger)
[2017-06-27 13:06:05,928] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10) to brokers Set(1, 2) for partition __consumer_offsets-29 (state.change.logger)
[2017-06-27 13:06:05,928] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=10, isr=[2], zkVersion=15, replicas=[0, 1, 2]) correlation id 51 from controller 1 epoch 10 for partition [__consumer_offsets,29] (state.change.logger)
[2017-06-27 13:06:05,929] TRACE Broker 2 handling LeaderAndIsr request correlationId 51 from controller 1 epoch 10 starting the become-leader transition for partition __consumer_offsets-29 (state.change.logger)
[2017-06-27 13:06:05,929] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-29 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 62 (state.change.logger)
[2017-06-27 13:06:05,929] INFO Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 51 from controller 1 epoch 10 for partition __consumer_offsets-29 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:06:05,929] TRACE Broker 2 completed LeaderAndIsr request correlationId 51 from controller 1 epoch 10 for the become-leader transition for partition __consumer_offsets-29 (state.change.logger)
[2017-06-27 13:06:05,929] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,929] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=29,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,929] TRACE Broker 1 handling stop replica (delete=false) for partition __consumer_offsets-29 (state.change.logger)
[2017-06-27 13:06:05,929] TRACE Broker 1 finished handling stop replica (delete=false) for partition __consumer_offsets-29 (state.change.logger)
[2017-06-27 13:06:05,929] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=29,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,929] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-29 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 52 (state.change.logger)
[2017-06-27 13:06:05,929] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,929] TRACE Broker 1 handling stop replica (delete=false) for partition __consumer_offsets-8 (state.change.logger)
[2017-06-27 13:06:05,929] TRACE Broker 1 finished handling stop replica (delete=false) for partition __consumer_offsets-8 (state.change.logger)
[2017-06-27 13:06:05,930] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=8,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,932] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,8] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-27 13:06:05,933] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,8] (state.change.logger)
[2017-06-27 13:06:05,933] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 0 for partition [__consumer_offsets,8] (state.change.logger)
[2017-06-27 13:06:05,933] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(1, 2) for partition __consumer_offsets-8 (state.change.logger)
[2017-06-27 13:06:05,933] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=14, replicas=[0, 1, 2]) correlation id 53 from controller 1 epoch 10 for partition [__consumer_offsets,8] (state.change.logger)
[2017-06-27 13:06:05,933] TRACE Broker 2 handling LeaderAndIsr request correlationId 53 from controller 1 epoch 10 starting the become-leader transition for partition __consumer_offsets-8 (state.change.logger)
[2017-06-27 13:06:05,933] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,22] (state.change.logger)
[2017-06-27 13:06:05,933] INFO Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 53 from controller 1 epoch 10 for partition __consumer_offsets-8 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:06:05,933] TRACE Broker 2 completed LeaderAndIsr request correlationId 53 from controller 1 epoch 10 for the become-leader transition for partition __consumer_offsets-8 (state.change.logger)
[2017-06-27 13:06:05,933] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-8 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 65 (state.change.logger)
[2017-06-27 13:06:05,933] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,933] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=8,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,933] TRACE Broker 1 handling stop replica (delete=false) for partition __consumer_offsets-8 (state.change.logger)
[2017-06-27 13:06:05,933] TRACE Broker 1 finished handling stop replica (delete=false) for partition __consumer_offsets-8 (state.change.logger)
[2017-06-27 13:06:05,934] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-8 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 54 (state.change.logger)
[2017-06-27 13:06:05,934] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=8,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,934] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,936] TRACE Controller 1 epoch 10 elected leader 2 for Offline partition [__consumer_offsets,22] (state.change.logger)
[2017-06-27 13:06:05,937] TRACE Controller 1 epoch 10 changed partition [__consumer_offsets,22] from OnlinePartition to OnlinePartition with leader 2 (state.change.logger)
[2017-06-27 13:06:05,937] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,22] (state.change.logger)
[2017-06-27 13:06:05,937] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 1 for partition [__consumer_offsets,22] (state.change.logger)
[2017-06-27 13:06:05,937] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(1, 2) for partition __consumer_offsets-22 (state.change.logger)
[2017-06-27 13:06:05,937] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,31] (state.change.logger)
[2017-06-27 13:06:05,937] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=14, replicas=[0, 1, 2]) correlation id 55 from controller 1 epoch 10 for partition [__consumer_offsets,22] (state.change.logger)
[2017-06-27 13:06:05,937] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=14, replicas=[0, 1, 2]) correlation id 67 from controller 1 epoch 10 for partition [__consumer_offsets,22] (state.change.logger)
[2017-06-27 13:06:05,937] TRACE Broker 2 handling LeaderAndIsr request correlationId 55 from controller 1 epoch 10 starting the become-leader transition for partition __consumer_offsets-22 (state.change.logger)
[2017-06-27 13:06:05,937] TRACE Broker 1 handling LeaderAndIsr request correlationId 67 from controller 1 epoch 10 starting the become-follower transition for partition __consumer_offsets-22 (state.change.logger)
[2017-06-27 13:06:05,938] TRACE Broker 1 stopped fetchers as part of become-follower request from controller 1 epoch 10 with correlation id 67 for partition __consumer_offsets-22 (state.change.logger)
[2017-06-27 13:06:05,938] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 10 with correlation id 55 for partition __consumer_offsets-22 (state.change.logger)
[2017-06-27 13:06:05,938] TRACE Broker 2 completed LeaderAndIsr request correlationId 55 from controller 1 epoch 10 for the become-leader transition for partition __consumer_offsets-22 (state.change.logger)
[2017-06-27 13:06:05,939] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=22,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,939] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-22 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 56 (state.change.logger)
[2017-06-27 13:06:05,939] TRACE Broker 1 truncated logs and checkpointed recovery boundaries for partition __consumer_offsets-22 as part of become-follower request with correlation id 67 from controller 1 epoch 10 (state.change.logger)
[2017-06-27 13:06:05,939] TRACE Broker 1 skipped the adding-fetcher step of the become-follower state change with correlation id 67 from controller 1 epoch 10 for partition __consumer_offsets-22 since it is shutting down (state.change.logger)
[2017-06-27 13:06:05,939] TRACE Broker 1 completed LeaderAndIsr request correlationId 67 from controller 1 epoch 10 for the become-follower transition for partition __consumer_offsets-22 (state.change.logger)
[2017-06-27 13:06:05,939] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,939] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=22,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,939] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-22 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 68 (state.change.logger)
[2017-06-27 13:06:05,940] TRACE Controller 1 epoch 10 elected leader 2 for Offline partition [__consumer_offsets,31] (state.change.logger)
[2017-06-27 13:06:05,940] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,940] TRACE Controller 1 epoch 10 changed partition [__consumer_offsets,31] from OnlinePartition to OnlinePartition with leader 2 (state.change.logger)
[2017-06-27 13:06:05,940] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,31] (state.change.logger)
[2017-06-27 13:06:05,940] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 1 for partition [__consumer_offsets,31] (state.change.logger)
[2017-06-27 13:06:05,940] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(1, 2) for partition __consumer_offsets-31 (state.change.logger)
[2017-06-27 13:06:05,940] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,18] (state.change.logger)
[2017-06-27 13:06:05,940] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=12, replicas=[0, 1, 2]) correlation id 57 from controller 1 epoch 10 for partition [__consumer_offsets,31] (state.change.logger)
[2017-06-27 13:06:05,940] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=12, replicas=[0, 1, 2]) correlation id 69 from controller 1 epoch 10 for partition [__consumer_offsets,31] (state.change.logger)
[2017-06-27 13:06:05,941] TRACE Broker 2 handling LeaderAndIsr request correlationId 57 from controller 1 epoch 10 starting the become-leader transition for partition __consumer_offsets-31 (state.change.logger)
[2017-06-27 13:06:05,941] TRACE Broker 1 handling LeaderAndIsr request correlationId 69 from controller 1 epoch 10 starting the become-follower transition for partition __consumer_offsets-31 (state.change.logger)
[2017-06-27 13:06:05,941] TRACE Broker 1 stopped fetchers as part of become-follower request from controller 1 epoch 10 with correlation id 69 for partition __consumer_offsets-31 (state.change.logger)
[2017-06-27 13:06:05,941] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 10 with correlation id 57 for partition __consumer_offsets-31 (state.change.logger)
[2017-06-27 13:06:05,941] TRACE Broker 2 completed LeaderAndIsr request correlationId 57 from controller 1 epoch 10 for the become-leader transition for partition __consumer_offsets-31 (state.change.logger)
[2017-06-27 13:06:05,941] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=31,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,941] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-31 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 58 (state.change.logger)
[2017-06-27 13:06:05,941] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,941] TRACE Broker 1 truncated logs and checkpointed recovery boundaries for partition __consumer_offsets-31 as part of become-follower request with correlation id 69 from controller 1 epoch 10 (state.change.logger)
[2017-06-27 13:06:05,942] TRACE Broker 1 skipped the adding-fetcher step of the become-follower state change with correlation id 69 from controller 1 epoch 10 for partition __consumer_offsets-31 since it is shutting down (state.change.logger)
[2017-06-27 13:06:05,942] TRACE Broker 1 completed LeaderAndIsr request correlationId 69 from controller 1 epoch 10 for the become-follower transition for partition __consumer_offsets-31 (state.change.logger)
[2017-06-27 13:06:05,942] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=31,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,942] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-31 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 70 (state.change.logger)
[2017-06-27 13:06:05,942] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,942] TRACE Controller 1 epoch 10 elected leader 2 for Offline partition [__consumer_offsets,18] (state.change.logger)
[2017-06-27 13:06:05,943] TRACE Controller 1 epoch 10 changed partition [__consumer_offsets,18] from OnlinePartition to OnlinePartition with leader 2 (state.change.logger)
[2017-06-27 13:06:05,943] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,18] (state.change.logger)
[2017-06-27 13:06:05,943] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to broker 1 for partition [__consumer_offsets,18] (state.change.logger)
[2017-06-27 13:06:05,943] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to brokers Set(1, 2) for partition __consumer_offsets-18 (state.change.logger)
[2017-06-27 13:06:05,943] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=7, isr=[2], zkVersion=11, replicas=[0, 1, 2]) correlation id 71 from controller 1 epoch 10 for partition [__consumer_offsets,18] (state.change.logger)
[2017-06-27 13:06:05,943] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=7, isr=[2], zkVersion=11, replicas=[0, 1, 2]) correlation id 59 from controller 1 epoch 10 for partition [__consumer_offsets,18] (state.change.logger)
[2017-06-27 13:06:05,943] TRACE Broker 1 handling LeaderAndIsr request correlationId 71 from controller 1 epoch 10 starting the become-follower transition for partition __consumer_offsets-18 (state.change.logger)
[2017-06-27 13:06:05,943] TRACE Broker 2 handling LeaderAndIsr request correlationId 59 from controller 1 epoch 10 starting the become-leader transition for partition __consumer_offsets-18 (state.change.logger)
[2017-06-27 13:06:05,943] TRACE Broker 1 stopped fetchers as part of become-follower request from controller 1 epoch 10 with correlation id 71 for partition __consumer_offsets-18 (state.change.logger)
[2017-06-27 13:06:05,944] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 10 with correlation id 59 for partition __consumer_offsets-18 (state.change.logger)
[2017-06-27 13:06:05,944] TRACE Broker 2 completed LeaderAndIsr request correlationId 59 from controller 1 epoch 10 for the become-leader transition for partition __consumer_offsets-18 (state.change.logger)
[2017-06-27 13:06:05,944] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=18,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,944] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-18 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 60 (state.change.logger)
[2017-06-27 13:06:05,944] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,945] TRACE Broker 1 truncated logs and checkpointed recovery boundaries for partition __consumer_offsets-18 as part of become-follower request with correlation id 71 from controller 1 epoch 10 (state.change.logger)
[2017-06-27 13:06:05,945] TRACE Broker 1 skipped the adding-fetcher step of the become-follower state change with correlation id 71 from controller 1 epoch 10 for partition __consumer_offsets-18 since it is shutting down (state.change.logger)
[2017-06-27 13:06:05,945] TRACE Broker 1 completed LeaderAndIsr request correlationId 71 from controller 1 epoch 10 for the become-follower transition for partition __consumer_offsets-18 (state.change.logger)
[2017-06-27 13:06:05,945] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,20] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-27 13:06:05,945] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,20] (state.change.logger)
[2017-06-27 13:06:05,945] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 0 for partition [__consumer_offsets,20] (state.change.logger)
[2017-06-27 13:06:05,945] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=18,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,945] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(1, 2) for partition __consumer_offsets-20 (state.change.logger)
[2017-06-27 13:06:05,945] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=14, replicas=[0, 1, 2]) correlation id 61 from controller 1 epoch 10 for partition [__consumer_offsets,20] (state.change.logger)
[2017-06-27 13:06:05,945] TRACE Broker 2 handling LeaderAndIsr request correlationId 61 from controller 1 epoch 10 starting the become-leader transition for partition __consumer_offsets-20 (state.change.logger)
[2017-06-27 13:06:05,946] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-18 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 72 (state.change.logger)
[2017-06-27 13:06:05,946] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,37] (state.change.logger)
[2017-06-27 13:06:05,946] INFO Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 61 from controller 1 epoch 10 for partition __consumer_offsets-20 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:06:05,946] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,946] TRACE Broker 2 completed LeaderAndIsr request correlationId 61 from controller 1 epoch 10 for the become-leader transition for partition __consumer_offsets-20 (state.change.logger)
[2017-06-27 13:06:05,946] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=20,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,946] TRACE Broker 1 handling stop replica (delete=false) for partition __consumer_offsets-20 (state.change.logger)
[2017-06-27 13:06:05,946] TRACE Broker 1 finished handling stop replica (delete=false) for partition __consumer_offsets-20 (state.change.logger)
[2017-06-27 13:06:05,946] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=20,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,946] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-20 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 62 (state.change.logger)
[2017-06-27 13:06:05,946] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,946] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-20 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 74 (state.change.logger)
[2017-06-27 13:06:05,946] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,947] TRACE Broker 1 handling stop replica (delete=false) for partition __consumer_offsets-20 (state.change.logger)
[2017-06-27 13:06:05,947] TRACE Broker 1 finished handling stop replica (delete=false) for partition __consumer_offsets-20 (state.change.logger)
[2017-06-27 13:06:05,947] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=20,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,947] TRACE Controller 1 epoch 10 elected leader 2 for Offline partition [__consumer_offsets,37] (state.change.logger)
[2017-06-27 13:06:05,948] TRACE Controller 1 epoch 10 changed partition [__consumer_offsets,37] from OnlinePartition to OnlinePartition with leader 2 (state.change.logger)
[2017-06-27 13:06:05,948] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,37] (state.change.logger)
[2017-06-27 13:06:05,948] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 1 for partition [__consumer_offsets,37] (state.change.logger)
[2017-06-27 13:06:05,948] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(1, 2) for partition __consumer_offsets-37 (state.change.logger)
[2017-06-27 13:06:05,948] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,49] (state.change.logger)
[2017-06-27 13:06:05,948] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=14, replicas=[0, 1, 2]) correlation id 63 from controller 1 epoch 10 for partition [__consumer_offsets,37] (state.change.logger)
[2017-06-27 13:06:05,948] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=14, replicas=[0, 1, 2]) correlation id 76 from controller 1 epoch 10 for partition [__consumer_offsets,37] (state.change.logger)
[2017-06-27 13:06:05,948] TRACE Broker 2 handling LeaderAndIsr request correlationId 63 from controller 1 epoch 10 starting the become-leader transition for partition __consumer_offsets-37 (state.change.logger)
[2017-06-27 13:06:05,948] TRACE Broker 1 handling LeaderAndIsr request correlationId 76 from controller 1 epoch 10 starting the become-follower transition for partition __consumer_offsets-37 (state.change.logger)
[2017-06-27 13:06:05,948] TRACE Broker 1 stopped fetchers as part of become-follower request from controller 1 epoch 10 with correlation id 76 for partition __consumer_offsets-37 (state.change.logger)
[2017-06-27 13:06:05,949] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 10 with correlation id 63 for partition __consumer_offsets-37 (state.change.logger)
[2017-06-27 13:06:05,949] TRACE Broker 2 completed LeaderAndIsr request correlationId 63 from controller 1 epoch 10 for the become-leader transition for partition __consumer_offsets-37 (state.change.logger)
[2017-06-27 13:06:05,949] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=37,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,949] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-37 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 64 (state.change.logger)
[2017-06-27 13:06:05,949] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,949] TRACE Broker 1 truncated logs and checkpointed recovery boundaries for partition __consumer_offsets-37 as part of become-follower request with correlation id 76 from controller 1 epoch 10 (state.change.logger)
[2017-06-27 13:06:05,949] TRACE Broker 1 skipped the adding-fetcher step of the become-follower state change with correlation id 76 from controller 1 epoch 10 for partition __consumer_offsets-37 since it is shutting down (state.change.logger)
[2017-06-27 13:06:05,949] TRACE Broker 1 completed LeaderAndIsr request correlationId 76 from controller 1 epoch 10 for the become-follower transition for partition __consumer_offsets-37 (state.change.logger)
[2017-06-27 13:06:05,950] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=37,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,950] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-37 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 77 (state.change.logger)
[2017-06-27 13:06:05,950] TRACE Controller 1 epoch 10 elected leader 2 for Offline partition [__consumer_offsets,49] (state.change.logger)
[2017-06-27 13:06:05,950] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,950] TRACE Controller 1 epoch 10 changed partition [__consumer_offsets,49] from OnlinePartition to OnlinePartition with leader 2 (state.change.logger)
[2017-06-27 13:06:05,950] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,49] (state.change.logger)
[2017-06-27 13:06:05,951] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 1 for partition [__consumer_offsets,49] (state.change.logger)
[2017-06-27 13:06:05,951] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(1, 2) for partition __consumer_offsets-49 (state.change.logger)
[2017-06-27 13:06:05,951] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=12, replicas=[0, 1, 2]) correlation id 78 from controller 1 epoch 10 for partition [__consumer_offsets,49] (state.change.logger)
[2017-06-27 13:06:05,951] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,12] (state.change.logger)
[2017-06-27 13:06:05,951] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=12, replicas=[0, 1, 2]) correlation id 65 from controller 1 epoch 10 for partition [__consumer_offsets,49] (state.change.logger)
[2017-06-27 13:06:05,951] TRACE Broker 1 handling LeaderAndIsr request correlationId 78 from controller 1 epoch 10 starting the become-follower transition for partition __consumer_offsets-49 (state.change.logger)
[2017-06-27 13:06:05,951] TRACE Broker 2 handling LeaderAndIsr request correlationId 65 from controller 1 epoch 10 starting the become-leader transition for partition __consumer_offsets-49 (state.change.logger)
[2017-06-27 13:06:05,951] TRACE Broker 1 stopped fetchers as part of become-follower request from controller 1 epoch 10 with correlation id 78 for partition __consumer_offsets-49 (state.change.logger)
[2017-06-27 13:06:05,951] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 10 with correlation id 65 for partition __consumer_offsets-49 (state.change.logger)
[2017-06-27 13:06:05,951] TRACE Broker 2 completed LeaderAndIsr request correlationId 65 from controller 1 epoch 10 for the become-leader transition for partition __consumer_offsets-49 (state.change.logger)
[2017-06-27 13:06:05,951] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=49,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,952] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-49 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 66 (state.change.logger)
[2017-06-27 13:06:05,952] TRACE Broker 1 truncated logs and checkpointed recovery boundaries for partition __consumer_offsets-49 as part of become-follower request with correlation id 78 from controller 1 epoch 10 (state.change.logger)
[2017-06-27 13:06:05,952] TRACE Broker 1 skipped the adding-fetcher step of the become-follower state change with correlation id 78 from controller 1 epoch 10 for partition __consumer_offsets-49 since it is shutting down (state.change.logger)
[2017-06-27 13:06:05,952] TRACE Broker 1 completed LeaderAndIsr request correlationId 78 from controller 1 epoch 10 for the become-follower transition for partition __consumer_offsets-49 (state.change.logger)
[2017-06-27 13:06:05,952] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,952] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=49,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,952] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-49 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 79 (state.change.logger)
[2017-06-27 13:06:05,952] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,953] TRACE Controller 1 epoch 10 elected leader 2 for Offline partition [__consumer_offsets,12] (state.change.logger)
[2017-06-27 13:06:05,953] TRACE Controller 1 epoch 10 changed partition [__consumer_offsets,12] from OnlinePartition to OnlinePartition with leader 2 (state.change.logger)
[2017-06-27 13:06:05,953] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,12] (state.change.logger)
[2017-06-27 13:06:05,953] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to broker 1 for partition [__consumer_offsets,12] (state.change.logger)
[2017-06-27 13:06:05,953] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to brokers Set(1, 2) for partition __consumer_offsets-12 (state.change.logger)
[2017-06-27 13:06:05,954] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=7, isr=[2], zkVersion=11, replicas=[0, 1, 2]) correlation id 80 from controller 1 epoch 10 for partition [__consumer_offsets,12] (state.change.logger)
[2017-06-27 13:06:05,954] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=7, isr=[2], zkVersion=11, replicas=[0, 1, 2]) correlation id 67 from controller 1 epoch 10 for partition [__consumer_offsets,12] (state.change.logger)
[2017-06-27 13:06:05,954] TRACE Broker 1 handling LeaderAndIsr request correlationId 80 from controller 1 epoch 10 starting the become-follower transition for partition __consumer_offsets-12 (state.change.logger)
[2017-06-27 13:06:05,954] TRACE Broker 2 handling LeaderAndIsr request correlationId 67 from controller 1 epoch 10 starting the become-leader transition for partition __consumer_offsets-12 (state.change.logger)
[2017-06-27 13:06:05,954] TRACE Broker 1 stopped fetchers as part of become-follower request from controller 1 epoch 10 with correlation id 80 for partition __consumer_offsets-12 (state.change.logger)
[2017-06-27 13:06:05,954] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 10 with correlation id 67 for partition __consumer_offsets-12 (state.change.logger)
[2017-06-27 13:06:05,954] TRACE Broker 2 completed LeaderAndIsr request correlationId 67 from controller 1 epoch 10 for the become-leader transition for partition __consumer_offsets-12 (state.change.logger)
[2017-06-27 13:06:05,954] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=12,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,954] TRACE Broker 1 truncated logs and checkpointed recovery boundaries for partition __consumer_offsets-12 as part of become-follower request with correlation id 80 from controller 1 epoch 10 (state.change.logger)
[2017-06-27 13:06:05,955] TRACE Broker 1 skipped the adding-fetcher step of the become-follower state change with correlation id 80 from controller 1 epoch 10 for partition __consumer_offsets-12 since it is shutting down (state.change.logger)
[2017-06-27 13:06:05,955] TRACE Broker 1 completed LeaderAndIsr request correlationId 80 from controller 1 epoch 10 for the become-follower transition for partition __consumer_offsets-12 (state.change.logger)
[2017-06-27 13:06:05,955] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-12 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 68 (state.change.logger)
[2017-06-27 13:06:05,955] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=12,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,955] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,955] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-12 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 81 (state.change.logger)
[2017-06-27 13:06:05,956] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,957] TRACE Broker 1 handling stop replica (delete=false) for partition __consumer_offsets-5 (state.change.logger)
[2017-06-27 13:06:05,957] TRACE Broker 1 finished handling stop replica (delete=false) for partition __consumer_offsets-5 (state.change.logger)
[2017-06-27 13:06:05,957] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=5,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,958] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,5] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-27 13:06:05,958] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,5] (state.change.logger)
[2017-06-27 13:06:05,958] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10) to broker 0 for partition [__consumer_offsets,5] (state.change.logger)
[2017-06-27 13:06:05,958] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10) to brokers Set(1, 2) for partition __consumer_offsets-5 (state.change.logger)
[2017-06-27 13:06:05,958] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=10, isr=[2], zkVersion=15, replicas=[0, 1, 2]) correlation id 69 from controller 1 epoch 10 for partition [__consumer_offsets,5] (state.change.logger)
[2017-06-27 13:06:05,958] TRACE Broker 2 handling LeaderAndIsr request correlationId 69 from controller 1 epoch 10 starting the become-leader transition for partition __consumer_offsets-5 (state.change.logger)
[2017-06-27 13:06:05,959] INFO Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 69 from controller 1 epoch 10 for partition __consumer_offsets-5 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:06:05,959] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-5 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 83 (state.change.logger)
[2017-06-27 13:06:05,959] TRACE Broker 2 completed LeaderAndIsr request correlationId 69 from controller 1 epoch 10 for the become-leader transition for partition __consumer_offsets-5 (state.change.logger)
[2017-06-27 13:06:05,959] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,959] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=5,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,959] TRACE Broker 1 handling stop replica (delete=false) for partition __consumer_offsets-5 (state.change.logger)
[2017-06-27 13:06:05,959] TRACE Broker 1 finished handling stop replica (delete=false) for partition __consumer_offsets-5 (state.change.logger)
[2017-06-27 13:06:05,959] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-5 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 70 (state.change.logger)
[2017-06-27 13:06:05,959] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=5,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,959] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,960] TRACE Broker 1 handling stop replica (delete=false) for partition __consumer_offsets-32 (state.change.logger)
[2017-06-27 13:06:05,960] TRACE Broker 1 finished handling stop replica (delete=false) for partition __consumer_offsets-32 (state.change.logger)
[2017-06-27 13:06:05,960] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=32,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,961] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,32] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-27 13:06:05,961] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,32] (state.change.logger)
[2017-06-27 13:06:05,961] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 0 for partition [__consumer_offsets,32] (state.change.logger)
[2017-06-27 13:06:05,961] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(1, 2) for partition __consumer_offsets-32 (state.change.logger)
[2017-06-27 13:06:05,962] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=14, replicas=[0, 1, 2]) correlation id 71 from controller 1 epoch 10 for partition [__consumer_offsets,32] (state.change.logger)
[2017-06-27 13:06:05,962] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-32 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 86 (state.change.logger)
[2017-06-27 13:06:05,962] TRACE Broker 2 handling LeaderAndIsr request correlationId 71 from controller 1 epoch 10 starting the become-leader transition for partition __consumer_offsets-32 (state.change.logger)
[2017-06-27 13:06:05,962] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,962] INFO Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 71 from controller 1 epoch 10 for partition __consumer_offsets-32 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:06:05,962] TRACE Broker 2 completed LeaderAndIsr request correlationId 71 from controller 1 epoch 10 for the become-leader transition for partition __consumer_offsets-32 (state.change.logger)
[2017-06-27 13:06:05,962] TRACE Broker 1 handling stop replica (delete=false) for partition __consumer_offsets-32 (state.change.logger)
[2017-06-27 13:06:05,962] TRACE Broker 1 finished handling stop replica (delete=false) for partition __consumer_offsets-32 (state.change.logger)
[2017-06-27 13:06:05,962] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=32,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,962] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=32,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,962] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-32 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 72 (state.change.logger)
[2017-06-27 13:06:05,962] TRACE Broker 1 handling stop replica (delete=false) for partition __consumer_offsets-2 (state.change.logger)
[2017-06-27 13:06:05,962] TRACE Broker 1 finished handling stop replica (delete=false) for partition __consumer_offsets-2 (state.change.logger)
[2017-06-27 13:06:05,963] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,963] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=2,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,966] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,2] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-27 13:06:05,966] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,2] (state.change.logger)
[2017-06-27 13:06:05,966] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 0 for partition [__consumer_offsets,2] (state.change.logger)
[2017-06-27 13:06:05,966] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(1, 2) for partition __consumer_offsets-2 (state.change.logger)
[2017-06-27 13:06:05,966] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=14, replicas=[0, 1, 2]) correlation id 73 from controller 1 epoch 10 for partition [__consumer_offsets,2] (state.change.logger)
[2017-06-27 13:06:05,966] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,1] (state.change.logger)
[2017-06-27 13:06:05,966] TRACE Broker 2 handling LeaderAndIsr request correlationId 73 from controller 1 epoch 10 starting the become-leader transition for partition __consumer_offsets-2 (state.change.logger)
[2017-06-27 13:06:05,966] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-2 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 89 (state.change.logger)
[2017-06-27 13:06:05,967] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,967] TRACE Broker 1 handling stop replica (delete=false) for partition __consumer_offsets-2 (state.change.logger)
[2017-06-27 13:06:05,967] TRACE Broker 1 finished handling stop replica (delete=false) for partition __consumer_offsets-2 (state.change.logger)
[2017-06-27 13:06:05,967] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=2,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,968] INFO Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 73 from controller 1 epoch 10 for partition __consumer_offsets-2 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:06:05,968] TRACE Broker 2 completed LeaderAndIsr request correlationId 73 from controller 1 epoch 10 for the become-leader transition for partition __consumer_offsets-2 (state.change.logger)
[2017-06-27 13:06:05,968] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=2,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,968] TRACE Controller 1 epoch 10 elected leader 2 for Offline partition [__consumer_offsets,1] (state.change.logger)
[2017-06-27 13:06:05,969] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-2 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 74 (state.change.logger)
[2017-06-27 13:06:05,969] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,969] TRACE Controller 1 epoch 10 changed partition [__consumer_offsets,1] from OnlinePartition to OnlinePartition with leader 2 (state.change.logger)
[2017-06-27 13:06:05,969] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,1] (state.change.logger)
[2017-06-27 13:06:05,969] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 1 for partition [__consumer_offsets,1] (state.change.logger)
[2017-06-27 13:06:05,969] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(1, 2) for partition __consumer_offsets-1 (state.change.logger)
[2017-06-27 13:06:05,969] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=12, replicas=[0, 1, 2]) correlation id 75 from controller 1 epoch 10 for partition [__consumer_offsets,1] (state.change.logger)
[2017-06-27 13:06:05,969] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,0] (state.change.logger)
[2017-06-27 13:06:05,969] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=12, replicas=[0, 1, 2]) correlation id 91 from controller 1 epoch 10 for partition [__consumer_offsets,1] (state.change.logger)
[2017-06-27 13:06:05,969] TRACE Broker 2 handling LeaderAndIsr request correlationId 75 from controller 1 epoch 10 starting the become-leader transition for partition __consumer_offsets-1 (state.change.logger)
[2017-06-27 13:06:05,969] TRACE Broker 1 handling LeaderAndIsr request correlationId 91 from controller 1 epoch 10 starting the become-follower transition for partition __consumer_offsets-1 (state.change.logger)
[2017-06-27 13:06:05,969] TRACE Broker 1 stopped fetchers as part of become-follower request from controller 1 epoch 10 with correlation id 91 for partition __consumer_offsets-1 (state.change.logger)
[2017-06-27 13:06:05,970] TRACE Broker 1 truncated logs and checkpointed recovery boundaries for partition __consumer_offsets-1 as part of become-follower request with correlation id 91 from controller 1 epoch 10 (state.change.logger)
[2017-06-27 13:06:05,970] TRACE Broker 1 skipped the adding-fetcher step of the become-follower state change with correlation id 91 from controller 1 epoch 10 for partition __consumer_offsets-1 since it is shutting down (state.change.logger)
[2017-06-27 13:06:05,970] TRACE Broker 1 completed LeaderAndIsr request correlationId 91 from controller 1 epoch 10 for the become-follower transition for partition __consumer_offsets-1 (state.change.logger)
[2017-06-27 13:06:05,971] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=1,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,971] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-1 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 92 (state.change.logger)
[2017-06-27 13:06:05,971] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,971] TRACE Controller 1 epoch 10 elected leader 2 for Offline partition [__consumer_offsets,0] (state.change.logger)
[2017-06-27 13:06:05,971] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 10 with correlation id 75 for partition __consumer_offsets-1 (state.change.logger)
[2017-06-27 13:06:05,971] TRACE Broker 2 completed LeaderAndIsr request correlationId 75 from controller 1 epoch 10 for the become-leader transition for partition __consumer_offsets-1 (state.change.logger)
[2017-06-27 13:06:05,971] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=1,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,972] TRACE Controller 1 epoch 10 changed partition [__consumer_offsets,0] from OnlinePartition to OnlinePartition with leader 2 (state.change.logger)
[2017-06-27 13:06:05,972] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,0] (state.change.logger)
[2017-06-27 13:06:05,972] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-1 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 76 (state.change.logger)
[2017-06-27 13:06:05,972] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to broker 1 for partition [__consumer_offsets,0] (state.change.logger)
[2017-06-27 13:06:05,972] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to brokers Set(1, 2) for partition __consumer_offsets-0 (state.change.logger)
[2017-06-27 13:06:05,972] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,972] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=7, isr=[2], zkVersion=11, replicas=[0, 1, 2]) correlation id 93 from controller 1 epoch 10 for partition [__consumer_offsets,0] (state.change.logger)
[2017-06-27 13:06:05,972] TRACE Broker 1 handling LeaderAndIsr request correlationId 93 from controller 1 epoch 10 starting the become-follower transition for partition __consumer_offsets-0 (state.change.logger)
[2017-06-27 13:06:05,972] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=7, isr=[2], zkVersion=11, replicas=[0, 1, 2]) correlation id 77 from controller 1 epoch 10 for partition [__consumer_offsets,0] (state.change.logger)
[2017-06-27 13:06:05,972] TRACE Broker 2 handling LeaderAndIsr request correlationId 77 from controller 1 epoch 10 starting the become-leader transition for partition __consumer_offsets-0 (state.change.logger)
[2017-06-27 13:06:05,972] TRACE Broker 1 stopped fetchers as part of become-follower request from controller 1 epoch 10 with correlation id 93 for partition __consumer_offsets-0 (state.change.logger)
[2017-06-27 13:06:05,973] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 10 with correlation id 77 for partition __consumer_offsets-0 (state.change.logger)
[2017-06-27 13:06:05,973] TRACE Broker 2 completed LeaderAndIsr request correlationId 77 from controller 1 epoch 10 for the become-leader transition for partition __consumer_offsets-0 (state.change.logger)
[2017-06-27 13:06:05,973] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=0,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,973] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-0 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 78 (state.change.logger)
[2017-06-27 13:06:05,973] TRACE Broker 1 truncated logs and checkpointed recovery boundaries for partition __consumer_offsets-0 as part of become-follower request with correlation id 93 from controller 1 epoch 10 (state.change.logger)
[2017-06-27 13:06:05,973] TRACE Broker 1 skipped the adding-fetcher step of the become-follower state change with correlation id 93 from controller 1 epoch 10 for partition __consumer_offsets-0 since it is shutting down (state.change.logger)
[2017-06-27 13:06:05,973] TRACE Broker 1 completed LeaderAndIsr request correlationId 93 from controller 1 epoch 10 for the become-follower transition for partition __consumer_offsets-0 (state.change.logger)
[2017-06-27 13:06:05,973] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,974] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=0,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,974] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-0 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 94 (state.change.logger)
[2017-06-27 13:06:05,974] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,974] TRACE Broker 1 handling stop replica (delete=false) for partition __consumer_offsets-15 (state.change.logger)
[2017-06-27 13:06:05,974] TRACE Broker 1 finished handling stop replica (delete=false) for partition __consumer_offsets-15 (state.change.logger)
[2017-06-27 13:06:05,974] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=15,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,975] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,15] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-27 13:06:05,975] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,15] (state.change.logger)
[2017-06-27 13:06:05,975] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to broker 0 for partition [__consumer_offsets,15] (state.change.logger)
[2017-06-27 13:06:05,975] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to brokers Set(1, 2) for partition __consumer_offsets-15 (state.change.logger)
[2017-06-27 13:06:05,975] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=7, isr=[2], zkVersion=11, replicas=[0, 1, 2]) correlation id 79 from controller 1 epoch 10 for partition [__consumer_offsets,15] (state.change.logger)
[2017-06-27 13:06:05,975] TRACE Broker 2 handling LeaderAndIsr request correlationId 79 from controller 1 epoch 10 starting the become-leader transition for partition __consumer_offsets-15 (state.change.logger)
[2017-06-27 13:06:05,975] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-15 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 96 (state.change.logger)
[2017-06-27 13:06:05,975] INFO Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 79 from controller 1 epoch 10 for partition __consumer_offsets-15 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:06:05,975] TRACE Broker 2 completed LeaderAndIsr request correlationId 79 from controller 1 epoch 10 for the become-leader transition for partition __consumer_offsets-15 (state.change.logger)
[2017-06-27 13:06:05,975] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,975] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=15,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,975] TRACE Broker 1 handling stop replica (delete=false) for partition __consumer_offsets-15 (state.change.logger)
[2017-06-27 13:06:05,975] TRACE Broker 1 finished handling stop replica (delete=false) for partition __consumer_offsets-15 (state.change.logger)
[2017-06-27 13:06:05,975] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=15,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,976] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-15 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 80 (state.change.logger)
[2017-06-27 13:06:05,976] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,976] TRACE Broker 1 handling stop replica (delete=false) for partition __consumer_offsets-44 (state.change.logger)
[2017-06-27 13:06:05,976] TRACE Broker 1 finished handling stop replica (delete=false) for partition __consumer_offsets-44 (state.change.logger)
[2017-06-27 13:06:05,976] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=44,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,977] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,44] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-27 13:06:05,977] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,44] (state.change.logger)
[2017-06-27 13:06:05,977] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 0 for partition [__consumer_offsets,44] (state.change.logger)
[2017-06-27 13:06:05,977] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(1, 2) for partition __consumer_offsets-44 (state.change.logger)
[2017-06-27 13:06:05,977] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=14, replicas=[0, 1, 2]) correlation id 81 from controller 1 epoch 10 for partition [__consumer_offsets,44] (state.change.logger)
[2017-06-27 13:06:05,977] TRACE Broker 2 handling LeaderAndIsr request correlationId 81 from controller 1 epoch 10 starting the become-leader transition for partition __consumer_offsets-44 (state.change.logger)
[2017-06-27 13:06:05,977] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-44 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 99 (state.change.logger)
[2017-06-27 13:06:05,978] INFO Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 81 from controller 1 epoch 10 for partition __consumer_offsets-44 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:06:05,978] TRACE Broker 2 completed LeaderAndIsr request correlationId 81 from controller 1 epoch 10 for the become-leader transition for partition __consumer_offsets-44 (state.change.logger)
[2017-06-27 13:06:05,978] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,978] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=44,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,978] TRACE Broker 1 handling stop replica (delete=false) for partition __consumer_offsets-44 (state.change.logger)
[2017-06-27 13:06:05,978] TRACE Broker 1 finished handling stop replica (delete=false) for partition __consumer_offsets-44 (state.change.logger)
[2017-06-27 13:06:05,978] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=44,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,978] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-44 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 82 (state.change.logger)
[2017-06-27 13:06:05,978] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,978] TRACE Broker 1 handling stop replica (delete=false) for partition __consumer_offsets-17 (state.change.logger)
[2017-06-27 13:06:05,978] TRACE Broker 1 finished handling stop replica (delete=false) for partition __consumer_offsets-17 (state.change.logger)
[2017-06-27 13:06:05,978] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=17,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,980] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,17] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-27 13:06:05,980] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,17] (state.change.logger)
[2017-06-27 13:06:05,980] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10) to broker 0 for partition [__consumer_offsets,17] (state.change.logger)
[2017-06-27 13:06:05,981] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10) to brokers Set(1, 2) for partition __consumer_offsets-17 (state.change.logger)
[2017-06-27 13:06:05,981] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=10, isr=[2], zkVersion=15, replicas=[0, 1, 2]) correlation id 83 from controller 1 epoch 10 for partition [__consumer_offsets,17] (state.change.logger)
[2017-06-27 13:06:05,981] TRACE Broker 2 handling LeaderAndIsr request correlationId 83 from controller 1 epoch 10 starting the become-leader transition for partition __consumer_offsets-17 (state.change.logger)
[2017-06-27 13:06:05,981] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,48] (state.change.logger)
[2017-06-27 13:06:05,981] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-17 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 102 (state.change.logger)
[2017-06-27 13:06:05,981] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,981] INFO Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 83 from controller 1 epoch 10 for partition __consumer_offsets-17 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:06:05,981] TRACE Broker 2 completed LeaderAndIsr request correlationId 83 from controller 1 epoch 10 for the become-leader transition for partition __consumer_offsets-17 (state.change.logger)
[2017-06-27 13:06:05,981] TRACE Broker 1 handling stop replica (delete=false) for partition __consumer_offsets-17 (state.change.logger)
[2017-06-27 13:06:05,981] TRACE Broker 1 finished handling stop replica (delete=false) for partition __consumer_offsets-17 (state.change.logger)
[2017-06-27 13:06:05,981] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=17,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,981] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=17,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,982] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-17 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 84 (state.change.logger)
[2017-06-27 13:06:05,982] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,983] TRACE Controller 1 epoch 10 elected leader 2 for Offline partition [__consumer_offsets,48] (state.change.logger)
[2017-06-27 13:06:05,983] TRACE Controller 1 epoch 10 changed partition [__consumer_offsets,48] from OnlinePartition to OnlinePartition with leader 2 (state.change.logger)
[2017-06-27 13:06:05,983] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,48] (state.change.logger)
[2017-06-27 13:06:05,983] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to broker 1 for partition [__consumer_offsets,48] (state.change.logger)
[2017-06-27 13:06:05,983] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to brokers Set(1, 2) for partition __consumer_offsets-48 (state.change.logger)
[2017-06-27 13:06:05,984] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=7, isr=[2], zkVersion=11, replicas=[0, 1, 2]) correlation id 85 from controller 1 epoch 10 for partition [__consumer_offsets,48] (state.change.logger)
[2017-06-27 13:06:05,984] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=7, isr=[2], zkVersion=11, replicas=[0, 1, 2]) correlation id 104 from controller 1 epoch 10 for partition [__consumer_offsets,48] (state.change.logger)
[2017-06-27 13:06:05,984] TRACE Broker 2 handling LeaderAndIsr request correlationId 85 from controller 1 epoch 10 starting the become-leader transition for partition __consumer_offsets-48 (state.change.logger)
[2017-06-27 13:06:05,984] TRACE Broker 1 handling LeaderAndIsr request correlationId 104 from controller 1 epoch 10 starting the become-follower transition for partition __consumer_offsets-48 (state.change.logger)
[2017-06-27 13:06:05,984] TRACE Broker 1 stopped fetchers as part of become-follower request from controller 1 epoch 10 with correlation id 104 for partition __consumer_offsets-48 (state.change.logger)
[2017-06-27 13:06:05,984] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 10 with correlation id 85 for partition __consumer_offsets-48 (state.change.logger)
[2017-06-27 13:06:05,984] TRACE Broker 2 completed LeaderAndIsr request correlationId 85 from controller 1 epoch 10 for the become-leader transition for partition __consumer_offsets-48 (state.change.logger)
[2017-06-27 13:06:05,984] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=48,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,985] TRACE Broker 1 truncated logs and checkpointed recovery boundaries for partition __consumer_offsets-48 as part of become-follower request with correlation id 104 from controller 1 epoch 10 (state.change.logger)
[2017-06-27 13:06:05,985] TRACE Broker 1 skipped the adding-fetcher step of the become-follower state change with correlation id 104 from controller 1 epoch 10 for partition __consumer_offsets-48 since it is shutting down (state.change.logger)
[2017-06-27 13:06:05,985] TRACE Broker 1 completed LeaderAndIsr request correlationId 104 from controller 1 epoch 10 for the become-follower transition for partition __consumer_offsets-48 (state.change.logger)
[2017-06-27 13:06:05,985] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-48 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 86 (state.change.logger)
[2017-06-27 13:06:05,985] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,985] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=48,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,985] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-48 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 105 (state.change.logger)
[2017-06-27 13:06:05,985] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,986] TRACE Broker 1 handling stop replica (delete=false) for partition __consumer_offsets-26 (state.change.logger)
[2017-06-27 13:06:05,986] TRACE Broker 1 finished handling stop replica (delete=false) for partition __consumer_offsets-26 (state.change.logger)
[2017-06-27 13:06:05,986] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=26,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,986] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,26] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-27 13:06:05,986] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,26] (state.change.logger)
[2017-06-27 13:06:05,987] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 0 for partition [__consumer_offsets,26] (state.change.logger)
[2017-06-27 13:06:05,987] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(1, 2) for partition __consumer_offsets-26 (state.change.logger)
[2017-06-27 13:06:05,987] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=14, replicas=[0, 1, 2]) correlation id 87 from controller 1 epoch 10 for partition [__consumer_offsets,26] (state.change.logger)
[2017-06-27 13:06:05,987] TRACE Broker 2 handling LeaderAndIsr request correlationId 87 from controller 1 epoch 10 starting the become-leader transition for partition __consumer_offsets-26 (state.change.logger)
[2017-06-27 13:06:05,987] INFO Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 87 from controller 1 epoch 10 for partition __consumer_offsets-26 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:06:05,987] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-26 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 107 (state.change.logger)
[2017-06-27 13:06:05,987] TRACE Broker 2 completed LeaderAndIsr request correlationId 87 from controller 1 epoch 10 for the become-leader transition for partition __consumer_offsets-26 (state.change.logger)
[2017-06-27 13:06:05,988] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,988] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=26,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,988] TRACE Broker 1 handling stop replica (delete=false) for partition __consumer_offsets-26 (state.change.logger)
[2017-06-27 13:06:05,988] TRACE Broker 1 finished handling stop replica (delete=false) for partition __consumer_offsets-26 (state.change.logger)
[2017-06-27 13:06:05,988] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-26 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 88 (state.change.logger)
[2017-06-27 13:06:05,989] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=26,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,989] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,989] TRACE Broker 1 handling stop replica (delete=false) for partition __consumer_offsets-33 (state.change.logger)
[2017-06-27 13:06:05,989] TRACE Broker 1 finished handling stop replica (delete=false) for partition __consumer_offsets-33 (state.change.logger)
[2017-06-27 13:06:05,990] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=33,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,992] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,33] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-27 13:06:05,992] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,33] (state.change.logger)
[2017-06-27 13:06:05,992] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to broker 0 for partition [__consumer_offsets,33] (state.change.logger)
[2017-06-27 13:06:05,992] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to brokers Set(1, 2) for partition __consumer_offsets-33 (state.change.logger)
[2017-06-27 13:06:05,992] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=7, isr=[2], zkVersion=11, replicas=[0, 1, 2]) correlation id 89 from controller 1 epoch 10 for partition [__consumer_offsets,33] (state.change.logger)
[2017-06-27 13:06:05,992] TRACE Broker 2 handling LeaderAndIsr request correlationId 89 from controller 1 epoch 10 starting the become-leader transition for partition __consumer_offsets-33 (state.change.logger)
[2017-06-27 13:06:05,993] INFO Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 89 from controller 1 epoch 10 for partition __consumer_offsets-33 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:06:05,993] TRACE Broker 2 completed LeaderAndIsr request correlationId 89 from controller 1 epoch 10 for the become-leader transition for partition __consumer_offsets-33 (state.change.logger)
[2017-06-27 13:06:05,993] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=33,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,993] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-33 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 110 (state.change.logger)
[2017-06-27 13:06:05,993] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,993] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-33 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 90 (state.change.logger)
[2017-06-27 13:06:05,993] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,993] TRACE Broker 1 handling stop replica (delete=false) for partition __consumer_offsets-33 (state.change.logger)
[2017-06-27 13:06:05,993] TRACE Broker 1 finished handling stop replica (delete=false) for partition __consumer_offsets-33 (state.change.logger)
[2017-06-27 13:06:05,993] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=33,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,994] TRACE Broker 1 handling stop replica (delete=false) for partition __consumer_offsets-41 (state.change.logger)
[2017-06-27 13:06:05,994] TRACE Broker 1 finished handling stop replica (delete=false) for partition __consumer_offsets-41 (state.change.logger)
[2017-06-27 13:06:05,994] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=41,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,995] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,41] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-27 13:06:05,995] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,41] (state.change.logger)
[2017-06-27 13:06:05,995] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10) to broker 0 for partition [__consumer_offsets,41] (state.change.logger)
[2017-06-27 13:06:05,996] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10) to brokers Set(1, 2) for partition __consumer_offsets-41 (state.change.logger)
[2017-06-27 13:06:05,996] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=10, isr=[2], zkVersion=15, replicas=[0, 1, 2]) correlation id 91 from controller 1 epoch 10 for partition [__consumer_offsets,41] (state.change.logger)
[2017-06-27 13:06:05,996] TRACE Broker 2 handling LeaderAndIsr request correlationId 91 from controller 1 epoch 10 starting the become-leader transition for partition __consumer_offsets-41 (state.change.logger)
[2017-06-27 13:06:05,996] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-41 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 113 (state.change.logger)
[2017-06-27 13:06:05,996] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,996] INFO Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 91 from controller 1 epoch 10 for partition __consumer_offsets-41 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:06:05,996] TRACE Broker 2 completed LeaderAndIsr request correlationId 91 from controller 1 epoch 10 for the become-leader transition for partition __consumer_offsets-41 (state.change.logger)
[2017-06-27 13:06:05,996] TRACE Broker 1 handling stop replica (delete=false) for partition __consumer_offsets-41 (state.change.logger)
[2017-06-27 13:06:05,996] TRACE Broker 1 finished handling stop replica (delete=false) for partition __consumer_offsets-41 (state.change.logger)
[2017-06-27 13:06:05,996] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=41,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,997] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=41,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,997] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-41 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 92 (state.change.logger)
[2017-06-27 13:06:05,997] TRACE Broker 1 handling stop replica (delete=false) for partition __consumer_offsets-45 (state.change.logger)
[2017-06-27 13:06:05,997] TRACE Broker 1 finished handling stop replica (delete=false) for partition __consumer_offsets-45 (state.change.logger)
[2017-06-27 13:06:05,997] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:05,997] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=45,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:05,999] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,45] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-27 13:06:05,999] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,45] (state.change.logger)
[2017-06-27 13:06:05,999] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to broker 0 for partition [__consumer_offsets,45] (state.change.logger)
[2017-06-27 13:06:05,999] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to brokers Set(1, 2) for partition __consumer_offsets-45 (state.change.logger)
[2017-06-27 13:06:06,000] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=7, isr=[2], zkVersion=11, replicas=[0, 1, 2]) correlation id 93 from controller 1 epoch 10 for partition [__consumer_offsets,45] (state.change.logger)
[2017-06-27 13:06:06,000] TRACE Broker 2 handling LeaderAndIsr request correlationId 93 from controller 1 epoch 10 starting the become-leader transition for partition __consumer_offsets-45 (state.change.logger)
[2017-06-27 13:06:06,000] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-45 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 116 (state.change.logger)
[2017-06-27 13:06:06,000] INFO Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 93 from controller 1 epoch 10 for partition __consumer_offsets-45 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:06:06,000] TRACE Broker 2 completed LeaderAndIsr request correlationId 93 from controller 1 epoch 10 for the become-leader transition for partition __consumer_offsets-45 (state.change.logger)
[2017-06-27 13:06:06,000] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:06,000] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=45,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:06,000] TRACE Broker 1 handling stop replica (delete=false) for partition __consumer_offsets-45 (state.change.logger)
[2017-06-27 13:06:06,000] TRACE Broker 1 finished handling stop replica (delete=false) for partition __consumer_offsets-45 (state.change.logger)
[2017-06-27 13:06:06,000] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-45 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 94 (state.change.logger)
[2017-06-27 13:06:06,001] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=45,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:06,001] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:06,001] TRACE Broker 1 handling stop replica (delete=false) for partition __consumer_offsets-35 (state.change.logger)
[2017-06-27 13:06:06,001] TRACE Broker 1 finished handling stop replica (delete=false) for partition __consumer_offsets-35 (state.change.logger)
[2017-06-27 13:06:06,001] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=35,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:06,002] TRACE Controller 1 epoch 10 changed state of replica 1 for partition [__consumer_offsets,35] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-27 13:06:06,002] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,35] (state.change.logger)
[2017-06-27 13:06:06,002] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10) to broker 0 for partition [__consumer_offsets,35] (state.change.logger)
[2017-06-27 13:06:06,002] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10) to brokers Set(1, 2) for partition __consumer_offsets-35 (state.change.logger)
[2017-06-27 13:06:06,002] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,46] (state.change.logger)
[2017-06-27 13:06:06,002] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=10, isr=[2], zkVersion=15, replicas=[0, 1, 2]) correlation id 95 from controller 1 epoch 10 for partition [__consumer_offsets,35] (state.change.logger)
[2017-06-27 13:06:06,002] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-35 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 119 (state.change.logger)
[2017-06-27 13:06:06,002] TRACE Broker 2 handling LeaderAndIsr request correlationId 95 from controller 1 epoch 10 starting the become-leader transition for partition __consumer_offsets-35 (state.change.logger)
[2017-06-27 13:06:06,002] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-27 13:06:06,002] INFO Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 95 from controller 1 epoch 10 for partition __consumer_offsets-35 since it is already the leader for the partition. (state.change.logger)
[2017-06-27 13:06:06,002] TRACE Broker 2 completed LeaderAndIsr request correlationId 95 from controller 1 epoch 10 for the become-leader transition for partition __consumer_offsets-35 (state.change.logger)
[2017-06-27 13:06:06,003] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=35,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:06,003] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-35 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 96 (state.change.logger)
[2017-06-27 13:06:06,003] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:06,004] TRACE Controller 1 epoch 10 elected leader 2 for Offline partition [__consumer_offsets,46] (state.change.logger)
[2017-06-27 13:06:06,005] TRACE Controller 1 epoch 10 changed partition [__consumer_offsets,46] from OnlinePartition to OnlinePartition with leader 2 (state.change.logger)
[2017-06-27 13:06:06,005] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,46] (state.change.logger)
[2017-06-27 13:06:06,005] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 1 for partition [__consumer_offsets,46] (state.change.logger)
[2017-06-27 13:06:06,005] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(1, 2) for partition __consumer_offsets-46 (state.change.logger)
[2017-06-27 13:06:06,006] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,19] (state.change.logger)
[2017-06-27 13:06:06,006] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=14, replicas=[0, 1, 2]) correlation id 97 from controller 1 epoch 10 for partition [__consumer_offsets,46] (state.change.logger)
[2017-06-27 13:06:06,006] TRACE Broker 2 handling LeaderAndIsr request correlationId 97 from controller 1 epoch 10 starting the become-leader transition for partition __consumer_offsets-46 (state.change.logger)
[2017-06-27 13:06:06,006] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 10 with correlation id 97 for partition __consumer_offsets-46 (state.change.logger)
[2017-06-27 13:06:06,006] TRACE Broker 2 completed LeaderAndIsr request correlationId 97 from controller 1 epoch 10 for the become-leader transition for partition __consumer_offsets-46 (state.change.logger)
[2017-06-27 13:06:06,007] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=46,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:06,007] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-46 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 98 (state.change.logger)
[2017-06-27 13:06:06,007] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:06,008] TRACE Controller 1 epoch 10 elected leader 2 for Offline partition [__consumer_offsets,19] (state.change.logger)
[2017-06-27 13:06:06,008] TRACE Controller 1 epoch 10 changed partition [__consumer_offsets,19] from OnlinePartition to OnlinePartition with leader 2 (state.change.logger)
[2017-06-27 13:06:06,008] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,19] (state.change.logger)
[2017-06-27 13:06:06,008] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 1 for partition [__consumer_offsets,19] (state.change.logger)
[2017-06-27 13:06:06,008] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(1, 2) for partition __consumer_offsets-19 (state.change.logger)
[2017-06-27 13:06:06,009] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,30] (state.change.logger)
[2017-06-27 13:06:06,009] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=14, replicas=[0, 1, 2]) correlation id 99 from controller 1 epoch 10 for partition [__consumer_offsets,19] (state.change.logger)
[2017-06-27 13:06:06,009] TRACE Broker 2 handling LeaderAndIsr request correlationId 99 from controller 1 epoch 10 starting the become-leader transition for partition __consumer_offsets-19 (state.change.logger)
[2017-06-27 13:06:06,009] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 10 with correlation id 99 for partition __consumer_offsets-19 (state.change.logger)
[2017-06-27 13:06:06,009] TRACE Broker 2 completed LeaderAndIsr request correlationId 99 from controller 1 epoch 10 for the become-leader transition for partition __consumer_offsets-19 (state.change.logger)
[2017-06-27 13:06:06,009] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=19,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:06,010] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-19 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 100 (state.change.logger)
[2017-06-27 13:06:06,010] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:06,011] TRACE Controller 1 epoch 10 elected leader 2 for Offline partition [__consumer_offsets,30] (state.change.logger)
[2017-06-27 13:06:06,011] TRACE Controller 1 epoch 10 changed partition [__consumer_offsets,30] from OnlinePartition to OnlinePartition with leader 2 (state.change.logger)
[2017-06-27 13:06:06,011] TRACE Controller 1 epoch 10 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,30] (state.change.logger)
[2017-06-27 13:06:06,011] TRACE Controller 1 epoch 10 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to broker 1 for partition [__consumer_offsets,30] (state.change.logger)
[2017-06-27 13:06:06,011] TRACE Controller 1 epoch 10 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to brokers Set(1, 2) for partition __consumer_offsets-30 (state.change.logger)
[2017-06-27 13:06:06,012] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=7, isr=[2], zkVersion=11, replicas=[0, 1, 2]) correlation id 101 from controller 1 epoch 10 for partition [__consumer_offsets,30] (state.change.logger)
[2017-06-27 13:06:06,012] TRACE Broker 2 handling LeaderAndIsr request correlationId 101 from controller 1 epoch 10 starting the become-leader transition for partition __consumer_offsets-30 (state.change.logger)
[2017-06-27 13:06:06,012] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 10 with correlation id 101 for partition __consumer_offsets-30 (state.change.logger)
[2017-06-27 13:06:06,012] TRACE Broker 2 completed LeaderAndIsr request correlationId 101 from controller 1 epoch 10 for the become-leader transition for partition __consumer_offsets-30 (state.change.logger)
[2017-06-27 13:06:06,015] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,43] (state.change.logger)
[2017-06-27 13:06:06,017] ERROR Controller 1 epoch 10 encountered error while electing leader for partition [__consumer_offsets,43] due to: No other replicas in ISR 2 for [__consumer_offsets,43] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-27 13:06:06,018] ERROR Controller 1 epoch 10 initiated state change for partition [__consumer_offsets,43] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,43] due to: No other replicas in ISR 2 for [__consumer_offsets,43] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,43] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:06,020] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,14] (state.change.logger)
[2017-06-27 13:06:06,022] ERROR Controller 1 epoch 10 encountered error while electing leader for partition [__consumer_offsets,14] due to: No other replicas in ISR 2 for [__consumer_offsets,14] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-27 13:06:06,022] ERROR Controller 1 epoch 10 initiated state change for partition [__consumer_offsets,14] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,14] due to: No other replicas in ISR 2 for [__consumer_offsets,14] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,14] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:06,023] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,28] (state.change.logger)
[2017-06-27 13:06:06,024] ERROR Controller 1 epoch 10 encountered error while electing leader for partition [__consumer_offsets,28] due to: No other replicas in ISR 2 for [__consumer_offsets,28] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-27 13:06:06,024] ERROR Controller 1 epoch 10 initiated state change for partition [__consumer_offsets,28] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,28] due to: No other replicas in ISR 2 for [__consumer_offsets,28] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,28] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:06,025] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,4] (state.change.logger)
[2017-06-27 13:06:06,026] ERROR Controller 1 epoch 10 encountered error while electing leader for partition [__consumer_offsets,4] due to: No other replicas in ISR 2 for [__consumer_offsets,4] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-27 13:06:06,027] ERROR Controller 1 epoch 10 initiated state change for partition [__consumer_offsets,4] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,4] due to: No other replicas in ISR 2 for [__consumer_offsets,4] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,4] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:06,028] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,36] (state.change.logger)
[2017-06-27 13:06:06,027] TRACE Controller 1 epoch 10 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=30,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:06,028] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-30 in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 102 (state.change.logger)
[2017-06-27 13:06:06,028] TRACE Controller 1 epoch 10 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:06,029] ERROR Controller 1 epoch 10 encountered error while electing leader for partition [__consumer_offsets,36] due to: No other replicas in ISR 2 for [__consumer_offsets,36] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-27 13:06:06,029] ERROR Controller 1 epoch 10 initiated state change for partition [__consumer_offsets,36] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,36] due to: No other replicas in ISR 2 for [__consumer_offsets,36] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,36] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:06,030] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,6] (state.change.logger)
[2017-06-27 13:06:06,031] ERROR Controller 1 epoch 10 encountered error while electing leader for partition [__consumer_offsets,6] due to: No other replicas in ISR 2 for [__consumer_offsets,6] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-27 13:06:06,031] ERROR Controller 1 epoch 10 initiated state change for partition [__consumer_offsets,6] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,6] due to: No other replicas in ISR 2 for [__consumer_offsets,6] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,6] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:06,031] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,39] (state.change.logger)
[2017-06-27 13:06:06,033] ERROR Controller 1 epoch 10 encountered error while electing leader for partition [__consumer_offsets,39] due to: No other replicas in ISR 2 for [__consumer_offsets,39] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-27 13:06:06,033] ERROR Controller 1 epoch 10 initiated state change for partition [__consumer_offsets,39] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,39] due to: No other replicas in ISR 2 for [__consumer_offsets,39] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,39] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-27 13:06:06,033] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,23] (state.change.logger)
[2017-06-27 13:06:06,034] ERROR Controller 1 epoch 10 encountered error while electing leader for partition [__consumer_offsets,23] due to: No other replicas in ISR 2 for [__consumer_offsets,23] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-27 13:06:06,034] ERROR Controller 1 epoch 10 initiated state change for partition [__consumer_offsets,23] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,23] due to: No other replicas in ISR 2 for [__consumer_offsets,23] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,23] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-27 13:06:06,035] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,24] (state.change.logger)
[2017-06-27 13:06:06,036] ERROR Controller 1 epoch 10 encountered error while electing leader for partition [__consumer_offsets,24] due to: No other replicas in ISR 2 for [__consumer_offsets,24] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-27 13:06:06,036] ERROR Controller 1 epoch 10 initiated state change for partition [__consumer_offsets,24] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,24] due to: No other replicas in ISR 2 for [__consumer_offsets,24] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,24] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:06,036] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,38] (state.change.logger)
[2017-06-27 13:06:06,038] ERROR Controller 1 epoch 10 encountered error while electing leader for partition [__consumer_offsets,38] due to: No other replicas in ISR 2 for [__consumer_offsets,38] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-27 13:06:06,038] ERROR Controller 1 epoch 10 initiated state change for partition [__consumer_offsets,38] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,38] due to: No other replicas in ISR 2 for [__consumer_offsets,38] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,38] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:06,040] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,16] (state.change.logger)
[2017-06-27 13:06:06,041] ERROR Controller 1 epoch 10 encountered error while electing leader for partition [__consumer_offsets,16] due to: No other replicas in ISR 2 for [__consumer_offsets,16] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-27 13:06:06,041] ERROR Controller 1 epoch 10 initiated state change for partition [__consumer_offsets,16] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,16] due to: No other replicas in ISR 2 for [__consumer_offsets,16] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,16] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 24 more
[2017-06-27 13:06:06,042] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,3] (state.change.logger)
[2017-06-27 13:06:06,043] ERROR Controller 1 epoch 10 encountered error while electing leader for partition [__consumer_offsets,3] due to: No other replicas in ISR 2 for [__consumer_offsets,3] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-27 13:06:06,043] ERROR Controller 1 epoch 10 initiated state change for partition [__consumer_offsets,3] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,3] due to: No other replicas in ISR 2 for [__consumer_offsets,3] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,3] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 24 more
[2017-06-27 13:06:06,043] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,21] (state.change.logger)
[2017-06-27 13:06:06,044] ERROR Controller 1 epoch 10 encountered error while electing leader for partition [__consumer_offsets,21] due to: No other replicas in ISR 2 for [__consumer_offsets,21] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-27 13:06:06,044] ERROR Controller 1 epoch 10 initiated state change for partition [__consumer_offsets,21] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,21] due to: No other replicas in ISR 2 for [__consumer_offsets,21] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,21] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:06,045] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,10] (state.change.logger)
[2017-06-27 13:06:06,046] ERROR Controller 1 epoch 10 encountered error while electing leader for partition [__consumer_offsets,10] due to: No other replicas in ISR 2 for [__consumer_offsets,10] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-27 13:06:06,046] ERROR Controller 1 epoch 10 initiated state change for partition [__consumer_offsets,10] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,10] due to: No other replicas in ISR 2 for [__consumer_offsets,10] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,10] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:06,047] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,40] (state.change.logger)
[2017-06-27 13:06:06,047] ERROR Controller 1 epoch 10 encountered error while electing leader for partition [__consumer_offsets,40] due to: No other replicas in ISR 2 for [__consumer_offsets,40] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-27 13:06:06,047] ERROR Controller 1 epoch 10 initiated state change for partition [__consumer_offsets,40] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,40] due to: No other replicas in ISR 2 for [__consumer_offsets,40] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,40] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:06,048] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,34] (state.change.logger)
[2017-06-27 13:06:06,049] ERROR Controller 1 epoch 10 encountered error while electing leader for partition [__consumer_offsets,34] due to: No other replicas in ISR 2 for [__consumer_offsets,34] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-27 13:06:06,049] ERROR Controller 1 epoch 10 initiated state change for partition [__consumer_offsets,34] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,34] due to: No other replicas in ISR 2 for [__consumer_offsets,34] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,34] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-27 13:06:06,049] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,25] (state.change.logger)
[2017-06-27 13:06:06,050] ERROR Controller 1 epoch 10 encountered error while electing leader for partition [__consumer_offsets,25] due to: No other replicas in ISR 2 for [__consumer_offsets,25] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-27 13:06:06,050] ERROR Controller 1 epoch 10 initiated state change for partition [__consumer_offsets,25] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,25] due to: No other replicas in ISR 2 for [__consumer_offsets,25] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,25] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:06,050] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,27] (state.change.logger)
[2017-06-27 13:06:06,051] ERROR Controller 1 epoch 10 encountered error while electing leader for partition [__consumer_offsets,27] due to: No other replicas in ISR 2 for [__consumer_offsets,27] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-27 13:06:06,051] ERROR Controller 1 epoch 10 initiated state change for partition [__consumer_offsets,27] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,27] due to: No other replicas in ISR 2 for [__consumer_offsets,27] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,27] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:06,051] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,42] (state.change.logger)
[2017-06-27 13:06:06,052] ERROR Controller 1 epoch 10 encountered error while electing leader for partition [__consumer_offsets,42] due to: No other replicas in ISR 2 for [__consumer_offsets,42] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-27 13:06:06,052] ERROR Controller 1 epoch 10 initiated state change for partition [__consumer_offsets,42] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,42] due to: No other replicas in ISR 2 for [__consumer_offsets,42] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,42] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:06,052] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,11] (state.change.logger)
[2017-06-27 13:06:06,053] ERROR Controller 1 epoch 10 encountered error while electing leader for partition [__consumer_offsets,11] due to: No other replicas in ISR 2 for [__consumer_offsets,11] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-27 13:06:06,053] ERROR Controller 1 epoch 10 initiated state change for partition [__consumer_offsets,11] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,11] due to: No other replicas in ISR 2 for [__consumer_offsets,11] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,11] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:06,054] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,7] (state.change.logger)
[2017-06-27 13:06:06,055] ERROR Controller 1 epoch 10 encountered error while electing leader for partition [__consumer_offsets,7] due to: No other replicas in ISR 2 for [__consumer_offsets,7] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-27 13:06:06,055] ERROR Controller 1 epoch 10 initiated state change for partition [__consumer_offsets,7] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,7] due to: No other replicas in ISR 2 for [__consumer_offsets,7] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,7] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:06,056] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,47] (state.change.logger)
[2017-06-27 13:06:06,057] ERROR Controller 1 epoch 10 encountered error while electing leader for partition [__consumer_offsets,47] due to: No other replicas in ISR 2 for [__consumer_offsets,47] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-27 13:06:06,057] ERROR Controller 1 epoch 10 initiated state change for partition [__consumer_offsets,47] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,47] due to: No other replicas in ISR 2 for [__consumer_offsets,47] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,47] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:06,057] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,9] (state.change.logger)
[2017-06-27 13:06:06,058] ERROR Controller 1 epoch 10 encountered error while electing leader for partition [__consumer_offsets,9] due to: No other replicas in ISR 2 for [__consumer_offsets,9] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-27 13:06:06,058] ERROR Controller 1 epoch 10 initiated state change for partition [__consumer_offsets,9] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,9] due to: No other replicas in ISR 2 for [__consumer_offsets,9] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,9] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:06,058] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,13] (state.change.logger)
[2017-06-27 13:06:06,059] ERROR Controller 1 epoch 10 encountered error while electing leader for partition [__consumer_offsets,13] due to: No other replicas in ISR 2 for [__consumer_offsets,13] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-27 13:06:06,059] ERROR Controller 1 epoch 10 initiated state change for partition [__consumer_offsets,13] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,13] due to: No other replicas in ISR 2 for [__consumer_offsets,13] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,13] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-27 13:06:06,059] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,29] (state.change.logger)
[2017-06-27 13:06:06,060] ERROR Controller 1 epoch 10 encountered error while electing leader for partition [__consumer_offsets,29] due to: No other replicas in ISR 2 for [__consumer_offsets,29] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-27 13:06:06,060] ERROR Controller 1 epoch 10 initiated state change for partition [__consumer_offsets,29] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,29] due to: No other replicas in ISR 2 for [__consumer_offsets,29] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,29] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:06,060] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,8] (state.change.logger)
[2017-06-27 13:06:06,061] ERROR Controller 1 epoch 10 encountered error while electing leader for partition [__consumer_offsets,8] due to: No other replicas in ISR 2 for [__consumer_offsets,8] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-27 13:06:06,061] ERROR Controller 1 epoch 10 initiated state change for partition [__consumer_offsets,8] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,8] due to: No other replicas in ISR 2 for [__consumer_offsets,8] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,8] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:06,061] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,22] (state.change.logger)
[2017-06-27 13:06:06,062] ERROR Controller 1 epoch 10 encountered error while electing leader for partition [__consumer_offsets,22] due to: No other replicas in ISR 2 for [__consumer_offsets,22] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-27 13:06:06,062] ERROR Controller 1 epoch 10 initiated state change for partition [__consumer_offsets,22] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,22] due to: No other replicas in ISR 2 for [__consumer_offsets,22] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,22] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:06,062] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,31] (state.change.logger)
[2017-06-27 13:06:06,064] ERROR Controller 1 epoch 10 encountered error while electing leader for partition [__consumer_offsets,31] due to: No other replicas in ISR 2 for [__consumer_offsets,31] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-27 13:06:06,064] ERROR Controller 1 epoch 10 initiated state change for partition [__consumer_offsets,31] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,31] due to: No other replicas in ISR 2 for [__consumer_offsets,31] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,31] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-27 13:06:06,064] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,18] (state.change.logger)
[2017-06-27 13:06:06,066] ERROR Controller 1 epoch 10 encountered error while electing leader for partition [__consumer_offsets,18] due to: No other replicas in ISR 2 for [__consumer_offsets,18] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-27 13:06:06,066] ERROR Controller 1 epoch 10 initiated state change for partition [__consumer_offsets,18] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,18] due to: No other replicas in ISR 2 for [__consumer_offsets,18] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,18] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:06,066] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,20] (state.change.logger)
[2017-06-27 13:06:06,066] TRACE Broker 1 handling stop replica (delete=false) for partition __consumer_offsets-35 (state.change.logger)
[2017-06-27 13:06:06,066] TRACE Broker 1 finished handling stop replica (delete=false) for partition __consumer_offsets-35 (state.change.logger)
[2017-06-27 13:06:06,067] ERROR Controller 1 epoch 10 encountered error while electing leader for partition [__consumer_offsets,20] due to: No other replicas in ISR 2 for [__consumer_offsets,20] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-27 13:06:06,067] ERROR Controller 1 epoch 10 initiated state change for partition [__consumer_offsets,20] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,20] due to: No other replicas in ISR 2 for [__consumer_offsets,20] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,20] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:06,068] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,37] (state.change.logger)
[2017-06-27 13:06:06,068] ERROR Controller 1 epoch 10 encountered error while electing leader for partition [__consumer_offsets,37] due to: No other replicas in ISR 2 for [__consumer_offsets,37] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-27 13:06:06,068] ERROR Controller 1 epoch 10 initiated state change for partition [__consumer_offsets,37] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,37] due to: No other replicas in ISR 2 for [__consumer_offsets,37] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,37] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-27 13:06:06,069] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,49] (state.change.logger)
[2017-06-27 13:06:06,070] ERROR Controller 1 epoch 10 encountered error while electing leader for partition [__consumer_offsets,49] due to: No other replicas in ISR 2 for [__consumer_offsets,49] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-27 13:06:06,070] ERROR Controller 1 epoch 10 initiated state change for partition [__consumer_offsets,49] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,49] due to: No other replicas in ISR 2 for [__consumer_offsets,49] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,49] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:06,071] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,12] (state.change.logger)
[2017-06-27 13:06:06,072] ERROR Controller 1 epoch 10 encountered error while electing leader for partition [__consumer_offsets,12] due to: No other replicas in ISR 2 for [__consumer_offsets,12] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-27 13:06:06,072] ERROR Controller 1 epoch 10 initiated state change for partition [__consumer_offsets,12] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,12] due to: No other replicas in ISR 2 for [__consumer_offsets,12] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,12] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:06,072] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,5] (state.change.logger)
[2017-06-27 13:06:06,073] ERROR Controller 1 epoch 10 encountered error while electing leader for partition [__consumer_offsets,5] due to: No other replicas in ISR 2 for [__consumer_offsets,5] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-27 13:06:06,073] ERROR Controller 1 epoch 10 initiated state change for partition [__consumer_offsets,5] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,5] due to: No other replicas in ISR 2 for [__consumer_offsets,5] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,5] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:06,073] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,32] (state.change.logger)
[2017-06-27 13:06:06,074] ERROR Controller 1 epoch 10 encountered error while electing leader for partition [__consumer_offsets,32] due to: No other replicas in ISR 2 for [__consumer_offsets,32] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-27 13:06:06,074] ERROR Controller 1 epoch 10 initiated state change for partition [__consumer_offsets,32] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,32] due to: No other replicas in ISR 2 for [__consumer_offsets,32] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,32] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:06,074] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,2] (state.change.logger)
[2017-06-27 13:06:06,075] ERROR Controller 1 epoch 10 encountered error while electing leader for partition [__consumer_offsets,2] due to: No other replicas in ISR 2 for [__consumer_offsets,2] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-27 13:06:06,075] ERROR Controller 1 epoch 10 initiated state change for partition [__consumer_offsets,2] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,2] due to: No other replicas in ISR 2 for [__consumer_offsets,2] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,2] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:06,075] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,1] (state.change.logger)
[2017-06-27 13:06:06,076] ERROR Controller 1 epoch 10 encountered error while electing leader for partition [__consumer_offsets,1] due to: No other replicas in ISR 2 for [__consumer_offsets,1] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-27 13:06:06,076] ERROR Controller 1 epoch 10 initiated state change for partition [__consumer_offsets,1] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,1] due to: No other replicas in ISR 2 for [__consumer_offsets,1] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,1] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:06,076] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,0] (state.change.logger)
[2017-06-27 13:06:06,077] ERROR Controller 1 epoch 10 encountered error while electing leader for partition [__consumer_offsets,0] due to: No other replicas in ISR 2 for [__consumer_offsets,0] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-27 13:06:06,077] ERROR Controller 1 epoch 10 initiated state change for partition [__consumer_offsets,0] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,0] due to: No other replicas in ISR 2 for [__consumer_offsets,0] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,0] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:06,077] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,15] (state.change.logger)
[2017-06-27 13:06:06,078] ERROR Controller 1 epoch 10 encountered error while electing leader for partition [__consumer_offsets,15] due to: No other replicas in ISR 2 for [__consumer_offsets,15] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-27 13:06:06,078] ERROR Controller 1 epoch 10 initiated state change for partition [__consumer_offsets,15] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,15] due to: No other replicas in ISR 2 for [__consumer_offsets,15] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,15] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:06,078] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,44] (state.change.logger)
[2017-06-27 13:06:06,079] ERROR Controller 1 epoch 10 encountered error while electing leader for partition [__consumer_offsets,44] due to: No other replicas in ISR 2 for [__consumer_offsets,44] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-27 13:06:06,079] ERROR Controller 1 epoch 10 initiated state change for partition [__consumer_offsets,44] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,44] due to: No other replicas in ISR 2 for [__consumer_offsets,44] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,44] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 23 more
[2017-06-27 13:06:06,079] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,17] (state.change.logger)
[2017-06-27 13:06:06,080] ERROR Controller 1 epoch 10 encountered error while electing leader for partition [__consumer_offsets,17] due to: No other replicas in ISR 2 for [__consumer_offsets,17] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-27 13:06:06,080] ERROR Controller 1 epoch 10 initiated state change for partition [__consumer_offsets,17] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,17] due to: No other replicas in ISR 2 for [__consumer_offsets,17] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,17] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 23 more
[2017-06-27 13:06:06,080] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,48] (state.change.logger)
[2017-06-27 13:06:06,081] ERROR Controller 1 epoch 10 encountered error while electing leader for partition [__consumer_offsets,48] due to: No other replicas in ISR 2 for [__consumer_offsets,48] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-27 13:06:06,081] ERROR Controller 1 epoch 10 initiated state change for partition [__consumer_offsets,48] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,48] due to: No other replicas in ISR 2 for [__consumer_offsets,48] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,48] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-27 13:06:06,081] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,26] (state.change.logger)
[2017-06-27 13:06:06,082] ERROR Controller 1 epoch 10 encountered error while electing leader for partition [__consumer_offsets,26] due to: No other replicas in ISR 2 for [__consumer_offsets,26] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-27 13:06:06,082] ERROR Controller 1 epoch 10 initiated state change for partition [__consumer_offsets,26] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,26] due to: No other replicas in ISR 2 for [__consumer_offsets,26] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,26] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:06,082] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,33] (state.change.logger)
[2017-06-27 13:06:06,083] ERROR Controller 1 epoch 10 encountered error while electing leader for partition [__consumer_offsets,33] due to: No other replicas in ISR 2 for [__consumer_offsets,33] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-27 13:06:06,083] ERROR Controller 1 epoch 10 initiated state change for partition [__consumer_offsets,33] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,33] due to: No other replicas in ISR 2 for [__consumer_offsets,33] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,33] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:06,083] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,41] (state.change.logger)
[2017-06-27 13:06:06,084] ERROR Controller 1 epoch 10 encountered error while electing leader for partition [__consumer_offsets,41] due to: No other replicas in ISR 2 for [__consumer_offsets,41] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-27 13:06:06,084] ERROR Controller 1 epoch 10 initiated state change for partition [__consumer_offsets,41] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,41] due to: No other replicas in ISR 2 for [__consumer_offsets,41] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,41] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-27 13:06:06,084] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,45] (state.change.logger)
[2017-06-27 13:06:06,085] ERROR Controller 1 epoch 10 encountered error while electing leader for partition [__consumer_offsets,45] due to: No other replicas in ISR 2 for [__consumer_offsets,45] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-27 13:06:06,085] ERROR Controller 1 epoch 10 initiated state change for partition [__consumer_offsets,45] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,45] due to: No other replicas in ISR 2 for [__consumer_offsets,45] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,45] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-27 13:06:06,085] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,35] (state.change.logger)
[2017-06-27 13:06:06,086] ERROR Controller 1 epoch 10 encountered error while electing leader for partition [__consumer_offsets,35] due to: No other replicas in ISR 2 for [__consumer_offsets,35] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-27 13:06:06,086] ERROR Controller 1 epoch 10 initiated state change for partition [__consumer_offsets,35] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,35] due to: No other replicas in ISR 2 for [__consumer_offsets,35] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,35] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:06,086] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,46] (state.change.logger)
[2017-06-27 13:06:06,087] ERROR Controller 1 epoch 10 encountered error while electing leader for partition [__consumer_offsets,46] due to: No other replicas in ISR 2 for [__consumer_offsets,46] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-27 13:06:06,087] ERROR Controller 1 epoch 10 initiated state change for partition [__consumer_offsets,46] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,46] due to: No other replicas in ISR 2 for [__consumer_offsets,46] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,46] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:06,087] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,19] (state.change.logger)
[2017-06-27 13:06:06,088] ERROR Controller 1 epoch 10 encountered error while electing leader for partition [__consumer_offsets,19] due to: No other replicas in ISR 2 for [__consumer_offsets,19] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-27 13:06:06,088] ERROR Controller 1 epoch 10 initiated state change for partition [__consumer_offsets,19] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,19] due to: No other replicas in ISR 2 for [__consumer_offsets,19] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,19] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:06,089] TRACE Controller 1 epoch 10 started leader election for partition [__consumer_offsets,30] (state.change.logger)
[2017-06-27 13:06:06,090] ERROR Controller 1 epoch 10 encountered error while electing leader for partition [__consumer_offsets,30] due to: No other replicas in ISR 2 for [__consumer_offsets,30] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-27 13:06:06,090] ERROR Controller 1 epoch 10 initiated state change for partition [__consumer_offsets,30] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,30] due to: No other replicas in ISR 2 for [__consumer_offsets,30] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,30] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:08,421] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-49 (state.change.logger)
[2017-06-27 13:06:08,421] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-38 (state.change.logger)
[2017-06-27 13:06:08,421] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-16 (state.change.logger)
[2017-06-27 13:06:08,421] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-27 (state.change.logger)
[2017-06-27 13:06:08,422] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-8 (state.change.logger)
[2017-06-27 13:06:08,422] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-19 (state.change.logger)
[2017-06-27 13:06:08,422] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-2 (state.change.logger)
[2017-06-27 13:06:08,422] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-13 (state.change.logger)
[2017-06-27 13:06:08,422] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-24 (state.change.logger)
[2017-06-27 13:06:08,422] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-46 (state.change.logger)
[2017-06-27 13:06:08,422] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-35 (state.change.logger)
[2017-06-27 13:06:08,422] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-5 (state.change.logger)
[2017-06-27 13:06:08,422] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-43 (state.change.logger)
[2017-06-27 13:06:08,422] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-21 (state.change.logger)
[2017-06-27 13:06:08,422] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-32 (state.change.logger)
[2017-06-27 13:06:08,422] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-10 (state.change.logger)
[2017-06-27 13:06:08,422] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-37 (state.change.logger)
[2017-06-27 13:06:08,422] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-48 (state.change.logger)
[2017-06-27 13:06:08,422] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-29 (state.change.logger)
[2017-06-27 13:06:08,422] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-40 (state.change.logger)
[2017-06-27 13:06:08,422] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-18 (state.change.logger)
[2017-06-27 13:06:08,422] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-7 (state.change.logger)
[2017-06-27 13:06:08,422] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-23 (state.change.logger)
[2017-06-27 13:06:08,422] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-34 (state.change.logger)
[2017-06-27 13:06:08,422] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-45 (state.change.logger)
[2017-06-27 13:06:08,422] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-26 (state.change.logger)
[2017-06-27 13:06:08,422] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-15 (state.change.logger)
[2017-06-27 13:06:08,422] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-4 (state.change.logger)
[2017-06-27 13:06:08,422] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-42 (state.change.logger)
[2017-06-27 13:06:08,422] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-20 (state.change.logger)
[2017-06-27 13:06:08,422] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-31 (state.change.logger)
[2017-06-27 13:06:08,422] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-9 (state.change.logger)
[2017-06-27 13:06:08,422] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-12 (state.change.logger)
[2017-06-27 13:06:08,422] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-1 (state.change.logger)
[2017-06-27 13:06:08,422] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-17 (state.change.logger)
[2017-06-27 13:06:08,422] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-28 (state.change.logger)
[2017-06-27 13:06:08,422] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-6 (state.change.logger)
[2017-06-27 13:06:08,422] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-39 (state.change.logger)
[2017-06-27 13:06:08,422] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-44 (state.change.logger)
[2017-06-27 13:06:08,422] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-47 (state.change.logger)
[2017-06-27 13:06:08,422] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-36 (state.change.logger)
[2017-06-27 13:06:08,422] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:9) to brokers Set(2) for partition rf1p1-0 (state.change.logger)
[2017-06-27 13:06:08,422] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-3 (state.change.logger)
[2017-06-27 13:06:08,422] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-14 (state.change.logger)
[2017-06-27 13:06:08,422] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-25 (state.change.logger)
[2017-06-27 13:06:08,422] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-30 (state.change.logger)
[2017-06-27 13:06:08,422] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-41 (state.change.logger)
[2017-06-27 13:06:08,422] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-22 (state.change.logger)
[2017-06-27 13:06:08,422] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-33 (state.change.logger)
[2017-06-27 13:06:08,422] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-11 (state.change.logger)
[2017-06-27 13:06:08,422] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-0 (state.change.logger)
[2017-06-27 13:06:08,427] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-13 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 0 (state.change.logger)
[2017-06-27 13:06:08,427] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-46 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 0 (state.change.logger)
[2017-06-27 13:06:08,427] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-9 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 0 (state.change.logger)
[2017-06-27 13:06:08,427] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-42 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 0 (state.change.logger)
[2017-06-27 13:06:08,427] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-21 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 0 (state.change.logger)
[2017-06-27 13:06:08,427] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-17 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 0 (state.change.logger)
[2017-06-27 13:06:08,427] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-30 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 0 (state.change.logger)
[2017-06-27 13:06:08,427] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-26 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 0 (state.change.logger)
[2017-06-27 13:06:08,427] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-5 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 0 (state.change.logger)
[2017-06-27 13:06:08,427] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-38 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 0 (state.change.logger)
[2017-06-27 13:06:08,427] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-1 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 0 (state.change.logger)
[2017-06-27 13:06:08,427] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-34 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 0 (state.change.logger)
[2017-06-27 13:06:08,427] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-16 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 0 (state.change.logger)
[2017-06-27 13:06:08,427] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-45 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 0 (state.change.logger)
[2017-06-27 13:06:08,427] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-12 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 0 (state.change.logger)
[2017-06-27 13:06:08,427] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-41 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 0 (state.change.logger)
[2017-06-27 13:06:08,427] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-24 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 0 (state.change.logger)
[2017-06-27 13:06:08,427] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-20 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 0 (state.change.logger)
[2017-06-27 13:06:08,427] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-49 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 0 (state.change.logger)
[2017-06-27 13:06:08,427] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-0 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 0 (state.change.logger)
[2017-06-27 13:06:08,427] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-29 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 0 (state.change.logger)
[2017-06-27 13:06:08,427] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-25 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 0 (state.change.logger)
[2017-06-27 13:06:08,428] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-8 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 0 (state.change.logger)
[2017-06-27 13:06:08,428] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-37 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 0 (state.change.logger)
[2017-06-27 13:06:08,428] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-4 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 0 (state.change.logger)
[2017-06-27 13:06:08,428] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-33 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 0 (state.change.logger)
[2017-06-27 13:06:08,428] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-15 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 0 (state.change.logger)
[2017-06-27 13:06:08,428] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-48 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 0 (state.change.logger)
[2017-06-27 13:06:08,428] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-11 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 0 (state.change.logger)
[2017-06-27 13:06:08,428] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-44 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 0 (state.change.logger)
[2017-06-27 13:06:08,428] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-23 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 0 (state.change.logger)
[2017-06-27 13:06:08,428] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:2) for partition rf1p1-0 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 0 (state.change.logger)
[2017-06-27 13:06:08,428] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-19 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 0 (state.change.logger)
[2017-06-27 13:06:08,428] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-32 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 0 (state.change.logger)
[2017-06-27 13:06:08,428] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-28 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 0 (state.change.logger)
[2017-06-27 13:06:08,428] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-7 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 0 (state.change.logger)
[2017-06-27 13:06:08,428] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-40 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 0 (state.change.logger)
[2017-06-27 13:06:08,428] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-3 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 0 (state.change.logger)
[2017-06-27 13:06:08,428] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-36 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 0 (state.change.logger)
[2017-06-27 13:06:08,428] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-47 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 0 (state.change.logger)
[2017-06-27 13:06:08,428] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-14 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 0 (state.change.logger)
[2017-06-27 13:06:08,428] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-43 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 0 (state.change.logger)
[2017-06-27 13:06:08,428] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-10 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 0 (state.change.logger)
[2017-06-27 13:06:08,428] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-22 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 0 (state.change.logger)
[2017-06-27 13:06:08,428] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-18 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 0 (state.change.logger)
[2017-06-27 13:06:08,428] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-31 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 0 (state.change.logger)
[2017-06-27 13:06:08,428] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-27 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 0 (state.change.logger)
[2017-06-27 13:06:08,428] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-39 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 0 (state.change.logger)
[2017-06-27 13:06:08,428] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-6 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 0 (state.change.logger)
[2017-06-27 13:06:08,428] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-35 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 0 (state.change.logger)
[2017-06-27 13:06:08,428] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-2 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 0 (state.change.logger)
[2017-06-27 13:06:08,429] TRACE Controller 2 epoch 11 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:08,432] TRACE Controller 2 epoch 11 changed state of replica 2 for partition [__consumer_offsets,17] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:06:08,433] TRACE Controller 2 epoch 11 changed state of replica 2 for partition [__consumer_offsets,38] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:06:08,433] TRACE Controller 2 epoch 11 changed state of replica 2 for partition [__consumer_offsets,39] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:06:08,433] TRACE Controller 2 epoch 11 changed state of replica 2 for partition [__consumer_offsets,23] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:06:08,433] TRACE Controller 2 epoch 11 changed state of replica 2 for partition [__consumer_offsets,48] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:06:08,433] TRACE Controller 2 epoch 11 changed state of replica 2 for partition [__consumer_offsets,42] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:06:08,433] TRACE Controller 2 epoch 11 changed state of replica 2 for partition [__consumer_offsets,2] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:06:08,433] TRACE Controller 2 epoch 11 changed state of replica 2 for partition [__consumer_offsets,22] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:06:08,433] TRACE Controller 2 epoch 11 changed state of replica 2 for partition [__consumer_offsets,13] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:06:08,433] TRACE Controller 2 epoch 11 changed state of replica 2 for partition [__consumer_offsets,34] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:06:08,433] TRACE Controller 2 epoch 11 changed state of replica 2 for partition [__consumer_offsets,40] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:06:08,433] TRACE Controller 2 epoch 11 changed state of replica 2 for partition [__consumer_offsets,33] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:06:08,433] TRACE Controller 2 epoch 11 changed state of replica 2 for partition [__consumer_offsets,3] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:06:08,433] TRACE Controller 2 epoch 11 changed state of replica 2 for partition [__consumer_offsets,37] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:06:08,433] TRACE Controller 2 epoch 11 changed state of replica 2 for partition [__consumer_offsets,24] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:06:08,433] TRACE Controller 2 epoch 11 changed state of replica 2 for partition [__consumer_offsets,11] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:06:08,433] TRACE Controller 2 epoch 11 changed state of replica 2 for partition [__consumer_offsets,20] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:06:08,433] TRACE Controller 2 epoch 11 changed state of replica 2 for partition [__consumer_offsets,27] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:06:08,433] TRACE Controller 2 epoch 11 changed state of replica 2 for partition [__consumer_offsets,30] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:06:08,433] TRACE Controller 2 epoch 11 changed state of replica 2 for partition [__consumer_offsets,15] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:06:08,433] TRACE Controller 2 epoch 11 changed state of replica 2 for partition [__consumer_offsets,28] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:06:08,433] TRACE Controller 2 epoch 11 changed state of replica 2 for partition [__consumer_offsets,7] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:06:08,434] TRACE Controller 2 epoch 11 changed state of replica 2 for partition [__consumer_offsets,43] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:06:08,434] TRACE Controller 2 epoch 11 changed state of replica 2 for partition [__consumer_offsets,10] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:06:08,434] TRACE Controller 2 epoch 11 changed state of replica 2 for partition [__consumer_offsets,12] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:06:08,434] TRACE Controller 2 epoch 11 changed state of replica 2 for partition [__consumer_offsets,32] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:06:08,434] TRACE Controller 2 epoch 11 changed state of replica 2 for partition [__consumer_offsets,4] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:06:08,434] TRACE Controller 2 epoch 11 changed state of replica 2 for partition [__consumer_offsets,26] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:06:08,434] TRACE Controller 2 epoch 11 changed state of replica 2 for partition [__consumer_offsets,35] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:06:08,434] TRACE Controller 2 epoch 11 changed state of replica 2 for partition [__consumer_offsets,46] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:06:08,434] TRACE Controller 2 epoch 11 changed state of replica 2 for partition [__consumer_offsets,6] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:06:08,434] TRACE Controller 2 epoch 11 changed state of replica 2 for partition [__consumer_offsets,8] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:06:08,434] TRACE Controller 2 epoch 11 changed state of replica 2 for partition [__consumer_offsets,44] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:06:08,434] TRACE Controller 2 epoch 11 changed state of replica 2 for partition [__consumer_offsets,45] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:06:08,434] TRACE Controller 2 epoch 11 changed state of replica 2 for partition [__consumer_offsets,49] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:06:08,434] TRACE Controller 2 epoch 11 changed state of replica 2 for partition [__consumer_offsets,1] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:06:08,434] TRACE Controller 2 epoch 11 changed state of replica 2 for partition [__consumer_offsets,19] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:06:08,434] TRACE Controller 2 epoch 11 changed state of replica 2 for partition [__consumer_offsets,36] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:06:08,434] TRACE Controller 2 epoch 11 changed state of replica 2 for partition [__consumer_offsets,14] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:06:08,434] TRACE Controller 2 epoch 11 changed state of replica 2 for partition [__consumer_offsets,31] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:06:08,434] TRACE Controller 2 epoch 11 changed state of replica 2 for partition [__consumer_offsets,21] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:06:08,434] TRACE Controller 2 epoch 11 changed state of replica 2 for partition [__consumer_offsets,25] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:06:08,434] TRACE Controller 2 epoch 11 changed state of replica 2 for partition [__consumer_offsets,5] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:06:08,434] TRACE Controller 2 epoch 11 changed state of replica 2 for partition [__consumer_offsets,41] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:06:08,435] TRACE Controller 2 epoch 11 changed state of replica 2 for partition [__consumer_offsets,47] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:06:08,435] TRACE Controller 2 epoch 11 changed state of replica 2 for partition [__consumer_offsets,16] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:06:08,435] TRACE Controller 2 epoch 11 changed state of replica 2 for partition [__consumer_offsets,0] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:06:08,435] TRACE Controller 2 epoch 11 changed state of replica 2 for partition [__consumer_offsets,29] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:06:08,435] TRACE Controller 2 epoch 11 changed state of replica 2 for partition [__consumer_offsets,18] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:06:08,435] TRACE Controller 2 epoch 11 changed state of replica 2 for partition [rf1p1,0] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:06:08,435] TRACE Controller 2 epoch 11 changed state of replica 2 for partition [__consumer_offsets,9] from OnlineReplica to OnlineReplica (state.change.logger)
[2017-06-27 13:06:08,436] TRACE Controller 2 epoch 11 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,49] (state.change.logger)
[2017-06-27 13:06:08,436] TRACE Controller 2 epoch 11 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,38] (state.change.logger)
[2017-06-27 13:06:08,436] TRACE Controller 2 epoch 11 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,27] (state.change.logger)
[2017-06-27 13:06:08,436] TRACE Controller 2 epoch 11 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,16] (state.change.logger)
[2017-06-27 13:06:08,436] TRACE Controller 2 epoch 11 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,8] (state.change.logger)
[2017-06-27 13:06:08,436] TRACE Controller 2 epoch 11 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,19] (state.change.logger)
[2017-06-27 13:06:08,436] TRACE Controller 2 epoch 11 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,2] (state.change.logger)
[2017-06-27 13:06:08,436] TRACE Controller 2 epoch 11 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,13] (state.change.logger)
[2017-06-27 13:06:08,436] TRACE Controller 2 epoch 11 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,24] (state.change.logger)
[2017-06-27 13:06:08,436] TRACE Controller 2 epoch 11 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,35] (state.change.logger)
[2017-06-27 13:06:08,436] TRACE Controller 2 epoch 11 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,46] (state.change.logger)
[2017-06-27 13:06:08,436] TRACE Controller 2 epoch 11 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,5] (state.change.logger)
[2017-06-27 13:06:08,436] TRACE Controller 2 epoch 11 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,43] (state.change.logger)
[2017-06-27 13:06:08,436] TRACE Controller 2 epoch 11 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,32] (state.change.logger)
[2017-06-27 13:06:08,436] TRACE Controller 2 epoch 11 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,21] (state.change.logger)
[2017-06-27 13:06:08,436] TRACE Controller 2 epoch 11 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,10] (state.change.logger)
[2017-06-27 13:06:08,436] TRACE Controller 2 epoch 11 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,37] (state.change.logger)
[2017-06-27 13:06:08,436] TRACE Controller 2 epoch 11 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,48] (state.change.logger)
[2017-06-27 13:06:08,436] TRACE Controller 2 epoch 11 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,40] (state.change.logger)
[2017-06-27 13:06:08,436] TRACE Controller 2 epoch 11 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,29] (state.change.logger)
[2017-06-27 13:06:08,436] TRACE Controller 2 epoch 11 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,18] (state.change.logger)
[2017-06-27 13:06:08,436] TRACE Controller 2 epoch 11 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,7] (state.change.logger)
[2017-06-27 13:06:08,436] TRACE Controller 2 epoch 11 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,23] (state.change.logger)
[2017-06-27 13:06:08,436] TRACE Controller 2 epoch 11 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,34] (state.change.logger)
[2017-06-27 13:06:08,436] TRACE Controller 2 epoch 11 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,45] (state.change.logger)
[2017-06-27 13:06:08,436] TRACE Controller 2 epoch 11 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,26] (state.change.logger)
[2017-06-27 13:06:08,436] TRACE Controller 2 epoch 11 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,15] (state.change.logger)
[2017-06-27 13:06:08,436] TRACE Controller 2 epoch 11 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,4] (state.change.logger)
[2017-06-27 13:06:08,436] TRACE Controller 2 epoch 11 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,42] (state.change.logger)
[2017-06-27 13:06:08,436] TRACE Controller 2 epoch 11 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,9] (state.change.logger)
[2017-06-27 13:06:08,436] TRACE Controller 2 epoch 11 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,20] (state.change.logger)
[2017-06-27 13:06:08,436] TRACE Controller 2 epoch 11 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,31] (state.change.logger)
[2017-06-27 13:06:08,436] TRACE Controller 2 epoch 11 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,12] (state.change.logger)
[2017-06-27 13:06:08,436] TRACE Controller 2 epoch 11 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,1] (state.change.logger)
[2017-06-27 13:06:08,436] TRACE Controller 2 epoch 11 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,28] (state.change.logger)
[2017-06-27 13:06:08,436] TRACE Controller 2 epoch 11 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,17] (state.change.logger)
[2017-06-27 13:06:08,436] TRACE Controller 2 epoch 11 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,6] (state.change.logger)
[2017-06-27 13:06:08,436] TRACE Controller 2 epoch 11 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,39] (state.change.logger)
[2017-06-27 13:06:08,436] TRACE Controller 2 epoch 11 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,44] (state.change.logger)
[2017-06-27 13:06:08,436] TRACE Controller 2 epoch 11 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,36] (state.change.logger)
[2017-06-27 13:06:08,437] TRACE Controller 2 epoch 11 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,47] (state.change.logger)
[2017-06-27 13:06:08,437] TRACE Controller 2 epoch 11 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:9) to broker 2 for partition [rf1p1,0] (state.change.logger)
[2017-06-27 13:06:08,437] TRACE Controller 2 epoch 11 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,3] (state.change.logger)
[2017-06-27 13:06:08,437] TRACE Controller 2 epoch 11 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,14] (state.change.logger)
[2017-06-27 13:06:08,437] TRACE Controller 2 epoch 11 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,25] (state.change.logger)
[2017-06-27 13:06:08,437] TRACE Controller 2 epoch 11 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,30] (state.change.logger)
[2017-06-27 13:06:08,437] TRACE Controller 2 epoch 11 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,41] (state.change.logger)
[2017-06-27 13:06:08,437] TRACE Controller 2 epoch 11 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,11] (state.change.logger)
[2017-06-27 13:06:08,437] TRACE Controller 2 epoch 11 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,22] (state.change.logger)
[2017-06-27 13:06:08,437] TRACE Controller 2 epoch 11 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,33] (state.change.logger)
[2017-06-27 13:06:08,437] TRACE Controller 2 epoch 11 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to broker 2 for partition [__consumer_offsets,0] (state.change.logger)
[2017-06-27 13:06:08,438] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-49 (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-38 (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-27 (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-16 (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-8 (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-19 (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-2 (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-13 (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-24 (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-35 (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-46 (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-5 (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-43 (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-32 (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-21 (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-10 (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-37 (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-48 (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-40 (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-29 (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-18 (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-7 (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-23 (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-34 (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-45 (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-26 (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-15 (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-4 (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-42 (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-9 (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-20 (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-31 (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-12 (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-1 (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-28 (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-17 (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-6 (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-39 (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-44 (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=15, replicas=[0, 1, 2]) correlation id 1 from controller 2 epoch 11 for partition [__consumer_offsets,13] (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-36 (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=14, replicas=[0, 1, 2]) correlation id 1 from controller 2 epoch 11 for partition [__consumer_offsets,46] (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-47 (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=7, isr=[2], zkVersion=11, replicas=[0, 1, 2]) correlation id 1 from controller 2 epoch 11 for partition [__consumer_offsets,9] (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:9) to brokers Set(2) for partition rf1p1-0 (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=7, isr=[2], zkVersion=11, replicas=[0, 1, 2]) correlation id 1 from controller 2 epoch 11 for partition [__consumer_offsets,42] (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-3 (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=7, isr=[2], zkVersion=11, replicas=[0, 1, 2]) correlation id 1 from controller 2 epoch 11 for partition [__consumer_offsets,21] (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-14 (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=10, isr=[2], zkVersion=15, replicas=[0, 1, 2]) correlation id 1 from controller 2 epoch 11 for partition [__consumer_offsets,17] (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-25 (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=7, isr=[2], zkVersion=11, replicas=[0, 1, 2]) correlation id 1 from controller 2 epoch 11 for partition [__consumer_offsets,30] (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-30 (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=14, replicas=[0, 1, 2]) correlation id 1 from controller 2 epoch 11 for partition [__consumer_offsets,26] (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-41 (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=10, isr=[2], zkVersion=15, replicas=[0, 1, 2]) correlation id 1 from controller 2 epoch 11 for partition [__consumer_offsets,5] (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=14, replicas=[0, 1, 2]) correlation id 1 from controller 2 epoch 11 for partition [__consumer_offsets,38] (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-11 (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=12, replicas=[0, 1, 2]) correlation id 1 from controller 2 epoch 11 for partition [__consumer_offsets,1] (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-22 (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=12, replicas=[0, 1, 2]) correlation id 1 from controller 2 epoch 11 for partition [__consumer_offsets,34] (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-33 (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=12, replicas=[0, 1, 2]) correlation id 1 from controller 2 epoch 11 for partition [__consumer_offsets,16] (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Controller 2 epoch 11 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10) to brokers Set(2) for partition __consumer_offsets-0 (state.change.logger)
[2017-06-27 13:06:08,439] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=7, isr=[2], zkVersion=11, replicas=[0, 1, 2]) correlation id 1 from controller 2 epoch 11 for partition [__consumer_offsets,45] (state.change.logger)
[2017-06-27 13:06:08,440] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=7, isr=[2], zkVersion=11, replicas=[0, 1, 2]) correlation id 1 from controller 2 epoch 11 for partition [__consumer_offsets,12] (state.change.logger)
[2017-06-27 13:06:08,440] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=10, isr=[2], zkVersion=15, replicas=[0, 1, 2]) correlation id 1 from controller 2 epoch 11 for partition [__consumer_offsets,41] (state.change.logger)
[2017-06-27 13:06:08,440] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=7, isr=[2], zkVersion=11, replicas=[0, 1, 2]) correlation id 1 from controller 2 epoch 11 for partition [__consumer_offsets,24] (state.change.logger)
[2017-06-27 13:06:08,440] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=14, replicas=[0, 1, 2]) correlation id 1 from controller 2 epoch 11 for partition [__consumer_offsets,20] (state.change.logger)
[2017-06-27 13:06:08,440] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=12, replicas=[0, 1, 2]) correlation id 1 from controller 2 epoch 11 for partition [__consumer_offsets,49] (state.change.logger)
[2017-06-27 13:06:08,440] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=7, isr=[2], zkVersion=11, replicas=[0, 1, 2]) correlation id 1 from controller 2 epoch 11 for partition [__consumer_offsets,0] (state.change.logger)
[2017-06-27 13:06:08,440] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=10, isr=[2], zkVersion=15, replicas=[0, 1, 2]) correlation id 1 from controller 2 epoch 11 for partition [__consumer_offsets,29] (state.change.logger)
[2017-06-27 13:06:08,440] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=12, replicas=[0, 1, 2]) correlation id 1 from controller 2 epoch 11 for partition [__consumer_offsets,25] (state.change.logger)
[2017-06-27 13:06:08,440] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=14, replicas=[0, 1, 2]) correlation id 1 from controller 2 epoch 11 for partition [__consumer_offsets,8] (state.change.logger)
[2017-06-27 13:06:08,440] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=14, replicas=[0, 1, 2]) correlation id 1 from controller 2 epoch 11 for partition [__consumer_offsets,37] (state.change.logger)
[2017-06-27 13:06:08,440] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=14, replicas=[0, 1, 2]) correlation id 1 from controller 2 epoch 11 for partition [__consumer_offsets,4] (state.change.logger)
[2017-06-27 13:06:08,440] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=7, isr=[2], zkVersion=11, replicas=[0, 1, 2]) correlation id 1 from controller 2 epoch 11 for partition [__consumer_offsets,33] (state.change.logger)
[2017-06-27 13:06:08,440] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=7, isr=[2], zkVersion=11, replicas=[0, 1, 2]) correlation id 1 from controller 2 epoch 11 for partition [__consumer_offsets,15] (state.change.logger)
[2017-06-27 13:06:08,440] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=7, isr=[2], zkVersion=11, replicas=[0, 1, 2]) correlation id 1 from controller 2 epoch 11 for partition [__consumer_offsets,48] (state.change.logger)
[2017-06-27 13:06:08,440] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=10, isr=[2], zkVersion=15, replicas=[0, 1, 2]) correlation id 1 from controller 2 epoch 11 for partition [__consumer_offsets,11] (state.change.logger)
[2017-06-27 13:06:08,440] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=14, replicas=[0, 1, 2]) correlation id 1 from controller 2 epoch 11 for partition [__consumer_offsets,44] (state.change.logger)
[2017-06-27 13:06:08,440] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=10, isr=[2], zkVersion=15, replicas=[0, 1, 2]) correlation id 1 from controller 2 epoch 11 for partition [__consumer_offsets,23] (state.change.logger)
[2017-06-27 13:06:08,440] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=2, leaderEpoch=9, isr=[2], zkVersion=9, replicas=[2]) correlation id 1 from controller 2 epoch 11 for partition [rf1p1,0] (state.change.logger)
[2017-06-27 13:06:08,440] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=14, replicas=[0, 1, 2]) correlation id 1 from controller 2 epoch 11 for partition [__consumer_offsets,19] (state.change.logger)
[2017-06-27 13:06:08,440] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=14, replicas=[0, 1, 2]) correlation id 1 from controller 2 epoch 11 for partition [__consumer_offsets,32] (state.change.logger)
[2017-06-27 13:06:08,440] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=12, replicas=[0, 1, 2]) correlation id 1 from controller 2 epoch 11 for partition [__consumer_offsets,28] (state.change.logger)
[2017-06-27 13:06:08,440] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=12, replicas=[0, 1, 2]) correlation id 1 from controller 2 epoch 11 for partition [__consumer_offsets,7] (state.change.logger)
[2017-06-27 13:06:08,440] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=12, replicas=[0, 1, 2]) correlation id 1 from controller 2 epoch 11 for partition [__consumer_offsets,40] (state.change.logger)
[2017-06-27 13:06:08,440] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=7, isr=[2], zkVersion=11, replicas=[0, 1, 2]) correlation id 1 from controller 2 epoch 11 for partition [__consumer_offsets,3] (state.change.logger)
[2017-06-27 13:06:08,440] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=7, isr=[2], zkVersion=11, replicas=[0, 1, 2]) correlation id 1 from controller 2 epoch 11 for partition [__consumer_offsets,36] (state.change.logger)
[2017-06-27 13:06:08,440] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=10, isr=[2], zkVersion=15, replicas=[0, 1, 2]) correlation id 1 from controller 2 epoch 11 for partition [__consumer_offsets,47] (state.change.logger)
[2017-06-27 13:06:08,440] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=14, replicas=[0, 1, 2]) correlation id 1 from controller 2 epoch 11 for partition [__consumer_offsets,14] (state.change.logger)
[2017-06-27 13:06:08,440] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=12, replicas=[0, 1, 2]) correlation id 1 from controller 2 epoch 11 for partition [__consumer_offsets,43] (state.change.logger)
[2017-06-27 13:06:08,440] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=12, replicas=[0, 1, 2]) correlation id 1 from controller 2 epoch 11 for partition [__consumer_offsets,10] (state.change.logger)
[2017-06-27 13:06:08,440] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=14, replicas=[0, 1, 2]) correlation id 1 from controller 2 epoch 11 for partition [__consumer_offsets,22] (state.change.logger)
[2017-06-27 13:06:08,440] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=7, isr=[2], zkVersion=11, replicas=[0, 1, 2]) correlation id 1 from controller 2 epoch 11 for partition [__consumer_offsets,18] (state.change.logger)
[2017-06-27 13:06:08,440] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=12, replicas=[0, 1, 2]) correlation id 1 from controller 2 epoch 11 for partition [__consumer_offsets,31] (state.change.logger)
[2017-06-27 13:06:08,440] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=7, isr=[2], zkVersion=11, replicas=[0, 1, 2]) correlation id 1 from controller 2 epoch 11 for partition [__consumer_offsets,27] (state.change.logger)
[2017-06-27 13:06:08,440] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=7, isr=[2], zkVersion=11, replicas=[0, 1, 2]) correlation id 1 from controller 2 epoch 11 for partition [__consumer_offsets,39] (state.change.logger)
[2017-06-27 13:06:08,440] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=7, isr=[2], zkVersion=11, replicas=[0, 1, 2]) correlation id 1 from controller 2 epoch 11 for partition [__consumer_offsets,6] (state.change.logger)
[2017-06-27 13:06:08,440] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=10, isr=[2], zkVersion=15, replicas=[0, 1, 2]) correlation id 1 from controller 2 epoch 11 for partition [__consumer_offsets,35] (state.change.logger)
[2017-06-27 13:06:08,441] TRACE Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=2, leaderEpoch=9, isr=[2], zkVersion=14, replicas=[0, 1, 2]) correlation id 1 from controller 2 epoch 11 for partition [__consumer_offsets,2] (state.change.logger)
[2017-06-27 13:06:08,441] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 11 for partition [__consumer_offsets,13] since its associated leader epoch 9 is not higher than the current leader epoch 9 (state.change.logger)
[2017-06-27 13:06:08,441] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 11 for partition [__consumer_offsets,46] since its associated leader epoch 9 is not higher than the current leader epoch 9 (state.change.logger)
[2017-06-27 13:06:08,441] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 11 for partition [__consumer_offsets,9] since its associated leader epoch 7 is not higher than the current leader epoch 7 (state.change.logger)
[2017-06-27 13:06:08,441] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 11 for partition [__consumer_offsets,42] since its associated leader epoch 7 is not higher than the current leader epoch 7 (state.change.logger)
[2017-06-27 13:06:08,441] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 11 for partition [__consumer_offsets,21] since its associated leader epoch 7 is not higher than the current leader epoch 7 (state.change.logger)
[2017-06-27 13:06:08,441] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 11 for partition [__consumer_offsets,17] since its associated leader epoch 10 is not higher than the current leader epoch 10 (state.change.logger)
[2017-06-27 13:06:08,441] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 11 for partition [__consumer_offsets,30] since its associated leader epoch 7 is not higher than the current leader epoch 7 (state.change.logger)
[2017-06-27 13:06:08,441] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 11 for partition [__consumer_offsets,26] since its associated leader epoch 9 is not higher than the current leader epoch 9 (state.change.logger)
[2017-06-27 13:06:08,441] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 11 for partition [__consumer_offsets,5] since its associated leader epoch 10 is not higher than the current leader epoch 10 (state.change.logger)
[2017-06-27 13:06:08,441] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 11 for partition [__consumer_offsets,38] since its associated leader epoch 9 is not higher than the current leader epoch 9 (state.change.logger)
[2017-06-27 13:06:08,441] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 11 for partition [__consumer_offsets,1] since its associated leader epoch 9 is not higher than the current leader epoch 9 (state.change.logger)
[2017-06-27 13:06:08,441] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 11 for partition [__consumer_offsets,34] since its associated leader epoch 9 is not higher than the current leader epoch 9 (state.change.logger)
[2017-06-27 13:06:08,441] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 11 for partition [__consumer_offsets,16] since its associated leader epoch 9 is not higher than the current leader epoch 9 (state.change.logger)
[2017-06-27 13:06:08,441] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 11 for partition [__consumer_offsets,45] since its associated leader epoch 7 is not higher than the current leader epoch 7 (state.change.logger)
[2017-06-27 13:06:08,441] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 11 for partition [__consumer_offsets,12] since its associated leader epoch 7 is not higher than the current leader epoch 7 (state.change.logger)
[2017-06-27 13:06:08,441] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 11 for partition [__consumer_offsets,41] since its associated leader epoch 10 is not higher than the current leader epoch 10 (state.change.logger)
[2017-06-27 13:06:08,441] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 11 for partition [__consumer_offsets,24] since its associated leader epoch 7 is not higher than the current leader epoch 7 (state.change.logger)
[2017-06-27 13:06:08,441] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 11 for partition [__consumer_offsets,20] since its associated leader epoch 9 is not higher than the current leader epoch 9 (state.change.logger)
[2017-06-27 13:06:08,441] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 11 for partition [__consumer_offsets,49] since its associated leader epoch 9 is not higher than the current leader epoch 9 (state.change.logger)
[2017-06-27 13:06:08,441] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 11 for partition [__consumer_offsets,0] since its associated leader epoch 7 is not higher than the current leader epoch 7 (state.change.logger)
[2017-06-27 13:06:08,441] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 11 for partition [__consumer_offsets,29] since its associated leader epoch 10 is not higher than the current leader epoch 10 (state.change.logger)
[2017-06-27 13:06:08,441] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 11 for partition [__consumer_offsets,25] since its associated leader epoch 9 is not higher than the current leader epoch 9 (state.change.logger)
[2017-06-27 13:06:08,441] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 11 for partition [__consumer_offsets,8] since its associated leader epoch 9 is not higher than the current leader epoch 9 (state.change.logger)
[2017-06-27 13:06:08,441] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 11 for partition [__consumer_offsets,37] since its associated leader epoch 9 is not higher than the current leader epoch 9 (state.change.logger)
[2017-06-27 13:06:08,441] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 11 for partition [__consumer_offsets,4] since its associated leader epoch 9 is not higher than the current leader epoch 9 (state.change.logger)
[2017-06-27 13:06:08,441] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 11 for partition [__consumer_offsets,33] since its associated leader epoch 7 is not higher than the current leader epoch 7 (state.change.logger)
[2017-06-27 13:06:08,441] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 11 for partition [__consumer_offsets,15] since its associated leader epoch 7 is not higher than the current leader epoch 7 (state.change.logger)
[2017-06-27 13:06:08,441] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 11 for partition [__consumer_offsets,48] since its associated leader epoch 7 is not higher than the current leader epoch 7 (state.change.logger)
[2017-06-27 13:06:08,441] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 11 for partition [__consumer_offsets,11] since its associated leader epoch 10 is not higher than the current leader epoch 10 (state.change.logger)
[2017-06-27 13:06:08,442] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 11 for partition [__consumer_offsets,44] since its associated leader epoch 9 is not higher than the current leader epoch 9 (state.change.logger)
[2017-06-27 13:06:08,442] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 11 for partition [__consumer_offsets,23] since its associated leader epoch 10 is not higher than the current leader epoch 10 (state.change.logger)
[2017-06-27 13:06:08,442] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 11 for partition [rf1p1,0] since its associated leader epoch 9 is not higher than the current leader epoch 9 (state.change.logger)
[2017-06-27 13:06:08,442] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 11 for partition [__consumer_offsets,19] since its associated leader epoch 9 is not higher than the current leader epoch 9 (state.change.logger)
[2017-06-27 13:06:08,442] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 11 for partition [__consumer_offsets,32] since its associated leader epoch 9 is not higher than the current leader epoch 9 (state.change.logger)
[2017-06-27 13:06:08,442] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 11 for partition [__consumer_offsets,28] since its associated leader epoch 9 is not higher than the current leader epoch 9 (state.change.logger)
[2017-06-27 13:06:08,442] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 11 for partition [__consumer_offsets,7] since its associated leader epoch 9 is not higher than the current leader epoch 9 (state.change.logger)
[2017-06-27 13:06:08,442] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 11 for partition [__consumer_offsets,40] since its associated leader epoch 9 is not higher than the current leader epoch 9 (state.change.logger)
[2017-06-27 13:06:08,442] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 11 for partition [__consumer_offsets,3] since its associated leader epoch 7 is not higher than the current leader epoch 7 (state.change.logger)
[2017-06-27 13:06:08,442] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 11 for partition [__consumer_offsets,36] since its associated leader epoch 7 is not higher than the current leader epoch 7 (state.change.logger)
[2017-06-27 13:06:08,442] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 11 for partition [__consumer_offsets,47] since its associated leader epoch 10 is not higher than the current leader epoch 10 (state.change.logger)
[2017-06-27 13:06:08,442] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 11 for partition [__consumer_offsets,14] since its associated leader epoch 9 is not higher than the current leader epoch 9 (state.change.logger)
[2017-06-27 13:06:08,442] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 11 for partition [__consumer_offsets,43] since its associated leader epoch 9 is not higher than the current leader epoch 9 (state.change.logger)
[2017-06-27 13:06:08,442] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 11 for partition [__consumer_offsets,10] since its associated leader epoch 9 is not higher than the current leader epoch 9 (state.change.logger)
[2017-06-27 13:06:08,442] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 11 for partition [__consumer_offsets,22] since its associated leader epoch 9 is not higher than the current leader epoch 9 (state.change.logger)
[2017-06-27 13:06:08,442] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 11 for partition [__consumer_offsets,18] since its associated leader epoch 7 is not higher than the current leader epoch 7 (state.change.logger)
[2017-06-27 13:06:08,442] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 11 for partition [__consumer_offsets,31] since its associated leader epoch 9 is not higher than the current leader epoch 9 (state.change.logger)
[2017-06-27 13:06:08,442] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 11 for partition [__consumer_offsets,27] since its associated leader epoch 7 is not higher than the current leader epoch 7 (state.change.logger)
[2017-06-27 13:06:08,442] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 11 for partition [__consumer_offsets,39] since its associated leader epoch 7 is not higher than the current leader epoch 7 (state.change.logger)
[2017-06-27 13:06:08,442] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 11 for partition [__consumer_offsets,6] since its associated leader epoch 7 is not higher than the current leader epoch 7 (state.change.logger)
[2017-06-27 13:06:08,442] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 11 for partition [__consumer_offsets,35] since its associated leader epoch 10 is not higher than the current leader epoch 10 (state.change.logger)
[2017-06-27 13:06:08,442] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 11 for partition [__consumer_offsets,2] since its associated leader epoch 9 is not higher than the current leader epoch 9 (state.change.logger)
[2017-06-27 13:06:08,443] TRACE Controller 2 epoch 11 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=49,error_code=11},{topic=__consumer_offsets,partition=38,error_code=11},{topic=__consumer_offsets,partition=16,error_code=11},{topic=__consumer_offsets,partition=27,error_code=11},{topic=__consumer_offsets,partition=8,error_code=11},{topic=__consumer_offsets,partition=19,error_code=11},{topic=__consumer_offsets,partition=2,error_code=11},{topic=__consumer_offsets,partition=13,error_code=11},{topic=__consumer_offsets,partition=35,error_code=11},{topic=__consumer_offsets,partition=24,error_code=11},{topic=__consumer_offsets,partition=46,error_code=11},{topic=__consumer_offsets,partition=5,error_code=11},{topic=__consumer_offsets,partition=43,error_code=11},{topic=__consumer_offsets,partition=21,error_code=11},{topic=__consumer_offsets,partition=32,error_code=11},{topic=__consumer_offsets,partition=10,error_code=11},{topic=__consumer_offsets,partition=37,error_code=11},{topic=__consumer_offsets,partition=48,error_code=11},{topic=__consumer_offsets,partition=29,error_code=11},{topic=__consumer_offsets,partition=40,error_code=11},{topic=__consumer_offsets,partition=18,error_code=11},{topic=__consumer_offsets,partition=7,error_code=11},{topic=__consumer_offsets,partition=45,error_code=11},{topic=__consumer_offsets,partition=34,error_code=11},{topic=__consumer_offsets,partition=23,error_code=11},{topic=__consumer_offsets,partition=26,error_code=11},{topic=__consumer_offsets,partition=4,error_code=11},{topic=__consumer_offsets,partition=15,error_code=11},{topic=__consumer_offsets,partition=42,error_code=11},{topic=__consumer_offsets,partition=20,error_code=11},{topic=__consumer_offsets,partition=9,error_code=11},{topic=__consumer_offsets,partition=31,error_code=11},{topic=__consumer_offsets,partition=12,error_code=11},{topic=__consumer_offsets,partition=1,error_code=11},{topic=__consumer_offsets,partition=17,error_code=11},{topic=__consumer_offsets,partition=28,error_code=11},{topic=__consumer_offsets,partition=6,error_code=11},{topic=__consumer_offsets,partition=39,error_code=11},{topic=__consumer_offsets,partition=44,error_code=11},{topic=__consumer_offsets,partition=36,error_code=11},{topic=__consumer_offsets,partition=47,error_code=11},{topic=rf1p1,partition=0,error_code=11},{topic=__consumer_offsets,partition=25,error_code=11},{topic=__consumer_offsets,partition=3,error_code=11},{topic=__consumer_offsets,partition=14,error_code=11},{topic=__consumer_offsets,partition=41,error_code=11},{topic=__consumer_offsets,partition=30,error_code=11},{topic=__consumer_offsets,partition=33,error_code=11},{topic=__consumer_offsets,partition=11,error_code=11},{topic=__consumer_offsets,partition=22,error_code=11},{topic=__consumer_offsets,partition=0,error_code=11}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:08,444] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-13 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 2 (state.change.logger)
[2017-06-27 13:06:08,444] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-46 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 2 (state.change.logger)
[2017-06-27 13:06:08,444] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-9 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 2 (state.change.logger)
[2017-06-27 13:06:08,444] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-42 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 2 (state.change.logger)
[2017-06-27 13:06:08,444] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-21 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 2 (state.change.logger)
[2017-06-27 13:06:08,444] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-17 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 2 (state.change.logger)
[2017-06-27 13:06:08,444] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-30 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 2 (state.change.logger)
[2017-06-27 13:06:08,444] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-26 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 2 (state.change.logger)
[2017-06-27 13:06:08,444] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-5 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 2 (state.change.logger)
[2017-06-27 13:06:08,444] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-38 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 2 (state.change.logger)
[2017-06-27 13:06:08,444] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-1 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 2 (state.change.logger)
[2017-06-27 13:06:08,444] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-34 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 2 (state.change.logger)
[2017-06-27 13:06:08,444] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-16 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 2 (state.change.logger)
[2017-06-27 13:06:08,444] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-45 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 2 (state.change.logger)
[2017-06-27 13:06:08,444] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-12 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 2 (state.change.logger)
[2017-06-27 13:06:08,444] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-41 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 2 (state.change.logger)
[2017-06-27 13:06:08,445] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-24 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 2 (state.change.logger)
[2017-06-27 13:06:08,445] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-20 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 2 (state.change.logger)
[2017-06-27 13:06:08,445] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-49 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 2 (state.change.logger)
[2017-06-27 13:06:08,445] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-0 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 2 (state.change.logger)
[2017-06-27 13:06:08,445] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-29 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 2 (state.change.logger)
[2017-06-27 13:06:08,445] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-25 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 2 (state.change.logger)
[2017-06-27 13:06:08,445] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-8 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 2 (state.change.logger)
[2017-06-27 13:06:08,445] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-37 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 2 (state.change.logger)
[2017-06-27 13:06:08,445] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-4 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 2 (state.change.logger)
[2017-06-27 13:06:08,445] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-33 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 2 (state.change.logger)
[2017-06-27 13:06:08,445] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-15 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 2 (state.change.logger)
[2017-06-27 13:06:08,445] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-48 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 2 (state.change.logger)
[2017-06-27 13:06:08,445] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-11 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 2 (state.change.logger)
[2017-06-27 13:06:08,445] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-44 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 2 (state.change.logger)
[2017-06-27 13:06:08,445] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-23 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 2 (state.change.logger)
[2017-06-27 13:06:08,445] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:2) for partition rf1p1-0 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 2 (state.change.logger)
[2017-06-27 13:06:08,445] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-19 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 2 (state.change.logger)
[2017-06-27 13:06:08,445] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-32 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 2 (state.change.logger)
[2017-06-27 13:06:08,445] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-28 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 2 (state.change.logger)
[2017-06-27 13:06:08,445] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-7 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 2 (state.change.logger)
[2017-06-27 13:06:08,445] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-40 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 2 (state.change.logger)
[2017-06-27 13:06:08,445] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-3 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 2 (state.change.logger)
[2017-06-27 13:06:08,446] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-36 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 2 (state.change.logger)
[2017-06-27 13:06:08,446] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-47 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 2 (state.change.logger)
[2017-06-27 13:06:08,446] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-14 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 2 (state.change.logger)
[2017-06-27 13:06:08,446] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-43 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 2 (state.change.logger)
[2017-06-27 13:06:08,446] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-10 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 2 (state.change.logger)
[2017-06-27 13:06:08,446] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-22 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 2 (state.change.logger)
[2017-06-27 13:06:08,446] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-18 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 2 (state.change.logger)
[2017-06-27 13:06:08,446] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-31 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 2 (state.change.logger)
[2017-06-27 13:06:08,446] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-27 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 2 (state.change.logger)
[2017-06-27 13:06:08,446] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-39 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 2 (state.change.logger)
[2017-06-27 13:06:08,446] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-6 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 2 (state.change.logger)
[2017-06-27 13:06:08,446] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:10,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-35 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 2 (state.change.logger)
[2017-06-27 13:06:08,446] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:9,ControllerEpoch:10),ReplicationFactor:3),AllReplicas:0,1,2) for partition __consumer_offsets-2 in response to UpdateMetadata request sent by controller 2 epoch 11 with correlation id 2 (state.change.logger)
[2017-06-27 13:06:08,446] TRACE Controller 2 epoch 11 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-27 13:06:10,641] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,43] (state.change.logger)
[2017-06-27 13:06:10,643] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,43] due to: No other replicas in ISR 2 for [__consumer_offsets,43] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:10,644] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,43] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,43] due to: No other replicas in ISR 2 for [__consumer_offsets,43] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,43] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:10,646] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,14] (state.change.logger)
[2017-06-27 13:06:10,647] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,14] due to: No other replicas in ISR 2 for [__consumer_offsets,14] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:10,647] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,14] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,14] due to: No other replicas in ISR 2 for [__consumer_offsets,14] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,14] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:10,647] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,28] (state.change.logger)
[2017-06-27 13:06:10,648] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,28] due to: No other replicas in ISR 2 for [__consumer_offsets,28] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:10,648] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,28] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,28] due to: No other replicas in ISR 2 for [__consumer_offsets,28] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,28] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:10,648] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,4] (state.change.logger)
[2017-06-27 13:06:10,649] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,4] due to: No other replicas in ISR 2 for [__consumer_offsets,4] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:10,649] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,4] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,4] due to: No other replicas in ISR 2 for [__consumer_offsets,4] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,4] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:10,649] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,36] (state.change.logger)
[2017-06-27 13:06:10,650] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,36] due to: No other replicas in ISR 2 for [__consumer_offsets,36] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:10,650] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,36] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,36] due to: No other replicas in ISR 2 for [__consumer_offsets,36] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,36] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:10,650] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,6] (state.change.logger)
[2017-06-27 13:06:10,651] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,6] due to: No other replicas in ISR 2 for [__consumer_offsets,6] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:10,651] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,6] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,6] due to: No other replicas in ISR 2 for [__consumer_offsets,6] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,6] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:10,652] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,39] (state.change.logger)
[2017-06-27 13:06:10,653] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,39] due to: No other replicas in ISR 2 for [__consumer_offsets,39] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:10,653] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,39] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,39] due to: No other replicas in ISR 2 for [__consumer_offsets,39] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,39] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-27 13:06:10,653] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,23] (state.change.logger)
[2017-06-27 13:06:10,654] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,23] due to: No other replicas in ISR 2 for [__consumer_offsets,23] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:10,654] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,23] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,23] due to: No other replicas in ISR 2 for [__consumer_offsets,23] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,23] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-27 13:06:10,654] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,24] (state.change.logger)
[2017-06-27 13:06:10,655] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,24] due to: No other replicas in ISR 2 for [__consumer_offsets,24] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:10,655] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,24] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,24] due to: No other replicas in ISR 2 for [__consumer_offsets,24] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,24] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:10,656] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,38] (state.change.logger)
[2017-06-27 13:06:10,657] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,38] due to: No other replicas in ISR 2 for [__consumer_offsets,38] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:10,657] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,38] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,38] due to: No other replicas in ISR 2 for [__consumer_offsets,38] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,38] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:10,657] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,16] (state.change.logger)
[2017-06-27 13:06:10,658] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,16] due to: No other replicas in ISR 2 for [__consumer_offsets,16] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:10,658] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,16] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,16] due to: No other replicas in ISR 2 for [__consumer_offsets,16] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,16] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 24 more
[2017-06-27 13:06:10,659] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,3] (state.change.logger)
[2017-06-27 13:06:10,660] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,3] due to: No other replicas in ISR 2 for [__consumer_offsets,3] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:10,660] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,3] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,3] due to: No other replicas in ISR 2 for [__consumer_offsets,3] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,3] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 24 more
[2017-06-27 13:06:10,660] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,21] (state.change.logger)
[2017-06-27 13:06:10,661] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,21] due to: No other replicas in ISR 2 for [__consumer_offsets,21] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:10,661] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,21] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,21] due to: No other replicas in ISR 2 for [__consumer_offsets,21] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,21] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:10,661] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,10] (state.change.logger)
[2017-06-27 13:06:10,662] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,10] due to: No other replicas in ISR 2 for [__consumer_offsets,10] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:10,662] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,10] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,10] due to: No other replicas in ISR 2 for [__consumer_offsets,10] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,10] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:10,662] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,40] (state.change.logger)
[2017-06-27 13:06:10,663] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,40] due to: No other replicas in ISR 2 for [__consumer_offsets,40] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:10,663] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,40] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,40] due to: No other replicas in ISR 2 for [__consumer_offsets,40] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,40] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:10,664] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,34] (state.change.logger)
[2017-06-27 13:06:10,665] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,34] due to: No other replicas in ISR 2 for [__consumer_offsets,34] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:10,665] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,34] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,34] due to: No other replicas in ISR 2 for [__consumer_offsets,34] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,34] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-27 13:06:10,665] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,25] (state.change.logger)
[2017-06-27 13:06:10,666] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,25] due to: No other replicas in ISR 2 for [__consumer_offsets,25] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:10,666] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,25] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,25] due to: No other replicas in ISR 2 for [__consumer_offsets,25] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,25] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:10,666] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,27] (state.change.logger)
[2017-06-27 13:06:10,667] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,27] due to: No other replicas in ISR 2 for [__consumer_offsets,27] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:10,667] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,27] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,27] due to: No other replicas in ISR 2 for [__consumer_offsets,27] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,27] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:10,667] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,42] (state.change.logger)
[2017-06-27 13:06:10,668] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,42] due to: No other replicas in ISR 2 for [__consumer_offsets,42] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:10,668] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,42] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,42] due to: No other replicas in ISR 2 for [__consumer_offsets,42] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,42] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:10,669] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,11] (state.change.logger)
[2017-06-27 13:06:10,670] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,11] due to: No other replicas in ISR 2 for [__consumer_offsets,11] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:10,670] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,11] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,11] due to: No other replicas in ISR 2 for [__consumer_offsets,11] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,11] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:10,670] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,7] (state.change.logger)
[2017-06-27 13:06:10,671] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,7] due to: No other replicas in ISR 2 for [__consumer_offsets,7] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:10,671] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,7] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,7] due to: No other replicas in ISR 2 for [__consumer_offsets,7] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,7] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:10,671] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,47] (state.change.logger)
[2017-06-27 13:06:10,672] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,47] due to: No other replicas in ISR 2 for [__consumer_offsets,47] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:10,672] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,47] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,47] due to: No other replicas in ISR 2 for [__consumer_offsets,47] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,47] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:10,672] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,9] (state.change.logger)
[2017-06-27 13:06:10,673] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,9] due to: No other replicas in ISR 2 for [__consumer_offsets,9] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:10,673] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,9] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,9] due to: No other replicas in ISR 2 for [__consumer_offsets,9] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,9] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:10,674] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,13] (state.change.logger)
[2017-06-27 13:06:10,674] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,13] due to: No other replicas in ISR 2 for [__consumer_offsets,13] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:10,674] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,13] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,13] due to: No other replicas in ISR 2 for [__consumer_offsets,13] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,13] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-27 13:06:10,675] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,29] (state.change.logger)
[2017-06-27 13:06:10,675] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,29] due to: No other replicas in ISR 2 for [__consumer_offsets,29] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:10,675] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,29] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,29] due to: No other replicas in ISR 2 for [__consumer_offsets,29] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,29] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:10,676] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,8] (state.change.logger)
[2017-06-27 13:06:10,676] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,8] due to: No other replicas in ISR 2 for [__consumer_offsets,8] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:10,676] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,8] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,8] due to: No other replicas in ISR 2 for [__consumer_offsets,8] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,8] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:10,676] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,22] (state.change.logger)
[2017-06-27 13:06:10,677] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,22] due to: No other replicas in ISR 2 for [__consumer_offsets,22] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:10,677] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,22] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,22] due to: No other replicas in ISR 2 for [__consumer_offsets,22] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,22] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:10,677] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,31] (state.change.logger)
[2017-06-27 13:06:10,678] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,31] due to: No other replicas in ISR 2 for [__consumer_offsets,31] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:10,678] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,31] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,31] due to: No other replicas in ISR 2 for [__consumer_offsets,31] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,31] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-27 13:06:10,678] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,18] (state.change.logger)
[2017-06-27 13:06:10,679] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,18] due to: No other replicas in ISR 2 for [__consumer_offsets,18] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:10,679] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,18] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,18] due to: No other replicas in ISR 2 for [__consumer_offsets,18] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,18] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:10,679] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,20] (state.change.logger)
[2017-06-27 13:06:10,680] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,20] due to: No other replicas in ISR 2 for [__consumer_offsets,20] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:10,680] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,20] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,20] due to: No other replicas in ISR 2 for [__consumer_offsets,20] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,20] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:10,680] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,37] (state.change.logger)
[2017-06-27 13:06:10,681] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,37] due to: No other replicas in ISR 2 for [__consumer_offsets,37] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:10,681] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,37] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,37] due to: No other replicas in ISR 2 for [__consumer_offsets,37] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,37] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-27 13:06:10,681] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,49] (state.change.logger)
[2017-06-27 13:06:10,682] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,49] due to: No other replicas in ISR 2 for [__consumer_offsets,49] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:10,682] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,49] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,49] due to: No other replicas in ISR 2 for [__consumer_offsets,49] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,49] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:10,683] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,12] (state.change.logger)
[2017-06-27 13:06:10,683] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,12] due to: No other replicas in ISR 2 for [__consumer_offsets,12] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:10,683] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,12] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,12] due to: No other replicas in ISR 2 for [__consumer_offsets,12] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,12] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:10,684] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,5] (state.change.logger)
[2017-06-27 13:06:10,684] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,5] due to: No other replicas in ISR 2 for [__consumer_offsets,5] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:10,684] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,5] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,5] due to: No other replicas in ISR 2 for [__consumer_offsets,5] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,5] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:10,685] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,32] (state.change.logger)
[2017-06-27 13:06:10,685] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,32] due to: No other replicas in ISR 2 for [__consumer_offsets,32] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:10,685] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,32] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,32] due to: No other replicas in ISR 2 for [__consumer_offsets,32] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,32] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:10,686] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,2] (state.change.logger)
[2017-06-27 13:06:10,686] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,2] due to: No other replicas in ISR 2 for [__consumer_offsets,2] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:10,686] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,2] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,2] due to: No other replicas in ISR 2 for [__consumer_offsets,2] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,2] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:10,687] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,1] (state.change.logger)
[2017-06-27 13:06:10,687] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,1] due to: No other replicas in ISR 2 for [__consumer_offsets,1] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:10,687] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,1] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,1] due to: No other replicas in ISR 2 for [__consumer_offsets,1] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,1] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:10,687] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,0] (state.change.logger)
[2017-06-27 13:06:10,688] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,0] due to: No other replicas in ISR 2 for [__consumer_offsets,0] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:10,688] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,0] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,0] due to: No other replicas in ISR 2 for [__consumer_offsets,0] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,0] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:10,688] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,15] (state.change.logger)
[2017-06-27 13:06:10,689] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,15] due to: No other replicas in ISR 2 for [__consumer_offsets,15] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:10,689] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,15] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,15] due to: No other replicas in ISR 2 for [__consumer_offsets,15] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,15] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:10,689] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,44] (state.change.logger)
[2017-06-27 13:06:10,690] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,44] due to: No other replicas in ISR 2 for [__consumer_offsets,44] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:10,690] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,44] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,44] due to: No other replicas in ISR 2 for [__consumer_offsets,44] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,44] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 23 more
[2017-06-27 13:06:10,690] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,17] (state.change.logger)
[2017-06-27 13:06:10,691] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,17] due to: No other replicas in ISR 2 for [__consumer_offsets,17] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:10,691] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,17] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,17] due to: No other replicas in ISR 2 for [__consumer_offsets,17] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,17] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 23 more
[2017-06-27 13:06:10,691] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,48] (state.change.logger)
[2017-06-27 13:06:10,692] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,48] due to: No other replicas in ISR 2 for [__consumer_offsets,48] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:10,692] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,48] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,48] due to: No other replicas in ISR 2 for [__consumer_offsets,48] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,48] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-27 13:06:10,692] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,26] (state.change.logger)
[2017-06-27 13:06:10,693] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,26] due to: No other replicas in ISR 2 for [__consumer_offsets,26] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:10,693] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,26] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,26] due to: No other replicas in ISR 2 for [__consumer_offsets,26] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,26] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:10,693] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,33] (state.change.logger)
[2017-06-27 13:06:10,694] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,33] due to: No other replicas in ISR 2 for [__consumer_offsets,33] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:10,694] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,33] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,33] due to: No other replicas in ISR 2 for [__consumer_offsets,33] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,33] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:10,694] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,41] (state.change.logger)
[2017-06-27 13:06:10,695] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,41] due to: No other replicas in ISR 2 for [__consumer_offsets,41] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:10,695] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,41] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,41] due to: No other replicas in ISR 2 for [__consumer_offsets,41] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,41] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-27 13:06:10,695] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,45] (state.change.logger)
[2017-06-27 13:06:10,696] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,45] due to: No other replicas in ISR 2 for [__consumer_offsets,45] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:10,696] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,45] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,45] due to: No other replicas in ISR 2 for [__consumer_offsets,45] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,45] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-27 13:06:10,696] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,35] (state.change.logger)
[2017-06-27 13:06:10,697] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,35] due to: No other replicas in ISR 2 for [__consumer_offsets,35] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:10,697] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,35] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,35] due to: No other replicas in ISR 2 for [__consumer_offsets,35] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,35] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:10,697] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,46] (state.change.logger)
[2017-06-27 13:06:10,698] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,46] due to: No other replicas in ISR 2 for [__consumer_offsets,46] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:10,698] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,46] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,46] due to: No other replicas in ISR 2 for [__consumer_offsets,46] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,46] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:10,698] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,19] (state.change.logger)
[2017-06-27 13:06:10,699] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,19] due to: No other replicas in ISR 2 for [__consumer_offsets,19] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:10,699] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,19] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,19] due to: No other replicas in ISR 2 for [__consumer_offsets,19] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,19] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:10,699] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,30] (state.change.logger)
[2017-06-27 13:06:10,700] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,30] due to: No other replicas in ISR 2 for [__consumer_offsets,30] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:10,700] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,30] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,30] due to: No other replicas in ISR 2 for [__consumer_offsets,30] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,30] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:15,714] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,43] (state.change.logger)
[2017-06-27 13:06:15,716] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,43] due to: No other replicas in ISR 2 for [__consumer_offsets,43] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:15,716] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,43] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,43] due to: No other replicas in ISR 2 for [__consumer_offsets,43] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,43] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:15,716] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,14] (state.change.logger)
[2017-06-27 13:06:15,717] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,14] due to: No other replicas in ISR 2 for [__consumer_offsets,14] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:15,717] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,14] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,14] due to: No other replicas in ISR 2 for [__consumer_offsets,14] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,14] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:15,717] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,28] (state.change.logger)
[2017-06-27 13:06:15,718] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,28] due to: No other replicas in ISR 2 for [__consumer_offsets,28] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:15,719] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,28] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,28] due to: No other replicas in ISR 2 for [__consumer_offsets,28] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,28] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:15,719] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,4] (state.change.logger)
[2017-06-27 13:06:15,720] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,4] due to: No other replicas in ISR 2 for [__consumer_offsets,4] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:15,720] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,4] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,4] due to: No other replicas in ISR 2 for [__consumer_offsets,4] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,4] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:15,720] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,36] (state.change.logger)
[2017-06-27 13:06:15,721] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,36] due to: No other replicas in ISR 2 for [__consumer_offsets,36] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:15,721] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,36] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,36] due to: No other replicas in ISR 2 for [__consumer_offsets,36] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,36] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:15,721] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,6] (state.change.logger)
[2017-06-27 13:06:15,722] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,6] due to: No other replicas in ISR 2 for [__consumer_offsets,6] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:15,722] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,6] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,6] due to: No other replicas in ISR 2 for [__consumer_offsets,6] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,6] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:15,723] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,39] (state.change.logger)
[2017-06-27 13:06:15,723] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,39] due to: No other replicas in ISR 2 for [__consumer_offsets,39] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:15,723] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,39] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,39] due to: No other replicas in ISR 2 for [__consumer_offsets,39] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,39] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-27 13:06:15,724] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,23] (state.change.logger)
[2017-06-27 13:06:15,725] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,23] due to: No other replicas in ISR 2 for [__consumer_offsets,23] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:15,725] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,23] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,23] due to: No other replicas in ISR 2 for [__consumer_offsets,23] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,23] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-27 13:06:15,725] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,24] (state.change.logger)
[2017-06-27 13:06:15,726] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,24] due to: No other replicas in ISR 2 for [__consumer_offsets,24] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:15,727] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,24] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,24] due to: No other replicas in ISR 2 for [__consumer_offsets,24] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,24] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:15,727] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,38] (state.change.logger)
[2017-06-27 13:06:15,728] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,38] due to: No other replicas in ISR 2 for [__consumer_offsets,38] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:15,728] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,38] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,38] due to: No other replicas in ISR 2 for [__consumer_offsets,38] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,38] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:15,728] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,16] (state.change.logger)
[2017-06-27 13:06:15,729] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,16] due to: No other replicas in ISR 2 for [__consumer_offsets,16] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:15,729] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,16] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,16] due to: No other replicas in ISR 2 for [__consumer_offsets,16] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,16] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 24 more
[2017-06-27 13:06:15,729] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,3] (state.change.logger)
[2017-06-27 13:06:15,730] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,3] due to: No other replicas in ISR 2 for [__consumer_offsets,3] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:15,730] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,3] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,3] due to: No other replicas in ISR 2 for [__consumer_offsets,3] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,3] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 24 more
[2017-06-27 13:06:15,730] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,21] (state.change.logger)
[2017-06-27 13:06:15,731] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,21] due to: No other replicas in ISR 2 for [__consumer_offsets,21] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:15,731] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,21] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,21] due to: No other replicas in ISR 2 for [__consumer_offsets,21] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,21] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:15,731] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,10] (state.change.logger)
[2017-06-27 13:06:15,731] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,10] due to: No other replicas in ISR 2 for [__consumer_offsets,10] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:15,732] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,10] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,10] due to: No other replicas in ISR 2 for [__consumer_offsets,10] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,10] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:15,732] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,40] (state.change.logger)
[2017-06-27 13:06:15,732] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,40] due to: No other replicas in ISR 2 for [__consumer_offsets,40] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:15,733] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,40] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,40] due to: No other replicas in ISR 2 for [__consumer_offsets,40] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,40] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:15,733] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,34] (state.change.logger)
[2017-06-27 13:06:15,733] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,34] due to: No other replicas in ISR 2 for [__consumer_offsets,34] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:15,734] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,34] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,34] due to: No other replicas in ISR 2 for [__consumer_offsets,34] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,34] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-27 13:06:15,734] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,25] (state.change.logger)
[2017-06-27 13:06:15,734] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,25] due to: No other replicas in ISR 2 for [__consumer_offsets,25] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:15,735] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,25] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,25] due to: No other replicas in ISR 2 for [__consumer_offsets,25] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,25] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:15,735] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,27] (state.change.logger)
[2017-06-27 13:06:15,735] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,27] due to: No other replicas in ISR 2 for [__consumer_offsets,27] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:15,736] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,27] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,27] due to: No other replicas in ISR 2 for [__consumer_offsets,27] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,27] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:15,736] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,42] (state.change.logger)
[2017-06-27 13:06:15,736] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,42] due to: No other replicas in ISR 2 for [__consumer_offsets,42] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:15,736] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,42] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,42] due to: No other replicas in ISR 2 for [__consumer_offsets,42] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,42] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:15,737] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,11] (state.change.logger)
[2017-06-27 13:06:15,738] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,11] due to: No other replicas in ISR 2 for [__consumer_offsets,11] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:15,738] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,11] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,11] due to: No other replicas in ISR 2 for [__consumer_offsets,11] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,11] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:15,738] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,7] (state.change.logger)
[2017-06-27 13:06:15,739] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,7] due to: No other replicas in ISR 2 for [__consumer_offsets,7] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:15,739] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,7] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,7] due to: No other replicas in ISR 2 for [__consumer_offsets,7] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,7] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:15,739] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,47] (state.change.logger)
[2017-06-27 13:06:15,740] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,47] due to: No other replicas in ISR 2 for [__consumer_offsets,47] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:15,740] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,47] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,47] due to: No other replicas in ISR 2 for [__consumer_offsets,47] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,47] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:15,740] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,9] (state.change.logger)
[2017-06-27 13:06:15,741] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,9] due to: No other replicas in ISR 2 for [__consumer_offsets,9] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:15,741] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,9] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,9] due to: No other replicas in ISR 2 for [__consumer_offsets,9] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,9] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:15,741] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,13] (state.change.logger)
[2017-06-27 13:06:15,742] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,13] due to: No other replicas in ISR 2 for [__consumer_offsets,13] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:15,742] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,13] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,13] due to: No other replicas in ISR 2 for [__consumer_offsets,13] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,13] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-27 13:06:15,742] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,29] (state.change.logger)
[2017-06-27 13:06:15,743] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,29] due to: No other replicas in ISR 2 for [__consumer_offsets,29] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:15,743] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,29] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,29] due to: No other replicas in ISR 2 for [__consumer_offsets,29] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,29] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:15,743] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,8] (state.change.logger)
[2017-06-27 13:06:15,744] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,8] due to: No other replicas in ISR 2 for [__consumer_offsets,8] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:15,744] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,8] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,8] due to: No other replicas in ISR 2 for [__consumer_offsets,8] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,8] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:15,744] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,22] (state.change.logger)
[2017-06-27 13:06:15,745] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,22] due to: No other replicas in ISR 2 for [__consumer_offsets,22] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:15,745] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,22] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,22] due to: No other replicas in ISR 2 for [__consumer_offsets,22] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,22] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:15,745] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,31] (state.change.logger)
[2017-06-27 13:06:15,746] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,31] due to: No other replicas in ISR 2 for [__consumer_offsets,31] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:15,746] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,31] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,31] due to: No other replicas in ISR 2 for [__consumer_offsets,31] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,31] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-27 13:06:15,746] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,18] (state.change.logger)
[2017-06-27 13:06:15,747] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,18] due to: No other replicas in ISR 2 for [__consumer_offsets,18] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:15,747] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,18] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,18] due to: No other replicas in ISR 2 for [__consumer_offsets,18] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,18] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:15,747] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,20] (state.change.logger)
[2017-06-27 13:06:15,748] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,20] due to: No other replicas in ISR 2 for [__consumer_offsets,20] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:15,748] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,20] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,20] due to: No other replicas in ISR 2 for [__consumer_offsets,20] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,20] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:15,748] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,37] (state.change.logger)
[2017-06-27 13:06:15,749] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,37] due to: No other replicas in ISR 2 for [__consumer_offsets,37] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:15,749] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,37] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,37] due to: No other replicas in ISR 2 for [__consumer_offsets,37] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,37] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-27 13:06:15,749] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,49] (state.change.logger)
[2017-06-27 13:06:15,750] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,49] due to: No other replicas in ISR 2 for [__consumer_offsets,49] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:15,750] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,49] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,49] due to: No other replicas in ISR 2 for [__consumer_offsets,49] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,49] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:15,750] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,12] (state.change.logger)
[2017-06-27 13:06:15,751] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,12] due to: No other replicas in ISR 2 for [__consumer_offsets,12] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:15,751] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,12] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,12] due to: No other replicas in ISR 2 for [__consumer_offsets,12] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,12] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:15,751] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,5] (state.change.logger)
[2017-06-27 13:06:15,752] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,5] due to: No other replicas in ISR 2 for [__consumer_offsets,5] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:15,752] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,5] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,5] due to: No other replicas in ISR 2 for [__consumer_offsets,5] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,5] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:15,752] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,32] (state.change.logger)
[2017-06-27 13:06:15,753] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,32] due to: No other replicas in ISR 2 for [__consumer_offsets,32] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:15,753] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,32] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,32] due to: No other replicas in ISR 2 for [__consumer_offsets,32] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,32] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:15,753] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,2] (state.change.logger)
[2017-06-27 13:06:15,754] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,2] due to: No other replicas in ISR 2 for [__consumer_offsets,2] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:15,754] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,2] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,2] due to: No other replicas in ISR 2 for [__consumer_offsets,2] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,2] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:15,754] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,1] (state.change.logger)
[2017-06-27 13:06:15,755] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,1] due to: No other replicas in ISR 2 for [__consumer_offsets,1] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:15,755] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,1] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,1] due to: No other replicas in ISR 2 for [__consumer_offsets,1] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,1] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:15,755] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,0] (state.change.logger)
[2017-06-27 13:06:15,756] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,0] due to: No other replicas in ISR 2 for [__consumer_offsets,0] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:15,756] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,0] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,0] due to: No other replicas in ISR 2 for [__consumer_offsets,0] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,0] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:15,756] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,15] (state.change.logger)
[2017-06-27 13:06:15,757] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,15] due to: No other replicas in ISR 2 for [__consumer_offsets,15] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:15,757] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,15] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,15] due to: No other replicas in ISR 2 for [__consumer_offsets,15] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,15] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:15,757] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,44] (state.change.logger)
[2017-06-27 13:06:15,758] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,44] due to: No other replicas in ISR 2 for [__consumer_offsets,44] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:15,758] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,44] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,44] due to: No other replicas in ISR 2 for [__consumer_offsets,44] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,44] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 23 more
[2017-06-27 13:06:15,758] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,17] (state.change.logger)
[2017-06-27 13:06:15,759] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,17] due to: No other replicas in ISR 2 for [__consumer_offsets,17] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:15,759] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,17] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,17] due to: No other replicas in ISR 2 for [__consumer_offsets,17] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,17] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 23 more
[2017-06-27 13:06:15,759] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,48] (state.change.logger)
[2017-06-27 13:06:15,760] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,48] due to: No other replicas in ISR 2 for [__consumer_offsets,48] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:15,760] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,48] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,48] due to: No other replicas in ISR 2 for [__consumer_offsets,48] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,48] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-27 13:06:15,760] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,26] (state.change.logger)
[2017-06-27 13:06:15,761] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,26] due to: No other replicas in ISR 2 for [__consumer_offsets,26] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:15,761] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,26] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,26] due to: No other replicas in ISR 2 for [__consumer_offsets,26] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,26] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:15,761] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,33] (state.change.logger)
[2017-06-27 13:06:15,762] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,33] due to: No other replicas in ISR 2 for [__consumer_offsets,33] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:15,762] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,33] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,33] due to: No other replicas in ISR 2 for [__consumer_offsets,33] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,33] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:15,762] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,41] (state.change.logger)
[2017-06-27 13:06:15,763] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,41] due to: No other replicas in ISR 2 for [__consumer_offsets,41] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:15,763] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,41] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,41] due to: No other replicas in ISR 2 for [__consumer_offsets,41] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,41] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-27 13:06:15,763] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,45] (state.change.logger)
[2017-06-27 13:06:15,764] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,45] due to: No other replicas in ISR 2 for [__consumer_offsets,45] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:15,764] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,45] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,45] due to: No other replicas in ISR 2 for [__consumer_offsets,45] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,45] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-27 13:06:15,764] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,35] (state.change.logger)
[2017-06-27 13:06:15,765] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,35] due to: No other replicas in ISR 2 for [__consumer_offsets,35] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:15,765] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,35] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,35] due to: No other replicas in ISR 2 for [__consumer_offsets,35] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,35] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:15,765] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,46] (state.change.logger)
[2017-06-27 13:06:15,766] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,46] due to: No other replicas in ISR 2 for [__consumer_offsets,46] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:15,766] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,46] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,46] due to: No other replicas in ISR 2 for [__consumer_offsets,46] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,46] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:15,766] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,19] (state.change.logger)
[2017-06-27 13:06:15,767] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,19] due to: No other replicas in ISR 2 for [__consumer_offsets,19] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:15,767] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,19] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,19] due to: No other replicas in ISR 2 for [__consumer_offsets,19] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,19] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-27 13:06:15,767] TRACE Controller 2 epoch 11 started leader election for partition [__consumer_offsets,30] (state.change.logger)
[2017-06-27 13:06:15,768] ERROR Controller 2 epoch 11 encountered error while electing leader for partition [__consumer_offsets,30] due to: No other replicas in ISR 2 for [__consumer_offsets,30] besides shutting down brokers 2. (state.change.logger)
[2017-06-27 13:06:15,768] ERROR Controller 2 epoch 11 initiated state change for partition [__consumer_offsets,30] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,30] due to: No other replicas in ISR 2 for [__consumer_offsets,30] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,30] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
