[2017-06-26 15:09:06,689] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [my-replicated-topic-1,0] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:06,690] TRACE Controller 1 epoch 88 received response {error_code=0,partitions=[{topic=my-replicated-topic-1,partition=0,error_code=0}]} for a request sent to broker 10.133.22.156:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 15:09:06,690] TRACE Controller 1 epoch 88 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,2,LeaderEpoch:1,ControllerEpoch:88) to broker 2 for partition [my-replicated-topic-1,0] (state.change.logger)
[2017-06-26 15:09:06,690] TRACE Controller 1 epoch 88 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,2,LeaderEpoch:1,ControllerEpoch:88) to broker 1 for partition [my-replicated-topic-1,0] (state.change.logger)
[2017-06-26 15:09:06,690] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:1,ISR:1,2,LeaderEpoch:1,ControllerEpoch:88) to brokers Set(0, 1, 2) for partition my-replicated-topic-1-0 (state.change.logger)
[2017-06-26 15:09:06,691] TRACE Controller 1 epoch 88 started leader election for partition [my-replicated-topic-2,0] (state.change.logger)
[2017-06-26 15:09:06,691] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=88, leader=1, leaderEpoch=1, isr=[1, 2], zkVersion=1, replicas=[0, 1, 2]) correlation id 9 from controller 1 epoch 88 for partition [my-replicated-topic-1,0] (state.change.logger)
[2017-06-26 15:09:06,692] TRACE Broker 1 handling LeaderAndIsr request correlationId 9 from controller 1 epoch 88 starting the become-leader transition for partition my-replicated-topic-1-0 (state.change.logger)
[2017-06-26 15:09:06,692] TRACE Controller 1 epoch 88 received response {error_code=0} for a request sent to broker 10.133.22.156:9092 (id: 0 rack: null) (state.change.logger)
[2017-06-26 15:09:06,692] INFO Broker 1 skipped the become-leader state change after marking its partition as leader with correlation id 9 from controller 1 epoch 88 for partition my-replicated-topic-1-0 since it is already the leader for the partition. (state.change.logger)
[2017-06-26 15:09:06,692] TRACE Broker 1 completed LeaderAndIsr request correlationId 9 from controller 1 epoch 88 for the become-leader transition for partition my-replicated-topic-1-0 (state.change.logger)
[2017-06-26 15:09:06,693] TRACE Controller 1 epoch 88 received response {error_code=0,partitions=[{topic=my-replicated-topic-1,partition=0,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 15:09:06,693] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:1,ControllerEpoch:88),ReplicationFactor:3),AllReplicas:0,1,2) for partition my-replicated-topic-1-0 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 10 (state.change.logger)
[2017-06-26 15:09:06,693] TRACE Controller 1 epoch 88 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 15:09:06,694] TRACE Controller 1 epoch 88 received response {error_code=0,partitions=[{topic=my-replicated-topic-1,partition=0,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 15:09:06,695] TRACE Controller 1 epoch 88 elected leader 1 for Offline partition [my-replicated-topic-2,0] (state.change.logger)
[2017-06-26 15:09:06,695] TRACE Controller 1 epoch 88 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 15:09:06,695] TRACE Controller 1 epoch 88 changed partition [my-replicated-topic-2,0] from OnlinePartition to OnlinePartition with leader 1 (state.change.logger)
[2017-06-26 15:09:06,695] TRACE Controller 1 epoch 88 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:1,ControllerEpoch:88) to broker 1 for partition [my-replicated-topic-2,0] (state.change.logger)
[2017-06-26 15:09:06,696] TRACE Controller 1 epoch 88 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:1,ControllerEpoch:88) to broker 0 for partition [my-replicated-topic-2,0] (state.change.logger)
[2017-06-26 15:09:06,696] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:1,ControllerEpoch:88) to brokers Set(0, 1, 2) for partition my-replicated-topic-2-0 (state.change.logger)
[2017-06-26 15:09:06,696] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=88, leader=1, leaderEpoch=1, isr=[1], zkVersion=1, replicas=[0, 1]) correlation id 11 from controller 1 epoch 88 for partition [my-replicated-topic-2,0] (state.change.logger)
[2017-06-26 15:09:06,696] TRACE Broker 1 handling LeaderAndIsr request correlationId 11 from controller 1 epoch 88 starting the become-leader transition for partition my-replicated-topic-2-0 (state.change.logger)
[2017-06-26 15:09:06,696] TRACE Broker 1 stopped fetchers as part of become-leader request from controller 1 epoch 88 with correlation id 11 for partition my-replicated-topic-2-0 (state.change.logger)
[2017-06-26 15:09:06,696] TRACE Broker 1 completed LeaderAndIsr request correlationId 11 from controller 1 epoch 88 for the become-leader transition for partition my-replicated-topic-2-0 (state.change.logger)
[2017-06-26 15:09:06,697] TRACE Controller 1 epoch 88 received response {error_code=0,partitions=[{topic=my-replicated-topic-2,partition=0,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 15:09:06,697] TRACE Controller 1 epoch 88 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 15:09:06,697] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:1,ControllerEpoch:88),ReplicationFactor:2),AllReplicas:0,1) for partition my-replicated-topic-2-0 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 12 (state.change.logger)
[2017-06-26 15:09:06,697] TRACE Controller 1 epoch 88 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 15:09:06,699] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [my-replicated-topic-1,1] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:06,699] TRACE Controller 1 epoch 88 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,1,LeaderEpoch:1,ControllerEpoch:88) to broker 2 for partition [my-replicated-topic-1,1] (state.change.logger)
[2017-06-26 15:09:06,699] TRACE Controller 1 epoch 88 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,1,LeaderEpoch:1,ControllerEpoch:88) to broker 1 for partition [my-replicated-topic-1,1] (state.change.logger)
[2017-06-26 15:09:06,699] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:2,ISR:2,1,LeaderEpoch:1,ControllerEpoch:88) to brokers Set(0, 1, 2) for partition my-replicated-topic-1-1 (state.change.logger)
[2017-06-26 15:09:06,699] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=88, leader=2, leaderEpoch=1, isr=[2, 1], zkVersion=1, replicas=[0, 1, 2]) correlation id 13 from controller 1 epoch 88 for partition [my-replicated-topic-1,1] (state.change.logger)
[2017-06-26 15:09:06,699] TRACE Controller 1 epoch 88 started leader election for partition [my-replicated-topic,0] (state.change.logger)
[2017-06-26 15:09:06,699] TRACE Broker 1 handling LeaderAndIsr request correlationId 13 from controller 1 epoch 88 starting the become-follower transition for partition my-replicated-topic-1-1 (state.change.logger)
[2017-06-26 15:09:06,700] INFO Broker 1 skipped the become-follower state change after marking its partition as follower with correlation id 13 from controller 1 epoch 88 for partition my-replicated-topic-1-1 since the new leader 2 is the same as the old leader (state.change.logger)
[2017-06-26 15:09:06,701] TRACE Broker 1 completed LeaderAndIsr request correlationId 13 from controller 1 epoch 88 for the become-follower transition for partition my-replicated-topic-1-1 (state.change.logger)
[2017-06-26 15:09:06,701] TRACE Controller 1 epoch 88 received response {error_code=0,partitions=[{topic=my-replicated-topic-1,partition=1,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 15:09:06,702] TRACE Controller 1 epoch 88 received response {error_code=0,partitions=[{topic=my-replicated-topic-1,partition=1,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 15:09:06,702] TRACE Controller 1 epoch 88 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 15:09:06,702] TRACE Controller 1 epoch 88 elected leader 1 for Offline partition [my-replicated-topic,0] (state.change.logger)
[2017-06-26 15:09:06,702] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:1,ControllerEpoch:88),ReplicationFactor:3),AllReplicas:0,1,2) for partition my-replicated-topic-1-1 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 14 (state.change.logger)
[2017-06-26 15:09:06,702] TRACE Controller 1 epoch 88 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 15:09:06,703] TRACE Controller 1 epoch 88 changed partition [my-replicated-topic,0] from OnlinePartition to OnlinePartition with leader 1 (state.change.logger)
[2017-06-26 15:09:06,703] TRACE Controller 1 epoch 88 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:1,ControllerEpoch:88) to broker 1 for partition [my-replicated-topic,0] (state.change.logger)
[2017-06-26 15:09:06,703] TRACE Controller 1 epoch 88 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:1,ControllerEpoch:88) to broker 0 for partition [my-replicated-topic,0] (state.change.logger)
[2017-06-26 15:09:06,703] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:1,ControllerEpoch:88) to brokers Set(0, 1, 2) for partition my-replicated-topic-0 (state.change.logger)
[2017-06-26 15:09:06,703] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=88, leader=1, leaderEpoch=1, isr=[1], zkVersion=1, replicas=[0, 1]) correlation id 15 from controller 1 epoch 88 for partition [my-replicated-topic,0] (state.change.logger)
[2017-06-26 15:09:06,703] TRACE Broker 1 handling LeaderAndIsr request correlationId 15 from controller 1 epoch 88 starting the become-leader transition for partition my-replicated-topic-0 (state.change.logger)
[2017-06-26 15:09:06,703] TRACE Broker 1 stopped fetchers as part of become-leader request from controller 1 epoch 88 with correlation id 15 for partition my-replicated-topic-0 (state.change.logger)
[2017-06-26 15:09:06,704] TRACE Broker 1 completed LeaderAndIsr request correlationId 15 from controller 1 epoch 88 for the become-leader transition for partition my-replicated-topic-0 (state.change.logger)
[2017-06-26 15:09:06,704] TRACE Controller 1 epoch 88 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 15:09:06,706] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [my-replicated-topic,2] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:06,706] TRACE Controller 1 epoch 88 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:1,ControllerEpoch:88) to broker 2 for partition [my-replicated-topic,2] (state.change.logger)
[2017-06-26 15:09:06,706] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:1,ControllerEpoch:88) to brokers Set(0, 1, 2) for partition my-replicated-topic-2 (state.change.logger)
[2017-06-26 15:09:06,707] TRACE Controller 1 epoch 88 received response {error_code=0,partitions=[{topic=my-replicated-topic,partition=2,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 15:09:06,708] TRACE Controller 1 epoch 88 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 15:09:06,713] TRACE Controller 1 epoch 88 changed state of replica 2 for partition [my-replicated-topic-1,0] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:06,713] TRACE Controller 1 epoch 88 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:2,ControllerEpoch:88) to broker 1 for partition [my-replicated-topic-1,0] (state.change.logger)
[2017-06-26 15:09:06,713] TRACE Controller 1 epoch 88 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:2,ControllerEpoch:88) to broker 0 for partition [my-replicated-topic-1,0] (state.change.logger)
[2017-06-26 15:09:06,713] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:2,ControllerEpoch:88) to brokers Set(0, 1, 2) for partition my-replicated-topic-1-0 (state.change.logger)
[2017-06-26 15:09:06,713] TRACE Controller 1 epoch 88 received response {error_code=0,partitions=[{topic=my-replicated-topic-1,partition=0,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 15:09:06,714] TRACE Controller 1 epoch 88 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 15:09:06,715] TRACE Controller 1 epoch 88 received response {error_code=0,partitions=[{topic=my-replicated-topic-1,partition=0,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 15:09:06,716] TRACE Controller 1 epoch 88 received response {error_code=0,partitions=[{topic=my-replicated-topic-2,partition=1,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 15:09:06,716] TRACE Controller 1 epoch 88 changed state of replica 2 for partition [my-replicated-topic-2,1] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:06,716] TRACE Controller 1 epoch 88 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:1,ControllerEpoch:88) to broker 1 for partition [my-replicated-topic-2,1] (state.change.logger)
[2017-06-26 15:09:06,716] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:1,ControllerEpoch:88) to brokers Set(0, 1, 2) for partition my-replicated-topic-2-1 (state.change.logger)
[2017-06-26 15:09:06,716] TRACE Controller 1 epoch 88 started leader election for partition [my-replicated-topic-1,1] (state.change.logger)
[2017-06-26 15:09:06,717] TRACE Controller 1 epoch 88 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 15:09:06,718] TRACE Controller 1 epoch 88 received response {error_code=0,partitions=[{topic=my-replicated-topic-2,partition=1,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 15:09:06,720] TRACE Controller 1 epoch 88 elected leader 1 for Offline partition [my-replicated-topic-1,1] (state.change.logger)
[2017-06-26 15:09:06,721] TRACE Controller 1 epoch 88 changed partition [my-replicated-topic-1,1] from OnlinePartition to OnlinePartition with leader 1 (state.change.logger)
[2017-06-26 15:09:06,721] TRACE Controller 1 epoch 88 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:2,ControllerEpoch:88) to broker 2 for partition [my-replicated-topic-1,1] (state.change.logger)
[2017-06-26 15:09:06,721] TRACE Controller 1 epoch 88 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:2,ControllerEpoch:88) to broker 1 for partition [my-replicated-topic-1,1] (state.change.logger)
[2017-06-26 15:09:06,721] TRACE Controller 1 epoch 88 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:2,ControllerEpoch:88) to broker 0 for partition [my-replicated-topic-1,1] (state.change.logger)
[2017-06-26 15:09:06,721] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:2,ControllerEpoch:88) to brokers Set(0, 1, 2) for partition my-replicated-topic-1-1 (state.change.logger)
[2017-06-26 15:09:06,724] TRACE Controller 1 epoch 88 started leader election for partition [my-replicated-topic,2] (state.change.logger)
[2017-06-26 15:09:06,725] TRACE Controller 1 epoch 88 received response {error_code=0,partitions=[{topic=my-replicated-topic,partition=0,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 15:09:06,726] TRACE Controller 1 epoch 88 received response {error_code=0,partitions=[{topic=my-replicated-topic-1,partition=1,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 15:09:06,726] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:1,ControllerEpoch:88),ReplicationFactor:2),AllReplicas:0,1) for partition my-replicated-topic-0 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 16 (state.change.logger)
[2017-06-26 15:09:06,726] ERROR Controller 1 epoch 88 encountered error while electing leader for partition [my-replicated-topic,2] due to: No other replicas in ISR 2 for [my-replicated-topic,2] besides shutting down brokers 0,2. (state.change.logger)
[2017-06-26 15:09:06,726] TRACE Controller 1 epoch 88 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 15:09:06,726] ERROR Controller 1 epoch 88 initiated state change for partition [my-replicated-topic,2] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [my-replicated-topic,2] due to: No other replicas in ISR 2 for [my-replicated-topic,2] besides shutting down brokers 0,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [my-replicated-topic,2] besides shutting down brokers 0,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 15:09:06,727] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:1,ControllerEpoch:88),ReplicationFactor:2),AllReplicas:0,2) for partition my-replicated-topic-2 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 17 (state.change.logger)
[2017-06-26 15:09:06,727] TRACE Controller 1 epoch 88 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 15:09:06,728] TRACE Controller 1 epoch 88 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 15:09:06,728] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=88, leader=1, leaderEpoch=2, isr=[1], zkVersion=2, replicas=[0, 1, 2]) correlation id 18 from controller 1 epoch 88 for partition [my-replicated-topic-1,0] (state.change.logger)
[2017-06-26 15:09:06,728] TRACE Broker 1 handling LeaderAndIsr request correlationId 18 from controller 1 epoch 88 starting the become-leader transition for partition my-replicated-topic-1-0 (state.change.logger)
[2017-06-26 15:09:06,728] INFO Broker 1 skipped the become-leader state change after marking its partition as leader with correlation id 18 from controller 1 epoch 88 for partition my-replicated-topic-1-0 since it is already the leader for the partition. (state.change.logger)
[2017-06-26 15:09:06,728] TRACE Broker 1 completed LeaderAndIsr request correlationId 18 from controller 1 epoch 88 for the become-leader transition for partition my-replicated-topic-1-0 (state.change.logger)
[2017-06-26 15:09:06,728] TRACE Controller 1 epoch 88 received response {error_code=0,partitions=[{topic=my-replicated-topic-1,partition=0,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 15:09:06,729] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:2,ControllerEpoch:88),ReplicationFactor:3),AllReplicas:0,1,2) for partition my-replicated-topic-1-0 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 19 (state.change.logger)
[2017-06-26 15:09:06,729] TRACE Controller 1 epoch 88 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 15:09:06,729] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=88, leader=1, leaderEpoch=1, isr=[1], zkVersion=1, replicas=[1, 2]) correlation id 20 from controller 1 epoch 88 for partition [my-replicated-topic-2,1] (state.change.logger)
[2017-06-26 15:09:06,729] TRACE Broker 1 handling LeaderAndIsr request correlationId 20 from controller 1 epoch 88 starting the become-leader transition for partition my-replicated-topic-2-1 (state.change.logger)
[2017-06-26 15:09:06,729] TRACE Controller 1 epoch 88 received response {error_code=0,partitions=[{topic=my-replicated-topic,partition=1,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 15:09:06,729] INFO Broker 1 skipped the become-leader state change after marking its partition as leader with correlation id 20 from controller 1 epoch 88 for partition my-replicated-topic-2-1 since it is already the leader for the partition. (state.change.logger)
[2017-06-26 15:09:06,729] TRACE Broker 1 completed LeaderAndIsr request correlationId 20 from controller 1 epoch 88 for the become-leader transition for partition my-replicated-topic-2-1 (state.change.logger)
[2017-06-26 15:09:06,730] TRACE Controller 1 epoch 88 received response {error_code=0,partitions=[{topic=my-replicated-topic-2,partition=1,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 15:09:06,730] TRACE Controller 1 epoch 88 changed state of replica 2 for partition [my-replicated-topic,1] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:06,730] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:1,ControllerEpoch:88),ReplicationFactor:2),AllReplicas:1,2) for partition my-replicated-topic-2-1 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 21 (state.change.logger)
[2017-06-26 15:09:06,730] TRACE Controller 1 epoch 88 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:1,ControllerEpoch:88) to broker 1 for partition [my-replicated-topic,1] (state.change.logger)
[2017-06-26 15:09:06,730] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:1,ControllerEpoch:88) to brokers Set(0, 1, 2) for partition my-replicated-topic-1 (state.change.logger)
[2017-06-26 15:09:06,730] TRACE Controller 1 epoch 88 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 15:09:06,731] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=88, leader=1, leaderEpoch=2, isr=[1], zkVersion=2, replicas=[0, 1, 2]) correlation id 22 from controller 1 epoch 88 for partition [my-replicated-topic-1,1] (state.change.logger)
[2017-06-26 15:09:06,731] TRACE Broker 1 handling LeaderAndIsr request correlationId 22 from controller 1 epoch 88 starting the become-leader transition for partition my-replicated-topic-1-1 (state.change.logger)
[2017-06-26 15:09:06,731] TRACE Broker 1 stopped fetchers as part of become-leader request from controller 1 epoch 88 with correlation id 22 for partition my-replicated-topic-1-1 (state.change.logger)
[2017-06-26 15:09:06,731] TRACE Broker 1 completed LeaderAndIsr request correlationId 22 from controller 1 epoch 88 for the become-leader transition for partition my-replicated-topic-1-1 (state.change.logger)
[2017-06-26 15:09:06,731] TRACE Controller 1 epoch 88 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 15:09:06,731] TRACE Controller 1 epoch 88 started leader election for partition [my-replicated-topic-1,0] (state.change.logger)
[2017-06-26 15:09:06,735] ERROR Controller 1 epoch 88 encountered error while electing leader for partition [my-replicated-topic-1,0] due to: No other replicas in ISR 1 for [my-replicated-topic-1,0] besides shutting down brokers 0,1,2. (state.change.logger)
[2017-06-26 15:09:06,735] ERROR Controller 1 epoch 88 initiated state change for partition [my-replicated-topic-1,0] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [my-replicated-topic-1,0] due to: No other replicas in ISR 1 for [my-replicated-topic-1,0] besides shutting down brokers 0,1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [my-replicated-topic-1,0] besides shutting down brokers 0,1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 15:09:06,735] TRACE Controller 1 epoch 88 received response {error_code=0,partitions=[{topic=my-replicated-topic-1,partition=1,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 15:09:06,735] TRACE Controller 1 epoch 88 started leader election for partition [my-replicated-topic-2,0] (state.change.logger)
[2017-06-26 15:09:06,735] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:2,ControllerEpoch:88),ReplicationFactor:3),AllReplicas:0,1,2) for partition my-replicated-topic-1-1 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 23 (state.change.logger)
[2017-06-26 15:09:06,735] TRACE Controller 1 epoch 88 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 15:09:06,736] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=88, leader=1, leaderEpoch=1, isr=[1], zkVersion=1, replicas=[1, 2]) correlation id 24 from controller 1 epoch 88 for partition [my-replicated-topic,1] (state.change.logger)
[2017-06-26 15:09:06,736] TRACE Broker 1 handling LeaderAndIsr request correlationId 24 from controller 1 epoch 88 starting the become-leader transition for partition my-replicated-topic-1 (state.change.logger)
[2017-06-26 15:09:06,736] INFO Broker 1 skipped the become-leader state change after marking its partition as leader with correlation id 24 from controller 1 epoch 88 for partition my-replicated-topic-1 since it is already the leader for the partition. (state.change.logger)
[2017-06-26 15:09:06,736] TRACE Broker 1 completed LeaderAndIsr request correlationId 24 from controller 1 epoch 88 for the become-leader transition for partition my-replicated-topic-1 (state.change.logger)
[2017-06-26 15:09:06,736] TRACE Controller 1 epoch 88 received response {error_code=0,partitions=[{topic=my-replicated-topic,partition=1,error_code=0}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 15:09:06,737] ERROR Controller 1 epoch 88 encountered error while electing leader for partition [my-replicated-topic-2,0] due to: No other replicas in ISR 1 for [my-replicated-topic-2,0] besides shutting down brokers 0,1,2. (state.change.logger)
[2017-06-26 15:09:06,737] ERROR Controller 1 epoch 88 initiated state change for partition [my-replicated-topic-2,0] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [my-replicated-topic-2,0] due to: No other replicas in ISR 1 for [my-replicated-topic-2,0] besides shutting down brokers 0,1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [my-replicated-topic-2,0] besides shutting down brokers 0,1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 15:09:06,737] TRACE Controller 1 epoch 88 started leader election for partition [my-replicated-topic-2,1] (state.change.logger)
[2017-06-26 15:09:06,737] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:1,ControllerEpoch:88),ReplicationFactor:2),AllReplicas:1,2) for partition my-replicated-topic-1 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 25 (state.change.logger)
[2017-06-26 15:09:06,738] TRACE Controller 1 epoch 88 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 15:09:06,739] ERROR Controller 1 epoch 88 encountered error while electing leader for partition [my-replicated-topic-2,1] due to: No other replicas in ISR 1 for [my-replicated-topic-2,1] besides shutting down brokers 0,1,2. (state.change.logger)
[2017-06-26 15:09:06,739] ERROR Controller 1 epoch 88 initiated state change for partition [my-replicated-topic-2,1] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [my-replicated-topic-2,1] due to: No other replicas in ISR 1 for [my-replicated-topic-2,1] besides shutting down brokers 0,1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [my-replicated-topic-2,1] besides shutting down brokers 0,1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 15:09:06,739] TRACE Controller 1 epoch 88 started leader election for partition [my-replicated-topic-1,1] (state.change.logger)
[2017-06-26 15:09:06,740] ERROR Controller 1 epoch 88 encountered error while electing leader for partition [my-replicated-topic-1,1] due to: No other replicas in ISR 1 for [my-replicated-topic-1,1] besides shutting down brokers 0,1,2. (state.change.logger)
[2017-06-26 15:09:06,740] ERROR Controller 1 epoch 88 initiated state change for partition [my-replicated-topic-1,1] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [my-replicated-topic-1,1] due to: No other replicas in ISR 1 for [my-replicated-topic-1,1] besides shutting down brokers 0,1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [my-replicated-topic-1,1] besides shutting down brokers 0,1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 15:09:06,741] TRACE Controller 1 epoch 88 started leader election for partition [my-replicated-topic,0] (state.change.logger)
[2017-06-26 15:09:06,742] ERROR Controller 1 epoch 88 encountered error while electing leader for partition [my-replicated-topic,0] due to: No other replicas in ISR 1 for [my-replicated-topic,0] besides shutting down brokers 0,1,2. (state.change.logger)
[2017-06-26 15:09:06,742] ERROR Controller 1 epoch 88 initiated state change for partition [my-replicated-topic,0] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [my-replicated-topic,0] due to: No other replicas in ISR 1 for [my-replicated-topic,0] besides shutting down brokers 0,1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [my-replicated-topic,0] besides shutting down brokers 0,1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 15:09:06,742] TRACE Controller 1 epoch 88 started leader election for partition [my-replicated-topic,1] (state.change.logger)
[2017-06-26 15:09:06,744] ERROR Controller 1 epoch 88 encountered error while electing leader for partition [my-replicated-topic,1] due to: No other replicas in ISR 1 for [my-replicated-topic,1] besides shutting down brokers 0,1,2. (state.change.logger)
[2017-06-26 15:09:06,744] ERROR Controller 1 epoch 88 initiated state change for partition [my-replicated-topic,1] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [my-replicated-topic,1] due to: No other replicas in ISR 1 for [my-replicated-topic,1] besides shutting down brokers 0,1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [my-replicated-topic,1] besides shutting down brokers 0,1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 15:09:06,821] TRACE Controller 1 epoch 88 received response {error_code=0,partitions=[{topic=my-replicated-topic,partition=1,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 15:09:07,818] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:2,ISR:2,0,LeaderEpoch:1,ControllerEpoch:88) to brokers Set(0, 1, 2) for partition my-replicated-topic-2 (state.change.logger)
[2017-06-26 15:09:07,818] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,0,LeaderEpoch:1,ControllerEpoch:88),ReplicationFactor:2),AllReplicas:0,2) for partition my-replicated-topic-2 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 26 (state.change.logger)
[2017-06-26 15:09:07,819] TRACE Controller 1 epoch 88 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 15:09:07,819] TRACE Controller 1 epoch 88 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 15:09:09,824] TRACE Controller 1 epoch 88 changed partition [__consumer_offsets,19] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 15:09:09,824] TRACE Controller 1 epoch 88 changed partition [test1,0] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 15:09:09,824] TRACE Controller 1 epoch 88 changed partition [__consumer_offsets,30] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 15:09:09,824] TRACE Controller 1 epoch 88 changed partition [__consumer_offsets,47] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 15:09:09,824] TRACE Controller 1 epoch 88 changed partition [__consumer_offsets,29] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 15:09:09,824] TRACE Controller 1 epoch 88 changed partition [__consumer_offsets,41] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 15:09:09,824] TRACE Controller 1 epoch 88 changed partition [__consumer_offsets,39] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 15:09:09,824] TRACE Controller 1 epoch 88 changed partition [__consumer_offsets,10] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 15:09:09,824] TRACE Controller 1 epoch 88 changed partition [__consumer_offsets,17] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 15:09:09,824] TRACE Controller 1 epoch 88 changed partition [__consumer_offsets,14] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 15:09:09,824] TRACE Controller 1 epoch 88 changed partition [__consumer_offsets,40] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 15:09:09,824] TRACE Controller 1 epoch 88 changed partition [__consumer_offsets,18] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 15:09:09,824] TRACE Controller 1 epoch 88 changed partition [__consumer_offsets,0] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 15:09:09,824] TRACE Controller 1 epoch 88 changed partition [__consumer_offsets,26] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 15:09:09,824] TRACE Controller 1 epoch 88 changed partition [__consumer_offsets,24] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 15:09:09,824] TRACE Controller 1 epoch 88 changed partition [__consumer_offsets,33] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 15:09:09,824] TRACE Controller 1 epoch 88 changed partition [__consumer_offsets,20] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 15:09:09,824] TRACE Controller 1 epoch 88 changed partition [__consumer_offsets,21] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 15:09:09,824] TRACE Controller 1 epoch 88 changed partition [__consumer_offsets,3] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 15:09:09,824] TRACE Controller 1 epoch 88 changed partition [__consumer_offsets,22] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 15:09:09,824] TRACE Controller 1 epoch 88 changed partition [__consumer_offsets,5] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 15:09:09,824] TRACE Controller 1 epoch 88 changed partition [__consumer_offsets,12] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 15:09:09,824] TRACE Controller 1 epoch 88 changed partition [__consumer_offsets,8] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 15:09:09,824] TRACE Controller 1 epoch 88 changed partition [__consumer_offsets,23] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 15:09:09,824] TRACE Controller 1 epoch 88 changed partition [__consumer_offsets,15] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 15:09:09,824] TRACE Controller 1 epoch 88 changed partition [__consumer_offsets,11] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 15:09:09,824] TRACE Controller 1 epoch 88 changed partition [__consumer_offsets,48] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 15:09:09,825] TRACE Controller 1 epoch 88 changed partition [__consumer_offsets,13] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 15:09:09,825] TRACE Controller 1 epoch 88 changed partition [__consumer_offsets,49] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 15:09:09,825] TRACE Controller 1 epoch 88 changed partition [__consumer_offsets,6] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 15:09:09,825] TRACE Controller 1 epoch 88 changed partition [__consumer_offsets,28] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 15:09:09,825] TRACE Controller 1 epoch 88 changed partition [__consumer_offsets,4] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 15:09:09,825] TRACE Controller 1 epoch 88 changed partition [__consumer_offsets,37] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 15:09:09,825] TRACE Controller 1 epoch 88 changed partition [__consumer_offsets,31] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 15:09:09,825] TRACE Controller 1 epoch 88 changed partition [__consumer_offsets,44] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 15:09:09,825] TRACE Controller 1 epoch 88 changed partition [__consumer_offsets,42] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 15:09:09,825] TRACE Controller 1 epoch 88 changed partition [__consumer_offsets,34] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 15:09:09,825] TRACE Controller 1 epoch 88 changed partition [__consumer_offsets,46] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 15:09:09,825] TRACE Controller 1 epoch 88 changed partition [__consumer_offsets,25] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 15:09:09,825] TRACE Controller 1 epoch 88 changed partition [__consumer_offsets,45] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 15:09:09,825] TRACE Controller 1 epoch 88 changed partition [__consumer_offsets,27] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 15:09:09,825] TRACE Controller 1 epoch 88 changed partition [__consumer_offsets,32] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 15:09:09,825] TRACE Controller 1 epoch 88 changed partition [__consumer_offsets,43] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 15:09:09,825] TRACE Controller 1 epoch 88 changed partition [__consumer_offsets,36] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 15:09:09,825] TRACE Controller 1 epoch 88 changed partition [__consumer_offsets,35] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 15:09:09,825] TRACE Controller 1 epoch 88 changed partition [__consumer_offsets,7] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 15:09:09,825] TRACE Controller 1 epoch 88 changed partition [test,0] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 15:09:09,825] TRACE Controller 1 epoch 88 changed partition [__consumer_offsets,9] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 15:09:09,825] TRACE Controller 1 epoch 88 changed partition [__consumer_offsets,38] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 15:09:09,825] TRACE Controller 1 epoch 88 changed partition [__consumer_offsets,1] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 15:09:09,825] TRACE Controller 1 epoch 88 changed partition [__consumer_offsets,2] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 15:09:09,825] TRACE Controller 1 epoch 88 changed partition [__consumer_offsets,16] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 15:09:09,825] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,19] (state.change.logger)
[2017-06-26 15:09:09,828] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,19] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,19] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:09,828] TRACE Controller 1 epoch 88 started leader election for partition [test1,0] (state.change.logger)
[2017-06-26 15:09:09,830] ERROR Controller 1 epoch 88 initiated state change for partition [test1,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test1,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:09,830] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,30] (state.change.logger)
[2017-06-26 15:09:09,832] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,30] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,30] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:09,832] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,47] (state.change.logger)
[2017-06-26 15:09:09,835] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,47] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,47] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:09,835] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,29] (state.change.logger)
[2017-06-26 15:09:09,837] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,29] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,29] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:09,837] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,41] (state.change.logger)
[2017-06-26 15:09:09,839] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,41] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,41] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:09,839] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,39] (state.change.logger)
[2017-06-26 15:09:09,842] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,39] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,39] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:09,842] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,17] (state.change.logger)
[2017-06-26 15:09:09,844] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,17] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,17] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:09,844] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,10] (state.change.logger)
[2017-06-26 15:09:09,846] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,10] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,10] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:09,846] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,14] (state.change.logger)
[2017-06-26 15:09:09,849] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,14] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,14] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:09,849] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,40] (state.change.logger)
[2017-06-26 15:09:09,851] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,40] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,40] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:09,851] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,18] (state.change.logger)
[2017-06-26 15:09:09,854] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,18] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,18] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:09,854] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,0] (state.change.logger)
[2017-06-26 15:09:09,856] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:09,856] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,26] (state.change.logger)
[2017-06-26 15:09:09,858] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,26] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,26] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:09,859] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,24] (state.change.logger)
[2017-06-26 15:09:09,861] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,24] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,24] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:09,861] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,33] (state.change.logger)
[2017-06-26 15:09:09,864] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,33] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,33] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:09,864] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,20] (state.change.logger)
[2017-06-26 15:09:09,866] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,20] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,20] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:09,866] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,21] (state.change.logger)
[2017-06-26 15:09:09,869] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,21] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,21] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:09,869] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,3] (state.change.logger)
[2017-06-26 15:09:09,872] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,3] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,3] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:09,873] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,22] (state.change.logger)
[2017-06-26 15:09:09,875] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,22] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,22] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:09,875] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,5] (state.change.logger)
[2017-06-26 15:09:09,878] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,5] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,5] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:09,878] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,12] (state.change.logger)
[2017-06-26 15:09:09,880] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,12] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,12] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:09,880] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,8] (state.change.logger)
[2017-06-26 15:09:09,882] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,8] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,8] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:09,882] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,23] (state.change.logger)
[2017-06-26 15:09:09,884] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,23] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,23] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:09,885] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,15] (state.change.logger)
[2017-06-26 15:09:09,888] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,15] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,15] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:09,889] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,48] (state.change.logger)
[2017-06-26 15:09:09,891] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,48] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,48] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:09,891] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,11] (state.change.logger)
[2017-06-26 15:09:09,893] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,11] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,11] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:09,893] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,13] (state.change.logger)
[2017-06-26 15:09:09,895] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,13] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,13] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:09,895] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,6] (state.change.logger)
[2017-06-26 15:09:09,897] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,6] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,6] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:09,897] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,49] (state.change.logger)
[2017-06-26 15:09:09,899] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,49] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,49] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:09,899] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,4] (state.change.logger)
[2017-06-26 15:09:09,901] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,4] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,4] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:09,901] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,28] (state.change.logger)
[2017-06-26 15:09:09,903] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,28] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,28] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:09,903] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,37] (state.change.logger)
[2017-06-26 15:09:09,905] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,37] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,37] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:09,906] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,31] (state.change.logger)
[2017-06-26 15:09:09,907] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,31] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,31] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:09,908] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,44] (state.change.logger)
[2017-06-26 15:09:09,910] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,44] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,44] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:09,910] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,42] (state.change.logger)
[2017-06-26 15:09:09,912] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,42] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,42] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:09,912] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,34] (state.change.logger)
[2017-06-26 15:09:09,914] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,34] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,34] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:09,914] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,46] (state.change.logger)
[2017-06-26 15:09:09,916] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,46] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,46] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:09,916] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,25] (state.change.logger)
[2017-06-26 15:09:09,918] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,25] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,25] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:09,918] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,27] (state.change.logger)
[2017-06-26 15:09:09,920] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,27] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,27] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:09,920] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,45] (state.change.logger)
[2017-06-26 15:09:09,922] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,45] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,45] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:09,922] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,32] (state.change.logger)
[2017-06-26 15:09:09,924] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,32] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,32] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:09,924] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,43] (state.change.logger)
[2017-06-26 15:09:09,926] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,43] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,43] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:09,927] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,36] (state.change.logger)
[2017-06-26 15:09:09,929] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,36] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,36] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:09,929] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,35] (state.change.logger)
[2017-06-26 15:09:09,931] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,35] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,35] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:09,931] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,7] (state.change.logger)
[2017-06-26 15:09:09,932] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,7] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,7] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:09,933] TRACE Controller 1 epoch 88 started leader election for partition [test,0] (state.change.logger)
[2017-06-26 15:09:09,934] ERROR Controller 1 epoch 88 initiated state change for partition [test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:09,934] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,38] (state.change.logger)
[2017-06-26 15:09:09,936] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,38] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,38] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:09,936] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,9] (state.change.logger)
[2017-06-26 15:09:09,938] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,9] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,9] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:09,938] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,1] (state.change.logger)
[2017-06-26 15:09:09,940] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,1] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,1] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:09,941] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,2] (state.change.logger)
[2017-06-26 15:09:09,943] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,2] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,2] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:09,943] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,16] (state.change.logger)
[2017-06-26 15:09:09,945] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,16] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,16] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:09,950] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [__consumer_offsets,25] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:09,952] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [__consumer_offsets,12] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:09,954] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [__consumer_offsets,31] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:09,957] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [__consumer_offsets,40] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:09,959] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [__consumer_offsets,35] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:09,962] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [test,0] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:09,964] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [__consumer_offsets,9] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:09,967] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [__consumer_offsets,43] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:09,968] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [my-replicated-topic-2,0] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:09,971] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [__consumer_offsets,2] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:09,973] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [__consumer_offsets,11] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:09,975] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [__consumer_offsets,29] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:09,976] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [my-replicated-topic,0] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:09,978] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [__consumer_offsets,30] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:09,981] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [__consumer_offsets,4] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:09,983] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [__consumer_offsets,42] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:09,985] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [__consumer_offsets,26] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:09,988] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [__consumer_offsets,34] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:09,990] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [__consumer_offsets,17] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:09,992] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [__consumer_offsets,37] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:09,995] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [__consumer_offsets,27] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:09,998] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [__consumer_offsets,10] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:10,000] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [__consumer_offsets,41] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:10,002] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [__consumer_offsets,20] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:10,004] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [__consumer_offsets,28] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:10,005] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [my-replicated-topic-1,0] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:10,007] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [__consumer_offsets,46] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:10,010] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [__consumer_offsets,39] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:10,012] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [__consumer_offsets,47] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:10,014] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [__consumer_offsets,49] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:10,017] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [__consumer_offsets,22] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:10,028] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [__consumer_offsets,1] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:10,030] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [__consumer_offsets,24] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:10,030] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [my-replicated-topic-1,1] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:10,032] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [__consumer_offsets,6] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:10,033] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [__consumer_offsets,36] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:10,034] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [my-replicated-topic,2] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:10,036] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [__consumer_offsets,8] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:10,037] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [__consumer_offsets,38] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:10,039] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [__consumer_offsets,16] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:10,040] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [__consumer_offsets,21] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:10,042] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [__consumer_offsets,18] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:10,043] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [__consumer_offsets,0] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:10,045] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [__consumer_offsets,48] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:10,046] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [__consumer_offsets,5] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:10,048] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [__consumer_offsets,13] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:10,049] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [__consumer_offsets,3] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:10,050] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [__consumer_offsets,44] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:10,051] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [__consumer_offsets,15] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:10,053] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [__consumer_offsets,7] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:10,054] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [test1,0] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:10,055] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [__consumer_offsets,19] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:10,057] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [__consumer_offsets,33] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:10,058] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [__consumer_offsets,45] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:10,059] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [__consumer_offsets,23] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:10,061] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [__consumer_offsets,32] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:10,062] TRACE Controller 1 epoch 88 changed state of replica 0 for partition [__consumer_offsets,14] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:10,062] TRACE Controller 1 epoch 88 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:2,ControllerEpoch:88) to broker 2 for partition [my-replicated-topic-1,1] (state.change.logger)
[2017-06-26 15:09:10,062] TRACE Controller 1 epoch 88 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:88) to broker 2 for partition [my-replicated-topic,2] (state.change.logger)
[2017-06-26 15:09:10,062] TRACE Controller 1 epoch 88 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:2,ControllerEpoch:88) to broker 2 for partition [my-replicated-topic-1,0] (state.change.logger)
[2017-06-26 15:09:10,062] TRACE Controller 1 epoch 88 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:2,ControllerEpoch:88) to broker 1 for partition [my-replicated-topic-1,1] (state.change.logger)
[2017-06-26 15:09:10,062] TRACE Controller 1 epoch 88 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:1,ControllerEpoch:88) to broker 1 for partition [my-replicated-topic-2,0] (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:1,ControllerEpoch:88) to broker 1 for partition [my-replicated-topic,0] (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:2,ControllerEpoch:88) to broker 1 for partition [my-replicated-topic-1,0] (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88) to brokers Set(1, 2) for partition __consumer_offsets-49 (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88) to brokers Set(1, 2) for partition __consumer_offsets-38 (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:10,ControllerEpoch:88) to brokers Set(1, 2) for partition test1-0 (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88) to brokers Set(1, 2) for partition __consumer_offsets-16 (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88) to brokers Set(1, 2) for partition __consumer_offsets-27 (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88) to brokers Set(1, 2) for partition __consumer_offsets-19 (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88) to brokers Set(1, 2) for partition __consumer_offsets-8 (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88) to brokers Set(1, 2) for partition __consumer_offsets-13 (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88) to brokers Set(1, 2) for partition __consumer_offsets-2 (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:2,ControllerEpoch:88) to brokers Set(1, 2) for partition my-replicated-topic-1-1 (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88) to brokers Set(1, 2) for partition __consumer_offsets-24 (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88) to brokers Set(1, 2) for partition __consumer_offsets-46 (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88) to brokers Set(1, 2) for partition __consumer_offsets-35 (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88) to brokers Set(1, 2) for partition __consumer_offsets-5 (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88) to brokers Set(1, 2) for partition __consumer_offsets-43 (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88) to brokers Set(1, 2) for partition __consumer_offsets-32 (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88) to brokers Set(1, 2) for partition __consumer_offsets-21 (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:1,ControllerEpoch:88) to brokers Set(1, 2) for partition my-replicated-topic-2-0 (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=88, leader=1, leaderEpoch=1, isr=[1], zkVersion=1, replicas=[0, 1]) correlation id 27 from controller 1 epoch 88 for partition [my-replicated-topic-2,0] (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88) to brokers Set(1, 2) for partition __consumer_offsets-10 (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=88, leader=1, leaderEpoch=1, isr=[1], zkVersion=1, replicas=[0, 1]) correlation id 27 from controller 1 epoch 88 for partition [my-replicated-topic,0] (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88) to brokers Set(1, 2) for partition __consumer_offsets-37 (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=88, leader=1, leaderEpoch=2, isr=[1], zkVersion=2, replicas=[0, 1, 2]) correlation id 27 from controller 1 epoch 88 for partition [my-replicated-topic-1,0] (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:1,ControllerEpoch:88) to brokers Set(1, 2) for partition my-replicated-topic-0 (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=88, leader=1, leaderEpoch=2, isr=[1], zkVersion=2, replicas=[0, 1, 2]) correlation id 27 from controller 1 epoch 88 for partition [my-replicated-topic-1,1] (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88) to brokers Set(1, 2) for partition __consumer_offsets-48 (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88) to brokers Set(1, 2) for partition __consumer_offsets-18 (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88) to brokers Set(1, 2) for partition __consumer_offsets-29 (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88) to brokers Set(1, 2) for partition __consumer_offsets-40 (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88) to brokers Set(1, 2) for partition __consumer_offsets-7 (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88) to brokers Set(1, 2) for partition __consumer_offsets-23 (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88) to brokers Set(1, 2) for partition __consumer_offsets-45 (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88) to brokers Set(1, 2) for partition __consumer_offsets-34 (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:88) to brokers Set(1, 2) for partition my-replicated-topic-2 (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88) to brokers Set(1, 2) for partition __consumer_offsets-26 (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88) to brokers Set(1, 2) for partition __consumer_offsets-15 (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88) to brokers Set(1, 2) for partition __consumer_offsets-4 (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88) to brokers Set(1, 2) for partition __consumer_offsets-42 (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88) to brokers Set(1, 2) for partition __consumer_offsets-20 (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88) to brokers Set(1, 2) for partition __consumer_offsets-9 (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88) to brokers Set(1, 2) for partition __consumer_offsets-31 (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88) to brokers Set(1, 2) for partition test-0 (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:2,ControllerEpoch:88) to brokers Set(1, 2) for partition my-replicated-topic-1-0 (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88) to brokers Set(1, 2) for partition __consumer_offsets-1 (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88) to brokers Set(1, 2) for partition __consumer_offsets-12 (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88) to brokers Set(1, 2) for partition __consumer_offsets-28 (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88) to brokers Set(1, 2) for partition __consumer_offsets-17 (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88) to brokers Set(1, 2) for partition __consumer_offsets-6 (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88) to brokers Set(1, 2) for partition __consumer_offsets-39 (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88) to brokers Set(1, 2) for partition __consumer_offsets-44 (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88) to brokers Set(1, 2) for partition __consumer_offsets-36 (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88) to brokers Set(1, 2) for partition __consumer_offsets-47 (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88) to brokers Set(1, 2) for partition __consumer_offsets-14 (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88) to brokers Set(1, 2) for partition __consumer_offsets-3 (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88) to brokers Set(1, 2) for partition __consumer_offsets-25 (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88) to brokers Set(1, 2) for partition __consumer_offsets-41 (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88) to brokers Set(1, 2) for partition __consumer_offsets-30 (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88) to brokers Set(1, 2) for partition __consumer_offsets-33 (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88) to brokers Set(1, 2) for partition __consumer_offsets-22 (state.change.logger)
[2017-06-26 15:09:10,063] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 27 epoch 88 for partition [my-replicated-topic-2,0] since its associated leader epoch 1 is not higher than the current leader epoch 1 (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88) to brokers Set(1, 2) for partition __consumer_offsets-11 (state.change.logger)
[2017-06-26 15:09:10,063] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 27 epoch 88 for partition [my-replicated-topic,0] since its associated leader epoch 1 is not higher than the current leader epoch 1 (state.change.logger)
[2017-06-26 15:09:10,063] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88) to brokers Set(1, 2) for partition __consumer_offsets-0 (state.change.logger)
[2017-06-26 15:09:10,063] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 27 epoch 88 for partition [my-replicated-topic-1,0] since its associated leader epoch 2 is not higher than the current leader epoch 2 (state.change.logger)
[2017-06-26 15:09:10,063] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 27 epoch 88 for partition [my-replicated-topic-1,1] since its associated leader epoch 2 is not higher than the current leader epoch 2 (state.change.logger)
[2017-06-26 15:09:10,064] TRACE Controller 1 epoch 88 received response {error_code=0,partitions=[{topic=my-replicated-topic-1,partition=1,error_code=11},{topic=my-replicated-topic-2,partition=0,error_code=11},{topic=my-replicated-topic,partition=0,error_code=11},{topic=my-replicated-topic-1,partition=0,error_code=11}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 15:09:10,064] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition __consumer_offsets-13 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,064] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition __consumer_offsets-46 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,064] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:1,ControllerEpoch:88),ReplicationFactor:2),AllReplicas:0,1) for partition my-replicated-topic-0 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,064] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition __consumer_offsets-9 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,064] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition __consumer_offsets-42 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,064] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition __consumer_offsets-21 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,064] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition __consumer_offsets-17 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,064] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition __consumer_offsets-30 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,064] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition __consumer_offsets-26 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,064] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition __consumer_offsets-5 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,065] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition __consumer_offsets-38 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,065] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition __consumer_offsets-1 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,065] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition __consumer_offsets-34 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,065] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition __consumer_offsets-16 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,065] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition __consumer_offsets-45 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,065] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition __consumer_offsets-12 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,065] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition __consumer_offsets-41 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,065] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:2,ControllerEpoch:88),ReplicationFactor:3),AllReplicas:0,1,2) for partition my-replicated-topic-1-1 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,065] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition __consumer_offsets-24 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,065] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition __consumer_offsets-20 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,065] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition __consumer_offsets-49 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,065] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition __consumer_offsets-0 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,065] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:10,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition test1-0 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,065] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition __consumer_offsets-29 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,065] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition __consumer_offsets-25 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,065] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition __consumer_offsets-8 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,065] TRACE Controller 1 epoch 88 received response {error_code=0,partitions=[{topic=my-replicated-topic-1,partition=1,error_code=11},{topic=my-replicated-topic,partition=2,error_code=0},{topic=my-replicated-topic-1,partition=0,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 15:09:10,065] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition __consumer_offsets-37 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,065] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition __consumer_offsets-4 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,065] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition __consumer_offsets-33 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,065] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition __consumer_offsets-15 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,065] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:1,ControllerEpoch:88),ReplicationFactor:2),AllReplicas:0,1) for partition my-replicated-topic-2-0 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,065] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition __consumer_offsets-48 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,065] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition __consumer_offsets-11 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,065] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition __consumer_offsets-44 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,065] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:88),ReplicationFactor:2),AllReplicas:0,2) for partition my-replicated-topic-2 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,065] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:2,ControllerEpoch:88),ReplicationFactor:3),AllReplicas:0,1,2) for partition my-replicated-topic-1-0 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,065] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition __consumer_offsets-23 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,065] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition __consumer_offsets-19 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,065] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition __consumer_offsets-32 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,065] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition __consumer_offsets-28 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,065] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition __consumer_offsets-7 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,066] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition __consumer_offsets-40 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,066] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition __consumer_offsets-3 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,066] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition __consumer_offsets-36 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,066] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition __consumer_offsets-47 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,066] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition __consumer_offsets-14 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,066] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition __consumer_offsets-43 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,066] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,066] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition __consumer_offsets-10 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,066] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition __consumer_offsets-22 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,066] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition __consumer_offsets-18 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,066] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition __consumer_offsets-31 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,066] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition __consumer_offsets-27 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,066] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition __consumer_offsets-39 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,066] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition __consumer_offsets-6 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,066] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition __consumer_offsets-35 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,066] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:83,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition __consumer_offsets-2 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 28 (state.change.logger)
[2017-06-26 15:09:10,066] TRACE Controller 1 epoch 88 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 15:09:10,067] TRACE Controller 1 epoch 88 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 15:09:11,745] TRACE Controller 1 epoch 88 received response {error_code=0,partitions=[{topic=my-replicated-topic-1,partition=0,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 15:09:11,745] TRACE Controller 1 epoch 88 changed state of replica 2 for partition [my-replicated-topic-1,0] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:11,745] TRACE Controller 1 epoch 88 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:2,ControllerEpoch:88) to broker 1 for partition [my-replicated-topic-1,0] (state.change.logger)
[2017-06-26 15:09:11,745] TRACE Controller 1 epoch 88 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:2,ControllerEpoch:88) to broker 0 for partition [my-replicated-topic-1,0] (state.change.logger)
[2017-06-26 15:09:11,746] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:2,ControllerEpoch:88) to brokers Set(1, 2) for partition my-replicated-topic-1-0 (state.change.logger)
[2017-06-26 15:09:11,746] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=88, leader=1, leaderEpoch=2, isr=[1], zkVersion=2, replicas=[0, 1, 2]) correlation id 29 from controller 1 epoch 88 for partition [my-replicated-topic-1,0] (state.change.logger)
[2017-06-26 15:09:11,746] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 29 epoch 88 for partition [my-replicated-topic-1,0] since its associated leader epoch 2 is not higher than the current leader epoch 2 (state.change.logger)
[2017-06-26 15:09:11,746] TRACE Controller 1 epoch 88 received response {error_code=0,partitions=[{topic=my-replicated-topic-1,partition=0,error_code=11}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 15:09:11,746] TRACE Controller 1 epoch 88 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 15:09:11,746] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:2,ControllerEpoch:88),ReplicationFactor:3),AllReplicas:0,1,2) for partition my-replicated-topic-1-0 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 30 (state.change.logger)
[2017-06-26 15:09:11,746] TRACE Controller 1 epoch 88 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 15:09:11,747] TRACE Controller 1 epoch 88 changed state of replica 2 for partition [my-replicated-topic-2,1] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:11,747] TRACE Controller 1 epoch 88 received response {error_code=0,partitions=[{topic=my-replicated-topic-1,partition=0,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 15:09:11,747] TRACE Controller 1 epoch 88 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:1,ControllerEpoch:88) to broker 1 for partition [my-replicated-topic-2,1] (state.change.logger)
[2017-06-26 15:09:11,747] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:1,ControllerEpoch:88) to brokers Set(1, 2) for partition my-replicated-topic-2-1 (state.change.logger)
[2017-06-26 15:09:11,747] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=88, leader=1, leaderEpoch=1, isr=[1], zkVersion=1, replicas=[1, 2]) correlation id 31 from controller 1 epoch 88 for partition [my-replicated-topic-2,1] (state.change.logger)
[2017-06-26 15:09:11,747] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 31 epoch 88 for partition [my-replicated-topic-2,1] since its associated leader epoch 1 is not higher than the current leader epoch 1 (state.change.logger)
[2017-06-26 15:09:11,747] TRACE Controller 1 epoch 88 received response {error_code=0,partitions=[{topic=my-replicated-topic-2,partition=1,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 15:09:11,747] TRACE Controller 1 epoch 88 received response {error_code=0,partitions=[{topic=my-replicated-topic-2,partition=1,error_code=11}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 15:09:11,748] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:1,ControllerEpoch:88),ReplicationFactor:2),AllReplicas:1,2) for partition my-replicated-topic-2-1 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 32 (state.change.logger)
[2017-06-26 15:09:11,748] TRACE Controller 1 epoch 88 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 15:09:11,748] TRACE Controller 1 epoch 88 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 15:09:11,748] TRACE Controller 1 epoch 88 changed state of replica 2 for partition [my-replicated-topic-1,1] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:11,748] TRACE Controller 1 epoch 88 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:2,ControllerEpoch:88) to broker 1 for partition [my-replicated-topic-1,1] (state.change.logger)
[2017-06-26 15:09:11,748] TRACE Controller 1 epoch 88 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:2,ControllerEpoch:88) to broker 0 for partition [my-replicated-topic-1,1] (state.change.logger)
[2017-06-26 15:09:11,748] TRACE Controller 1 epoch 88 received response {error_code=0,partitions=[{topic=my-replicated-topic-2,partition=1,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 15:09:11,748] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:2,ControllerEpoch:88) to brokers Set(1, 2) for partition my-replicated-topic-1-1 (state.change.logger)
[2017-06-26 15:09:11,748] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=88, leader=1, leaderEpoch=2, isr=[1], zkVersion=2, replicas=[0, 1, 2]) correlation id 33 from controller 1 epoch 88 for partition [my-replicated-topic-1,1] (state.change.logger)
[2017-06-26 15:09:11,748] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 33 epoch 88 for partition [my-replicated-topic-1,1] since its associated leader epoch 2 is not higher than the current leader epoch 2 (state.change.logger)
[2017-06-26 15:09:11,748] TRACE Controller 1 epoch 88 received response {error_code=0,partitions=[{topic=my-replicated-topic-1,partition=1,error_code=11}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 15:09:11,748] TRACE Controller 1 epoch 88 started leader election for partition [my-replicated-topic,2] (state.change.logger)
[2017-06-26 15:09:11,749] TRACE Controller 1 epoch 88 received response {error_code=0,partitions=[{topic=my-replicated-topic-1,partition=1,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 15:09:11,749] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:2,ControllerEpoch:88),ReplicationFactor:3),AllReplicas:0,1,2) for partition my-replicated-topic-1-1 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 34 (state.change.logger)
[2017-06-26 15:09:11,749] TRACE Controller 1 epoch 88 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 15:09:11,749] TRACE Controller 1 epoch 88 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 15:09:11,749] ERROR Controller 1 epoch 88 encountered error while electing leader for partition [my-replicated-topic,2] due to: No other replicas in ISR 2 for [my-replicated-topic,2] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-26 15:09:11,749] ERROR Controller 1 epoch 88 initiated state change for partition [my-replicated-topic,2] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [my-replicated-topic,2] due to: No other replicas in ISR 2 for [my-replicated-topic,2] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [my-replicated-topic,2] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 15:09:11,749] TRACE Controller 1 epoch 88 received response {error_code=0,partitions=[{topic=my-replicated-topic-1,partition=1,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 15:09:11,750] TRACE Controller 1 epoch 88 received response {error_code=0,partitions=[{topic=my-replicated-topic,partition=1,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 15:09:11,750] TRACE Controller 1 epoch 88 changed state of replica 2 for partition [my-replicated-topic,1] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:11,750] TRACE Controller 1 epoch 88 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:1,ControllerEpoch:88) to broker 1 for partition [my-replicated-topic,1] (state.change.logger)
[2017-06-26 15:09:11,750] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:1,ControllerEpoch:88) to brokers Set(1, 2) for partition my-replicated-topic-1 (state.change.logger)
[2017-06-26 15:09:11,751] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=88, leader=1, leaderEpoch=1, isr=[1], zkVersion=1, replicas=[1, 2]) correlation id 35 from controller 1 epoch 88 for partition [my-replicated-topic,1] (state.change.logger)
[2017-06-26 15:09:11,751] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 35 epoch 88 for partition [my-replicated-topic,1] since its associated leader epoch 1 is not higher than the current leader epoch 1 (state.change.logger)
[2017-06-26 15:09:11,751] TRACE Controller 1 epoch 88 received response {error_code=0,partitions=[{topic=my-replicated-topic,partition=1,error_code=11}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 15:09:11,751] TRACE Controller 1 epoch 88 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 15:09:11,751] TRACE Controller 1 epoch 88 started leader election for partition [my-replicated-topic-1,0] (state.change.logger)
[2017-06-26 15:09:11,751] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:1,ControllerEpoch:88),ReplicationFactor:2),AllReplicas:1,2) for partition my-replicated-topic-1 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 36 (state.change.logger)
[2017-06-26 15:09:11,751] TRACE Controller 1 epoch 88 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 15:09:11,751] TRACE Controller 1 epoch 88 received response {error_code=0,partitions=[{topic=my-replicated-topic,partition=1,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 15:09:11,752] ERROR Controller 1 epoch 88 encountered error while electing leader for partition [my-replicated-topic-1,0] due to: No other replicas in ISR 1 for [my-replicated-topic-1,0] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-26 15:09:11,752] ERROR Controller 1 epoch 88 initiated state change for partition [my-replicated-topic-1,0] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [my-replicated-topic-1,0] due to: No other replicas in ISR 1 for [my-replicated-topic-1,0] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [my-replicated-topic-1,0] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 15:09:11,752] TRACE Controller 1 epoch 88 started leader election for partition [my-replicated-topic-2,0] (state.change.logger)
[2017-06-26 15:09:11,753] ERROR Controller 1 epoch 88 encountered error while electing leader for partition [my-replicated-topic-2,0] due to: No other replicas in ISR 1 for [my-replicated-topic-2,0] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-26 15:09:11,753] ERROR Controller 1 epoch 88 initiated state change for partition [my-replicated-topic-2,0] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [my-replicated-topic-2,0] due to: No other replicas in ISR 1 for [my-replicated-topic-2,0] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [my-replicated-topic-2,0] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 15:09:11,753] TRACE Controller 1 epoch 88 started leader election for partition [my-replicated-topic-2,1] (state.change.logger)
[2017-06-26 15:09:11,754] ERROR Controller 1 epoch 88 encountered error while electing leader for partition [my-replicated-topic-2,1] due to: No other replicas in ISR 1 for [my-replicated-topic-2,1] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-26 15:09:11,754] ERROR Controller 1 epoch 88 initiated state change for partition [my-replicated-topic-2,1] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [my-replicated-topic-2,1] due to: No other replicas in ISR 1 for [my-replicated-topic-2,1] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [my-replicated-topic-2,1] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 15:09:11,754] TRACE Controller 1 epoch 88 started leader election for partition [my-replicated-topic-1,1] (state.change.logger)
[2017-06-26 15:09:11,755] ERROR Controller 1 epoch 88 encountered error while electing leader for partition [my-replicated-topic-1,1] due to: No other replicas in ISR 1 for [my-replicated-topic-1,1] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-26 15:09:11,755] ERROR Controller 1 epoch 88 initiated state change for partition [my-replicated-topic-1,1] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [my-replicated-topic-1,1] due to: No other replicas in ISR 1 for [my-replicated-topic-1,1] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [my-replicated-topic-1,1] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 15:09:11,755] TRACE Controller 1 epoch 88 started leader election for partition [my-replicated-topic,0] (state.change.logger)
[2017-06-26 15:09:11,755] ERROR Controller 1 epoch 88 encountered error while electing leader for partition [my-replicated-topic,0] due to: No other replicas in ISR 1 for [my-replicated-topic,0] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-26 15:09:11,755] ERROR Controller 1 epoch 88 initiated state change for partition [my-replicated-topic,0] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [my-replicated-topic,0] due to: No other replicas in ISR 1 for [my-replicated-topic,0] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [my-replicated-topic,0] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 15:09:11,756] TRACE Controller 1 epoch 88 started leader election for partition [my-replicated-topic,1] (state.change.logger)
[2017-06-26 15:09:11,756] ERROR Controller 1 epoch 88 encountered error while electing leader for partition [my-replicated-topic,1] due to: No other replicas in ISR 1 for [my-replicated-topic,1] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-26 15:09:11,756] ERROR Controller 1 epoch 88 initiated state change for partition [my-replicated-topic,1] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [my-replicated-topic,1] due to: No other replicas in ISR 1 for [my-replicated-topic,1] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [my-replicated-topic,1] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 15:09:16,760] TRACE Controller 1 epoch 88 received response {error_code=0,partitions=[{topic=my-replicated-topic-1,partition=0,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 15:09:16,760] TRACE Controller 1 epoch 88 changed state of replica 2 for partition [my-replicated-topic-1,0] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:16,760] TRACE Controller 1 epoch 88 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:2,ControllerEpoch:88) to broker 1 for partition [my-replicated-topic-1,0] (state.change.logger)
[2017-06-26 15:09:16,760] TRACE Controller 1 epoch 88 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:2,ControllerEpoch:88) to broker 0 for partition [my-replicated-topic-1,0] (state.change.logger)
[2017-06-26 15:09:16,760] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:2,ControllerEpoch:88) to brokers Set(1, 2) for partition my-replicated-topic-1-0 (state.change.logger)
[2017-06-26 15:09:16,761] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=88, leader=1, leaderEpoch=2, isr=[1], zkVersion=2, replicas=[0, 1, 2]) correlation id 37 from controller 1 epoch 88 for partition [my-replicated-topic-1,0] (state.change.logger)
[2017-06-26 15:09:16,761] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 37 epoch 88 for partition [my-replicated-topic-1,0] since its associated leader epoch 2 is not higher than the current leader epoch 2 (state.change.logger)
[2017-06-26 15:09:16,761] TRACE Controller 1 epoch 88 received response {error_code=0,partitions=[{topic=my-replicated-topic-1,partition=0,error_code=11}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 15:09:16,761] TRACE Controller 1 epoch 88 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 15:09:16,761] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:2,ControllerEpoch:88),ReplicationFactor:3),AllReplicas:0,1,2) for partition my-replicated-topic-1-0 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 38 (state.change.logger)
[2017-06-26 15:09:16,761] TRACE Controller 1 epoch 88 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 15:09:16,762] TRACE Controller 1 epoch 88 received response {error_code=0,partitions=[{topic=my-replicated-topic-1,partition=0,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 15:09:16,762] TRACE Controller 1 epoch 88 received response {error_code=0,partitions=[{topic=my-replicated-topic-2,partition=1,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 15:09:16,763] TRACE Controller 1 epoch 88 changed state of replica 2 for partition [my-replicated-topic-2,1] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:16,763] TRACE Controller 1 epoch 88 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:1,ControllerEpoch:88) to broker 1 for partition [my-replicated-topic-2,1] (state.change.logger)
[2017-06-26 15:09:16,763] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:1,ControllerEpoch:88) to brokers Set(1, 2) for partition my-replicated-topic-2-1 (state.change.logger)
[2017-06-26 15:09:16,763] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=88, leader=1, leaderEpoch=1, isr=[1], zkVersion=1, replicas=[1, 2]) correlation id 39 from controller 1 epoch 88 for partition [my-replicated-topic-2,1] (state.change.logger)
[2017-06-26 15:09:16,763] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 39 epoch 88 for partition [my-replicated-topic-2,1] since its associated leader epoch 1 is not higher than the current leader epoch 1 (state.change.logger)
[2017-06-26 15:09:16,763] TRACE Controller 1 epoch 88 received response {error_code=0,partitions=[{topic=my-replicated-topic-2,partition=1,error_code=11}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 15:09:16,764] TRACE Controller 1 epoch 88 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 15:09:16,764] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:1,ControllerEpoch:88),ReplicationFactor:2),AllReplicas:1,2) for partition my-replicated-topic-2-1 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 40 (state.change.logger)
[2017-06-26 15:09:16,764] TRACE Controller 1 epoch 88 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 15:09:16,764] TRACE Controller 1 epoch 88 received response {error_code=0,partitions=[{topic=my-replicated-topic-2,partition=1,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 15:09:16,764] TRACE Controller 1 epoch 88 changed state of replica 2 for partition [my-replicated-topic-1,1] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:16,764] TRACE Controller 1 epoch 88 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:2,ControllerEpoch:88) to broker 1 for partition [my-replicated-topic-1,1] (state.change.logger)
[2017-06-26 15:09:16,764] TRACE Controller 1 epoch 88 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:2,ControllerEpoch:88) to broker 0 for partition [my-replicated-topic-1,1] (state.change.logger)
[2017-06-26 15:09:16,764] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:2,ControllerEpoch:88) to brokers Set(1, 2) for partition my-replicated-topic-1-1 (state.change.logger)
[2017-06-26 15:09:16,764] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=88, leader=1, leaderEpoch=2, isr=[1], zkVersion=2, replicas=[0, 1, 2]) correlation id 41 from controller 1 epoch 88 for partition [my-replicated-topic-1,1] (state.change.logger)
[2017-06-26 15:09:16,764] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 41 epoch 88 for partition [my-replicated-topic-1,1] since its associated leader epoch 2 is not higher than the current leader epoch 2 (state.change.logger)
[2017-06-26 15:09:16,765] TRACE Controller 1 epoch 88 received response {error_code=0,partitions=[{topic=my-replicated-topic-1,partition=1,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 15:09:16,765] TRACE Controller 1 epoch 88 started leader election for partition [my-replicated-topic,2] (state.change.logger)
[2017-06-26 15:09:16,765] TRACE Controller 1 epoch 88 received response {error_code=0,partitions=[{topic=my-replicated-topic-1,partition=1,error_code=11}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 15:09:16,765] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:2,ControllerEpoch:88),ReplicationFactor:3),AllReplicas:0,1,2) for partition my-replicated-topic-1-1 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 42 (state.change.logger)
[2017-06-26 15:09:16,765] TRACE Controller 1 epoch 88 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 15:09:16,765] TRACE Controller 1 epoch 88 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 15:09:16,765] ERROR Controller 1 epoch 88 encountered error while electing leader for partition [my-replicated-topic,2] due to: No other replicas in ISR 2 for [my-replicated-topic,2] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-26 15:09:16,765] ERROR Controller 1 epoch 88 initiated state change for partition [my-replicated-topic,2] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [my-replicated-topic,2] due to: No other replicas in ISR 2 for [my-replicated-topic,2] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [my-replicated-topic,2] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 15:09:16,765] TRACE Controller 1 epoch 88 received response {error_code=0,partitions=[{topic=my-replicated-topic-1,partition=1,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 15:09:16,766] TRACE Controller 1 epoch 88 received response {error_code=0,partitions=[{topic=my-replicated-topic,partition=1,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 15:09:16,766] TRACE Controller 1 epoch 88 changed state of replica 2 for partition [my-replicated-topic,1] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:16,767] TRACE Controller 1 epoch 88 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:1,ControllerEpoch:88) to broker 1 for partition [my-replicated-topic,1] (state.change.logger)
[2017-06-26 15:09:16,767] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:1,ControllerEpoch:88) to brokers Set(1, 2) for partition my-replicated-topic-1 (state.change.logger)
[2017-06-26 15:09:16,767] TRACE Broker 1 received LeaderAndIsr request PartitionState(controllerEpoch=88, leader=1, leaderEpoch=1, isr=[1], zkVersion=1, replicas=[1, 2]) correlation id 43 from controller 1 epoch 88 for partition [my-replicated-topic,1] (state.change.logger)
[2017-06-26 15:09:16,767] WARN Broker 1 ignoring LeaderAndIsr request from controller 1 with correlation id 43 epoch 88 for partition [my-replicated-topic,1] since its associated leader epoch 1 is not higher than the current leader epoch 1 (state.change.logger)
[2017-06-26 15:09:16,768] TRACE Controller 1 epoch 88 received response {error_code=0} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 15:09:16,768] TRACE Controller 1 epoch 88 received response {error_code=0,partitions=[{topic=my-replicated-topic,partition=1,error_code=11}]} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 15:09:16,768] TRACE Controller 1 epoch 88 started leader election for partition [my-replicated-topic-1,0] (state.change.logger)
[2017-06-26 15:09:16,768] TRACE Broker 1 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:1,ControllerEpoch:88),ReplicationFactor:2),AllReplicas:1,2) for partition my-replicated-topic-1 in response to UpdateMetadata request sent by controller 1 epoch 88 with correlation id 44 (state.change.logger)
[2017-06-26 15:09:16,768] TRACE Controller 1 epoch 88 received response {error_code=0} for a request sent to broker 10.133.22.156:9093 (id: 1 rack: null) (state.change.logger)
[2017-06-26 15:09:16,768] TRACE Controller 1 epoch 88 received response {error_code=0,partitions=[{topic=my-replicated-topic,partition=1,error_code=0}]} for a request sent to broker 10.133.22.156:9094 (id: 2 rack: null) (state.change.logger)
[2017-06-26 15:09:16,769] ERROR Controller 1 epoch 88 encountered error while electing leader for partition [my-replicated-topic-1,0] due to: No other replicas in ISR 1 for [my-replicated-topic-1,0] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-26 15:09:16,769] ERROR Controller 1 epoch 88 initiated state change for partition [my-replicated-topic-1,0] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [my-replicated-topic-1,0] due to: No other replicas in ISR 1 for [my-replicated-topic-1,0] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [my-replicated-topic-1,0] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 15:09:16,769] TRACE Controller 1 epoch 88 started leader election for partition [my-replicated-topic-2,0] (state.change.logger)
[2017-06-26 15:09:16,770] ERROR Controller 1 epoch 88 encountered error while electing leader for partition [my-replicated-topic-2,0] due to: No other replicas in ISR 1 for [my-replicated-topic-2,0] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-26 15:09:16,770] ERROR Controller 1 epoch 88 initiated state change for partition [my-replicated-topic-2,0] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [my-replicated-topic-2,0] due to: No other replicas in ISR 1 for [my-replicated-topic-2,0] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [my-replicated-topic-2,0] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 15:09:16,771] TRACE Controller 1 epoch 88 started leader election for partition [my-replicated-topic-2,1] (state.change.logger)
[2017-06-26 15:09:16,772] ERROR Controller 1 epoch 88 encountered error while electing leader for partition [my-replicated-topic-2,1] due to: No other replicas in ISR 1 for [my-replicated-topic-2,1] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-26 15:09:16,772] ERROR Controller 1 epoch 88 initiated state change for partition [my-replicated-topic-2,1] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [my-replicated-topic-2,1] due to: No other replicas in ISR 1 for [my-replicated-topic-2,1] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [my-replicated-topic-2,1] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 15:09:16,772] TRACE Controller 1 epoch 88 started leader election for partition [my-replicated-topic-1,1] (state.change.logger)
[2017-06-26 15:09:16,773] ERROR Controller 1 epoch 88 encountered error while electing leader for partition [my-replicated-topic-1,1] due to: No other replicas in ISR 1 for [my-replicated-topic-1,1] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-26 15:09:16,773] ERROR Controller 1 epoch 88 initiated state change for partition [my-replicated-topic-1,1] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [my-replicated-topic-1,1] due to: No other replicas in ISR 1 for [my-replicated-topic-1,1] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [my-replicated-topic-1,1] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 22 more
[2017-06-26 15:09:16,773] TRACE Controller 1 epoch 88 started leader election for partition [my-replicated-topic,0] (state.change.logger)
[2017-06-26 15:09:16,774] ERROR Controller 1 epoch 88 encountered error while electing leader for partition [my-replicated-topic,0] due to: No other replicas in ISR 1 for [my-replicated-topic,0] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-26 15:09:16,774] ERROR Controller 1 epoch 88 initiated state change for partition [my-replicated-topic,0] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [my-replicated-topic,0] due to: No other replicas in ISR 1 for [my-replicated-topic,0] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [my-replicated-topic,0] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 15:09:16,774] TRACE Controller 1 epoch 88 started leader election for partition [my-replicated-topic,1] (state.change.logger)
[2017-06-26 15:09:16,775] ERROR Controller 1 epoch 88 encountered error while electing leader for partition [my-replicated-topic,1] due to: No other replicas in ISR 1 for [my-replicated-topic,1] besides shutting down brokers 1,2. (state.change.logger)
[2017-06-26 15:09:16,775] ERROR Controller 1 epoch 88 initiated state change for partition [my-replicated-topic,1] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [my-replicated-topic,1] due to: No other replicas in ISR 1 for [my-replicated-topic,1] besides shutting down brokers 1,2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:362)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:202)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:141)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:140)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:140)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:268)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:263)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:263)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:259)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:224)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:87)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:62)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 1 for [my-replicated-topic,1] besides shutting down brokers 1,2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	... 21 more
[2017-06-26 15:09:23,991] TRACE Controller 1 epoch 88 changed partition [my-replicated-topic,2] state from OnlinePartition to OfflinePartition (state.change.logger)
[2017-06-26 15:09:23,991] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,19] (state.change.logger)
[2017-06-26 15:09:23,993] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,19] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,19] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:23,993] TRACE Controller 1 epoch 88 started leader election for partition [test1,0] (state.change.logger)
[2017-06-26 15:09:23,994] ERROR Controller 1 epoch 88 initiated state change for partition [test1,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test1,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:23,994] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,30] (state.change.logger)
[2017-06-26 15:09:23,995] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,30] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,30] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:23,995] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,47] (state.change.logger)
[2017-06-26 15:09:23,997] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,47] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,47] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:23,997] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,29] (state.change.logger)
[2017-06-26 15:09:23,998] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,29] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,29] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:23,998] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,41] (state.change.logger)
[2017-06-26 15:09:23,999] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,41] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,41] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:23,999] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,39] (state.change.logger)
[2017-06-26 15:09:24,000] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,39] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,39] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:24,001] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,17] (state.change.logger)
[2017-06-26 15:09:24,002] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,17] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,17] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:24,002] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,10] (state.change.logger)
[2017-06-26 15:09:24,003] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,10] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,10] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:24,003] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,14] (state.change.logger)
[2017-06-26 15:09:24,004] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,14] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,14] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:24,004] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,40] (state.change.logger)
[2017-06-26 15:09:24,005] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,40] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,40] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:24,005] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,18] (state.change.logger)
[2017-06-26 15:09:24,007] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,18] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,18] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:24,007] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,0] (state.change.logger)
[2017-06-26 15:09:24,008] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:24,008] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,26] (state.change.logger)
[2017-06-26 15:09:24,009] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,26] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,26] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:24,010] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,24] (state.change.logger)
[2017-06-26 15:09:24,011] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,24] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,24] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:24,011] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,33] (state.change.logger)
[2017-06-26 15:09:24,012] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,33] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,33] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:24,013] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,20] (state.change.logger)
[2017-06-26 15:09:24,014] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,20] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,20] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:24,014] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,21] (state.change.logger)
[2017-06-26 15:09:24,015] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,21] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,21] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:24,015] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,3] (state.change.logger)
[2017-06-26 15:09:24,016] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,3] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,3] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:24,016] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,22] (state.change.logger)
[2017-06-26 15:09:24,017] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,22] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,22] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:24,017] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,5] (state.change.logger)
[2017-06-26 15:09:24,020] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,5] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,5] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:24,021] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,12] (state.change.logger)
[2017-06-26 15:09:24,023] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,12] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,12] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:24,023] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,8] (state.change.logger)
[2017-06-26 15:09:24,026] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,8] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,8] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:24,026] TRACE Controller 1 epoch 88 started leader election for partition [my-replicated-topic,2] (state.change.logger)
[2017-06-26 15:09:24,027] ERROR Controller 1 epoch 88 initiated state change for partition [my-replicated-topic,2] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [my-replicated-topic,2] is alive. Live brokers are: [Set()], Assigned replicas are: [List(2, 0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:24,027] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,23] (state.change.logger)
[2017-06-26 15:09:24,029] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,23] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,23] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:24,029] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,15] (state.change.logger)
[2017-06-26 15:09:24,030] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,15] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,15] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:24,030] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,48] (state.change.logger)
[2017-06-26 15:09:24,032] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,48] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,48] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:24,032] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,11] (state.change.logger)
[2017-06-26 15:09:24,033] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,11] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,11] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:24,033] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,13] (state.change.logger)
[2017-06-26 15:09:24,035] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,13] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,13] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:24,036] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,6] (state.change.logger)
[2017-06-26 15:09:24,037] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,6] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,6] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:24,037] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,49] (state.change.logger)
[2017-06-26 15:09:24,040] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,49] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,49] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:24,040] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,4] (state.change.logger)
[2017-06-26 15:09:24,042] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,4] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,4] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:24,043] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,28] (state.change.logger)
[2017-06-26 15:09:24,044] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,28] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,28] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:24,045] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,37] (state.change.logger)
[2017-06-26 15:09:24,046] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,37] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,37] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:24,046] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,31] (state.change.logger)
[2017-06-26 15:09:24,047] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,31] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,31] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:24,048] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,44] (state.change.logger)
[2017-06-26 15:09:24,049] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,44] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,44] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:24,049] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,42] (state.change.logger)
[2017-06-26 15:09:24,050] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,42] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,42] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:24,050] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,34] (state.change.logger)
[2017-06-26 15:09:24,052] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,34] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,34] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:24,052] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,46] (state.change.logger)
[2017-06-26 15:09:24,053] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,46] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,46] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:24,053] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,25] (state.change.logger)
[2017-06-26 15:09:24,054] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,25] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,25] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:24,054] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,27] (state.change.logger)
[2017-06-26 15:09:24,056] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,27] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,27] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:24,056] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,45] (state.change.logger)
[2017-06-26 15:09:24,057] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,45] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,45] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:24,057] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,32] (state.change.logger)
[2017-06-26 15:09:24,058] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,32] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,32] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:24,058] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,43] (state.change.logger)
[2017-06-26 15:09:24,059] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,43] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,43] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:24,060] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,36] (state.change.logger)
[2017-06-26 15:09:24,061] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,36] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,36] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:24,061] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,35] (state.change.logger)
[2017-06-26 15:09:24,062] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,35] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,35] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:24,062] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,7] (state.change.logger)
[2017-06-26 15:09:24,063] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,7] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,7] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:24,063] TRACE Controller 1 epoch 88 started leader election for partition [test,0] (state.change.logger)
[2017-06-26 15:09:24,064] ERROR Controller 1 epoch 88 initiated state change for partition [test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:24,065] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,38] (state.change.logger)
[2017-06-26 15:09:24,066] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,38] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,38] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:24,066] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,9] (state.change.logger)
[2017-06-26 15:09:24,067] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,9] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,9] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:24,067] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,1] (state.change.logger)
[2017-06-26 15:09:24,068] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,1] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,1] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:24,068] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,2] (state.change.logger)
[2017-06-26 15:09:24,069] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,2] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,2] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:24,069] TRACE Controller 1 epoch 88 started leader election for partition [__consumer_offsets,16] (state.change.logger)
[2017-06-26 15:09:24,070] ERROR Controller 1 epoch 88 initiated state change for partition [__consumer_offsets,16] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [__consumer_offsets,16] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:339)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:200)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:115)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:112)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:112)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:480)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$doHandleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:213)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.doHandleChildChange(ReplicaStateMachine.scala:355)
	at kafka.controller.ControllerZkChildListener$class.handleChildChange(ControllerZkListener.scala:35)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:349)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:844)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:72)
[2017-06-26 15:09:24,071] TRACE Controller 1 epoch 88 changed state of replica 2 for partition [my-replicated-topic-1,1] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:24,072] TRACE Controller 1 epoch 88 changed state of replica 2 for partition [my-replicated-topic-2,1] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:24,072] TRACE Controller 1 epoch 88 changed state of replica 2 for partition [my-replicated-topic,1] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:24,075] TRACE Controller 1 epoch 88 changed state of replica 2 for partition [my-replicated-topic,2] from OnlineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:24,076] TRACE Controller 1 epoch 88 changed state of replica 2 for partition [my-replicated-topic-1,0] from OfflineReplica to OfflineReplica (state.change.logger)
[2017-06-26 15:09:24,076] TRACE Controller 1 epoch 88 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:2,ControllerEpoch:88) to broker 1 for partition [my-replicated-topic-1,1] (state.change.logger)
[2017-06-26 15:09:24,076] TRACE Controller 1 epoch 88 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:2,ControllerEpoch:88) to broker 1 for partition [my-replicated-topic-1,0] (state.change.logger)
[2017-06-26 15:09:24,076] TRACE Controller 1 epoch 88 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:1,ControllerEpoch:88) to broker 1 for partition [my-replicated-topic-2,1] (state.change.logger)
[2017-06-26 15:09:24,076] TRACE Controller 1 epoch 88 sending become-leader LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:1,ControllerEpoch:88) to broker 1 for partition [my-replicated-topic,1] (state.change.logger)
[2017-06-26 15:09:24,076] TRACE Controller 1 epoch 88 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:2,ControllerEpoch:88) to broker 0 for partition [my-replicated-topic-1,1] (state.change.logger)
[2017-06-26 15:09:24,076] TRACE Controller 1 epoch 88 sending become-follower LeaderAndIsr request (Leader:-1,ISR:,LeaderEpoch:3,ControllerEpoch:88) to broker 0 for partition [my-replicated-topic,2] (state.change.logger)
[2017-06-26 15:09:24,076] TRACE Controller 1 epoch 88 sending become-follower LeaderAndIsr request (Leader:1,ISR:1,LeaderEpoch:2,ControllerEpoch:88) to broker 0 for partition [my-replicated-topic-1,0] (state.change.logger)
[2017-06-26 15:09:24,076] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:2,ControllerEpoch:88) to brokers Set(1) for partition my-replicated-topic-1-1 (state.change.logger)
[2017-06-26 15:09:24,076] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:3,ControllerEpoch:88) to brokers Set(1) for partition my-replicated-topic-2 (state.change.logger)
[2017-06-26 15:09:24,076] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:2,ControllerEpoch:88) to brokers Set(1) for partition my-replicated-topic-1-0 (state.change.logger)
[2017-06-26 15:09:24,076] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:1,ControllerEpoch:88) to brokers Set(1) for partition my-replicated-topic-2-1 (state.change.logger)
[2017-06-26 15:09:24,076] TRACE Controller 1 epoch 88 sending UpdateMetadata request (Leader:1,ISR:1,LeaderEpoch:1,ControllerEpoch:88) to brokers Set(1) for partition my-replicated-topic-1 (state.change.logger)
